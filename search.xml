<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Jetpack ViewModel åˆ†æ</title>
      <link href="/20221210/jetpack-viewmodel-fen-xi/"/>
      <url>/20221210/jetpack-viewmodel-fen-xi/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://developer.android.com/topic/libraries/architecture/viewmodel?hl=zh-cn">ViewModel å®˜æ–¹æ–‡æ¡£</a>ä»‹ç»</p><blockquote><p><a href="https://developer.android.com/reference/androidx/lifecycle/ViewModel?hl=zh-cn"><code>ViewModel</code></a>&nbsp;ç±»æ˜¯ä¸€ç§<a href="https://developer.android.com/topic/architecture/ui-layer/stateholders?hl=zh-cn">ä¸šåŠ¡é€»è¾‘æˆ–å±å¹•çº§çŠ¶æ€å®¹å™¨</a>ã€‚<br>å®ƒç”¨äºå°†çŠ¶æ€å…¬å¼€ç»™ç•Œé¢ï¼Œä»¥åŠå°è£…ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘ã€‚<br>å®ƒçš„ä¸»è¦ä¼˜ç‚¹æ˜¯ï¼Œå®ƒå¯ä»¥ç¼“å­˜çŠ¶æ€ï¼Œå¹¶å¯åœ¨é…ç½®æ›´æ”¹åæŒä¹…ä¿ç•™ç›¸åº”çŠ¶æ€ã€‚<br>è¿™æ„å‘³ç€åœ¨ activity ä¹‹é—´å¯¼èˆªæ—¶æˆ–è¿›è¡Œé…ç½®æ›´æ”¹åï¼ˆä¾‹å¦‚æ—‹è½¬å±å¹•æ—¶ï¼‰ï¼Œç•Œé¢å°†æ— éœ€é‡æ–°æå–æ•°æ®ã€‚</p></blockquote><h2 id="ViewModel-çš„ä¼˜åŠ¿"><a href="#ViewModel-çš„ä¼˜åŠ¿" class="headerlink" title="ViewModel çš„ä¼˜åŠ¿"></a>ViewModel çš„ä¼˜åŠ¿</h2><p>ViewModel å¯ä»¥æ›¿ä»£éœ€è¦æ‰‹åŠ¨å®ç° onSaveInstanceState ç­‰æ–¹æ³•æ¥å®ç°æ•°æ®ä¿å­˜å’Œæ¢å¤ã€‚<br>åœ¨ Navigation ç›®çš„åœ°ä¹‹é—´å¯¼èˆªæ—¶æˆ–è€… Activity å¼‚å¸¸é”€æ¯æ—¶ï¼Œéœ€è¦ä¿å­˜æ•°æ®ä»¥ä¾¿åç»­é‡å»ºæ—¶æ¢å¤ã€‚<br>æ­¤æ—¶ï¼Œå¦‚æœæ‚¨ä¸åˆ©ç”¨<a href="https://developer.android.com/topic/libraries/architecture/saving-states?hl=zh-cn#onsaveinstancestate">ä¿å­˜å®ä¾‹çŠ¶æ€æœºåˆ¶</a>å­˜å‚¨ç›¸åº”æ•°æ®ï¼Œç³»ç»Ÿä¾¿ä¼šé”€æ¯ç›¸åº”æ•°æ®ã€‚ViewModel æä¾›äº†ä¸€ä¸ªä¾¿æ·çš„æ•°æ®æŒä¹…æ€§ APIï¼Œå¯ä»¥è§£å†³æ­¤é—®é¢˜ã€‚</p><p>ViewModel ä¸»è¦ä¼˜åŠ¿å®é™…ä¸Šæœ‰ä¸¤ä¸ªæ–¹é¢ï¼š</p><ul><li>  å®ƒå…è®¸æ‚¨æŒä¹…ä¿ç•™ç•Œé¢çŠ¶æ€ã€‚</li><li>  å®ƒå¯ä»¥æä¾›å¯¹ä¸šåŠ¡é€»è¾‘çš„è®¿é—®æƒé™ã€‚</li></ul><h2 id="ViewModel-ä½¿ç”¨æ–¹æ³•"><a href="#ViewModel-ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ViewModel ä½¿ç”¨æ–¹æ³•"></a>ViewModel ä½¿ç”¨æ–¹æ³•</h2><h3 id="å¢åŠ ç›¸å…³åº“ä¾èµ–"><a href="#å¢åŠ ç›¸å…³åº“ä¾èµ–" class="headerlink" title="å¢åŠ ç›¸å…³åº“ä¾èµ–"></a>å¢åŠ ç›¸å…³åº“ä¾èµ–</h3><pre class="line-numbers language-groovy" data-language="groovy"><code class="language-groovy">implementation <span class="token string">'androidx.core:core-ktx:1.10.1'</span>  implementation <span class="token string">'androidx.appcompat:appcompat:1.6.1'</span>  implementation <span class="token string">'androidx.activity:activity-ktx:1.7.1'</span>  implementation <span class="token string">'androidx.fragment:fragment-ktx:1.5.7'</span>implementation <span class="token interpolation-string"><span class="token string">"androidx.lifecycle:lifecycle-runtime-ktx:2.6.1"</span></span>  implementation <span class="token interpolation-string"><span class="token string">"androidx.lifecycle:lifecycle-livedata-ktx:2.6.1"</span></span>  implementation <span class="token interpolation-string"><span class="token string">"androidx.lifecycle:lifecycle-viewmodel-ktx:2.6.1"</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ViewModel-å®šä¹‰"><a href="#ViewModel-å®šä¹‰" class="headerlink" title="ViewModel å®šä¹‰"></a>ViewModel å®šä¹‰</h3><p>åˆ†ä¸ºæ™®é€š ViewModel å’Œ AndroidViewModel (å¯ä»¥æ‹¿åˆ° Application å®ä¾‹)</p><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token keyword">class</span> MainViewModel<span class="token operator">:</span> <span class="token function">ViewModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">//...</span><span class="token punctuation">}</span><span class="token comment">// or </span><span class="token keyword">class</span> <span class="token function">MainViewModel</span><span class="token punctuation">(</span>application<span class="token operator">:</span> Application<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">AndroidViewModel</span><span class="token punctuation">(</span>application<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment">//...</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ MainVieModel ä¸­å¯ä»¥å®šä¹‰ UI ç•Œé¢ä¸­éœ€è¦çš„æ•°æ®ï¼ˆå¯¹è±¡ã€LiveDataã€Flow ç­‰ç­‰ï¼‰å’Œæ–¹æ³•ï¼Œåœ¨ Activity çœŸæ­£é”€æ¯å‰ ViewModel ä¸­çš„æ•°æ®ä¸ä¼šä¸¢å¤±ã€‚</p><h3 id="Activity-ä¸­è·å–"><a href="#Activity-ä¸­è·å–" class="headerlink" title="Activity ä¸­è·å–"></a>Activity ä¸­è·å–</h3><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token keyword">val</span> vm <span class="token operator">=</span> <span class="token function">ViewModelProvider</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>MainViewModel<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span><span class="token comment">// å¼•å…¥ activity-ktx åº“å¯ä»¥è¿™æ ·åˆå§‹åŒ– ViewModel</span><span class="token keyword">val</span> vm <span class="token keyword">by</span> viewModels<span class="token operator">&lt;</span>MainViewModel<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Fragment-ä¸­è·å–"><a href="#Fragment-ä¸­è·å–" class="headerlink" title="Fragment ä¸­è·å–"></a>Fragment ä¸­è·å–</h3><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token keyword">val</span> vm <span class="token operator">=</span> <span class="token function">ViewModelProvider</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>MainViewModel<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span><span class="token comment">// or </span><span class="token comment">// è·å–å’Œ Activity å…±äº«çš„ ViewModel</span><span class="token keyword">val</span> vm <span class="token operator">=</span> <span class="token function">ViewModelProvider</span><span class="token punctuation">(</span><span class="token function">requireActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>MainViewModel<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span><span class="token comment">// å¼•å…¥ fragment-ktx å¯ä»¥è¿™æ ·åˆå§‹åŒ–</span><span class="token keyword">val</span> vm <span class="token keyword">by</span> viewModels<span class="token operator">&lt;</span>MainViewModel<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">val</span> vm <span class="token keyword">by</span> activityViewModels<span class="token operator">&lt;</span>MainViewModel<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é»˜è®¤æ•°æ®ä¿å­˜æ¢å¤æ–¹æ³•"><a href="#é»˜è®¤æ•°æ®ä¿å­˜æ¢å¤æ–¹æ³•" class="headerlink" title="é»˜è®¤æ•°æ®ä¿å­˜æ¢å¤æ–¹æ³•"></a>é»˜è®¤æ•°æ®ä¿å­˜æ¢å¤æ–¹æ³•</h2><p>ViewModel çš„ä½¿ç”¨éå¸¸ç®€å•ï¼Œä¹Ÿå¾ˆå®¹æ˜“ç†è§£ï¼Œå°±æ˜¯ä¸€ä¸ª <code>ç”Ÿå‘½å‘¨æœŸé•¿äº Activity</code> çš„å¯¹è±¡ï¼ŒåŒºåˆ«åœ¨äº <code>ä¸ä¼šé€ æˆå†…å­˜æ³„æ¼</code>ã€‚</p><p>ViewModel ä¸æ˜¯é­”æ³•ï¼Œç«™åœ¨å¼€å‘è€…çš„è§’åº¦åœ¨ ViewModel æ²¡æœ‰é—®ä¸–ä¹‹å‰æ¨ªç«–å±åˆ‡æ¢éœ€è¦ä¿å­˜çŠ¶æ€æ•°æ®çš„éœ€æ±‚é€šå¸¸éƒ½æ˜¯é€šè¿‡ <code>onSaveInstanceState</code> <code>onRestoreInstanceState</code> æ¥å®ç°ã€‚</p><h3 id="onSaveInstanceState"><a href="#onSaveInstanceState" class="headerlink" title="onSaveInstanceState"></a>onSaveInstanceState</h3><ul><li>onSaveInstanceState ç”¨äºåœ¨ Activity æ¨ªç«–å±åˆ‡æ¢ï¼ˆæ„å¤–é”€æ¯ï¼‰å‰ä¿å­˜æ•°æ®ï¼›</li></ul><p>ç”±äºæ˜¯åœ¨ Activity é”€æ¯å‰è§¦å‘ï¼Œé‚£ä¹ˆç›´æ¥æ¥ <code>ActivityThread</code> ä¸­æ‰¾åˆ° <code>performPauseActivity</code> æ–¹æ³•ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// ActivityThread.java</span><span class="token keyword">private</span> <span class="token class-name">Bundle</span> <span class="token function">performPauseActivity</span><span class="token punctuation">(</span><span class="token class-name">ActivityClientRecord</span> r<span class="token punctuation">,</span> <span class="token keyword">boolean</span> finished<span class="token punctuation">,</span> <span class="token class-name">String</span> reason<span class="token punctuation">,</span> <span class="token class-name">PendingTransactionActions</span> pendingActions<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// ...</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>shouldSaveState<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">callActivityOnSaveInstanceState</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">// ...</span><span class="token punctuation">}</span><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">callActivityOnSaveInstanceState</span><span class="token punctuation">(</span><span class="token class-name">ActivityClientRecord</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// ...</span>    <span class="token comment">// è¿™é‡Œé€šè¿‡ ActivityClientRecord è·å–åˆ° activity</span>    <span class="token comment">// state æ˜¯ Bundle å¯¹è±¡ï¼Œåé¢è¦ä¿å­˜çš„æ•°æ®å°±æ”¾åœ¨ state ä¸­</span>    mInstrumentation<span class="token punctuation">.</span><span class="token function">callActivityOnSaveInstanceState</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>activity<span class="token punctuation">,</span> r<span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// ...</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæœ‰ ActivityThread è°ƒç”¨åˆ°äº† Instrumentation ä¸­ï¼Œç»§ç»­çœ‹æºç ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// Instrumentation.java</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">callActivityOnSaveInstanceState</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">Activity</span> activity<span class="token punctuation">,</span> <span class="token annotation punctuation">@NonNull</span> <span class="token class-name">Bundle</span> outState<span class="token punctuation">)</span> <span class="token punctuation">{</span>    activity<span class="token punctuation">.</span><span class="token function">performSaveInstanceState</span><span class="token punctuation">(</span>outState<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ ¹æ®ä¼ å…¥çš„ activity è°ƒç”¨å…¶ <code>performSaveInstanceState</code> æ–¹æ³•ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// Activity.java</span><span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">performSaveInstanceState</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">Bundle</span> outState<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">onSaveInstanceState</span><span class="token punctuation">(</span>outState<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ€»ç»“ä¸€ä¸‹ï¼ŒonSaveInstanceState ä¸­æˆ‘ä»¬å°†æ•°æ®å­˜å‚¨åœ¨ <code>Bundle</code> å¯¹è±¡ä¸­ï¼Œè€Œè¿™ä¸ª Bundle å¯¹è±¡æ˜¯å­˜å‚¨åœ¨ <code>ActivityClientRecord</code> ä¸­ã€‚</p><h3 id="onRestoreInstanceState"><a href="#onRestoreInstanceState" class="headerlink" title="onRestoreInstanceState"></a>onRestoreInstanceState</h3><ul><li>onRestoreInstanceState æ˜¯ç”¨äº Activity æ¨ªç«–å±åˆ‡æ¢ï¼ˆé‡å»ºï¼‰åè·å–ä¿å­˜çš„æ•°æ®ï¼›</li></ul><p>onRestoreInstanceState çš„æµç¨‹å°±æ¥ç®€å•è¯´è¯´ï¼Œç”±äºåœ¨ onStart åå‘ç”Ÿå›è°ƒï¼Œæ‰€ä»¥ç›´æ¥å»çœ‹ ActivityThread ä¸­çš„æºç ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// ActivityThread.java</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleStartActivity</span><span class="token punctuation">(</span><span class="token class-name">ActivityClientRecord</span> r<span class="token punctuation">,</span> <span class="token class-name">PendingTransactionActions</span> pendingActions<span class="token punctuation">,</span> <span class="token class-name">ActivityOptions</span> activityOptions<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// ...</span>    mInstrumentation<span class="token punctuation">.</span><span class="token function">callActivityOnRestoreInstanceState</span><span class="token punctuation">(</span>activity<span class="token punctuation">,</span> r<span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// ...</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹å‡ºè¿™é‡Œä» <code>ActivityClientRecord</code> ä¸­å–å‡ºäº† activity å’Œ state(bundle æ•°æ®) è¿›è¡Œä¼ é€’ï¼Œåé¢å°±å’Œ <code>onSaveInstanceState</code> è°ƒç”¨æµç¨‹ç±»ä¼¼äº†ã€‚</p><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>Activity åœ¨éæ­£å¸¸é”€æ¯æ—¶ï¼Œåœ¨ onStop ä¹‹å‰ (onPause å‰åä¸ç¡®å®š) ä¼šè°ƒç”¨ <code>onSaveInstanceState</code> æ¥æŠŠæ•°æ®ä¿å­˜åˆ° <code>bundle</code> ä¸­ï¼›<br>åœ¨ onStart ä¹‹åä¼šè°ƒç”¨ <code>onRestoreInstanceState</code> æ¥æ¢å¤æ­¤å‰ä¿å­˜çš„æ•°æ®ï¼›<br>å¦å¤– onCreate å†²çš„ <code>savedInstanceState</code> å‚æ•°ä¹Ÿå¯ä»¥è·å–åˆ°æ­¤å‰ä¿å­˜çš„æ•°æ®ã€‚</p><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">//...</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="è‡ªå®šä¹‰æ•°æ®ä¿å­˜æ¢å¤æ–¹æ³•"><a href="#è‡ªå®šä¹‰æ•°æ®ä¿å­˜æ¢å¤æ–¹æ³•" class="headerlink" title="è‡ªå®šä¹‰æ•°æ®ä¿å­˜æ¢å¤æ–¹æ³•"></a>è‡ªå®šä¹‰æ•°æ®ä¿å­˜æ¢å¤æ–¹æ³•</h2><p>é™¤äº† onSaveInstanceState å’Œ onRestoreInstanceState (<code>Activity</code> ä¸­)ï¼Œåœ¨ <code>ComponentActivity</code> ä¸­è¿˜æœ‰ä¸€ç»„æ–¹æ³•å¯ä»¥å®ç°ç±»ä¼¼çš„åŠŸèƒ½ï¼Œå°±æ˜¯ <code>onRetainCustomNonConfigurationInstance</code> å’Œ <code>getLastCustomNonConfigurationInstance</code>ï¼Œå‰è€…å³ä¿å­˜æ•°æ®ï¼Œåè€…å³è·å–ä¿å­˜çš„æ•°æ®ï¼›</p><h3 id="ä½¿ç”¨ç¤ºä¾‹"><a href="#ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹"></a>ä½¿ç”¨ç¤ºä¾‹</h3><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onRetainCustomNonConfigurationInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Any<span class="token operator">?</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">SaveStateData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>    <span class="token comment">// è·å–ä¿å­˜çš„æ•°æ®</span>    <span class="token keyword">val</span> <span class="token keyword">data</span> <span class="token operator">=</span> <span class="token function">getLastCustomNonConfigurationInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> SaveStateData<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å’Œ <code>onSaveInstanceState</code> ä½¿ç”¨çš„åŒºåˆ«åœ¨äº <code>onSaveInstanceState</code> åªèƒ½åœ¨å…¶å‚æ•°ä¸­çš„ <code>Bundle</code> å¯¹è±¡ä¸­å†™å…¥æ•°æ®ï¼Œè€Œ <code>onRetainCustomNonConfigurationInstance</code> è¿”å›çš„ç±»å‹æ˜¯ <code>Any</code> ä¸é™åˆ¶æ•°æ®ç±»å‹ã€‚å…ˆæ¥è¿™ç»„æ–¹æ³•çš„æºç è°ƒç”¨æµç¨‹ã€‚</p><h3 id="onRetainCustomNonConfigurationInstance"><a href="#onRetainCustomNonConfigurationInstance" class="headerlink" title="onRetainCustomNonConfigurationInstance"></a>onRetainCustomNonConfigurationInstance</h3><p><code>onRetainCustomNonConfigurationInstance</code> æ˜¯åœ¨ <code>ComponentActivity</code> ä¸­å®šä¹‰çš„ï¼Œé»˜è®¤å®ç°è¿”å› <code>null</code>ï¼Œå…¶åœ¨ <code>onRetainNonConfigurationInstance</code> æ–¹æ³•ä¸­è¢«è°ƒç”¨ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">onRetainCustomNonConfigurationInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// é»˜è®¤è¿”å› null, å¯ä»¥é‡å†™</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">Object</span> <span class="token function">onRetainNonConfigurationInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// è°ƒç”¨ğŸ‘†ğŸ»æ–¹æ³•ï¼Œä¿å­˜åœ¨ custom å˜é‡ä¸­</span>    <span class="token class-name">Object</span> custom <span class="token operator">=</span> <span class="token function">onRetainCustomNonConfigurationInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// è¿™é‡Œå¯ä»¥çœ‹åˆ° ViewModel ç›¸å…³çš„æºç äº†ï¼Œåé¢å†ç»§ç»­è¯´</span>    <span class="token class-name">ViewModelStore</span> viewModelStore <span class="token operator">=</span> mViewModelStore<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>viewModelStore <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">NonConfigurationInstances</span> nc <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">NonConfigurationInstances</span><span class="token punctuation">)</span> <span class="token function">getLastNonConfigurationInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>nc <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            viewModelStore <span class="token operator">=</span> nc<span class="token punctuation">.</span>viewModelStore<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>viewModelStore <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> custom <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">// æ–°å»º ComponentActivity.NonConfigurationInstances å¯¹è±¡</span>    <span class="token class-name">NonConfigurationInstances</span> nci <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NonConfigurationInstances</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// custom å’Œ viewModelStore èµ‹å€¼ç»™äº† NonConfigurationInstances å¯¹è±¡</span>    nci<span class="token punctuation">.</span>custom <span class="token operator">=</span> custom<span class="token punctuation">;</span>    nci<span class="token punctuation">.</span>viewModelStore <span class="token operator">=</span> viewModelStore<span class="token punctuation">;</span>    <span class="token keyword">return</span> nci<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ç€æ‰¾ <code>onRetainNonConfigurationInstance</code> çš„å®šä¹‰ï¼Œåœ¨ Activity ä¸­ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// Activity.java</span><span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">onRetainNonConfigurationInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// é»˜è®¤è¿”å› null, ComponentActivity é‡å†™äº†</span>    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token class-name">NonConfigurationInstances</span> <span class="token function">retainNonConfigurationInstances</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// ComponentActivity ä¸­è¿”å›çš„ NonConfigurationInstances å¯¹è±¡</span>    <span class="token class-name">Object</span> activity <span class="token operator">=</span> <span class="token function">onRetainNonConfigurationInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// ...</span>    <span class="token comment">// æ³¨æ„ è¿™é‡Œæ–°å»ºçš„æ˜¯ Activity.NonConfigurationInstances å¯¹è±¡</span>    <span class="token class-name">NonConfigurationInstances</span> nci <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NonConfigurationInstances</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// ComponentActivity ä¸­è¿”å›çš„ NonConfigurationInstances å¯¹è±¡</span>    <span class="token comment">// å­˜å‚¨åˆ°äº†æ–°çš„ NonConfigurationInstances ä¸­çš„ activity å±æ€§ä¸­</span>    nci<span class="token punctuation">.</span>activity <span class="token operator">=</span> activity<span class="token punctuation">;</span>    <span class="token comment">// ...</span>    <span class="token keyword">return</span> nci<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸¤ä¸ª NonConfigurationInstances æ•°æ®ç»“æ„å¯¹æ¯”</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// ComponentActivity.java</span><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">NonConfigurationInstances</span> <span class="token punctuation">{</span>      <span class="token class-name">Object</span> custom<span class="token punctuation">;</span>      <span class="token class-name">ViewModelStore</span> viewModelStore<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token comment">// Activity.java</span><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">NonConfigurationInstances</span> <span class="token punctuation">{</span>      <span class="token class-name">Object</span> activity<span class="token punctuation">;</span>      <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> children<span class="token punctuation">;</span>      <span class="token class-name">FragmentManagerNonConfig</span> fragments<span class="token punctuation">;</span>      <span class="token class-name">ArrayMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">LoaderManager</span><span class="token punctuation">&gt;</span></span> loaders<span class="token punctuation">;</span>      <span class="token class-name">VoiceInteractor</span> voiceInteractor<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ç€å†çœ‹ä¸€ä¸‹ <code>NonConfigurationInstances</code> åˆ°åº•å­˜åœ¨äº†å“ªé‡Œï¼Ÿåœ¨ <code>ActivityThread.java</code> ä¸­æ‰¾åˆ°äº†è°ƒç”¨ <code>retainNonConfigurationInstances</code> çš„åœ°æ–¹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// ActivityThread.java</span><span class="token keyword">void</span> <span class="token function">performDestroyActivity</span><span class="token punctuation">(</span><span class="token class-name">ActivityClientRecord</span> r<span class="token punctuation">,</span> <span class="token keyword">boolean</span> finishing<span class="token punctuation">,</span> <span class="token keyword">int</span> configChanges<span class="token punctuation">,</span> <span class="token keyword">boolean</span> getNonConfigInstance<span class="token punctuation">,</span> <span class="token class-name">String</span> reason<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// ...</span>    <span class="token comment">// è¿™ä¸ª r æ˜¯å‚æ•°ä¸­çš„ ActivityClientRecord</span>    r<span class="token punctuation">.</span>lastNonConfigurationInstances <span class="token operator">=</span> r<span class="token punctuation">.</span>activity<span class="token punctuation">.</span><span class="token function">retainNonConfigurationInstances</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å’Œ onSaveInstanceState ä¸€æ ·å­˜å‚¨åœ¨äº† ActivityClientRecord ä¸­ï¼Œåªä¸è¿‡æ˜¯å­˜åˆ°äº†å¦å¤–ä¸€ä¸ªå±æ€§ <code>lastNonConfigurationInstances</code>ã€‚</p><h3 id="getLastCustomNonConfigurationInstance"><a href="#getLastCustomNonConfigurationInstance" class="headerlink" title="getLastCustomNonConfigurationInstance"></a>getLastCustomNonConfigurationInstance</h3><p>çœ‹å®Œäº†å­˜å‚¨çš„æµç¨‹ï¼Œç®€å•æ¥çœ‹çœ‹å–æ•°æ®çš„æµç¨‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// ComponentActivity.java</span><span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getLastCustomNonConfigurationInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// é€šè¿‡çˆ¶ç±» Activity#getLastNonConfigurationInstance è·å– NonConfigurationInstances</span>    <span class="token class-name">NonConfigurationInstances</span> nc <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">NonConfigurationInstances</span><span class="token punctuation">)</span> <span class="token function">getLastNonConfigurationInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// è¿”å› custom</span>    <span class="token keyword">return</span> nc <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> nc<span class="token punctuation">.</span>custom <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ <code>Activity</code> ä¸­è‚¯å®šè¿˜éœ€è¦å–ä¸€æ¬¡ <code>ActivityClientRecord</code> ä¸­çš„ <code>NonConfigurationInstances</code>:</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// Activity.java</span><span class="token class-name">NonConfigurationInstances</span> mLastNonConfigurationInstances<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getLastNonConfigurationInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// è¿”å›å…¶ activity å­—æ®µ</span>    <span class="token keyword">return</span> mLastNonConfigurationInstances <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> mLastNonConfigurationInstances<span class="token punctuation">.</span>activity <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">// mLastNonConfigurationInstances èµ‹å€¼åœ¨ attach æ–¹æ³•ä¸­</span><span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">attach</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token comment">/*å‚æ•°å¤ªå¤šçœç•¥äº†*/</span> <span class="token class-name">NonConfigurationInstances</span> lastNonConfigurationInstances<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// ...</span>    mLastNonConfigurationInstances <span class="token operator">=</span> lastNonConfigurationInstances<span class="token punctuation">;</span>    <span class="token comment">// ...</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹å‡ºåœ¨ <code>Activity#attach</code> æ–¹æ³•ä¸­å°±å·²ç»æ‹¿åˆ°äº† <code>Activity.NonConfigurationInstances</code> å¯¹è±¡ï¼Œé€šè¿‡æºç çŸ¥é“ <code>Activity#attach</code> æ–¹æ³•æ˜¯åœ¨ <code>ActivityThread</code> çš„ <code>performLaunchActivity</code> ä¸­è°ƒç”¨ï¼Œçœ‹ä¸€ä¸‹æºç ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// ActivityThread.java</span><span class="token keyword">private</span> <span class="token class-name">Activity</span> <span class="token function">performLaunchActivity</span><span class="token punctuation">(</span><span class="token class-name">ActivityClientRecord</span> r<span class="token punctuation">,</span> <span class="token class-name">Intent</span> customIntent<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// ...</span>    <span class="token comment">// å‚æ•°å¤ªå¤š çœç•¥äº†</span>    <span class="token comment">// å¯ä»¥çœ‹åˆ°æ˜¯ä» ActivityClientRecord ä¸­å–å‡ºä¼ å…¥çš„</span>    activity<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span>appContext<span class="token punctuation">,</span> r<span class="token punctuation">.</span>lastNonConfigurationInstancesn<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// ...</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><!-- ![[NonConfigurationInstances.svg]] --><p><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/uPic/NonConfigurationInstances.png" alt="NonConfigurationInstances"></p><h3 id="å°ç»“-1"><a href="#å°ç»“-1" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>ä¸¤ç§æ–¹å¼éƒ½æ˜¯å°†æ•°æ®ä¿å­˜åˆ°äº† <code>ActivityClientRecord</code> ä¸­ï¼Œä¸åŒçš„æ˜¯å‰è€…é™åˆ¶äº† <code>Bundle</code> ç±»å‹ï¼Œåè€… <code>ä¸é™åˆ¶ç±»å‹</code>ï¼ˆViewModel é‡‡ç”¨çš„å°±æ˜¯åè€…è¿™ç»„æ–¹æ³•å®ç°ï¼‰ï¼Œä¸è¿‡åè€…å·²ç»åœ¨æºç ä¸­è¢«æ ‡è®°äº†åºŸå¼ƒï¼Œå¹¶ä¸å½±å“ä½¿ç”¨ï¼Œæ ‡è®°åºŸå¼ƒæ˜¯ä¸ºäº†è®©å¼€å‘è€…å°½å¯èƒ½ä½¿ç”¨ ViewModel æ¥å®ç°ã€‚</p><h2 id="ViewModel-æºç åˆ†æ"><a href="#ViewModel-æºç åˆ†æ" class="headerlink" title="ViewModel æºç åˆ†æ"></a>ViewModel æºç åˆ†æ</h2><p>ä»å‰é¢æ•°æ®ä¿å­˜å’Œæ¢å¤çš„åˆ†æå¯ä»¥çœ‹åˆ° ViewModel çš„ä¿å­˜ã€æ¢å¤æ˜¯åˆ©ç”¨äº†ç³»ç»Ÿæä¾›çš„æ–¹æ³•ï¼Œä¸è¿‡è¿˜æœ‰äº›ç»†èŠ‚è¿˜éœ€è¦åœ¨æºç ä¸­æ¢ç´¢ï¼Œæ¯”å¦‚ï¼šå¦‚ä½•å®ç° Activity/Fragment å…±äº« ViewModelï¼Ÿæ¥ä¸‹æ¥å°±æ¥æ·±å…¥ ViewModel æºç ã€‚</p><h3 id="ViewModel-å®ä¾‹è·å–-by-viewModels"><a href="#ViewModel-å®ä¾‹è·å–-by-viewModels" class="headerlink" title="ViewModel å®ä¾‹è·å– by viewModels"></a>ViewModel å®ä¾‹è·å– by viewModels</h3><p>å…ˆæ¥ä»¥ Activity ä¸­åˆ›å»º ViewModel çš„è¿™æ®µä»£ç å…¥æ‰‹ï¼š</p><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token keyword">val</span> vm <span class="token keyword">by</span> viewModels<span class="token operator">&lt;</span>MainViewModel<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>viewModels æ‰©å±•å‡½æ•°æºç ï¼š</p><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// è¿™æ˜¯ä¸€ä¸ª ComponentActivity çš„æ‰©å±•æ–¹æ³•</span><span class="token annotation builtin">@MainThread</span><span class="token keyword">inline</span> <span class="token keyword">fun</span> <span class="token operator">&lt;</span><span class="token keyword">reified</span> VM <span class="token operator">:</span> ViewModel<span class="token operator">&gt;</span> ComponentActivity<span class="token punctuation">.</span><span class="token function">viewModels</span><span class="token punctuation">(</span>    <span class="token comment">// ä»å‘½åä¹Ÿå¯ä»¥çœ‹å‡ºæ˜¯ä¸€ä¸ªå·¥å‚æ¨¡å¼ï¼Œé»˜è®¤æ˜¯ null</span>    <span class="token keyword">noinline</span> factoryProducer<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Factory<span class="token punctuation">)</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token operator">:</span> Lazy<span class="token operator">&lt;</span>VM<span class="token operator">&gt;</span> <span class="token punctuation">{</span>    <span class="token comment">// é»˜è®¤ factoryProducer ä¸º null, è¿”å›çš„æ˜¯ AndroidViewModelFactory</span>    <span class="token keyword">val</span> factoryPromise <span class="token operator">=</span> factoryProducer <span class="token operator">?:</span> <span class="token punctuation">{</span>        <span class="token keyword">val</span> application <span class="token operator">=</span> application <span class="token operator">?:</span> <span class="token keyword">throw</span> <span class="token function">IllegalArgumentException</span><span class="token punctuation">(</span>            <span class="token string-literal singleline"><span class="token string">"ViewModel can be accessed only when Activity is attached"</span></span>        <span class="token punctuation">)</span>        <span class="token comment">// Note: 1 ğŸ”½</span>        AndroidViewModelFactory<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>application<span class="token punctuation">)</span>    <span class="token punctuation">}</span>        <span class="token comment">// è¿”å›äº†ä¸€ä¸ª ViewModelLazy å¯¹è±¡ï¼Œå°† viewModelStoreã€factoryProducer ä¼ å…¥</span>    <span class="token comment">// Note: 3 ğŸ”½                   // Note: 2 ğŸ”½</span>    <span class="token keyword">return</span> <span class="token function">ViewModelLazy</span><span class="token punctuation">(</span>VM<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> viewModelStore <span class="token punctuation">}</span><span class="token punctuation">,</span> factoryPromise<span class="token punctuation">)</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸»è¦ä»ä¸Šé¢æ³¨æ„ç‚¹æ¥çœ‹</p><ul><li>AndroidViewModelFactory å®ä¾‹å¦‚ä½•è·å–ï¼Œ</li><li>viewModelStore å®ä¾‹å¦‚ä½•è·å–ï¼Œ</li><li>ViewModelLazy é€»è¾‘</li></ul><h3 id="1-è·å–-AndroidViewModelFactory"><a href="#1-è·å–-AndroidViewModelFactory" class="headerlink" title="1.è·å– AndroidViewModelFactory"></a>1.è·å– AndroidViewModelFactory</h3><p>AndroidViewModelFactory æ˜¯ ViewModelProvider å†…éƒ¨ç±»ï¼Œå®é™…ä¸Šæ˜¯ä¸€ä¸ªå•ä¾‹æ¨¡å¼ï¼š</p><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// ViewModelProvider.kt -&gt; AndroidViewModelFactory</span><span class="token keyword">private</span> <span class="token keyword">var</span> sInstance<span class="token operator">:</span> AndroidViewModelFactory<span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token annotation builtin">@JvmStatic</span><span class="token keyword">public</span> <span class="token keyword">fun</span> <span class="token function">getInstance</span><span class="token punctuation">(</span>application<span class="token operator">:</span> Application<span class="token punctuation">)</span><span class="token operator">:</span> AndroidViewModelFactory <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>sInstance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        sInstance <span class="token operator">=</span> <span class="token function">AndroidViewModelFactory</span><span class="token punctuation">(</span>application<span class="token punctuation">)</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> sInstance<span class="token operator">!!</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-è·å–-ViewModelStore"><a href="#2-è·å–-ViewModelStore" class="headerlink" title="2.è·å– ViewModelStore"></a>2.è·å– ViewModelStore</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// ComponentActivity.java</span><span class="token keyword">private</span> <span class="token class-name">ViewModelStore</span> mViewModelStore<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token class-name">ViewModelStore</span> <span class="token function">getViewModelStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// ...</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>mViewModelStore <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// ç¬¬ä¸€æ¬¡å¯åŠ¨ activity ä¸º null</span>        <span class="token comment">// è·å–ä¿å­˜çš„æ•°æ®</span>        <span class="token class-name">NonConfigurationInstances</span> nc <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">NonConfigurationInstances</span><span class="token punctuation">)</span> <span class="token function">getLastNonConfigurationInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// ä¼˜å…ˆä»ä¿å­˜çš„æ•°æ®ä¸­è·å–</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>nc <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            mViewModelStore <span class="token operator">=</span> nc<span class="token punctuation">.</span>viewModelStore<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment">// åˆ›å»ºæ–°çš„ ViewModelStore</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>mViewModelStore <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            mViewModelStore <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ViewModelStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> mViewModelStore<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ViewModelStore å†…éƒ¨ä»…ä»…æ˜¯ç®¡ç†ä¸€ä¸ª <code>Map&lt;String, ViewModel&gt;</code>ï¼Œç”¨äºç¼“å­˜ã€æ¸…ç†åˆ›å»ºçš„ ViewModelã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ViewModelStore</span> <span class="token punctuation">{</span>      <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">ViewModel</span><span class="token punctuation">&gt;</span></span> mMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">ViewModel</span> viewModel<span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token class-name">ViewModel</span> oldViewModel <span class="token operator">=</span> mMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> viewModel<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>oldViewModel <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>              oldViewModel<span class="token punctuation">.</span><span class="token function">onCleared</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>      <span class="token punctuation">}</span>        <span class="token keyword">final</span> <span class="token class-name">ViewModel</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token keyword">return</span> mMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>        <span class="token comment">//...</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-ViewModelLazy"><a href="#3-ViewModelLazy" class="headerlink" title="3.ViewModelLazy"></a>3.ViewModelLazy</h3><p>å†å›æ¥æ¥ç€çœ‹æ‰©å±•æ–¹æ³• viewModels è¿”å›çš„ ViewModelLazyï¼š</p><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token keyword">public</span> <span class="token keyword">class</span> ViewModelLazy<span class="token operator">&lt;</span>VM <span class="token operator">:</span> ViewModel<span class="token operator">&gt;</span> <span class="token keyword">constructor</span><span class="token punctuation">(</span>    <span class="token keyword">private</span> <span class="token keyword">val</span> viewModelClass<span class="token operator">:</span> KClass<span class="token operator">&lt;</span>VM<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token comment">// ViewModel çš„ class</span>    <span class="token keyword">private</span> <span class="token keyword">val</span> storeProducer<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> ViewModelStore<span class="token punctuation">,</span> <span class="token comment">// é»˜è®¤æ˜¯ ViewModelStore</span>    <span class="token keyword">private</span> <span class="token keyword">val</span> factoryProducer<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> ViewModelProvider<span class="token punctuation">.</span>Factory<span class="token punctuation">,</span> <span class="token comment">// è¿™é‡Œå°±æ˜¯ mDefaultFactory</span>    <span class="token keyword">private</span> <span class="token keyword">val</span> extrasProducer<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> CreationExtras <span class="token operator">=</span> <span class="token punctuation">{</span> CreationExtras<span class="token punctuation">.</span>Empty <span class="token punctuation">}</span> <span class="token comment">// </span><span class="token punctuation">)</span> <span class="token operator">:</span> Lazy<span class="token operator">&lt;</span>VM<span class="token operator">&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// æ³¨æ„è¿™é‡Œè¿”å›çš„ Lazyï¼Œå»¶è¿Ÿåˆå§‹åŒ–</span>    <span class="token keyword">private</span> <span class="token keyword">var</span> cached<span class="token operator">:</span> VM<span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span>    <span class="token keyword">override</span> <span class="token keyword">val</span> value<span class="token operator">:</span> VM        <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// ç”±äºè¿”å›çš„æ˜¯ Lazyï¼Œä¹Ÿå°±æ˜¯å½“ä½¿ç”¨ ViewModel æ—¶æ‰ä¼šè°ƒç”¨ get</span>            <span class="token keyword">val</span> viewModel <span class="token operator">=</span> cached            <span class="token keyword">return</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>viewModel <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// ç¬¬ä¸€æ¬¡è°ƒç”¨æ˜¯ nullï¼Œè¿›å…¥ if</span>                <span class="token keyword">val</span> factory <span class="token operator">=</span> <span class="token function">factoryProducer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// è·å– mDefaultFactory</span>                <span class="token keyword">val</span> store <span class="token operator">=</span> <span class="token function">storeProducer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// è·å– ViewModelStore</span>                <span class="token function">ViewModelProvider</span><span class="token punctuation">(</span> <span class="token comment">// ç”Ÿæˆ ViewModelProvider å¯¹è±¡</span>                    store<span class="token punctuation">,</span> factory<span class="token punctuation">,</span> <span class="token function">extrasProducer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>viewModelClass<span class="token punctuation">.</span>java<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">also</span> <span class="token punctuation">{</span>                    cached <span class="token operator">=</span> it  <span class="token comment">// ä¿å­˜åˆ° cached å˜é‡</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                viewModel            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">isInitialized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Boolean <span class="token operator">=</span> cached <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ç€æŸ¥çœ‹ ViewModelProvider çš„ get æ–¹æ³•æ˜¯å¦‚ä½•åˆ›å»º ViewModel çš„ï¼š</p><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// å­˜å‚¨ViewModelçš„keyçš„å‰ç¼€</span><span class="token keyword">internal</span> <span class="token keyword">const</span> <span class="token keyword">val</span> DEFAULT_KEY <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"androidx.lifecycle.ViewModelProvider.DefaultKey"</span></span><span class="token keyword">public</span> <span class="token keyword">open</span> <span class="token keyword">operator</span> <span class="token keyword">fun</span> <span class="token operator">&lt;</span>T <span class="token operator">:</span> ViewModel<span class="token operator">&gt;</span> <span class="token keyword">get</span><span class="token punctuation">(</span>modelClass<span class="token operator">:</span> Class<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> T <span class="token punctuation">{</span>    <span class="token keyword">val</span> canonicalName <span class="token operator">=</span> modelClass<span class="token punctuation">.</span>canonicalName        <span class="token operator">?:</span> <span class="token keyword">throw</span> <span class="token function">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Local and anonymous classes can not be ViewModels"</span></span><span class="token punctuation">)</span>    <span class="token comment">// è°ƒç”¨é‡è½½æ–¹æ³•ï¼Œæ‹¼æ¥ key ä¼ å…¥</span>    <span class="token comment">// å½“å‰keyå³ä¸ºï¼šandroidx.lifecycle.ViewModelProvider.DefaultKey$com.xxx.MainViewModel</span>    <span class="token keyword">return</span> <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">DEFAULT_KEY</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">canonicalName</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> modelClass<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token annotation builtin">@MainThread</span><span class="token keyword">public</span> <span class="token keyword">open</span> <span class="token keyword">operator</span> <span class="token keyword">fun</span> <span class="token operator">&lt;</span>T <span class="token operator">:</span> ViewModel<span class="token operator">&gt;</span> <span class="token keyword">get</span><span class="token punctuation">(</span>key<span class="token operator">:</span> String<span class="token punctuation">,</span> modelClass<span class="token operator">:</span> Class<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> T <span class="token punctuation">{</span>    <span class="token keyword">val</span> viewModel <span class="token operator">=</span> store<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token comment">// ä¼˜å…ˆä» ViewModelStroe ä¸­è·å–ç¼“å­˜</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>modelClass<span class="token punctuation">.</span><span class="token function">isInstance</span><span class="token punctuation">(</span>viewModel<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// å¦‚æœç±»å‹ç›¸åŒ ç›´æ¥è¿”å›</span>        <span class="token comment">// è¿™é‡Œæˆ‘ä»¬çš„ factory æ˜¯ AndroidViewModelFactory æ‰€ä»¥ä¸ä¼šèµ°è¿™è¡Œä»£ç </span>        <span class="token punctuation">(</span>factory <span class="token keyword">as</span><span class="token operator">?</span> OnRequeryFactory<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">onRequery</span><span class="token punctuation">(</span>viewModel<span class="token punctuation">)</span>        <span class="token keyword">return</span> viewModel <span class="token keyword">as</span> T    <span class="token punctuation">}</span>    <span class="token comment">// ...</span>    <span class="token comment">// è¿™é‡Œçš„ defaultCreationExtras æ˜¯ä¸Šä¸€æ­¥éª¤ä¸­çš„ CreationExtrasï¼Œé»˜è®¤å€¼ä¸º CreationExtras.Empty</span>    <span class="token comment">// MutableCreationExtras åŒ…è£…ä¸€å±‚å°±æ˜¯å°† defaultCreationExtras ä¸­æ‰€æœ‰çš„é”®å€¼å¯¹éƒ½copyä¸€ä»½</span>    <span class="token keyword">val</span> extras <span class="token operator">=</span> <span class="token function">MutableCreationExtras</span><span class="token punctuation">(</span>defaultCreationExtras<span class="token punctuation">)</span>    <span class="token comment">// å°†å½“å‰ ViewModel çš„ key å­˜å‚¨è¿›å»</span>    extras<span class="token punctuation">[</span>VIEW_MODEL_KEY<span class="token punctuation">]</span> <span class="token operator">=</span> key        <span class="token keyword">return</span> <span class="token keyword">try</span> <span class="token punctuation">{</span>        <span class="token comment">// ä¼˜å…ˆè°ƒç”¨åŒå‚æ•°æ–¹æ³•</span>        factory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>modelClass<span class="token punctuation">,</span> extras<span class="token punctuation">)</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token operator">:</span> AbstractMethodError<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">// è°ƒç”¨åŒå‚æ•°æ–¹æ³•å‘ç”Ÿå¼‚å¸¸å†è°ƒç”¨å•å‚æ•°æ–¹æ³•</span>        factory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>modelClass<span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">also</span> <span class="token punctuation">{</span>         <span class="token comment">// è·å–åˆ° ViewModel åå­˜å‚¨åˆ° viewModelStore ä¸­</span>        <span class="token comment">// å†æä¸€å˜´ viewModelStore æ˜¯åœ¨ ComponentActivity ä¸­å®šä¹‰ </span>        store<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> it<span class="token punctuation">)</span>     <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»ˆäºåˆ°äº†åˆ›å»º ViewModel çš„éƒ¨åˆ†äº†ï¼Œç›´æ¥å»çœ‹ <code>ViewModelProvider.AndroidViewModelFactory</code> çš„ create æ–¹æ³•ï¼š</p><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token operator">&lt;</span>T <span class="token operator">:</span> ViewModel<span class="token operator">&gt;</span> <span class="token function">create</span><span class="token punctuation">(</span>modelClass<span class="token operator">:</span> Class<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">,</span> extras<span class="token operator">:</span> CreationExtras<span class="token punctuation">)</span><span class="token operator">:</span> T <span class="token punctuation">{</span>    <span class="token comment">// application ä¸ä¸º null è°ƒç”¨å•å‚æ•°æ–¹æ³•</span>    <span class="token comment">// åœ¨æ–°å»º AndroidViewModelFactory å·²ç»ä¼ å…¥äº† applicationï¼Œä¸€èˆ¬æƒ…å†µä¸ä¸º null</span>    <span class="token keyword">return</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>application <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>         <span class="token function">create</span><span class="token punctuation">(</span>modelClass<span class="token punctuation">)</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>         <span class="token comment">// application å¦‚æœä¸º nullï¼Œåˆ™ä¼šä»ä¼ å…¥çš„ extras ä¸­å°è¯•è·å–</span>        <span class="token keyword">val</span> application <span class="token operator">=</span> extras<span class="token punctuation">[</span>APPLICATION_KEY<span class="token punctuation">]</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>application <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment">// è¿™ä¸ª create ä¹Ÿæ˜¯åŒå‚æ•°ï¼Œä½†ä¸æ˜¯é€’å½’ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ applicationï¼Œæºç è´´åœ¨ä¸‹é¢</span>            <span class="token function">create</span><span class="token punctuation">(</span>modelClass<span class="token punctuation">,</span> application<span class="token punctuation">)</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token comment">// å¦‚æœ application ä»ç„¶ä¸º nullï¼Œä¸” ViewModel ç±»å‹ä¸º AndroidViewModel åˆ™æŠ›å¼‚å¸¸</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>AndroidViewModel<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>modelClass<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">throw</span> <span class="token function">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>            <span class="token punctuation">}</span>            <span class="token comment">// ç±»å‹ä¸æ˜¯ AndroidViewModel åˆ™æ ¹æ® class åˆ›å»º</span>            <span class="token comment">// æ³¨æ„è¿™é‡Œè°ƒç”¨çš„ super.create æ˜¯çˆ¶ç±»æ–¹æ³•</span>            <span class="token comment">// çˆ¶ç±»æ–¹æ³•ç›´æ¥æ ¹æ® modelClass.newInstance() åˆ›å»ºï¼Œå°±ä¸€è¡Œå°±ä¸è´´æºç äº†</span>            <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>modelClass<span class="token punctuation">)</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token operator">&lt;</span>T <span class="token operator">:</span> ViewModel<span class="token operator">&gt;</span> <span class="token function">create</span><span class="token punctuation">(</span>modelClass<span class="token operator">:</span> Class<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> T <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>application <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// application ä¸º null ç›´æ¥æŠ›å¼‚å¸¸</span>        <span class="token keyword">throw</span> <span class="token function">UnsupportedOperationException</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token comment">// è°ƒç”¨ä¸‹é¢çš„åŒå‚æ•°æ–¹æ³•</span>        <span class="token function">create</span><span class="token punctuation">(</span>modelClass<span class="token punctuation">,</span> application<span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token operator">&lt;</span>T <span class="token operator">:</span> ViewModel<span class="token operator">&gt;</span> <span class="token function">create</span><span class="token punctuation">(</span>modelClass<span class="token operator">:</span> Class<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">,</span> app<span class="token operator">:</span> Application<span class="token punctuation">)</span><span class="token operator">:</span> T <span class="token punctuation">{</span>    <span class="token comment">// å¦‚æœæ˜¯ AndroidViewModel ç±»å‹åˆ™è·å–å¸¦ application çš„æ„é€ å‚æ•°åˆ›å»º</span>    <span class="token keyword">return</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>AndroidViewModel<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>modelClass<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        modelClass<span class="token punctuation">.</span><span class="token function">getConstructor</span><span class="token punctuation">(</span>Application<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token comment">// ç›´æ¥è°ƒç”¨çˆ¶ç±» create æ–¹æ³•é€šè¿‡ modelClass.newInstance() åˆ›å»º</span>        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>modelClass<span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>åˆ°è¿™é‡Œ Activity ä¸­çš„ ViewModel å®ä¾‹è·å–å°±å…¨éƒ¨åˆ†æå®Œäº†</p><ul><li>Activity ä¸­çš„ ViewModel åˆ›å»ºéƒ½æ˜¯é€šè¿‡å•ä¾‹å·¥å‚ AndroidViewModelFactory çš„ create æ–¹æ³•ä¸­åå°„åˆ›å»ºï¼Œ</li><li>åœ¨è°ƒç”¨ create åˆ›å»ºå‰ä¼šç”Ÿæˆå­—ç¬¦ä¸² keyï¼Œåˆ›å»ºå®Œæˆåä¼šå°† key å’Œ vm å¯¹è±¡å­˜å‚¨åˆ° ViewModelStore ä¸­ï¼Œåç»­è·å–å°†ä¼˜å…ˆä» ViewModelStore ç¼“å­˜ä¸­è·å–ã€‚</li></ul><p>ä»å‰é¢çš„æ•°æ®ä¿å­˜å’Œæ¢å¤å¯ä»¥çŸ¥é“ <code>ViewModelStore</code> å®ä¾‹åœ¨ Activity æ„å¤–é”€æ¯æ—¶ï¼Œä¼šä¿å­˜åˆ° <code>ActivityClientRecord</code> ä¸­çš„ <code>lastNonConfigurationInstances</code>ï¼Œåœ¨ Activity é‡æ–°åˆ›å»ºæ—¶ä»è€Œå¯ä»¥è·å–åˆ°åŸæ¥çš„ <code>ViewModelStore</code>ã€‚</p><p>æ‰€ä»¥ ViewModel ç”Ÿå‘½å‘¨æœŸé•¿äº Activity å°±æ˜¯å› ä¸º ViewModelStore ä¼šè¢«ä¿å­˜èµ·æ¥ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Jetpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android Native å¼‚å¸¸æ•è·ä¸è§£æ</title>
      <link href="/20221009/android-native-crash/"/>
      <url>/20221009/android-native-crash/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="Android-native-so"><a href="#Android-native-so" class="headerlink" title="Android native so"></a>Android native so</h2><p>NativeCrash å³ Native Exception, æ˜¯ <code>C/C++</code> è¿è¡Œè¿‡ç¨‹ä¸­äº§ç”Ÿçš„é”™è¯¯ï¼ŒNative Exception ä¸åŒäºæ™®é€šçš„ Java Exceptionï¼Œæ™®é€šçš„ logcat æ— æ³•ç›´æ¥è¿˜åŸæˆå¯é˜…è¯»çš„å †æ ˆï¼Œä¸€èˆ¬æ²¡æœ‰æºç ä¹Ÿæ— æ³•è°ƒè¯•ã€‚</p><p>æ™®é€šçš„ logcat åªèƒ½çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„ä¿¡æ¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">A/libc: Fatal signal <span class="token number">5</span> <span class="token punctuation">(</span>SIGTRAP<span class="token punctuation">)</span>, code <span class="token number">1</span> <span class="token punctuation">(</span>TRAP_BRKPT<span class="token punctuation">)</span>, fault addr 0x72a275a838 <span class="token keyword">in</span> tid <span class="token number">19185</span> <span class="token punctuation">(</span>xcrash.sample<span class="token punctuation">)</span>, pid <span class="token number">19185</span> <span class="token punctuation">(</span>xcrash.sample<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¾ˆéš¾ä»è¿™äº›ä¿¡æ¯åˆ†æå…·ä½“åŸå› ï¼Œè¿™æ—¶å°±éœ€è¦ä» so ç›¸å…³ä¿¡æ¯æ¥çœ‹ã€‚</p><h3 id="åˆ†æ-so-ç»„æˆ"><a href="#åˆ†æ-so-ç»„æˆ" class="headerlink" title="åˆ†æ so ç»„æˆ"></a>åˆ†æ so ç»„æˆ</h3><p>ä¸€ä¸ªå®Œæ•´çš„ so ç”± <code>C/c++</code> ä»£ç åŠ ä¸€äº› <code>debug</code> ä¿¡æ¯ç»„æˆï¼Œè¿™äº› debug ä¿¡æ¯ä¼šè®°å½• so ä¸­æ‰€æœ‰æ–¹æ³•çš„å¯¹ç…§è¡¨ï¼Œå°±æ˜¯ <code>æ–¹æ³•å</code> å’Œå…¶ <code>åç§»åœ°å€</code> çš„å¯¹åº”è¡¨ï¼Œä¹Ÿå«åšç¬¦å·è¡¨ï¼Œè¿™ç§ so &nbsp;ä¹Ÿå«åšæœª strip (æ²¡æœ‰å»æ‰ç¬¦å·è¡¨çš„)ï¼Œé€šå¸¸ä½“ç§¯ä¼šæ¯”è¾ƒå¤§ã€‚</p><p>è€Œ release çš„ so éƒ½ä¼šç»è¿‡ <code>strip</code> æ“ä½œï¼Œstrip ä¹‹åçš„ so ä¸­çš„ debug ä¿¡æ¯ä¼šè¢«å‰¥ç¦»ï¼Œæ•´ä¸ª so çš„ä½“ç§¯ä¹Ÿä¼šç¼©å°ã€‚</p><p><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/uPic/5MG6LA.jpg" alt="5MG6LA"></p><p>å¦‚ä¸‹å¯ä»¥çœ‹åˆ° strip ä¹‹å‰å’Œä¹‹åçš„å¤§å°å¯¹æ¯”ï¼š2.9MB (strip) vs 23.6MB (æœª strip)</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">ls</span> <span class="token parameter variable">-l</span>-rw-r--r--  <span class="token number">1</span> weiwei  staff   <span class="token number">2867944</span> <span class="token number">10</span>  <span class="token number">8</span> <span class="token number">10</span>:30 libtest-s.so-rw-r--r--  <span class="token number">1</span> weiwei  staff  <span class="token number">23614624</span> <span class="token number">10</span>  <span class="token number">8</span> <span class="token number">10</span>:30 libtest.so<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥ç®€å•å°†è¿™ä¸ª debug ä¿¡æ¯ç†è§£ä¸º Java ä»£ç æ··æ·†ä¸­çš„ mapping æ–‡ä»¶ï¼Œåªæœ‰æ‹¥æœ‰è¿™ä¸ª mapping æ–‡ä»¶æ‰èƒ½è¿›è¡Œå †æ ˆåˆ†æï¼Œæ²¡æœ‰å †æ ˆä¿¡æ¯å°±å¾ˆéš¾è§£å†³å‘ç”Ÿçš„å¼‚å¸¸ã€‚</p><p>æ‰€ä»¥è¿™äº› debug ä¿¡æ¯å¾ˆé‡è¦ï¼Œæ˜¯æˆ‘ä»¬åˆ†æ Native Exception é—®é¢˜çš„å…³é”®ä¿¡æ¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨ç¼–è¯‘ so æ—¶å€™åŠ¡å¿…ä¿ç•™ä¸€ä»½æœªè¢« strip çš„ so æˆ–è€…å‰¥ç¦»åçš„ç¬¦å·è¡¨ä¿¡æ¯ï¼Œä»¥ä¾›åé¢é—®é¢˜åˆ†æï¼Œå¹¶ä¸”æ¯æ¬¡ç¼–è¯‘çš„ so éƒ½éœ€è¦ä¿å­˜ï¼Œä¸€æ—¦äº§ç”Ÿä»£ç ä¿®æ”¹é‡æ–°ç¼–è¯‘ï¼Œé‚£ä¹ˆä¿®æ”¹å‰åçš„ç¬¦å·è¡¨ä¿¡æ¯ä¼šæ— æ³•å¯¹åº”ï¼Œä¹Ÿæ— æ³•è¿›è¡Œåˆ†æã€‚</p><h3 id="æŸ¥çœ‹-so-ä¿¡æ¯"><a href="#æŸ¥çœ‹-so-ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹ so ä¿¡æ¯"></a>æŸ¥çœ‹ so ä¿¡æ¯</h3><p>åœ¨ macOS/Linux ä¸‹å¯ä»¥ä½¿ç”¨ <code>file</code> å‘½ä»¤æŸ¥çœ‹ so æ–‡ä»¶ä¿¡æ¯ï¼š<code>stripped</code> ä»£è¡¨æ˜¯æ²¡æœ‰ debug ä¿¡æ¯çš„ so, <code>with debug_info</code>,  <code>not stripped</code> ä»£è¡¨åŒ…å« debug ä¿¡æ¯çš„ soã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">file</span> libtest.solibtest.so: ELF <span class="token number">64</span>-bit LSB shared object, ARM aarch64, version <span class="token number">1</span> <span class="token punctuation">(</span>SYSV<span class="token punctuation">)</span>, dynamically linked, BuildID<span class="token punctuation">[</span>sha1<span class="token punctuation">]</span><span class="token operator">=</span>9a28e26533f985cf3ae8733ccd0c2cae8cc49fb3, with debug_info, not stripped$ <span class="token function">file</span> libtest-s.solibtest-s.so: ELF <span class="token number">64</span>-bit LSB shared object, ARM aarch64, version <span class="token number">1</span> <span class="token punctuation">(</span>SYSV<span class="token punctuation">)</span>, dynamically linked, BuildID<span class="token punctuation">[</span>sha1<span class="token punctuation">]</span><span class="token operator">=</span>9a28e26533f985cf3ae8733ccd0c2cae8cc49fb3, stripped<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸‹é¢çœ‹ä¸‹å¦‚ä½•è·å–ä¸¤ç§çŠ¶æ€ä¸‹çš„ soã€‚</p><h3 id="è·å–-so-æ–‡ä»¶"><a href="#è·å–-so-æ–‡ä»¶" class="headerlink" title="è·å– so æ–‡ä»¶"></a>è·å– so æ–‡ä»¶</h3><p>æ— è®ºæ˜¯ä½¿ç”¨ mk æˆ–è€… Cmake ç¼–è¯‘çš„æ–¹å¼éƒ½ä¼šåŒæ—¶è¾“å‡º strip å’Œæœª strip çš„ soï¼Œä¸‹é¢æ–‡ä»¶æ ‘åˆ—è¡¨æ˜¯ Cmake ç¼–è¯‘ so äº§ç”Ÿçš„ä¸¤ç§å¯¹åº”çš„ soã€‚</p><p>æˆ‘ä»¬æ‰§è¡Œ release ä»»åŠ¡ï¼Œä¾‹å¦‚ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ ./gradlew libTest:assembleRelease<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰§è¡Œå®Œæˆåå¯ä»¥åœ¨ <code>libTest/build/intermediates </code> ç›®å½•ä¸‹æ‰¾åˆ°ä¸¤ç§å¯¹åº”çš„ so: (ä¸‹é¢è¾“å‡ºç»“æœå¯¹åº”çš„æ˜¯ AGP 7.0+)</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># weiwei in ~/NativeDemo/libTest/build/intermediates</span>$ tree <span class="token parameter variable">-L</span> <span class="token number">2</span>â”œâ”€â”€ cmakeâ”‚   â””â”€â”€ releaseâ”‚       â””â”€â”€ objâ”‚           â”œâ”€â”€ arm64-v8aâ”‚           â”‚   â”œâ”€â”€ libtest.soâ”‚           â””â”€â”€ armeabi-v7aâ”‚               â”œâ”€â”€ libtest.soâ”œâ”€â”€ merged_native_libsâ”‚   â””â”€â”€ releaseâ”‚       â””â”€â”€ outâ”‚           â””â”€â”€ libâ”‚               â”œâ”€â”€ arm64-v8aâ”‚               â”‚   â”œâ”€â”€ libtest.soâ”‚               â””â”€â”€ armeabi-v7aâ”‚                   â”œâ”€â”€ libtest.soâ”œâ”€â”€ stripped_native_libsâ”‚   â””â”€â”€ releaseâ”‚       â””â”€â”€ outâ”‚           â””â”€â”€ libâ”‚               â”œâ”€â”€ arm64-v8aâ”‚               â”‚   â”œâ”€â”€ libtest.soâ”‚               â””â”€â”€ armeabi-v7aâ”‚                   â”œâ”€â”€ libtest.so<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>cmake</code> å’Œ <code>merged_native_libs</code> ç›®å½•ä¸‹çš„ so æ–‡ä»¶éƒ½æ˜¯æœªåš strip å¤„ç†çš„ï¼Œæˆ‘ä»¬éœ€è¦ä¿å­˜å¥½è¿™ä¸ªæ–‡ä»¶ã€‚</li><li><code>stripped_native_libs</code> ç›®å½•ä¸‹åˆ™æ˜¯ç»è¿‡ strip å¤„ç†çš„ so æ–‡ä»¶ï¼Œä¼šè¢«æ‰“åˆ°æœ€ç»ˆçš„ apk å½“ä¸­ã€‚</li></ul><p>ä¿å­˜æœªåš strip çš„ so æ–‡ä»¶ï¼Œæœ€å¥½æ˜¯åœ¨ ci æ„å»ºæ–°çš„ Library æˆ–è€… Application æ—¶è‡ªåŠ¨å°†å…¶ä¿å­˜çš„ç‰¹å®šä½ç½®ä»¥ä¾¿äºåç»­åˆ†æä½¿ç”¨ã€‚</p><p>å¦å¤–ä¹Ÿå¯ä»¥é€šè¿‡ Android sdk æä¾›çš„å·¥å…· <code>aarch64-linux-android-strip</code> æ‰‹åŠ¨è¿›è¡Œ stripï¼Œå·¥å…·ä½äº <code>$HOME/Library/Android/sdk/ndk/21.4.7075529/toolchains</code> ç›®å½•ä¸‹ (è‡ªè¡Œé€‰æ‹©å¯ç”¨çš„ NDK ç‰ˆæœ¬)</p><p>åœ¨ toolchains ç›®å½•ä¸‹é€šè¿‡ <code>fzf</code> æœç´¢ <code>-android-strip</code> å¯ä»¥å¾—åˆ°å¦‚ä¸‹</p><p><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/ylwbKV.png" alt="ylwbKV"></p><p>ç„¶åå¯ä»¥è¿›å…¥ <code>aarch64-linux-android-4.9/prebuilt/darwin-x86_64/bin/</code> ç›®å½•ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯ä»¥ç›´æ¥å°† debug çš„ so è¿›è¡Œ strip å¤„ç†</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">aarch64-linux-android-strip --strip-all libtest.so<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½¿ç”¨ Cmake è¿›è¡Œç¼–è¯‘çš„æ—¶å€™ï¼Œå¯ä»¥å¢åŠ å¦‚ä¸‹å‘½ä»¤ï¼Œå¯ä»¥ç›´æ¥ç¼–è¯‘å‡º strip çš„ so</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#set(CMAKE_C_FLAGS_RELEASE "${CMAKE_C_FLAGS_RELEASE} -s")</span><span class="token comment">#set(CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS_RELEASE} -s")</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä½¿ç”¨ mk æ–‡ä»¶è¿›è¡Œç¼–è¯‘çš„æ—¶å€™ï¼Œå¯ä»¥å¢åŠ å¦‚ä¸‹å‘½ä»¤ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç¼–è¯‘å‡º strip çš„ so</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token parameter variable">-fvisibility</span><span class="token operator">=</span>hidden<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="å¼‚å¸¸æ•è·è§£æ"><a href="#å¼‚å¸¸æ•è·è§£æ" class="headerlink" title="å¼‚å¸¸æ•è·è§£æ"></a>å¼‚å¸¸æ•è·è§£æ</h2><p>å¯ä»¥å‚è€ƒ <a href="https://juejin.cn/post/6932757164003950599">Android NativeCrash æ•è·ä¸è§£æ</a> ä½¿ç”¨ logcat, DropBox, Breakpad éƒ½å¯ä»¥è·å–åˆ° Native exception æ—¥å¿—ï¼Œä½†éƒ½å­˜åœ¨ä¸å°‘é—®é¢˜ã€‚</p><ul><li>logcat çš„ç¼ºç‚¹æ˜¯åªèƒ½æµ‹è¯•è°ƒè¯•è¿‡ç¨‹ä¸­ä½¿ç”¨ï¼Œæ­£å¼ç¯å¢ƒæ— æ³•ä½¿ç”¨ã€‚</li><li>DropBox çš„ç¼ºç‚¹æ˜¯åªé€‚ç”¨äºç³»ç»Ÿåº”ç”¨ï¼Œæ™®é€šåº”ç”¨ä½¿ç”¨å›°éš¾ã€‚</li><li>Breakpad æ˜¯ Google å¼€æºçš„ï¼Œéå¸¸æˆç†Ÿï¼Œä½†ä½¿ç”¨æ¯”è¾ƒéº»çƒ¦ï¼Œè€Œä¸”ä»£ç é‡å¾ˆå¤§ã€‚</li></ul><p><a href="https://github.com/iqiyi/xCrash">iqiyi/xCrash</a> æ˜¯çˆ±å¥‡è‰ºå¼€æºçš„æ•è· Java exception, Native exception, ANR çš„åº“ï¼Œä¸éœ€è¦ä»»ä½• root æƒé™æˆ–ç³»ç»Ÿæƒé™ï¼Œå¾ˆé€‚åˆç”¨æ¥æ•è· Native exceptionï¼Œå…·ä½“ä½¿ç”¨å’ŒåŸç†å¯ä»¥å‚è€ƒé¡¹ç›®ä¸­çš„<a href="https://github.com/iqiyi/xCrash/blob/master/README.zh-CN.md">æ–‡æ¡£</a>ã€‚</p><p>å½“å¼‚å¸¸å‘ç”Ÿæ—¶ï¼Œ xCrash æ•è·å¼‚å¸¸å¹¶ä¿å­˜åˆ°åˆå§‹åŒ–è®¾ç½®çš„ç›®å½•ï¼ŒNative exception ç¤ºä¾‹å¦‚ä¸‹ï¼ˆå®Œæˆå¯ä»¥å‚è€ƒ <a href="https://github.com/iqiyi/xCrash/blob/master/doc/tombstone_native_arm64-v8a.txt">native crash (arm64-v8a)</a>ï¼‰</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">*** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***Tombstone maker: <span class="token string">'xCrash 2.4.6'</span>Crash type: <span class="token string">'native'</span>Start time: <span class="token string">'2019-10-12T03:18:02.523+0800'</span>Crash time: <span class="token string">'2019-10-12T03:18:21.127+0800'</span>App ID: <span class="token string">'xcrash.sample'</span>App version: <span class="token string">'1.2.3-beta456-patch789'</span>Rooted: <span class="token string">'No'</span>API level: <span class="token string">'29'</span>OS version: <span class="token string">'10'</span>Kernel version: <span class="token string">'Linux version 3.18.137-g382d7256ce44 #1 SMP PREEMPT Fri Jul 12 06:00:07 UTC 2019 (aarch64)'</span>ABI list: <span class="token string">'arm64-v8a,armeabi-v7a,armeabi'</span>Manufacturer: <span class="token string">'Google'</span>Brand: <span class="token string">'google'</span>Model: <span class="token string">'Pixel'</span>Build fingerprint: <span class="token string">'google/sailfish/sailfish:10/QP1A.190711.020/5800535:user/release-keys'</span>ABI: <span class="token string">'arm64'</span>pid: <span class="token number">20501</span>, tid: <span class="token number">20501</span>, name: xcrash.sample <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> xcrash.sample <span class="token operator">&lt;&lt;&lt;</span>signal <span class="token number">11</span> <span class="token punctuation">(</span>SIGSEGV<span class="token punctuation">)</span>, code <span class="token number">1</span> <span class="token punctuation">(</span>SEGV_MAPERR<span class="token punctuation">)</span>, fault addr 0x0x0 0000000000000003 x1 0000000000000000 x2 000000751128fd60 x3 0000007511290020x4 000000751128fd60 x5 00000075a26c1708 x6 000000751128fd50 x7 00000075200a59dcx8 0000000000000000 x9 79fc7e30c0ff4d9e x10 00000000000003e8 x11 0000000000000000x12 0000000000004100 x13 0000000000000001 x14 0000000000080100 x15 0000000000000000x16 00000074b9be4d20 x17 00000074b9bcc86c x18 00000075a57fa000 x19 00000075a4f52000x20 0000000000000000 x21 00000075a4f52000 x22 0000007fe0ef23a0 x23 00000074bb1b62fex24 0000000000000004 x25 00000075a5107020 x26 00000075a4f520b0 x27 0000000000000001x28 0000007fe0ef2130 x29 0000007fe0ef2090sp 0000007fe0ef2070 lr 00000074b9bcc8cc pc 00000074b9bcc884backtrace:<span class="token comment">#00 pc 000000000000b884 /data/app/xcrash.sample-WeCpVYjROKKgYtuzbHflHg==/lib/arm64/libxcrash.so (xc_test_call_4+24)</span><span class="token comment">#01 pc 000000000000b8c8 /data/app/xcrash.sample-WeCpVYjROKKgYtuzbHflHg==/lib/arm64/libxcrash.so (xc_test_call_3+24)</span><span class="token comment">#02 pc 000000000000b8f8 /data/app/xcrash.sample-WeCpVYjROKKgYtuzbHflHg==/lib/arm64/libxcrash.so (xc_test_call_2+24)</span><span class="token comment">#03 pc 000000000000b920 /data/app/xcrash.sample-WeCpVYjROKKgYtuzbHflHg==/lib/arm64/libxcrash.so (xc_test_call_1+16)</span><span class="token comment">#04 pc 000000000000b9b4 /data/app/xcrash.sample-WeCpVYjROKKgYtuzbHflHg==/lib/arm64/libxcrash.so (xc_test_crash+124)</span><span class="token comment">#05 pc 000000000013f350 /apex/com.android.runtime/lib64/libart.so (art_quick_generic_jni_trampoline+144)</span><span class="token comment">#06 pc 00000000001365b8 /apex/com.android.runtime/lib64/libart.so (art_quick_invoke_static_stub+568)</span><span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»æ•è·åˆ°çš„æ—¥å¿—å¯ä»¥çœ‹åˆ°éå¸¸å®Œæ•´çš„ä¿¡æ¯ï¼šCrash ç±»å‹ï¼Œå¯åŠ¨æ—¶é—´ï¼Œå´©æºƒæ—¶é—´ï¼Œå„ç§ç‰ˆæœ¬ä¿¡æ¯å’Œè®¾å¤‡ä¿¡æ¯ï¼Œå´©æºƒçš„è¿›ç¨‹å’Œçº¿ç¨‹ï¼Œ</p><p>ä» signal å¯ä»¥çœ‹åˆ°å´©æºƒçš„åŸå› æ˜¯ <code>fault addr 0x0</code></p><p>å…·ä½“å´©æºƒçš„å †æ ˆåˆ™æ˜¯åœ¨ <code>backtrace</code> ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>addr2line</code> å·¥å…·é…åˆç¼–è¯‘ç”Ÿæˆçš„å¸¦ç¬¦å·è¡¨çš„ so æ–‡ä»¶ï¼Œæ‰¾åˆ°ä»£ç ä¸­å´©æºƒçš„ä½ç½®</p><p>addr2line å·¥å…·ä½äº <code>$HOME/Library/Android/sdk/ndk/selectVersion/toolchains</code> , æˆ‘ä»¬åœ¨è¿™ä¸ªç›®å½•é€šè¿‡ <code>fzf</code> æœç´¢ <code>-addr2line</code> ï¼š</p><p><code>~/Library/Android/sdk/ndk/21.4.7075529/toolchains</code> æœç´¢ç»“æœ</p><p><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/uPic/8xDTeQ.png" alt="8xDTeQ"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">aarch64-linux-android-4.9/prebuilt/darwin-x86_64/bin/aarch64-linux-android-addr2linearm-linux-androideabi-4.9/prebuilt/darwin-x86_64/bin/arm-linux-androideabi-addr2linex86_64-4.9/prebuilt/darwin-x86_64/bin/x86_64-linux-android-addr2linex86-4.9/prebuilt/darwin-x86_64/bin/i686-linux-android-addr2linellvm/prebuilt/darwin-x86_64/bin/aarch64-linux-android-addr2linellvm/prebuilt/darwin-x86_64/bin/arm-linux-androideabi-addr2linellvm/prebuilt/darwin-x86_64/bin/x86_64-linux-android-addr2linellvm/prebuilt/darwin-x86_64/bin/i686-linux-android-addr2linellvm/prebuilt/darwin-x86_64/bin/llvm-addr2line<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>~/Library/Android/sdk/ndk/23.1.7779620/toolchains</code> æœç´¢ç»“æœ</p><p><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/uPic/mO3apY.png" alt="mO3apY"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">llvm/prebuilt/darwin-x86_64/bin/llvm-addr2line<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯ä»¥çœ‹å‡ºä¸èƒ½ ndk ç‰ˆæœ¬è¿˜æ˜¯ä¸ä¸€æ ·ï¼Œé«˜ç‰ˆæœ¬åªæœ‰ä¸€ä¸ª <code>llvm-addr2line</code>, ä½ç‰ˆæœ¬åˆ™å­˜åœ¨å¤šä¸ª <code>*-linux-android-addr2line</code></p><p>å…·ä½“ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹: </p><p>é€šè¿‡æ—¥å¿—æ‰¾åˆ°å´©æºƒçš„ so æ–‡ä»¶ (æœª strip), ç„¶åæ‰§è¡Œä¸‹é¢æŒ‡ä»¤ï¼Œä¼ å…¥ so æ–‡ä»¶è·¯å¾„å’Œ backtrace çš„å †æ ˆä¿¡æ¯</p><pre class="line-numbers language-none"><code class="language-none">addr2line -C -f -e æœªstripçš„soè·¯å¾„ backtraceå †æ ˆä¿¡æ¯<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>-e è¡¨ç¤ºæ‰“å°é”™è¯¯åœ°å€çš„å¯¹åº”è·¯å¾„åŠè¡Œæ•°</li><li>-C -f è¡¨ç¤ºæ‰“å°é”™è¯¯è¡Œæ•°æ‰€åœ¨çš„å‡½æ•°åç§°</li><li>backtrace å †æ ˆä¿¡æ¯å¯ä»¥å†™å¤šä¸ªï¼Œä½¿ç”¨ç©ºæ ¼éš”å¼€</li><li>addr2line ç¨‹åºå¯ä»¥ä½¿ç”¨å®Œæ•´è·¯å¾„æˆ–è€…åˆ‡æ¢åˆ°æ‰€åœ¨è·¯å¾„ä½¿ç”¨</li></ul><p>æµ‹è¯• release çš„ arm64 so ç¤ºä¾‹:</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># weiwei in ~/Library/Android/sdk/ndk/21.4.7075529/toolchains/aarch64-linux-android-4.9/prebuilt/darwin-x86_64/bin</span>aarch64-linux-android-addr2line <span class="token parameter variable">-e</span> xcrash_lib/build/intermediates/merged_native_libs/release/out/lib/arm64-v8a/libxcrash.so 000000000000b884xCrash/xcrash_lib/src/main/cpp/xcrash/xc_test.c:65<span class="token comment"># å®æµ‹ ndk/21.4.7075529: aarch64-linux-android-addr2line, x86_64-linux-android-addr2line, i686-linux-android-addr2line éƒ½æ˜¯å¯ç”¨çš„ï¼Œarm-linux-androideabi-addr2line, llvm-addr2line åˆ™ä¸è¡Œ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># weiwei in ~/Library/Android/sdk/ndk/23.1.7779620/toolchains/llvm/prebuilt/darwin-x86_64/bin</span>llvm-addr2line <span class="token parameter variable">-e</span> xcrash_lib/build/intermediates/merged_native_libs/release/out/lib/arm64-v8a/libxcrash.so 000000000000b884xCrash/xcrash_lib/src/main/cpp/xcrash/xc_test.c:65<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ‰¾åˆ°å¼‚å¸¸å‘ç”Ÿçš„ä½ç½®ä¹‹åå°±å¯ä»¥ä»æºä»£ç å»åˆ†æå…·ä½“å¼‚å¸¸åŸå› äº†ï¼Œå¦‚æœä¸æ–¹ä¾¿ä¿å­˜å¸¦ debug ä¿¡æ¯çš„ so æ–‡ä»¶ï¼Œå¯ä»¥å•ç‹¬æå–å‡ºç¬¦å·è¡¨ï¼Œç¬¦å·è¡¨æå–å’Œä½¿ç”¨å‚è€ƒï¼š<a href="https://juejin.cn/post/6932757164003950599#heading-12">Android NativeCrash æ•è·ä¸è§£æ# ä¸‰ã€so&nbsp;ç¬¦å·è¡¨çš„æå–</a></p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li><a href="https://juejin.cn/post/6932757164003950599">Android NativeCrash æ•è·ä¸è§£æ</a></li><li><a href="https://mp.weixin.qq.com/s/g-WzYF3wWAljok1XjPoo7w">Android å¹³å° Native ä»£ç çš„å´©æºƒæ•è·æœºåˆ¶åŠå®ç°</a></li><li><a href="https://github.com/google/breakpad">https://github.com/google/breakpad</a></li><li><a href="https://github.com/iqiyi/xCrash">https://github.com/iqiyi/xCrash</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> C++ </tag>
            
            <tag> NDK </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mac å¼€å‘ç¯å¢ƒè‡ªåŠ¨éƒ¨ç½²</title>
      <link href="/20220918/mac-dev-setup/"/>
      <url>/20220918/mac-dev-setup/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Project: <a href="https://github.com/weikeet/macsetup">https://github.com/weikeet/macsetup</a></p><h2 id="Requirements"><a href="#Requirements" class="headerlink" title="Requirements"></a>Requirements</h2><ul><li><a href="https://developer.apple.com/download/more/">Command Line Tools</a></li><li><a href="https://git-scm.com/">Git</a></li></ul><p>å®‰è£…å¥½ <a href="https://developer.apple.com/download/more/">Command Line Tools</a> åï¼Œå°±å¯ä»¥ä½¿ç”¨ <a href="https://git-scm.com/">Git</a> å‘½ä»¤äº†ã€‚</p><h2 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h2><h3 id="è‡ªåŠ¨æ‰§è¡Œ"><a href="#è‡ªåŠ¨æ‰§è¡Œ" class="headerlink" title="è‡ªåŠ¨æ‰§è¡Œ"></a>è‡ªåŠ¨æ‰§è¡Œ</h3><p>åªéœ€è¦æ‰§è¡Œä»¥ä¸‹ä»£ç å³å¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> https://raw.githubusercontent.com/weikeet/macsetup/master/setup.sh <span class="token operator">|</span> <span class="token function">sh</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> ~/.macsetup <span class="token operator">&amp;&amp;</span> <span class="token function">zsh</span> install.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="æ‰‹åŠ¨æ‰§è¡Œ"><a href="#æ‰‹åŠ¨æ‰§è¡Œ" class="headerlink" title="æ‰‹åŠ¨æ‰§è¡Œ"></a>æ‰‹åŠ¨æ‰§è¡Œ</h3><p>æ‰‹åŠ¨ clone åˆ° <code>~/.macsetup</code> ç›®å½•ä¸‹ï¼Œç„¶åæ‰§è¡Œ <code>zsh install.sh</code> å³å¯ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone https://github.com/weikeet/macsetup.git ~/.macsetup<span class="token builtin class-name">cd</span> ~/.macsetup <span class="token operator">&amp;&amp;</span> <span class="token function">zsh</span> install.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="Q-amp-A"><a href="#Q-amp-A" class="headerlink" title="Q &amp; A"></a>Q &amp; A</h2><h3 id="Zsh-detects-insecure-completion-dependent-directories"><a href="#Zsh-detects-insecure-completion-dependent-directories" class="headerlink" title="Zsh detects insecure completion-dependent directories"></a>Zsh detects insecure completion-dependent directories</h3><p>å®‰è£… oh-my-zsh åæ˜¾ç¤º Zsh detects insecure completion-dependent directories â€¦ è­¦å‘Š</p><p>è§£å†³æ–¹æ³•ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">bash</span> ~/.macsetup/env/oh_my_zsh_fixed.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="links"><a href="#links" class="headerlink" title="links"></a>links</h2><ul><li><a href="https://github.com/jlevy/the-art-of-command-line/blob/master/README-zh.md">å‘½ä»¤è¡Œçš„è‰ºæœ¯</a></li><li><a href="https://github.com/bestswifter/macbootstrap/">bestswifter/macbootstrap</a></li><li><a href="https://github.com/nicolashery/mac-dev-setup">nicolashery/mac-dev-setup</a></li><li><a href="https://github.com/donnemartin/dev-setup">donnemartin/dev-setup</a></li><li><a href="https://github.com/bkuhlmann/mac_os-config">bkuhlmann/mac_os-config</a></li><li><a href="https://sourabhbajaj.com/mac-setup/">sourabhbajaj/mac-setup/</a></li></ul><h3 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h3><ul><li><a href="https://zhuanlan.zhihu.com/p/28900182">Zsh å¼€å‘æŒ‡å—</a></li><li><a href="https://blog.csdn.net/u014297722/article/details/54601660">shell æ•°ç»„ã€å­—å…¸ã€sourceã€split</a></li><li><a href="https://stackoverflow.com/questions/6047648/associative-arrays-error-declare-a-invalid-option">fixed declare: -A: invalid option</a></li><li><a href="https://juejin.cn/post/6844903553119748109">10åˆ†é’Ÿå…¥é—¨Shellè„šæœ¬ç¼–ç¨‹</a></li><li><a href="https://juejin.cn/post/6962032698697187364">Shell è„šæœ¬å¸¸ç”¨è¯­æ³•</a></li><li><a href="http://billie66.github.io/TLCL/book/index.html">Shell</a></li><li><a href="https://juejin.cn/post/7108908752174579743">å¦‚ä½•ä¼˜é›…åœ°è§£æå‘½ä»¤è¡Œé€‰é¡¹</a></li><li><a href="https://mp.weixin.qq.com/s?__biz=MzI2OTA3NTk3Ng==&amp;mid=2649284881&amp;idx=1&amp;sn=a5e1039c159422ab90ac97264147b0de">å¦‚ä½•ä¼˜é›…åœ°å¤„ç†å‘½ä»¤è¡Œå‚æ•°ï¼Ÿ</a></li><li><a href="https://cloud.tencent.com/developer/article/1629932">è¿™æ ·å¤„ç†shellè„šæœ¬å‚æ•°ï¼Œçˆ½å¤šäº†</a></li></ul><h3 id="Terminal-Beautify"><a href="#Terminal-Beautify" class="headerlink" title="Terminal Beautify"></a>Terminal Beautify</h3><ul><li><a href="https://ohmyz.sh/">oh-my-zsh</a></li><li><a href="https://iterm2.com/">iTerm2 app</a></li><li><a href="https://alacritty.com/">Alacritty app</a></li><li><a href="https://www.macosicons.com/">macOS App icons</a></li><li><a href="https://www.zhihu.com/question/51622732">å¦‚ä½•è®© iTerm2 åœ¨ä»»ä½•ç•Œé¢å‘¼å…¥å‘¼å‡º</a></li><li><a href="https://sspai.com/post/74216">æ‰“å¼€ç»ˆç«¯æ€»æœ‰å¥½å¿ƒæƒ…ï¼šæˆ‘çš„ç¾åŒ–æ–¹æ¡ˆåŠé…ç½®åˆ†äº«</a></li><li><a href="https://github.com/dracula/iterm">Dracula iTerm2 theme</a></li><li><a href="https://github.com/dracula/zsh">Dracula zsh theme</a></li><li><a href="https://blog.dreamfever.me/2021/02/13/alacritty-pei-zhi-zhi-nan/">Alacritty é…ç½®æŒ‡å—</a></li><li><a href="https://starship.rs/">starship</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Mac </tag>
            
            <tag> Shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android è½¯é”®ç›˜åˆ†æå’Œæœ€ä½³å®è·µ</title>
      <link href="/20220620/android-softkeyboard/"/>
      <url>/20220620/android-softkeyboard/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Project: <a href="https://github.com/weikeet/SoftKeyboardWatcher">https://github.com/weikeet/SoftKeyboardWatcher</a></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><ul><li><p>è½¯é”®ç›˜æ˜¯ Android è¿›è¡Œç”¨æˆ·äº¤äº’çš„é‡è¦é€”å¾„ä¹‹ä¸€ï¼ŒAndroid åº”ç”¨å¼€å‘åŸºæœ¬æ— æ³•é¿å…ä¸ä½¿ç”¨å®ƒã€‚</p></li><li><p>ç„¶è€Œå®˜æ–¹æ²¡æœ‰æä¾›ä¸€å¥—æ˜ç¡®çš„ API æ¥è·å–è½¯é”®ç›˜ç›¸å…³ä¿¡æ¯ï¼š</p><ul><li>è½¯é”®ç›˜æ˜¯å¦æ­£åœ¨å±•ç¤º</li><li>è½¯é”®ç›˜é«˜åº¦ç­‰</li></ul></li><li><p>æœ¬æ¬¡åˆ†äº«å°†ä»ä»¥ä¸‹å†…å®¹æ¥åˆ†æè½¯é”®ç›˜</p><ul><li>è½¯é”®ç›˜å¼€å¯ä¸å…³é—­</li><li>è½¯é”®ç›˜ç¤ºä¾‹åˆ†æ</li><li>softInputMode ä½¿ç”¨åŠåŸç†</li><li>å¦‚ä½•è·å–å¯è§åŒºåŸŸ</li><li>WindowInsets API</li><li>è½¯é”®ç›˜é€‚é…æœ€ä½³å®è·µ</li></ul></li></ul><h2 id="è½¯é”®ç›˜å¼¹å‡ºå’Œå…³é—­"><a href="#è½¯é”®ç›˜å¼¹å‡ºå’Œå…³é—­" class="headerlink" title="è½¯é”®ç›˜å¼¹å‡ºå’Œå…³é—­"></a>è½¯é”®ç›˜å¼¹å‡ºå’Œå…³é—­</h2><p>å¹³æ—¶å’Œè½¯é”®ç›˜äº¤äº’æœ€å¤šçš„å°±æ˜¯ <code>EditText</code>, å½“ç‚¹å‡» <code>EditText</code> æ—¶é”®ç›˜å°±ä¼šå¼¹å‡ºï¼Œå½“ç‚¹å‡»è¿”å›æŒ‰é’®æ—¶é”®ç›˜æ”¶èµ·ï¼š</p><img class="h-60" src=" https://blog-1251678165.cos.ap-chengdu.myqcloud.com/uPic/ime-pan-1.gif"><p>æ—¢ç„¶å·²ç»æœ‰å¼¹å‡ºã€æ”¶èµ·é”®ç›˜çš„ä¾‹å­ï¼Œé‚£ä¹ˆæ‰¾æ‰¾å…¶å¦‚ä½•æ§åˆ¶é”®ç›˜çš„ã€‚</p><p>ä» TextView (EditText extends TextView) æºç çœ‹çœ‹å¦‚ä½•ç‚¹å‡»æ—¶å¼¹å‡ºè½¯é”®ç›˜</p><h3 id="å¼¹å‡ºè½¯é”®ç›˜"><a href="#å¼¹å‡ºè½¯é”®ç›˜" class="headerlink" title="å¼¹å‡ºè½¯é”®ç›˜"></a>å¼¹å‡ºè½¯é”®ç›˜</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span>  <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">onTouchEvent</span><span class="token punctuation">(</span><span class="token class-name">MotionEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">final</span> <span class="token keyword">int</span> action <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getActionMasked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//...  </span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>mMovement <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token function">onCheckIsTextEditor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token operator">&amp;&amp;</span> mText <span class="token keyword">instanceof</span> <span class="token class-name">Spannable</span> <span class="token operator">&amp;&amp;</span> mLayout <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token comment">//...  </span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>touchIsFinished <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token function">isTextEditable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> textIsSelectable<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">// Show the IME, except when selecting in read-only text.  </span>      <span class="token keyword">final</span> <span class="token class-name">InputMethodManager</span> imm <span class="token operator">=</span> <span class="token function">getInputMethodManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">viewClicked</span><span class="token punctuation">(</span>imm<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isTextEditable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> mEditor<span class="token punctuation">.</span>mShowSoftInputOnFocus <span class="token operator">&amp;&amp;</span> imm <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">showAutofillDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        imm<span class="token punctuation">.</span><span class="token function">showSoftInput</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment">//...  </span>    <span class="token punctuation">}</span>      <span class="token comment">//...  </span>  <span class="token punctuation">}</span>    <span class="token comment">//...  </span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹å‡ºå¼¹å‡ºé”®ç›˜éœ€è¦ä¸¤ä¸ªæ­¥éª¤ï¼š</p><blockquote><p>1ã€è·å– InputMethodManager å®ä¾‹<br>2ã€è°ƒç”¨ showSoftInput()</p></blockquote><h3 id="å…³é—­è½¯é”®ç›˜"><a href="#å…³é—­è½¯é”®ç›˜" class="headerlink" title="å…³é—­è½¯é”®ç›˜"></a>å…³é—­è½¯é”®ç›˜</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onEditorAction</span><span class="token punctuation">(</span><span class="token keyword">int</span> actionCode<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//...</span><span class="token keyword">if</span> <span class="token punctuation">(</span>actionCode <span class="token operator">==</span> <span class="token class-name">EditorInfo</span><span class="token punctuation">.</span><span class="token constant">IME_ACTION_DONE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token class-name">InputMethodManager</span> imm <span class="token operator">=</span> <span class="token function">getInputMethodManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>imm <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> imm<span class="token punctuation">.</span><span class="token function">isActive</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>          imm<span class="token punctuation">.</span><span class="token function">hideSoftInputFromWindow</span><span class="token punctuation">(</span><span class="token function">getWindowToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">//...</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥å¾—å‡ºå…³é—­é”®ç›˜ä¹Ÿåªéœ€è¦ä¸¤æ­¥ï¼š</p><blockquote><p>1ã€è·å– InputMethodManager å®ä¾‹<br>2ã€è°ƒç”¨ hideSoftInputFromWindow()</p></blockquote><h3 id="æ³¨æ„-ğŸ“¢"><a href="#æ³¨æ„-ğŸ“¢" class="headerlink" title="æ³¨æ„ ğŸ“¢"></a>æ³¨æ„ ğŸ“¢</h3><ol><li><code>imm.showSoftInput(view, code)</code> é€šå¸¸ view ä¼ å…¥çš„æ˜¯ EditText ç±»å‹ã€‚<ul><li>å¦‚æœä¼ å…¥å…¶å®ƒ <code>View</code>ï¼Œéœ€è¦è®¾ç½® <code>setFocusableInTouchMode(true)</code> æ‰èƒ½å¼¹å‡ºé”®ç›˜ã€‚</li><li>æ¯”è¾ƒå®Œå–„çš„å®ç°è¿˜éœ€åœ¨ <code>onTouchEvent()</code> é‡Œå¼¹å‡ºé”®ç›˜ã€å°† <code>Button</code> ä¸é”®ç›˜å…³è”ï¼Œå®é™…ä¸Šå°±æ˜¯æ¨¡ä»¿ EditText çš„å®ç°ã€‚</li></ul></li><li><code>imm.showSoftInput(view, code)</code>, <code>imm.hideSoftInputFromWindow(windowToken, code)</code> ä¸¤ä¸ªæ–¹æ³•çš„æœ€åä¸€ä¸ªå‚æ•°ç”¨æ¥åŒ¹é…å…³é—­é”®ç›˜æ—¶åˆ¤æ–­å½“åˆå¼¹å‡ºé”®ç›˜æ—¶ä¼ å…¥çš„ç±»å‹ï¼Œä¸€èˆ¬å¡« 0 å³å¯ã€‚</li><li><code>imm.hideSoftInputFromWindow(windowToken, code)</code> ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥çš„ IBinder windowToken ç±»å‹ã€‚<ul><li>æ¯ä¸ª Activity åˆ›å»ºæ—¶å€™ä¼šç”Ÿæˆ windowTokenï¼Œè¯¥å€¼å­˜å‚¨åœ¨ AttachInfo é‡Œã€‚</li><li>å› æ­¤å¯¹äºåŒä¸€ä¸ª Activity é‡Œçš„ ViewTreeï¼Œæ¯ä¸ª View æŒæœ‰çš„ windowToken éƒ½æ˜¯æŒ‡å‘ç›¸åŒå¯¹è±¡ã€‚</li></ul></li></ol><h2 id="è½¯é”®ç›˜ç¤ºä¾‹åˆ†æ"><a href="#è½¯é”®ç›˜ç¤ºä¾‹åˆ†æ" class="headerlink" title="è½¯é”®ç›˜ç¤ºä¾‹åˆ†æ"></a>è½¯é”®ç›˜ç¤ºä¾‹åˆ†æ</h2><img h="60" src=" https://blog-1251678165.cos.ap-chengdu.myqcloud.com/uPic/ime-pan-1.gif"><ul><li>å½“é”®ç›˜å¼¹èµ·çš„æ—¶ï¼Œå½“å‰èƒ½çœ‹åˆ°çš„æ˜¯ä¸¤ä¸ª Window: <code>Activity#Window</code> å’Œ <code>IME#Window</code></li><li><code>IME#Window</code> å±•ç¤ºé®ä½ <code>Activity#Window</code> çš„éƒ¨åˆ†åŒºåŸŸï¼Œä¸ºäº†ä½¿ <code>EditText</code> èƒ½å¤Ÿè¢«çœ‹åˆ°ï¼Œ<code>Activity</code> å¸ƒå±€ä¼šå‘ä¸Šåç§»</li></ul><blockquote><p>Window åŒºåŸŸæ„æˆå’Œå˜åŒ–æƒ…å†µ</p></blockquote><p><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/uPic/H0CsIU.jpg" alt="H0CsIU"></p><blockquote><p>è½¯é”®ç›˜å¼¹å‡ºæ—¶ Window çŠ¶æ€ï¼šWindow {d 855900 InputMethod} æ­£å¥½åœ¨ ImeTestActivity ä¹‹ä¸Š</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><div class="caption"><span>{all|6,7}</span></div><code class="language-bash">$ adb shell dumpsys window<span class="token operator">|</span><span class="token function">grep</span> WindowStateAnimator      Window <span class="token comment">#0: WindowStateAnimator{e30fe7 com.android.systemui.ImageWallpaper}</span>      Window <span class="token comment">#1: WindowStateAnimator{3305794 com.google.android.apps.nexuslauncher/com.google.android.apps.nexuslauncher.NexusLauncherActivity}</span>      Window <span class="token comment">#2: WindowStateAnimator{6bc923d com.google.android.apps.nexuslauncher/com.google.android.apps.nexuslauncher.NexusLauncherActivity}</span>      Window <span class="token comment">#3: WindowStateAnimator{b070a32 com.weiwei.keyboard.watcher.sample/com.weiwei.keyboard.watcher.sample.MainActivity}</span>      Window <span class="token comment">#4: WindowStateAnimator{bc6c383 com.weiwei.keyboard.watcher.sample/com.weiwei.keyboard.watcher.sample.test.ImeTestActivity}</span>      Window <span class="token comment">#5: WindowStateAnimator{d855900 InputMethod}</span>      Window <span class="token comment">#6: WindowStateAnimator{8e51539 ShellDropTarget}</span>      Window <span class="token comment">#7: WindowStateAnimator{917977e StatusBar}</span>      Window <span class="token comment">#8: WindowStateAnimator{8a814df NotificationShade}</span>      Window <span class="token comment">#9: WindowStateAnimator{967052c NavigationBar0}</span>      Window <span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ˜¯è°æ§åˆ¶äº† Window å‘ä¸Šåç§»å‘¢ï¼Ÿ</p><ul><li>Window ä¸­æ°å¥½å°±æœ‰æ§åˆ¶è½¯é”®ç›˜çš„å‚æ•° WindowManager.LayoutParams.softInputMode</li></ul><blockquote><p>è¯•æƒ³ä»¥ä¸‹é—®é¢˜å¦‚ä½•è§£å†³ï¼š<br>1ã€å½“é”®ç›˜å¼¹å‡ºæ—¶ï¼Œåº•éƒ¨ Button æ°å¥½ä¿æŒåœ¨é”®ç›˜ä¹‹ä¸Šã€‚<br>2ã€å½“é”®ç›˜å¼¹å‡ºæ—¶ï¼Œä»»ä½• View éƒ½ä¸éœ€è¦é¡¶ä¸Šå»ã€‚</p></blockquote><h2 id="softInputMode-æ–‡æ¡£è¯´æ˜"><a href="#softInputMode-æ–‡æ¡£è¯´æ˜" class="headerlink" title="softInputMode æ–‡æ¡£è¯´æ˜"></a>softInputMode æ–‡æ¡£è¯´æ˜</h2><p>softInputMode é¡¾åæ€ä¹‰ï¼š<strong>è½¯é”®ç›˜æ¨¡å¼</strong>ï¼Œæ§åˆ¶è½¯é”®ç›˜æ˜¯å¦å¯è§ã€å…³è”çš„ EditText æ˜¯å¦è·Ÿéšé”®ç›˜ç§»åŠ¨ç­‰ï¼Œé‡ç‚¹å…³æ³¨ä»¥ä¸‹å±æ€§ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// WindowManager.java</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">SOFT_INPUT_ADJUST_UNSPECIFIED</span> <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">SOFT_INPUT_ADJUST_RESIZE</span> <span class="token operator">=</span> <span class="token number">0x10</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">SOFT_INPUT_ADJUST_PAN</span> <span class="token operator">=</span> <span class="token number">0x20</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">SOFT_INPUT_ADJUST_NOTHING</span> <span class="token operator">=</span> <span class="token number">0x30</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»æ³¨é‡Šçš„æ–‡æ¡£ä¸Šçœ‹ï¼š</p><ul><li>ADJUST_UNSPECIFIED: ä¸æŒ‡å®šè°ƒæ•´æ–¹å¼ï¼Œç³»ç»Ÿè‡ªè¡Œå†³å®šä½¿ç”¨å“ªç§è°ƒæ•´æ–¹å¼</li><li>ADJUST_RESIZE: æ˜¾ç¤ºè½¯é”®ç›˜æ—¶è°ƒæ•´çª—å£å¤§å°ï¼Œä½¿å…¶å†…å®¹ä¸è¢«è¾“å…¥æ³•è¦†ç›–</li><li>ADJUST_PAN: æ˜¾ç¤ºè½¯é”®ç›˜æ—¶ï¼Œçª—å£å°†å›å¹³ç§»æ¥ä¿è¯è¾“å…¥ç„¦ç‚¹å¯è§</li><li>ADJUST_NOTHING: ä¸åšä»»ä½•æ“ä½œ</li></ul><h2 id="softInputMode-è®¾ç½®æ–¹æ³•"><a href="#softInputMode-è®¾ç½®æ–¹æ³•" class="headerlink" title="softInputMode è®¾ç½®æ–¹æ³•"></a>softInputMode è®¾ç½®æ–¹æ³•</h2><p>softInputMode é»˜è®¤æ˜¯ ADJUST_UNSPECIFIED æ¨¡å¼ï¼Œå…¶ä»–æ¨¡å¼è®¾ç½®æ–¹æ³•ï¼š</p><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin">æ–¹æ³•<span class="token number">1</span> Activity#onCreate  window<span class="token punctuation">.</span><span class="token function">setSoftInputMode</span><span class="token punctuation">(</span>WindowManager<span class="token punctuation">.</span>LayoutParams<span class="token punctuation">.</span>SOFT_INPUT_ADJUST_NOTHING<span class="token punctuation">)</span>æ–¹æ³•<span class="token number">2</span> AndroidManifest<span class="token punctuation">.</span>xml activity tagandroid<span class="token operator">:</span>windowSoftInputMode<span class="token operator">=</span><span class="token string-literal singleline"><span class="token string">"adjustNothing"</span></span>æ–¹æ³•<span class="token number">3</span> Application<span class="token operator">/</span>Activity theme  <span class="token operator">&lt;</span>item name<span class="token operator">=</span><span class="token string-literal singleline"><span class="token string">"android:windowSoftInputMode"</span></span><span class="token operator">&gt;</span>adjustNothing<span class="token operator">&lt;</span><span class="token operator">/</span>item<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="softInputMode-ç¤ºä¾‹å¯¹æ¯”"><a href="#softInputMode-ç¤ºä¾‹å¯¹æ¯”" class="headerlink" title="softInputMode ç¤ºä¾‹å¯¹æ¯”"></a>softInputMode ç¤ºä¾‹å¯¹æ¯”</h2><p>ä»¥è¿™ä¸‰ç§å¸ƒå±€çº¦æŸæ’åˆ—ç»“æ„ä¸ºç¤ºä¾‹ï¼šåˆ†åˆ«ç‚¹å‡»ä¸¤ä¸ª EditText æ¥æµ‹è¯•å¼¹å‡ºå’Œæ”¶èµ·è½¯é”®ç›˜</p><img class="h-100" src=" https://blog-1251678165.cos.ap-chengdu.myqcloud.com/uPic/byqhVE.jpg"><hr><h2 id="SOFT-INPUT-ADJUST-RESIZE"><a href="#SOFT-INPUT-ADJUST-RESIZE" class="headerlink" title="SOFT_INPUT_ADJUST_RESIZE"></a>SOFT_INPUT_ADJUST_RESIZE</h2><table><thead><tr><th><img src=" https://blog-1251678165.cos.ap-chengdu.myqcloud.com/uPic/ime-resize-1.gif" class="h-100"></th><th><img src=" https://blog-1251678165.cos.ap-chengdu.myqcloud.com/uPic/ime-resize-2.gif" class="h-100"></th><th><img src=" https://blog-1251678165.cos.ap-chengdu.myqcloud.com/uPic/ime-resize-3.gif" class="h-100"></th></tr></thead></table><p>ä»ä¸‰ä¸ªç¤ºä¾‹ gif å¯ä»¥çœ‹å‡ºï¼šè½¯é”®ç›˜å¼¹å‡º/å…³é—­æ—¶ï¼Œå¸ƒå±€é«˜åº¦ä¼šéšç€æ”¹å˜ï¼Œå¸ƒå±€ä¸­çš„æ§ä»¶ä¼šé‡æ–°å¸ƒå±€ã€‚</p><p>æ‰€ä»¥ä¸åº•éƒ¨æ²¡æœ‰çº¦æŸå…³ç³»çš„ View åœ¨å¸ƒå±€é«˜åº¦å˜åŒ–çš„æ—¶å€™ï¼Œä¸ä¼šè·Ÿéšç§»åŠ¨ã€‚</p><ul><li>é‚£ä¹ˆæ€è€ƒä¸€ä¸‹ ADJUST_RESIZE æ¨¡å¼ä¸‹çš„å‡ ä¸ªé—®é¢˜ï¼š<ul><li>å¦‚ä½•æ”¹å˜å¸ƒå±€é«˜åº¦ï¼Ÿ</li><li>æ”¹å˜äº†å“ªä¸ªå¸ƒå±€çš„é«˜åº¦ï¼Ÿ</li><li>æ˜¯å¦ä¸€å®šä¼šæ”¹å˜å¸ƒå±€é«˜åº¦ï¼Ÿ</li></ul></li></ul><h3 id="åŸç†åˆ†æ"><a href="#åŸç†åˆ†æ" class="headerlink" title="åŸç†åˆ†æ"></a>åŸç†åˆ†æ</h3><p>ç”±ä»¥ä¸Šçš„ç¤ºä¾‹å¯çŸ¥ä¸€å®šæ˜¯ ViewTree é‡Œçš„æŸä¸ª ViewGroup é«˜åº¦æ”¹å˜äº†ã€‚</p><p>é”®ç›˜æœ¬èº«æ˜¯ä¸€ä¸ª Windowï¼Œé”®ç›˜å¼¹å‡ºå½±å“äº† <code>ActivityWindow</code> å¤§å°ï¼Œä»è€Œå¯¼è‡´ ViewTree å˜åŒ–ï¼Œè€Œ Window å’Œ ViewTree çš„è”ç³»åˆ™æ˜¯é€šè¿‡ <code>ViewRootImpl.java</code> å®ç°çš„</p><p><code>ViewRootImpl</code> æ¥æ”¶ <code>WMS äº‹ä»¶</code> çš„å¤„ç†è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// ViewRootImpl.java</span><span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">ViewRootHandler</span> <span class="token keyword">extends</span> <span class="token class-name">Handler</span> <span class="token punctuation">{</span>  <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">handleMessageImpl</span><span class="token punctuation">(</span><span class="token class-name">Message</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>msg<span class="token punctuation">.</span>what<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token comment">//æ¥æ”¶çª—å£å˜åŒ–äº‹ä»¶</span>      <span class="token keyword">case</span> <span class="token constant">MSG_RESIZED</span><span class="token operator">:</span> <span class="token punctuation">{</span>        <span class="token comment">//args è®°å½•äº†å„ä¸ªåŒºåŸŸå¤§å¤§å°</span>        <span class="token class-name">SomeArgs</span> args <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SomeArgs</span><span class="token punctuation">)</span> msg<span class="token punctuation">.</span>obj<span class="token punctuation">;</span>        <span class="token comment">//-------------------&gt;Note 1</span>        <span class="token comment">//arg 1----&gt;Window çš„å°ºå¯¸</span>        <span class="token comment">//arg 2----&gt;å†…å®¹åŒºåŸŸé™å®šè¾¹ç•Œ</span>        <span class="token comment">//arg 3-----&gt;å¯è§åŒºåŸŸçš„é™å®šè¾¹ç•Œ</span>        <span class="token comment">//arg 6-----&gt;å›ºå®šåŒºåŸŸçš„é™å®šè¾¹ç•Œ</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>mWinFrame<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>arg <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token operator">&amp;&amp;</span> mPendingOverscanInsets<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>arg <span class="token number">5</span><span class="token punctuation">)</span>            <span class="token operator">&amp;&amp;</span> mPendingContentInsets<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>arg <span class="token number">2</span><span class="token punctuation">)</span>            <span class="token operator">&amp;&amp;</span> mPendingStableInsets<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>arg <span class="token number">6</span><span class="token punctuation">)</span>            <span class="token operator">&amp;&amp;</span> mPendingDisplayCutout<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>arg <span class="token number">9</span><span class="token punctuation">)</span>            <span class="token operator">&amp;&amp;</span> mPendingVisibleInsets<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>arg <span class="token number">3</span><span class="token punctuation">)</span>            <span class="token operator">&amp;&amp;</span> mPendingOutsets<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>arg <span class="token number">7</span><span class="token punctuation">)</span>            <span class="token operator">&amp;&amp;</span> mPendingBackDropFrame<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>arg <span class="token number">8</span><span class="token punctuation">)</span>            <span class="token operator">&amp;&amp;</span> args<span class="token punctuation">.</span>arg <span class="token number">4</span> <span class="token operator">==</span> <span class="token keyword">null</span>            <span class="token operator">&amp;&amp;</span> args<span class="token punctuation">.</span>argi <span class="token number">1</span> <span class="token operator">==</span> <span class="token number">0</span>            <span class="token operator">&amp;&amp;</span> mDisplay<span class="token punctuation">.</span><span class="token function">getDisplayId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> args<span class="token punctuation">.</span>argi <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token comment">//å„ä¸ªåŒºåŸŸå¤§å°éƒ½æ²¡å˜åŒ–ï¼Œåˆ™ä¸ä½œä»»ä½•æ“ä½œ</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>      <span class="token punctuation">}</span>      <span class="token keyword">case</span> <span class="token constant">MSG_RESIZED_REPORT</span><span class="token operator">:</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>mAdded<span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token class-name">SomeArgs</span> args <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SomeArgs</span><span class="token punctuation">)</span> msg<span class="token punctuation">.</span>obj<span class="token punctuation">;</span>          <span class="token comment">//...</span>          <span class="token keyword">final</span> <span class="token keyword">boolean</span> framesChanged <span class="token operator">=</span> <span class="token operator">!</span>mWinFrame<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>arg <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token operator">||</span> <span class="token operator">!</span>mPendingOverscanInsets<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>arg <span class="token number">5</span><span class="token punctuation">)</span>            <span class="token operator">||</span> <span class="token operator">!</span>mPendingContentInsets<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>arg <span class="token number">2</span><span class="token punctuation">)</span>            <span class="token operator">||</span> <span class="token operator">!</span>mPendingStableInsets<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>arg <span class="token number">6</span><span class="token punctuation">)</span>            <span class="token operator">||</span> <span class="token operator">!</span>mPendingDisplayCutout<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>arg <span class="token number">9</span><span class="token punctuation">)</span>            <span class="token operator">||</span> <span class="token operator">!</span>mPendingVisibleInsets<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>arg <span class="token number">3</span><span class="token punctuation">)</span>            <span class="token operator">||</span> <span class="token operator">!</span>mPendingOutsets<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>arg <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">//é‡æ–°è®¾ç½® Window å°ºå¯¸</span>          <span class="token function">setFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Rect</span><span class="token punctuation">)</span> args<span class="token punctuation">.</span>arg <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">//å°†å€¼è®°å½•åˆ°å„ä¸ªæˆå‘˜å˜é‡é‡Œ</span>          mPendingOverscanInsets<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Rect</span><span class="token punctuation">)</span> args<span class="token punctuation">.</span>arg <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          mPendingContentInsets<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Rect</span><span class="token punctuation">)</span> args<span class="token punctuation">.</span>arg <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          mPendingStableInsets<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Rect</span><span class="token punctuation">)</span> args<span class="token punctuation">.</span>arg <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          mPendingDisplayCutout<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">DisplayCutout</span><span class="token punctuation">)</span> args<span class="token punctuation">.</span>arg <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          mPendingVisibleInsets<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Rect</span><span class="token punctuation">)</span> args<span class="token punctuation">.</span>arg <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          mPendingOutsets<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Rect</span><span class="token punctuation">)</span> args<span class="token punctuation">.</span>arg <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          mPendingBackDropFrame<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Rect</span><span class="token punctuation">)</span> args<span class="token punctuation">.</span>arg <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          mForceNextWindowRelayout <span class="token operator">=</span> args<span class="token punctuation">.</span>argi <span class="token number">1</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">;</span>          mPendingAlwaysConsumeSystemBars <span class="token operator">=</span> args<span class="token punctuation">.</span>argi <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">;</span>          args<span class="token punctuation">.</span><span class="token function">recycle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>msg<span class="token punctuation">.</span>what <span class="token operator">==</span> <span class="token constant">MSG_RESIZED_REPORT</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">reportNextDraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>mView <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>framesChanged <span class="token operator">||</span> configChanged<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment">//å°ºå¯¸å‘ç”Ÿå˜åŒ–ï¼Œå¼ºåˆ¶èµ° layout+draw è¿‡ç¨‹-----------&gt;Note2</span>            <span class="token function">forceLayout</span><span class="token punctuation">(</span>mView<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          <span class="token comment">//é‡æ–° layout--------------&gt;Note3</span>          <span class="token function">requestLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token comment">//...</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šé¢ä»£ç åˆ—å‡ºäº†ä¸‰ä¸ªæ³¨æ„ç‚¹ï¼Œåˆ†åˆ«æ¥çœ‹çœ‹ï¼š</p><p><strong>Note 1</strong></p><blockquote><p>//arg 1â€”-&gt;Window çš„å°ºå¯¸<br>//arg 2â€”-&gt;å†…å®¹åŒºåŸŸé™å®šè¾¹ç•Œ<br>//arg 3â€”â€“&gt;å¯è§åŒºåŸŸçš„é™å®šè¾¹ç•Œ<br>//arg 6â€”â€“&gt;å›ºå®šåŒºåŸŸçš„é™å®šè¾¹ç•Œ<br>arg æ˜¯ Rect ç±»å‹</p></blockquote><p>â€œé™å®šè¾¹ç•Œâ€æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿä»¥å°ç±³ 6 æµ‹è¯•æœºä¸ºä¾‹ (å±å¹•å°ºå¯¸ 1920 x 1080)ï¼šå¯ä»¥çœ‹å‡ºï¼Œæ‰€è°“çš„â€é™å®šè¾¹ç•Œâ€å®é™…ä¸Šå°±æ˜¯ä¸Šé¢çŸ©å½¢åŒºåŸŸã€‚</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/MOu2ZNAwZwMdfb25nt76qmRW3aHYfib3Jcb824y8lXxDxZSyicd1YpSeBM9CIlIJ6yj3ibhExG2Af8qeopGTfnIlg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><p>å½“é”®ç›˜å¼¹å‡ºæ—¶ï¼š</p><ul><li>arg 1â€”-&gt;Rect(0, 0 - 1080, 1920)</li><li>arg 2â€”-&gt;Rect(0, 63 - 0, 972)</li><li>arg 3â€”-&gt;Rect(0, 63 - 0, 972)</li><li>arg 6â€”-&gt;Rect(0, 63 - 0, 126)</li></ul><p>å½“é”®ç›˜æ”¶èµ·åï¼š</p><ul><li>arg 1â€”-&gt;Rect(0, 0 - 1080, 1920)</li><li>arg 2â€”-&gt;Rect(0, 63 - 0, 126)</li><li>arg 3â€”-&gt;Rect(0, 63 - 0, 126)</li><li>arg 6â€”-&gt;Rect(0, 63 - 0, 126)</li></ul><p>çœ‹åˆ°æ­¤ï¼Œå¤§å®¶éƒ½æ˜ç™½äº†ï¼š</p><ul><li>arg 1 è¡¨ç¤ºçš„å±å¹•å°ºå¯¸ã€‚</li><li>arg 6 è¡¨ç¤ºçš„æ˜¯çŠ¶æ€æ å’Œå¯¼èˆªæ çš„é«˜åº¦ã€‚</li><li>arg 6 èµ‹å€¼ç»™äº† mPendingStableInsetsï¼Œä»åå­—å¯ä»¥çœ‹å‡ºï¼Œè¿™å€¼æ˜¯ä¸å˜çš„ã€‚</li></ul><p>æ— è®ºé”®ç›˜å¼¹å‡ºè¿˜æ˜¯å…³é—­ï¼Œè¿™ä¸¤ä¸ªå€¼éƒ½ä¸å˜ï¼Œå˜çš„æ˜¯ arg 2 å’Œ arg 3ï¼Œè€Œ arg 2 èµ‹å€¼ç»™äº† mPendingContentInsetsï¼Œarg 3 èµ‹å€¼ç»™äº† mPendingVisibleInsetsã€‚å¥½äº†ï¼Œç°åœ¨ arg 2ã€arg 3ã€arg 6 éƒ½è®°å½•åˆ°æˆå‘˜å˜é‡é‡Œäº†ã€‚</p><p><strong>Note 2 &amp; 3</strong></p><p>å°ºå¯¸å‘ç”Ÿäº†å˜åŒ–åè°ƒç”¨ï¼š</p><p>forceLayout(mView)â€”&gt;ViewTree é‡Œæ¯ä¸ª View/ViewGroup æ‰“ä¸Š layout, draw æ ‡è®°ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸ª View/ViewGroup æœ€åéƒ½ä¼šæ‰§è¡Œä¸‰å¤§æµç¨‹ã€‚</p><p>requestLayout()â€”&gt; è§¦å‘æ‰§è¡Œä¸‰å¤§æµç¨‹</p><p>æ—¢ç„¶è®°å½•äº†å°ºå¯¸çš„å˜åŒ–ï¼Œç»§ç»­è·Ÿè¸ªè¿™äº›å€¼æ€ä¹ˆä½¿ç”¨ã€‚è°ƒç”¨ requestLayout() å°†ä¼šè§¦å‘æ‰§è¡Œ performTraversals() æ–¹æ³•ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// ViewRootImpl.java</span><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">performTraversals</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>mFirst <span class="token operator">||</span> windowShouldResize <span class="token operator">||</span> insetsChanged <span class="token operator">||</span>      viewVisibilityChanged <span class="token operator">||</span> params <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">||</span> mForceNextWindowRelayout<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">//...</span>    <span class="token keyword">boolean</span> hwInitialized <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token comment">//å†…å®¹è¾¹ç•Œæ˜¯å¦å‘ç”Ÿå˜åŒ–</span>    <span class="token keyword">boolean</span> contentInsetsChanged <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>      <span class="token comment">//...</span>      <span class="token comment">//å†…å®¹åŒºåŸŸå˜åŒ–-----------&gt;Note 1</span>      contentInsetsChanged <span class="token operator">=</span> <span class="token operator">!</span>mPendingContentInsets<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>        mAttachInfo<span class="token punctuation">.</span>mContentInsets<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>contentInsetsChanged <span class="token operator">||</span> mLastSystemUiVisibility <span class="token operator">!=</span>          mAttachInfo<span class="token punctuation">.</span>mSystemUiVisibility <span class="token operator">||</span> mApplyInsetsRequested          <span class="token operator">||</span> mLastOverscanRequested <span class="token operator">!=</span> mAttachInfo<span class="token punctuation">.</span>mOverscanRequested          <span class="token operator">||</span> outsetsChanged<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//...</span>        <span class="token comment">//åˆ†å‘ Inset-----------&gt;Note2</span>        <span class="token function">dispatchApplyInsets</span><span class="token punctuation">(</span>host<span class="token punctuation">)</span><span class="token punctuation">;</span>        contentInsetsChanged <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token comment">//...</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RemoteException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token comment">//...</span>  <span class="token punctuation">}</span>  <span class="token comment">//...</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸»è¦çœ‹ä¸¤ä¸ªç‚¹ï¼š</p><p><strong>Note 1</strong>: å†…å®¹åŒºåŸŸå‘ç”Ÿå˜åŒ–</p><ul><li>å½“è®¾ç½® SOFT_INPUT_ADJUST_RESIZEï¼Œé”®ç›˜å¼¹èµ·æ—¶å†…å®¹åŒºåŸŸå‘ç”Ÿå˜åŒ–ï¼Œå› æ­¤ä¼šæ‰§è¡Œ dispatchApplyInsets()</li><li>å½“è®¾ç½® SOFT_INPUT_ADJUST_PANï¼Œé”®ç›˜å¼¹èµ·æ—¶å†…å®¹éƒ¨åŒºåŸŸä¸å˜ï¼Œå› æ­¤ä¸ä¼šæ‰§è¡Œ dispatchApplyInsets()</li></ul><p><strong>Note 2</strong>: åˆ†å‘ Inset</p><p>è¿™äº›è®°å½•çš„å€¼ä¼šå­˜å‚¨åœ¨ AttachInfo å¯¹åº”çš„å˜é‡é‡Œã€‚è¯¥æ–¹æ³•è°ƒç”¨æ ˆå¦‚ä¸‹ï¼š</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/MOu2ZNAwZwMdfb25nt76qmRW3aHYfib3Jia0cOnrqxNZMK6fz8Bwqiaouks0V0DgnV8gUpXHfhTKKBEq0fjJW6OEw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><p>dispatchApplyWindowInsets(WindowInsets insetsï¼‰é‡Œçš„ insets æ„æˆæ˜¯é€šè¿‡è®¡ç®—ä¹‹å‰è®°å½•åœ¨ mPendingXx é‡Œçš„è¾¹ç•Œå€¼ã€‚</p><p>æœ€ç»ˆè°ƒç”¨ fitSystemWindowsInt():</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// View.java</span><span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">fitSystemWindowsInt</span><span class="token punctuation">(</span><span class="token class-name">Rect</span> insets<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">//å¯¹äº DecorView çš„å­å¸ƒå±€ LinearLayout æ¥è¯´ï¼Œé»˜è®¤ fitsSystemWindows=true</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>mViewFlags <span class="token operator">&amp;</span> <span class="token constant">FITS_SYSTEM_WINDOWS</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">FITS_SYSTEM_WINDOWS</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">//...</span>    <span class="token comment">//è®¾ç½® padding</span>    <span class="token function">internalSetPadding</span><span class="token punctuation">(</span>localInsets<span class="token punctuation">.</span>left<span class="token punctuation">,</span> localInsets<span class="token punctuation">.</span>top<span class="token punctuation">,</span> localInsets<span class="token punctuation">.</span>right<span class="token punctuation">,</span> localInsets<span class="token punctuation">.</span>bottom<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>çœ‹åˆ°è¿™ç­”æ¡ˆå°±å‘¼ä¹‹æ¬²å‡ºäº†ï¼ŒDecorView çš„å­å¸ƒå±€ LinearLayout è®¾ç½® paddingï¼Œä»è€Œå½±å“ LinearLayout å­å¸ƒå±€çš„é«˜åº¦ï¼Œæœ€ç»ˆä¼šå½±å“åˆ° Activity å¸ƒå±€æ–‡ä»¶çš„é«˜åº¦ã€‚</p><hr><h2 id="SOFT-INPUT-ADJUST-PAN"><a href="#SOFT-INPUT-ADJUST-PAN" class="headerlink" title="SOFT_INPUT_ADJUST_PAN"></a>SOFT_INPUT_ADJUST_PAN</h2><table><thead><tr><th><img src=" https://blog-1251678165.cos.ap-chengdu.myqcloud.com/uPic/ime-pan-1.gif" class="h-100"></th><th><img src=" https://blog-1251678165.cos.ap-chengdu.myqcloud.com/uPic/ime-pan-2.gif" class="h-100"></th><th><img src=" https://blog-1251678165.cos.ap-chengdu.myqcloud.com/uPic/ime-pan-3.gif" class="h-100"></th></tr></thead></table><p>è½¯é”®ç›˜å¼¹å‡º/å…³é—­æ—¶ï¼Œæ•´ä¸ªå¸ƒå±€ä¼šä¸Šç§»ï¼Œå¸ƒå±€é«˜åº¦ä¸ä¼šæ”¹å˜ï¼Œå¸ƒå±€ä¸­çš„æ§ä»¶ä¸ä¼šé‡æ–°å¸ƒå±€ã€‚</p><ul><li>ADJUST_PAN å¦‚ä½•ç§»åŠ¨æ•´ä¸ªå¸ƒå±€ï¼Ÿ</li></ul><p>å½“ç‚¹å‡»è¾“å…¥æ¡† 1 çš„æ—¶å€™ï¼Œç•Œé¢æ²¡æœ‰ç§»åŠ¨ï¼Œå½“ç‚¹å‡»è¾“å…¥æ¡† 2 çš„æ—¶å€™ï¼Œç•Œé¢å‘ä¸Šç§»åŠ¨äº†ã€‚æ¥ä¸‹æ¥å°†åˆ†æä¸ºå•¥ä¼šæœ‰è¿™æ ·çš„è¡¨ç°ã€‚</p><h3 id="åŸç†åˆ†æ-1"><a href="#åŸç†åˆ†æ-1" class="headerlink" title="åŸç†åˆ†æ"></a>åŸç†åˆ†æ</h3><p><code>ADJUST_PAN</code> å’Œ <code>ADJUST_RESIZE</code> æµç¨‹å·®ä¸å¤šï¼Œä¹Ÿæ˜¯åœ¨ ViewRootImpl é‡Œæ¥æ”¶çª—å£å˜åŒ–çš„é€šçŸ¥ï¼Œä¸åŒçš„æ˜¯ï¼š</p><p>å½“é”®ç›˜å¼¹èµ·æ—¶ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">- arg <span class="token number">1</span>----<span class="token operator">&gt;</span>Rect<span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">0</span> - <span class="token number">1080</span>, <span class="token number">1920</span><span class="token punctuation">)</span>- arg <span class="token number">2</span>----<span class="token operator">&gt;</span>Rect<span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">63</span> - <span class="token number">0</span>, <span class="token number">126</span><span class="token punctuation">)</span>- arg <span class="token number">3</span>----<span class="token operator">&gt;</span>Rect<span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">63</span> - <span class="token number">0</span>, <span class="token number">972</span><span class="token punctuation">)</span>- arg <span class="token number">6</span>----<span class="token operator">&gt;</span>Rect<span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">63</span> - <span class="token number">0</span>, <span class="token number">126</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹å‡º arg 2 æ²¡æœ‰å˜åŒ–ï¼Œä¹Ÿå°±æ˜¯å†…å®¹åŒºåŸŸæ²¡æœ‰å˜ï¼Œæœ€ç»ˆä¸ä¼šæ‰§è¡Œ <code>ViewRootImp-&gt; dispatchApplyInsets(xx)</code> ï¼Œå½“ç„¶å¸ƒå±€çš„é«˜åº¦å°±ä¸ä¼šå˜ã€‚</p><p>å…ˆæ¥åˆ†æä¸ºä»€ä¹ˆç‚¹å‡»è¾“å…¥æ¡† 2 èƒ½å¾€ä¸Šç§»åŠ¨ã€‚æˆ‘ä»¬çŸ¥é“å¸ƒå±€ç§»åŠ¨æ— éå°±æ˜¯åæ ‡å‘ç”Ÿæ”¹å˜ï¼Œæˆ–è€…å†…å®¹æ»šåŠ¨äº†ï¼Œä¸ç®¡æ˜¯ä½•ç§å½¢å¼æœ€ç»ˆéƒ½éœ€è¦é€šè¿‡å¯¹ Canvas è¿›è¡Œä½ç§»æ‰èƒ½å®ç°ç§»åŠ¨çš„æ•ˆæœã€‚</p><p>å½“çª—å£äº‹ä»¶åˆ°æ¥ä¹‹åï¼Œå‘èµ· View çš„ä¸‰å¤§ç»˜åˆ¶æµç¨‹ï¼Œå¹¶ä¸”å°†é™å®šè¾¹ç•Œå­˜å‚¨åˆ° AttachInfo çš„æˆå‘˜å˜é‡é‡Œï¼Œæœ‰å¦‚ä¸‹å…³ç³»ï¼š</p><ul><li>mPendingContentInsetsâ€“&gt;mAttachInfo.mContentInsets;</li><li>mPendingVisibleInsetsâ€“&gt;mAttachInfo.mVisibleInsets;</li></ul><p>ä¾æ—§æ˜¯ä»ä¸‰å¤§æµç¨‹å¼€å¯çš„æ–¹æ³•å¼€å§‹åˆ†æã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// ViewRootImpl.java</span><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">performTraversals</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">//...</span>  <span class="token comment">//åœ¨æ‰§è¡Œ Draw è¿‡ç¨‹ä¹‹å‰æ‰§è¡Œ</span>  <span class="token keyword">boolean</span> cancelDraw <span class="token operator">=</span> mAttachInfo<span class="token punctuation">.</span>mTreeObserver<span class="token punctuation">.</span><span class="token function">dispatchOnPreDraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span>isViewVisible<span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cancelDraw<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">//...</span>    <span class="token comment">//å¼€å¯ Draw è¿‡ç¨‹</span>    <span class="token function">performDraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token comment">//...</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>performDraw() æœ€ç»ˆæ‰§è¡Œäº† scrollToRectOrFocus() æ–¹æ³•ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// View.java</span><span class="token keyword">boolean</span> <span class="token function">scrollToRectOrFocus</span><span class="token punctuation">(</span><span class="token class-name">Rect</span> rectangle<span class="token punctuation">,</span> <span class="token keyword">boolean</span> immediate<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">final</span> <span class="token class-name">Rect</span> ci <span class="token operator">=</span> mAttachInfo<span class="token punctuation">.</span>mContentInsets<span class="token punctuation">;</span> <span class="token comment">//çª—å£å†…å®¹åŒºåŸŸ</span>  <span class="token keyword">final</span> <span class="token class-name">Rect</span> vi <span class="token operator">=</span> mAttachInfo<span class="token punctuation">.</span>mVisibleInsets<span class="token punctuation">;</span> <span class="token comment">//çª—å£å¯è§åŒºåŸŸ</span>  <span class="token keyword">int</span> scrollY <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//æ»šåŠ¨è·ç¦»</span>  <span class="token keyword">boolean</span> handled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>vi<span class="token punctuation">.</span>left <span class="token operator">&gt;</span> ci<span class="token punctuation">.</span>left <span class="token operator">||</span> vi<span class="token punctuation">.</span>top <span class="token operator">&gt;</span> ci<span class="token punctuation">.</span>top <span class="token operator">||</span> vi<span class="token punctuation">.</span>right <span class="token operator">&gt;</span> ci<span class="token punctuation">.</span>right <span class="token operator">||</span> vi<span class="token punctuation">.</span>bottom <span class="token operator">&gt;</span> ci<span class="token punctuation">.</span>bottom<span class="token punctuation">)</span> <span class="token punctuation">{</span>    scrollY <span class="token operator">=</span> mScrollY<span class="token punctuation">;</span>    <span class="token comment">//æ‰¾åˆ°å½“å‰æœ‰ç„¦ç‚¹çš„ View------------&gt;Note1</span>    <span class="token keyword">final</span> <span class="token class-name">View</span> focus <span class="token operator">=</span> mView<span class="token punctuation">.</span><span class="token function">findFocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//...</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>focus <span class="token operator">==</span> lastScrolledFocus <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>mScrollMayChange <span class="token operator">&amp;&amp;</span> rectangle <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token comment">//ç„¦ç‚¹æ²¡æœ‰å‘ç”Ÿåˆ‡æ¢ï¼Œä¸åšæ“ä½œ</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>      mLastScrolledFocus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">View</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>focus<span class="token punctuation">)</span><span class="token punctuation">;</span>      mScrollMayChange <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>      <span class="token comment">// Try to find the rectangle from the focus view.</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>focus<span class="token punctuation">.</span><span class="token function">getGlobalVisibleRect</span><span class="token punctuation">(</span>mVisRect<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//...</span>        <span class="token comment">//æ‰¾åˆ°å½“å‰ç„¦ç‚¹ä¸å¯è§åŒºåŸŸçš„ç›¸äº¤éƒ¨åˆ†</span>        <span class="token comment">//mVisRect ä¸ºå½“å‰ç„¦ç‚¹åœ¨ Window é‡Œçš„å¯è§éƒ¨åˆ†</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>mTempRect<span class="token punctuation">.</span><span class="token function">intersect</span><span class="token punctuation">(</span>mVisRect<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>mTempRect<span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token punctuation">(</span>mView<span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>vi<span class="token punctuation">.</span>top<span class="token operator">-</span>vi<span class="token punctuation">.</span>bottom<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment">//...</span>          <span class="token punctuation">}</span>          <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>mTempRect<span class="token punctuation">.</span>top <span class="token operator">&lt;</span> vi<span class="token punctuation">.</span>top<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment">//å¦‚æœå½“å‰ç„¦ç‚¹ä½ç½®åœ¨çª—å£å¯è§åŒºåŸŸä¸Šè¾¹ï¼Œè¯´æ˜ç„¦ç‚¹ View åº”è¯¥å¾€ä¸‹ç§»åŠ¨åˆ°å¯è§åŒºåŸŸé‡Œè¾¹</span>            scrollY <span class="token operator">=</span> mTempRect<span class="token punctuation">.</span>top <span class="token operator">-</span> vi<span class="token punctuation">.</span>top<span class="token punctuation">;</span>          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>mTempRect<span class="token punctuation">.</span>bottom <span class="token operator">&gt;</span> <span class="token punctuation">(</span>mView<span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>vi<span class="token punctuation">.</span>bottom<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment">//å¦‚æœå½“å‰ç„¦ç‚¹ä½ç½®åœ¨çª—å£å¯è§åŒºåŸŸä¹‹ä¸‹ï¼Œè¯´æ˜å…¶åº”è¯¥å¾€ä¸Šç§»åŠ¨åˆ°å¯è§åŒºåŸŸé‡Œè¾¹-------&gt;Note 2</span>            scrollY <span class="token operator">=</span> mTempRect<span class="token punctuation">.</span>bottom <span class="token operator">-</span> <span class="token punctuation">(</span>mView<span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>vi<span class="token punctuation">.</span>bottom<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token comment">//æ— éœ€æ»šåŠ¨-------&gt;Note 3</span>            scrollY <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>          handled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>scrollY <span class="token operator">!=</span> mScrollY<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">//æ»šåŠ¨è·ç¦»å‘ç”Ÿå˜åŒ–</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>immediate<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>mScroller <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        mScroller <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scroller</span><span class="token punctuation">(</span>mView<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token comment">//å¼€å§‹è®¾ç½®æ»šåŠ¨-----------&gt;Note 4</span>      mScroller<span class="token punctuation">.</span><span class="token function">startScroll</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> mScrollY<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> scrollY<span class="token operator">-</span>mScrollY<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>mScroller <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      mScroller<span class="token punctuation">.</span><span class="token function">abortAnimation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">//èµ‹å€¼ç»™æˆå‘˜å˜é‡</span>    mScrollY <span class="token operator">=</span> scrollY<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> handled<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>Note 1: å¯¹äºä¸Šé¢çš„ Demo æ¥è¯´ï¼Œå½“å‰çš„ç„¦ç‚¹ View å°±æ˜¯ EditTextï¼Œç‚¹å‡»å“ªä¸ª EditTextï¼Œå“ªä¸ªå°±è·å¾—ç„¦ç‚¹ã€‚</li><li>Note 2: å¯¹äºè¾“å…¥æ¡† 2 æ¥è¯´ï¼Œå› ä¸ºé”®ç›˜å¼¹å‡ºä¼šé®ä½å®ƒï¼Œé€šè¿‡è®¡ç®—æ»¡è¶³â€å½“å‰ç„¦ç‚¹ä½ç½®åœ¨çª—å£å¯è§åŒºåŸŸä¹‹ä¸‹ï¼Œè¯´æ˜å…¶åº”è¯¥å¾€ä¸Šç§»åŠ¨åˆ°å¯è§åŒºåŸŸé‡Œè¾¹â€ æ¡ä»¶ï¼Œå› æ­¤ srolly &gt; 0</li><li>Note 3: è€Œå¯¹äºè¾“å…¥æ¡† 1 æ¥è¯´ï¼Œå½“é”®ç›˜å¼¹å‡ºæ—¶ï¼Œå®ƒæ²¡æœ‰è¢«é”®ç›˜é®æŒ¡ï¼Œèµ°åˆ° else åˆ†æ”¯ï¼Œå› æ­¤ scrollY = 0</li><li>Note 4: æ»šåŠ¨æ˜¯å€ŸåŠ© <code>Scoller</code> ç±»å®Œæˆçš„ã€‚</li></ul><p>ä¸Šé¢çš„æ“ä½œå®é™…ä¸Šå°±æ˜¯ä¸ºäº†ç¡®è®¤æ»šåŠ¨å€¼ï¼Œå¹¶è®°å½•åœ¨æˆå‘˜å˜é‡ <code>mScrollY</code> é‡Œï¼Œç»§ç»­æ¥çœ‹å¦‚ä½•ä½¿ç”¨æ»šåŠ¨å€¼å‘¢ï¼Ÿ</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//ViewRootImpl.java</span><span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> fullRedrawNeeded<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">//...</span>  <span class="token keyword">boolean</span> animating <span class="token operator">=</span> mScroller <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> mScroller<span class="token punctuation">.</span><span class="token function">computeScrollOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">final</span> <span class="token keyword">int</span> curScrollY<span class="token punctuation">;</span>  <span class="token comment">//è·å–å½“å‰éœ€è¦æ»šåŠ¨çš„ scroll å€¼</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>animating<span class="token punctuation">)</span> <span class="token punctuation">{</span>    curScrollY <span class="token operator">=</span> mScroller<span class="token punctuation">.</span><span class="token function">getCurrY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    curScrollY <span class="token operator">=</span> mScrollY<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment">//...</span>  <span class="token keyword">int</span> xOffset <span class="token operator">=</span> <span class="token operator">-</span>mCanvasOffsetX<span class="token punctuation">;</span>  <span class="token comment">//è®°å½•åœ¨ yOffset é‡Œ</span>  <span class="token keyword">int</span> yOffset <span class="token operator">=</span> <span class="token operator">-</span>mCanvasOffsetY <span class="token operator">+</span> curScrollY<span class="token punctuation">;</span>  <span class="token keyword">boolean</span> useAsyncReport <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>dirty<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> mIsAnimating <span class="token operator">||</span> accessibilityFocusDirty<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>mAttachInfo<span class="token punctuation">.</span>mThreadedRenderer <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> mAttachInfo<span class="token punctuation">.</span>mThreadedRenderer<span class="token punctuation">.</span><span class="token function">isEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token comment">//...</span>      <span class="token comment">//å¯¹äºèµ°ç¡¬ä»¶åŠ é€Ÿç»˜åˆ¶</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>mHardwareYOffset <span class="token operator">!=</span> yOffset <span class="token operator">||</span> mHardwareXOffset <span class="token operator">!=</span> xOffset<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//è®°å½•åç§»é‡åˆ° mHardwareYOffset é‡Œ</span>        mHardwareYOffset <span class="token operator">=</span> yOffset<span class="token punctuation">;</span>        mHardwareXOffset <span class="token operator">=</span> xOffset<span class="token punctuation">;</span>        invalidateRoot <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token comment">//...</span>      mAttachInfo<span class="token punctuation">.</span>mThreadedRenderer<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span>mView<span class="token punctuation">,</span> mAttachInfo<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>      <span class="token comment">//è½¯ä»¶ç»˜åˆ¶, ä¼ å…¥ yOffset</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">drawSoftware</span><span class="token punctuation">(</span>surface<span class="token punctuation">,</span> mAttachInfo<span class="token punctuation">,</span> xOffset<span class="token punctuation">,</span> yOffset<span class="token punctuation">,</span> scalingRequired<span class="token punctuation">,</span> dirty<span class="token punctuation">,</span> surfaceInsets<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token comment">//...</span>  <span class="token keyword">return</span> useAsyncReport<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ»šåŠ¨å€¼åˆ†åˆ«ä¼ é€’ç»™äº†ç¡¬ä»¶åŠ é€Ÿç»˜åˆ¶åˆ†æ”¯å’Œè½¯ä»¶ç»˜åˆ¶åˆ†æ”¯ï¼Œåœ¨å„è‡ªçš„åˆ†æ”¯é‡Œå¯¹ Canvas è¿›è¡Œå¹³ç§»ã€‚</p><p><strong>å°ç»“</strong></p><blockquote><p>å½“è®¾ç½® SOFT_INPUT_ADJUST_PAN æ—¶ï¼Œå¦‚æœå‘ç°é”®ç›˜é®ä½äº†å½“å‰æœ‰ç„¦ç‚¹çš„ Viewï¼Œé‚£ä¹ˆä¼šå¯¹ RootView (æ­¤å¤„ Demo é‡Œ DecorView ä½œä¸º RootView) çš„ Canvas è¿›è¡Œå¹³ç§»ï¼Œç›´è‡³æœ‰ç„¦ç‚¹çš„ View æ˜¾ç¤ºåˆ°å¯è§åŒºåŸŸä¸ºæ­¢ã€‚æ‰€ä»¥ç‚¹å‡»è¾“å…¥æ¡† 2 çš„æ—¶å€™å¸ƒå±€ä¼šæ•´ä½“å‘ä¸Šç§»åŠ¨ã€‚</p></blockquote><p>åŒæ ·çš„æœ€åç”¨å›¾å±•ç¤ºè¿™ç§ç§»åŠ¨æ•ˆæœï¼š</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/MOu2ZNAwZwMdfb25nt76qmRW3aHYfib3Jq9JWVIwcBIjEUXVLy3MxzianNoneysHbibxB8seS4H01b8Ln1qf2ziaDg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="å›¾ç‰‡"></p><h2 id="SOFT-INPUT-ADJUST-NOTHING"><a href="#SOFT-INPUT-ADJUST-NOTHING" class="headerlink" title="SOFT_INPUT_ADJUST_NOTHING"></a>SOFT_INPUT_ADJUST_NOTHING</h2><p>è½¯é”®ç›˜å¼¹å‡º/å…³é—­æ—¶ï¼Œæ•´ä¸ªå¸ƒå±€ä¸ä¼šå‘ç”Ÿä»»ä½•å˜åŒ–ï¼ˆä¸æ”¾ gif å›¾äº†ï¼‰æ²¡æœ‰äº‹ä»¶å‘å‡ºï¼Œè‡ªç„¶ä¸ä¼šäº§ç”Ÿä»»ä½•æ•ˆæœäº†ã€‚</p><hr><h2 id="SOFT-INPUT-ADJUST-UNSPECIFIED"><a href="#SOFT-INPUT-ADJUST-UNSPECIFIED" class="headerlink" title="SOFT_INPUT_ADJUST_UNSPECIFIED"></a>SOFT_INPUT_ADJUST_UNSPECIFIED</h2><p>é»˜è®¤çš„æ•ˆæœä¸ SOFT_INPUT_ADJUST_PAN ä¸€è‡´ã€‚</p><table><thead><tr><th><img src=" https://blog-1251678165.cos.ap-chengdu.myqcloud.com/uPic/ime-pan-1.gif" class="h-100"></th><th><img src=" https://blog-1251678165.cos.ap-chengdu.myqcloud.com/uPic/ime-pan-2.gif" class="h-100"></th><th><img src=" https://blog-1251678165.cos.ap-chengdu.myqcloud.com/uPic/ime-pan-3.gif" class="h-100"></th></tr></thead></table><p>åœ¨ View é‡Œå¢åŠ  isScrollContainer å±æ€§</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">android:isScrollContainer="true"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é‡æ–°è¿è¡Œåæ•ˆæœå¦‚ä¸‹ï¼š</p><table><thead><tr><th><img src=" https://blog-1251678165.cos.ap-chengdu.myqcloud.com/uPic/ime-resize-1.gif" class="h-100"></th><th><img src=" https://blog-1251678165.cos.ap-chengdu.myqcloud.com/uPic/ime-resize-2.gif" class="h-100"></th><th><img src=" https://blog-1251678165.cos.ap-chengdu.myqcloud.com/uPic/ime-resize-3.gif" class="h-100"></th></tr></thead></table><p>å¯ä»¥çœ‹åˆ° <code>ADJUST_UNSPECIFIED</code> æ¨¡å¼ä¸‹äº§ç”Ÿçš„æ•ˆæœå¯èƒ½ä¸ <code>ADJUST_PAN</code> ç›¸åŒï¼Œ<code>ä¹Ÿå¯èƒ½ä¸ ADJUST_RESIZE</code> ç›¸åŒã€‚</p><p>æ¥ä¸‹æ¥å°±æ¥åˆ†æ <code>é€‰æ‹©çš„æ ‡å‡†</code> æ˜¯ä»€ä¹ˆï¼Ÿ</p><h3 id="åŸç†åˆ†æ-2"><a href="#åŸç†åˆ†æ-2" class="headerlink" title="åŸç†åˆ†æ"></a>åŸç†åˆ†æ</h3><p>ä» <code>ViewRootImpl #performTraversals ()</code> æ–¹æ³•å¼€å§‹åˆ†æï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">performTraversals</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">//...</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>mFirst <span class="token operator">||</span> mAttachInfo<span class="token punctuation">.</span>mViewVisibilityChanged<span class="token punctuation">)</span> <span class="token punctuation">{</span>    mAttachInfo<span class="token punctuation">.</span>mViewVisibilityChanged <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> resizeMode <span class="token operator">=</span> mSoftInputMode <span class="token operator">&amp;</span> <span class="token class-name">WindowManager<span class="token punctuation">.</span>LayoutParams</span><span class="token punctuation">.</span><span class="token constant">SOFT_INPUT_MASK_ADJUST</span><span class="token punctuation">;</span>    <span class="token comment">//å¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œé‚£ä¹ˆé»˜è®¤ä¸º 0ï¼Œå³ SOFT_INPUT_ADJUST_UNSPECIFIED</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>resizeMode <span class="token operator">==</span> <span class="token class-name">WindowManager<span class="token punctuation">.</span>LayoutParams</span><span class="token punctuation">.</span><span class="token constant">SOFT_INPUT_ADJUST_UNSPECIFIED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token comment">//æŸ¥çœ‹ mScrollContainers æ•°ç»„ä¸­çš„å…ƒç´  --&gt; Note 1</span>      <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token class-name">N</span> <span class="token operator">=</span> mAttachInfo<span class="token punctuation">.</span>mScrollContainers<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token class-name">N</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>mAttachInfo<span class="token punctuation">.</span>mScrollContainers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isShown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token comment">//å¦‚æœæœ‰ä¸” ScrollContainer=true åˆ™è®¾ä¸º SOFT_INPUT_ADJUST_RESIZE æ¨¡å¼</span>          resizeMode <span class="token operator">=</span> <span class="token class-name">WindowManager<span class="token punctuation">.</span>LayoutParams</span><span class="token punctuation">.</span><span class="token constant">SOFT_INPUT_ADJUST_RESIZE</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>      <span class="token punctuation">}</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>resizeMode <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//å¦‚æœæ²¡æœ‰è®¾ç½®ä¸º resize æ¨¡å¼ï¼Œåˆ™è®¾ç½® pan æ¨¡å¼</span>        resizeMode <span class="token operator">=</span> <span class="token class-name">WindowManager<span class="token punctuation">.</span>LayoutParams</span><span class="token punctuation">.</span><span class="token constant">SOFT_INPUT_ADJUST_PAN</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>lp<span class="token punctuation">.</span>softInputMode <span class="token operator">&amp;</span> <span class="token class-name">WindowManager<span class="token punctuation">.</span>LayoutParams</span><span class="token punctuation">.</span><span class="token constant">SOFT_INPUT_MASK_ADJUST</span><span class="token punctuation">)</span> <span class="token operator">!=</span> resizeMode<span class="token punctuation">)</span> <span class="token punctuation">{</span>        lp<span class="token punctuation">.</span>softInputMode <span class="token operator">=</span> <span class="token punctuation">(</span>lp<span class="token punctuation">.</span>softInputMode <span class="token operator">&amp;</span> <span class="token operator">~</span><span class="token class-name">WindowManager<span class="token punctuation">.</span>LayoutParams</span><span class="token punctuation">.</span><span class="token constant">SOFT_INPUT_MASK_ADJUST</span><span class="token punctuation">)</span> <span class="token operator">|</span> resizeMode<span class="token punctuation">;</span>        <span class="token comment">//æœ€åèµ‹å€¼ç»™ paramsï¼Œè®© Window å±æ€§ç”Ÿæ•ˆ</span>        params <span class="token operator">=</span> lp<span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token comment">//...</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Note 1: <code>mAttachInfo.mScrollContainers: ArrayList&lt;View&gt;</code> å³å¯æ»šåŠ¨çš„ View listï¼Œä»€ä¹ˆæ—¶å€™æ·»åŠ å…ƒç´ è¿›å»çš„å‘¢ï¼Ÿ</p><p>è°ƒç”¨ View #setScrollContainer æ–¹æ³•æ—¶ä¼šæŠŠ View æ·»åŠ åˆ° <code>mAttachInfo.mScrollContainers</code></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setScrollContainer</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> isScrollContainer<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>isScrollContainer<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>mAttachInfo <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>mPrivateFlags<span class="token operator">&amp;</span><span class="token constant">PFLAG_SCROLL_CONTAINER_ADDED</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      mAttachInfo<span class="token punctuation">.</span>mScrollContainers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; add</span>      mPrivateFlags <span class="token operator">|=</span> <span class="token constant">PFLAG_SCROLL_CONTAINER_ADDED</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    mPrivateFlags <span class="token operator">|=</span> <span class="token constant">PFLAG_SCROLL_CONTAINER</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>mPrivateFlags<span class="token operator">&amp;</span><span class="token constant">PFLAG_SCROLL_CONTAINER_ADDED</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      mAttachInfo<span class="token punctuation">.</span>mScrollContainers<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; remove</span>    <span class="token punctuation">}</span>    mPrivateFlags <span class="token operator">&amp;=</span> <span class="token operator">~</span><span class="token punctuation">(</span><span class="token constant">PFLAG_SCROLL_CONTAINER</span><span class="token operator">|</span><span class="token constant">PFLAG_SCROLL_CONTAINER_ADDED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬å¸¸ç”¨çš„ RecyclerView å°±åœ¨æ„é€ å‡½æ•°é‡Œé»˜è®¤è®¾ç½®äº†è¯¥å€¼ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">RecyclerView</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token class-name">AttributeSet</span> attrs<span class="token punctuation">,</span> <span class="token keyword">int</span> defStyle<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">setScrollContainer</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//...</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰€ä»¥å®¹å™¨å¯ä»¥æ»šåŠ¨çš„è¯ï¼Œé‚£ä¹ˆå®ƒçš„é«˜åº¦å¯ä»¥ä¼¸ç¼©çš„ï¼Œæ—¢ç„¶å¯ä»¥ä¼¸ç¼©ï¼Œé‚£ä¹ˆåˆšå¥½ç¬¦åˆ SOFT_INPUT_ADJUST_RESIZE æ¨¡å¼ï¼Œå› æ­¤æ­¤ç§æƒ…å†µä¸‹ä¼šè®¾ç½®ä¸º SOFT_INPUT_ADJUST_RESIZE æ¨¡å¼ã€‚</p><h2 id="å¦‚ä½•è·å–å¯è§åŒºåŸŸ"><a href="#å¦‚ä½•è·å–å¯è§åŒºåŸŸ" class="headerlink" title="å¦‚ä½•è·å–å¯è§åŒºåŸŸ"></a>å¦‚ä½•è·å–å¯è§åŒºåŸŸ</h2><p>ä»å‰é¢çš„åˆ†æå¯ä»¥çŸ¥é“ï¼šçŠ¶æ€æ ã€å¯¼èˆªæ ã€å±å¹•å¯è§åŒºåŸŸã€å†…å®¹åŒºåŸŸé™å®šè¾¹ç•Œéƒ½æ˜¯å­˜å‚¨åœ¨å¦‚ä¸‹å˜é‡é‡Œï¼š</p><blockquote><p>AttachInfo.mStableInsets çŠ¶æ€æ å¯¼èˆªæ <br>AttachInfo.mContentInsets å†…å®¹åŒºåŸŸé™å®šè¾¹ç•Œ<br>AttachInfo.mVisibleInsets å¯è§åŒºåŸŸé™å®šè¾¹ç•Œ</p></blockquote><p>fixme-èƒ½è·å–åˆ°ä¸Šé¢çš„å€¼ï¼Œä»€ä¹ˆçŠ¶æ€æ ã€å¯¼èˆªæ ã€é”®ç›˜é«˜åº¦è·å–ä¸åœ¨è¯ä¸‹ã€‚å‘ç°è¿™äº›å­—æ®µçš„è®¿é—®æƒé™æ˜¯â€defaultâ€ï¼Œå½“ç„¶ä½ æƒ³åˆ°äº†åå°„ï¼Œæ²¡é”™åå°„æ˜¯å¯ä»¥è·å–è¿™äº›å€¼ï¼Œä½†æ˜¯åœ¨ Android 10.0 ä¹‹åä¸èƒ½åå°„äº†ã€‚</p><p>åå°„è¡Œä¸é€šï¼Œè¿˜å¥½ Android è¿˜å¼€äº†ä¸ªå£å­ï¼šgetWindowVisibleDisplayFrame()</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getWindowVisibleDisplayFrame</span><span class="token punctuation">(</span><span class="token class-name">Rect</span> outRect<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>mAttachInfo <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>      <span class="token comment">//è·å– Window å°ºå¯¸ï¼Œæ³¨æ„æ­¤å¤„çš„å°ºå¯¸æ˜¯åŒ…å«çŠ¶æ€æ ã€å¯¼èˆªæ </span>      <span class="token comment">//ä¸ getWindowManager().getDefaultDisplay().getRealSize()å°ºå¯¸ä¸€è‡´;</span>      mAttachInfo<span class="token punctuation">.</span>mSession<span class="token punctuation">.</span><span class="token function">getDisplayFrame</span><span class="token punctuation">(</span>mAttachInfo<span class="token punctuation">.</span>mWindow<span class="token punctuation">,</span> outRect<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RemoteException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">//...</span>    <span class="token keyword">final</span> <span class="token class-name">Rect</span> insets <span class="token operator">=</span> mAttachInfo<span class="token punctuation">.</span>mVisibleInsets<span class="token punctuation">;</span>    <span class="token comment">//æ‹¿åˆ°å¯è§åŒºåŸŸ(é™å®šè¾¹ç•Œ) è¿ç®—ä¸€ä¸‹ï¼Œå°†å¯è§åŒºåŸŸè®°å½•åœ¨ outRect(ç›¸å¯¹äºå±å¹•)</span>    outRect<span class="token punctuation">.</span>left <span class="token operator">+=</span> insets<span class="token punctuation">.</span>left<span class="token punctuation">;</span>    outRect<span class="token punctuation">.</span>top <span class="token operator">+=</span> insets<span class="token punctuation">.</span>top<span class="token punctuation">;</span>    outRect<span class="token punctuation">.</span>right <span class="token operator">-=</span> insets<span class="token punctuation">.</span>right<span class="token punctuation">;</span>    outRect<span class="token punctuation">.</span>bottom <span class="token operator">-=</span> insets<span class="token punctuation">.</span>bottom<span class="token punctuation">;</span>    <span class="token keyword">return</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment">//...</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‹¿åˆ°çš„ outRect å°±æ˜¯å¯è§åŒºåŸŸçš„ä½ç½®åæ ‡ã€‚</p><p>åˆ°æ­¤æˆ‘ä»¬æ˜ç™½äº†ï¼Œå±å¹•å°ºå¯¸æˆ‘ä»¬æ˜¯çŸ¥é“çš„ï¼ŒoutRect æˆ‘ä»¬ä¹ŸçŸ¥é“äº†ï¼Œåæ¨ mAttachInfo.mVisibleInsets ä¹Ÿå¯ä»¥ç®—å‡ºæ¥äº†ï¼Œè¿™ä¸ªå€¼æœ‰äº†ï¼Œé”®ç›˜é«˜åº¦ä¹Ÿå°±æœ‰äº†ã€‚æ›²çº¿æ•‘å›½ä¹‹è·¯è‡³æ­¤å®Œæˆäº†ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ <code>getWindowVisibleDisplayFrame()</code> çš„è®¡ç®—ä¾èµ–äº mAttachInfo.mVisibleInsetsï¼Œè€Œ <code>mAttachInfo.mVisibleInsets</code> å€¼å‘ç”Ÿå˜åŒ–çš„æ¡ä»¶æ˜¯è®¾ç½®äº† <code>SOFT_INPUT_ADJUST_RESIZE</code> or <code>SOFT_INPUT_ADJUST_PAN</code> æ¨¡å¼ã€‚</p><h2 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h2><p>é€šè¿‡å‰é¢çš„ç¤ºä¾‹å¯ä»¥çœ‹å‡º adjustPan ä½“éªŒä¸å¤ªå‹å¥½ï¼ŒadjustResize åœ¨æŸäº›æƒ…å†µä¸‹åˆä¼šå¤±æ•ˆï¼Œä¸”ä¸èƒ½å®Œå…¨æ»¡è¶³éœ€æ±‚ã€‚</p><p>adjustPan å’Œ adjustResize éƒ½æ— æ³•è¾¾åˆ°æˆ‘ä»¬çš„é«˜è¦æ±‚å’Œå…¼å®¹æ€§ï¼Œæ­£å¦‚é—®é¢˜æ‰€è¯´çš„ï¼Œå®ƒä»¬å­˜åœ¨å„ç§é—®é¢˜ã€‚</p><p>è€Œåœ¨ adjustNothing æ¨¡å¼ä¸‹ï¼Œè½¯é”®ç›˜å¼¹å‡ºæ—¶ï¼Œé¡µé¢æ˜¯å®Œå…¨ä¸åä¸ç§»çš„ï¼Œæˆ‘ä»¬åªè¦èƒ½åœ¨è¿™ç§æ¨¡å¼ä¸‹ç›‘å¬åˆ°è½¯é”®ç›˜å¼¹å‡ºã€æ”¶èµ·äº‹ä»¶å’Œé«˜åº¦ï¼Œå°±èƒ½è‡ªè¡Œæ§åˆ¶é¡µé¢çš„å†…å®¹åç§»æˆ–è€… resizeã€‚é‚£ä¹ˆæ€ä¹ˆæ‰èƒ½ç›‘å¬åˆ°å¼¹å‡ºã€æ”¶èµ·ç”šè‡³å¾—åˆ°å‡†ç¡®é«˜åº¦ï¼Ÿ</p><p>å¦‚æœæƒ³åšåˆ°å®Œå…¨å¯ç©ºï¼Œé‚£ä¹ˆåªæœ‰ adjustNothing å¯é€‰æ‹©ï¼Œ</p><p>adjustNothing æ˜¯ä¸€ä¸ªå¯æ€•çš„æ¨¡å¼ï¼Œå®ƒçš„æ„æ€æ˜¯ï¼Œå½“é”®ç›˜å¼¹å‡ºæ—¶ï¼ŒActivity ä¸åšä»»ä½•å˜å½¢ã€åç§»å“åº”ã€‚ </p><p>é‚£ä¹ˆåœ¨ adjustNothing æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬å¦‚ä½•æ¥ç®¡è½¯é”®ç›˜é€»è¾‘ï¼Ÿæˆ‘ä»¬ä¸ºä»€ä¹ˆè¦é€‰æ‹© adjustNothingï¼Ÿ </p><p>çº¯çº¯å†™ä½œé‡‡ç”¨çš„æ–¹å¼æ˜¯ï¼šåœ¨ Activity å±‚ä¸ŠåŠ å…¥ä¸€å±‚å®Œå…¨çœ‹ä¸è§çš„ Windowï¼Œç”±è¿™ä¸ª Window æ¥ç›‘å¬é”®ç›˜å˜åŒ–ï¼Œæ¯ä¸€ä¸ª Window éƒ½å¯ä»¥è®¾ç½® softInputModeï¼Œå› æ­¤å®ƒå¯ä»¥å•ç‹¬è®¾ç½®ä¸º adjustResizeï¼Œè¿™æ ·å½“è¿™ä¸ª Window æœ¬èº«è¢«æŒ¤å‹æ—¶ï¼Œæˆ‘ä»¬å°±èƒ½åˆ¤æ–­å’Œè®¡ç®—å‡ºé”®ç›˜çš„çŠ¶æ€äº†ï¼Œè¿›è€Œå†é€šçŸ¥åˆ°ç¼–è¾‘å™¨ Activityã€‚</p><h3 id="å¼¹å‡º-å…³é—­"><a href="#å¼¹å‡º-å…³é—­" class="headerlink" title="å¼¹å‡º/å…³é—­"></a>å¼¹å‡º/å…³é—­</h3><h3 id="åˆ¤æ–­æ˜¯å¦å±•ç¤º"><a href="#åˆ¤æ–­æ˜¯å¦å±•ç¤º" class="headerlink" title="åˆ¤æ–­æ˜¯å¦å±•ç¤º"></a>åˆ¤æ–­æ˜¯å¦å±•ç¤º</h3><h2 id="ä¼˜åŒ–è¡¥å……"><a href="#ä¼˜åŒ–è¡¥å……" class="headerlink" title="ä¼˜åŒ–è¡¥å……"></a>ä¼˜åŒ–è¡¥å……</h2><p>ç°å¦‚æœç”¨æˆ·ä½¿ç”¨ FooView æµ®çª—ç»„ä»¶ï¼Œåœ¨ Android 9.0 ä¹‹ä¸Šå°†ç›‘å¬ä¸åˆ°é”®ç›˜çŠ¶æ€ã€‚è¿™æ˜¯ä¸ªå‘ - å¯ä»¥é€šè¿‡æä¾› Window type è§£å†³</p><!--è¿™ä¸ªæ–¹æ³•æ›¾ç»ä¸€åº¦å®Œå…¨å¤±æ•ˆï¼Œæ˜¯åœ¨ Android 9 å¼€å‘è€…é¢„è§ˆç‰ˆçš„æ—¶å€™ï¼ŒDrakeet å‘ç°äº†ç›¸å…³é—®é¢˜ï¼Œå¹¶ä¸”å‘è°·æ­Œåé¦ˆï¼Œè°·æ­Œç«‹é©¬ä¿®å¤äº†å®ƒ--><h2 id="WindowInsets-Api"><a href="#WindowInsets-Api" class="headerlink" title="WindowInsets Api"></a>WindowInsets Api</h2><p>Android 11 çš„ä¸€äº› Window Insets ç›¸å…³å†…å®¹æä¾›äº†å‘ä¸‹å…¼å®¹ï¼š é™„å›¾æ˜¯ Chris Banes æä¾›çš„ç¤ºä¾‹ï¼Œä»å›¾ä¸­å¯è§ï¼Œä¹‹åæˆ‘ä»¬å°†ä¸å†éœ€è¦è°ƒç”¨ä¸€å †çš„ flags å’Œ setSystemUiVisibility(int) äº†ï¼Œæ–°çš„æ¥å£ setDecorFitsSystemWindows èƒ½å¤Ÿæ›´æ–¹ä¾¿çš„é…ç½® DoctorView æ˜¯å¦ fitï¼Œè¿™åº”è¯¥å½±å“çŠ¶æ€æ å’Œå¯¼èˆªæ åŒºåŸŸ UI çš„å»¶ä¼¸ã€‚<br>å¦å¤–ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ ViewCompat.getRootWindowInsets(view) æ¥å¿«æ·è·å– root insets äº†ï¼Œè€Œä¸”ï¼Œime è½¯é”®ç›˜ insets API ä¹Ÿèƒ½åŒæ—¶è·å¾—å…¼å®¹ï¼Œç»ˆäºï¼Œåˆ° Android 11 æ—¶ä»£ï¼Œæˆ‘ä»¬ç»ˆäºå¯ä»¥æ–¹ä¾¿åœ°è·å–é”®ç›˜é«˜åº¦äº†ï¼Ÿï¼<br>æ‹­ç›®ä»¥å¾…ã€‚ğŸŒš é™„ï¼šè¿™æ˜¯è¯¥ PR çš„æè¿°ï¼š </p><ul><li><p>Backport WindowInsetsCompat.getInsets(), getInsetsIgnoringVisibility and isVisible() APIs. </p></li><li><p>Works with both adjustResize and adjustPan </p></li><li><p>Backport WindowInsetsCompat.Builder APIs. </p></li><li><p>Also backports WindowCompat.setDecorFitsSystemWindows().</p></li><li><p>æ”¯æŒ WindowInsetsCompat.getInsets()ã€getInsetsIgnoringVisibility å’Œ isVisible()APIã€‚</p></li><li><p>ä¸ adjustResize å’Œ adjustPan ä¸€èµ·å·¥ä½œã€‚</p></li><li><p>å›ä¼  WindowInsetsCompat.Builder APIsã€‚</p></li><li><p>åŒæ—¶å¤‡ä»½ WindowCompat.setDecorFitsSystemWindows()ã€‚</p></li></ul><p><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/uPic/H4cOzP.jpg" alt="H4cOzP"></p><h3 id="setWindowInsetsAnimationCallback"><a href="#setWindowInsetsAnimationCallback" class="headerlink" title="setWindowInsetsAnimationCallback"></a>setWindowInsetsAnimationCallback</h3><p>onPrepare -&gt; onStart-&gt; onProgressâ€¦ -&gt; onEnd</p><p>å¼¹å‡ºè½¯é”®ç›˜è¿‡ç¨‹ä¸­ imeVisible çŠ¶æ€<br>onPrepare: false<br>onStart: true<br>onProgress: false -&gt; false -&gt; trueâ€¦ -&gt; true<br>onEnd: true</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">15</span>:16:46.726 D/SoftKeyboardWatcher: onPrepare: <span class="token assign-left variable">imeVisible</span><span class="token operator">=</span>false, <span class="token assign-left variable">imeHeight</span><span class="token operator">=</span><span class="token number">0</span>, <span class="token assign-left variable">navigationBarsHeight</span><span class="token operator">=</span><span class="token number">48</span>  <span class="token number">15</span>:16:46.744 D/SoftKeyboardWatcher: onStart: <span class="token assign-left variable">imeVisible</span><span class="token operator">=</span>true, <span class="token assign-left variable">imeHeight</span><span class="token operator">=</span><span class="token number">962</span>, <span class="token assign-left variable">navigationBarsHeight</span><span class="token operator">=</span><span class="token number">48</span>  <span class="token number">15</span>:16:46.747 D/SoftKeyboardWatcher: onProgress: <span class="token assign-left variable">imeVisible</span><span class="token operator">=</span>false, <span class="token assign-left variable">imeHeight</span><span class="token operator">=</span><span class="token number">0</span>, <span class="token assign-left variable">navigationBarsHeight</span><span class="token operator">=</span><span class="token number">48</span>  <span class="token number">15</span>:16:46.760 D/SoftKeyboardWatcher: onProgress: <span class="token assign-left variable">imeVisible</span><span class="token operator">=</span>false, <span class="token assign-left variable">imeHeight</span><span class="token operator">=</span><span class="token number">0</span>, <span class="token assign-left variable">navigationBarsHeight</span><span class="token operator">=</span><span class="token number">48</span>  <span class="token number">15</span>:16:46.764 D/SoftKeyboardWatcher: onProgress: <span class="token assign-left variable">imeVisible</span><span class="token operator">=</span>true, <span class="token assign-left variable">imeHeight</span><span class="token operator">=</span><span class="token number">14</span>, <span class="token assign-left variable">navigationBarsHeight</span><span class="token operator">=</span><span class="token number">48</span>  <span class="token number">15</span>:16:46.779 D/SoftKeyboardWatcher: onProgress: <span class="token assign-left variable">imeVisible</span><span class="token operator">=</span>true, <span class="token assign-left variable">imeHeight</span><span class="token operator">=</span><span class="token number">79</span>, <span class="token assign-left variable">navigationBarsHeight</span><span class="token operator">=</span><span class="token number">48</span>  <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">15</span>:16:47.154 D/SoftKeyboardWatcher: onProgress: <span class="token assign-left variable">imeVisible</span><span class="token operator">=</span>true, <span class="token assign-left variable">imeHeight</span><span class="token operator">=</span><span class="token number">960</span>, <span class="token assign-left variable">navigationBarsHeight</span><span class="token operator">=</span><span class="token number">48</span>  <span class="token number">15</span>:16:47.171 D/SoftKeyboardWatcher: onProgress: <span class="token assign-left variable">imeVisible</span><span class="token operator">=</span>true, <span class="token assign-left variable">imeHeight</span><span class="token operator">=</span><span class="token number">961</span>, <span class="token assign-left variable">navigationBarsHeight</span><span class="token operator">=</span><span class="token number">48</span>  <span class="token number">15</span>:16:47.187 D/SoftKeyboardWatcher: onProgress: <span class="token assign-left variable">imeVisible</span><span class="token operator">=</span>true, <span class="token assign-left variable">imeHeight</span><span class="token operator">=</span><span class="token number">962</span>, <span class="token assign-left variable">navigationBarsHeight</span><span class="token operator">=</span><span class="token number">48</span>  <span class="token number">15</span>:16:47.188 D/SoftKeyboardWatcher: onEnd: <span class="token assign-left variable">imeVisible</span><span class="token operator">=</span>true, <span class="token assign-left variable">imeHeight</span><span class="token operator">=</span><span class="token number">962</span>, <span class="token assign-left variable">navigationBarsHeight</span><span class="token operator">=</span><span class="token number">48</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ”¶èµ·è½¯é”®ç›˜è¿‡ç¨‹ä¸­ imeVisible çŠ¶æ€<br>onPrepare: true<br>onStart: false<br>onProgress: true -&gt; trueâ€¦ -&gt; false<br>onEnd: false</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">15</span>:19:39.994 D/SoftKeyboardWatcher: onPrepare: <span class="token assign-left variable">imeVisible</span><span class="token operator">=</span>true, <span class="token assign-left variable">imeHeight</span><span class="token operator">=</span><span class="token number">962</span>, <span class="token assign-left variable">navigationBarsHeight</span><span class="token operator">=</span><span class="token number">48</span>  <span class="token number">15</span>:19:40.026 D/SoftKeyboardWatcher: onStart: <span class="token assign-left variable">imeVisible</span><span class="token operator">=</span>false, <span class="token assign-left variable">imeHeight</span><span class="token operator">=</span><span class="token number">0</span>, <span class="token assign-left variable">navigationBarsHeight</span><span class="token operator">=</span><span class="token number">48</span>  <span class="token number">15</span>:19:40.028 D/SoftKeyboardWatcher: onProgress: <span class="token assign-left variable">imeVisible</span><span class="token operator">=</span>true, <span class="token assign-left variable">imeHeight</span><span class="token operator">=</span><span class="token number">962</span>, <span class="token assign-left variable">navigationBarsHeight</span><span class="token operator">=</span><span class="token number">48</span>  <span class="token number">15</span>:19:40.045 D/SoftKeyboardWatcher: onProgress: <span class="token assign-left variable">imeVisible</span><span class="token operator">=</span>true, <span class="token assign-left variable">imeHeight</span><span class="token operator">=</span><span class="token number">962</span>, <span class="token assign-left variable">navigationBarsHeight</span><span class="token operator">=</span><span class="token number">48</span>  <span class="token number">15</span>:19:40.060 D/SoftKeyboardWatcher: onProgress: <span class="token assign-left variable">imeVisible</span><span class="token operator">=</span>true, <span class="token assign-left variable">imeHeight</span><span class="token operator">=</span><span class="token number">947</span>, <span class="token assign-left variable">navigationBarsHeight</span><span class="token operator">=</span><span class="token number">48</span>  <span class="token number">15</span>:19:40.077 D/SoftKeyboardWatcher: onProgress: <span class="token assign-left variable">imeVisible</span><span class="token operator">=</span>true, <span class="token assign-left variable">imeHeight</span><span class="token operator">=</span><span class="token number">882</span>, <span class="token assign-left variable">navigationBarsHeight</span><span class="token operator">=</span><span class="token number">48</span>  <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">15</span>:19:40.439 D/SoftKeyboardWatcher: onProgress: <span class="token assign-left variable">imeVisible</span><span class="token operator">=</span>true, <span class="token assign-left variable">imeHeight</span><span class="token operator">=</span><span class="token number">2</span>, <span class="token assign-left variable">navigationBarsHeight</span><span class="token operator">=</span><span class="token number">48</span>  <span class="token number">15</span>:19:40.456 D/SoftKeyboardWatcher: onProgress: <span class="token assign-left variable">imeVisible</span><span class="token operator">=</span>true, <span class="token assign-left variable">imeHeight</span><span class="token operator">=</span><span class="token number">1</span>, <span class="token assign-left variable">navigationBarsHeight</span><span class="token operator">=</span><span class="token number">48</span>  <span class="token number">15</span>:19:40.478 D/SoftKeyboardWatcher: onProgress: <span class="token assign-left variable">imeVisible</span><span class="token operator">=</span>false, <span class="token assign-left variable">imeHeight</span><span class="token operator">=</span><span class="token number">0</span>, <span class="token assign-left variable">navigationBarsHeight</span><span class="token operator">=</span><span class="token number">48</span>  <span class="token number">15</span>:19:40.479 D/SoftKeyboardWatcher: onEnd: <span class="token assign-left variable">imeVisible</span><span class="token operator">=</span>false, <span class="token assign-left variable">imeHeight</span><span class="token operator">=</span><span class="token number">0</span>, <span class="token assign-left variable">navigationBarsHeight</span><span class="token operator">=</span><span class="token number">48</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é”™è¯¯çº æ­£"><a href="#é”™è¯¯çº æ­£" class="headerlink" title="é”™è¯¯çº æ­£"></a>é”™è¯¯çº æ­£</h2><p><del>å¯ä»¥çœ‹å‡ºï¼ŒEditText éšç€é”®ç›˜é¡¶ä¸Šå»äº†ï¼ŒImageView éšç€é”®ç›˜é¡¶ä¸Šå»äº†ã€‚</del></p><p>ï¼ˆå®é™…ä¸Šä»¥ä¸Šå¸ƒå±€ä»…ä»…æ˜¯æ‰©å¤§äº† ImageView å±•ç¤ºèŒƒå›´ - è¡¨è¿°æœ‰è¯¯ï¼Œå¹¶ä¸æ˜¯å•çº¯æ‰©å¤§èŒƒå›´ï¼Œè€Œæ˜¯è®© ImageView å’Œ EditText å æ»¡çˆ¶æ§ä»¶ï¼‰</p><h2 id="Links"><a href="#Links" class="headerlink" title="Links"></a>Links</h2><p><a href="https://juejin.cn/post/7064175843840360462"># Android ç›‘å¬è½¯é”®ç›˜çš„é«˜åº¦å¹¶è§£å†³å…¶è¦†ç›–è¾“å…¥æ¡†çš„é—®é¢˜</a><br><a href="https://juejin.im/post/5ef850c9f265da231019f6e4"># è¿™äº¤äº’ç‚¸äº†ç³»åˆ—ï¼š ä»¿å¾®ä¿¡é”®ç›˜å¼¹å‡ºä½“éªŒ</a><br><a href="https://mp.weixin.qq.com/s/6VJALLA1bAFSujkZkdSNVQ"># Android è½¯é”®ç›˜çš„é‚£äº›å‘ï¼ŒåŸç†ç¯‡æ¥äº†ï¼</a><br><a href="https://mp.weixin.qq.com/s?__biz=MzAxMTI4MTkwNQ==&amp;mid=2650835965&amp;idx=1&amp;sn=94d8776faa38a0c0f7a90e7951c11303"># Android è½¯é”®ç›˜çš„é‚£äº›å‘ï¼Œä¸€æ‹›æå®šï¼</a><br><a href="https://github.com/liangjingkanji/soft-input-event">liangjingkanji/soft-input-event</a><br><a href="https://github.com/android/user-interface-samples/tree/main/WindowInsetsAnimation">android/user-interface-samples/WindowInsetsAnimation</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> WindowInsets </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android WindowInsets åˆ†æå’Œæœ€ä½³å®è·µ</title>
      <link href="/20220325/android-windowinsets/"/>
      <url>/20220325/android-windowinsets/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä»€ä¹ˆæ˜¯-Insets"><a href="#ä»€ä¹ˆæ˜¯-Insets" class="headerlink" title="ä»€ä¹ˆæ˜¯ Insets"></a>ä»€ä¹ˆæ˜¯ Insets</h2><p>å±å¹•ä¸Šé™¤äº†å¼€å‘è€… app ç»˜åˆ¶çš„å†…å®¹è¿˜æœ‰ç³»ç»Ÿçš„ Insetsï¼ˆæ’å…¥ç‰©ï¼‰ï¼ŒInsets åŒºåŸŸè´Ÿè´£æè¿°å±å¹•çš„å“ªäº›éƒ¨åˆ†ä¼šä¸ç³»ç»Ÿ UI ç›¸äº¤ã€‚å¦‚ <code>Starus bar</code> æˆ– <code>Navigation bar</code>ï¼š<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/hGnYQS.jpg"></p><blockquote><p>å¸¸è§çš„ Insets æœ‰ï¼š</p><ul><li>  <code>STATUS_BAR</code>ï¼Œç”¨äºå±•ç¤ºç³»ç»Ÿæ—¶é—´ï¼Œç”µé‡ï¼Œwifi ç­‰ä¿¡æ¯</li><li>  <code>NAVIGATION_BAR</code>ï¼Œè™šæ‹Ÿå¯¼èˆªæ ï¼ˆåŒºåˆ«äºå®ä½“çš„ä¸‰å¤§é‡‘åˆšé”®ï¼‰ï¼Œå½¢æ€æœ‰ä¸‰å¤§é‡‘åˆšé”®å¯¼èˆªï¼Œæ‰‹åŠ¿å¯¼èˆªä¸¤ç§ã€‚ï¼ˆæœ‰äº›è®¾å¤‡å½¢æ€å¦‚ TV æ²¡æœ‰å¯¼èˆªæ ï¼‰</li><li>  <code>IME</code>ï¼Œè½¯é”®ç›˜ï¼Œç”¨äºè¾“å…¥æ–‡å­—</li></ul></blockquote><p>å…¶ä¸­ <code>STATUS_BAR</code> ä¸ <code>NAVIGATION_BAR</code> åˆè¢«ç§°ä¸º <code>System bar</code>ã€‚</p><p><strong>å¦‚æœå¼€å‘è€…ç»˜åˆ¶çš„å†…å®¹å‡ºç°åœ¨äº†ç³»ç»Ÿ UI åŒºåŸŸå†…ï¼Œå°±å¯èƒ½å‡ºç°è§†è§‰ä¸æ‰‹åŠ¿çš„å†²çªã€‚å¼€å‘è€…å¯ä»¥å€ŸåŠ© Insets æŠŠ view ä»å±å¹•è¾¹ç¼˜å‘å†…ç§»åŠ¨åˆ°ä¸€ä¸ªåˆé€‚çš„ä½ç½®ã€‚</strong></p><p>åœ¨æºç ä¸­ï¼ŒInsets å¯¹è±¡æ‹¥æœ‰ 4 ä¸ª int å€¼ï¼Œç”¨äºæè¿°çŸ©å½¢å››ä¸ªè¾¹çš„åç§»ï¼š<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/QAWAQc.jpg" alt="QAWAQc"></p><blockquote><p>ğŸ“¢ æ³¨æ„ï¼šä¸è¦æŠŠ Insets çš„ <code>top</code> ï¼Œ<code>bottom</code>ï¼Œ<code>left</code>ï¼Œ<code>right</code> ä¸ Rect çš„ææ··ï¼Œå‰è€…æè¿°çš„æ˜¯<strong>åç§»</strong>ï¼Œåè€…æ˜¯<strong>åæ ‡</strong>ã€‚</p></blockquote><p>å…³äº Insets æ›´è¯¦å°½çš„ä¿¡æ¯ï¼Œå¯ä»¥ <a href="https://juejin.cn/post/6844904006343458830" title="https://juejin.cn/post/6844904006343458830">æŸ¥çœ‹è¿™ç¯‡æ–‡ç« </a>ã€‚</p><h2 id="setSystemUiVisibility-ä¸-WTFs"><a href="#setSystemUiVisibility-ä¸-WTFs" class="headerlink" title="setSystemUiVisibility ä¸ WTFs"></a>setSystemUiVisibility ä¸ WTFs</h2><p>View çš„æºç ä¸­æœ‰ä¸€ä¸ª <code>setSystemUiVisibility()</code> çš„æ–¹æ³•ï¼Œè™½ç„¶<strong>è¯¥æ–¹æ³•åœ¨ Android 11 å·²è¢«å¼ƒç”¨</strong>ï¼Œä½†æŒ‰ç…§æœ¬ä¸“æ çš„ä¸€è´¯é£æ ¼ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦æ¥ä»‹ç»ä¸€ä¸‹è¯¥æ–¹æ³•ã€‚</p><p>æœ‰äº›åœºæ™¯å¼€å‘è€…å¯èƒ½å¸Œæœ› app çš„å†…å®¹å¯ä»¥ç»˜åˆ¶åˆ°çŠ¶æ€æ æˆ–å¯¼èˆªæ çš„åŒºåŸŸä»¥æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œå› æ­¤ç³»ç»Ÿæä¾›äº† <code>setSystemUiVisibility</code> æ–¹æ³•ï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡å‘è¯¥æ–¹æ³•ä¼ å…¥ä¸åŒçš„ flag ä»¥åº”å¯¹ä¸åŒçš„ä½¿ç”¨åœºæ™¯ã€‚</p><p>è¿™äº› flag è¢«ç§°ä¸º <code>Window Transform Flags</code>ï¼Œç®€ç§° WTFsï¼ˆæ»‘ç¨½è„¸ğŸ˜ï¼‰ï¼ŒåŒæ ·çš„ï¼Œå®ƒä»¬åœ¨ Android 11 ä¸­è¢«å¼ƒç”¨ã€‚å¸¸ç”¨çš„ flag å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">SYSTEM_UI_FLAG_VISIBLESYSTEM_UI_FLAG_LOW_PROFILESYSTEM_UI_FLAG_HIDEN_NAVIGATIONSYSTEM_UI_FLAG_FULLSCREENSYSTEM_UI_FLAG_IMMERSIVE_STICKYSYSTEM_UI_FLAG_IMMERSIVESYSTEM_UI_FLAG_LIGHT_STATUS_BARSYSTEM_UI_FLAG_LIGHT_NAVIGATION_BARSYSTEM_UI_FLAG_LAYOUT_STABLESYSTEM_UI_FLAG_LAYOUT_HIDEN_NAVIGATIONSYSTEM_UI_FLAG_LAYOUT_FULLSCREEN<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœæƒ³äº†è§£è¿™äº› flag çš„æ•ˆæœå¯ä»¥å‚è€ƒ <a href="https://blog.csdn.net/QQxiaoqiang1573/article/details/79867127"># Android setSystemUiVisibilityè¯¦è§£</a>ã€‚</p><h2 id="System-bar-èƒ½åŠ›å˜åŒ–å²"><a href="#System-bar-èƒ½åŠ›å˜åŒ–å²" class="headerlink" title="System bar èƒ½åŠ›å˜åŒ–å²"></a>System bar èƒ½åŠ›å˜åŒ–å²</h2><h3 id="Android-4-4-ä¹‹å‰"><a href="#Android-4-4-ä¹‹å‰" class="headerlink" title="Android 4.4 ä¹‹å‰"></a>Android 4.4 ä¹‹å‰</h3><p>ç”¨æˆ·å†…å®¹æ˜¾ç¤ºåœ¨ <code>System bar</code> ä¹‹é—´ï¼Œå³ä¸‹å›¾çº¢æ¡†æ‰€åœ¨åŒºåŸŸï¼š<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/2cq336.jpg" alt="2cq336"></p><p>å¼€å‘è€…å¯ä»¥ä½¿ç”¨ <code>setSystemUiVisibility</code> æ–¹æ³•å°†å†…å®¹ç»˜åˆ¶åˆ°çŠ¶æ€æ åé¢ï¼Œä¸‹å›¾çº¢æ¡†åŒºåŸŸï¼š<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/voT6SW.jpg" alt="voT6SW"></p><h3 id="Android-4-4"><a href="#Android-4-4" class="headerlink" title="Android 4.4"></a>Android 4.4</h3><p>Android 4.4 å¼•å…¥äº† <code>android:windowTranslucentStatus</code> å’Œ <code>android:windowTranslucentNavigation</code> ï¼Œå…è®¸å¼€å‘è€…å°† <code>System bar</code> è®¾ç½®æˆé€æ˜ï¼š<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/65mvhq.jpg" alt="65mvhq"></p><blockquote><p><code>System bar</code> background æ˜¯ç”± WindowManager ç»˜åˆ¶çš„ï¼ˆåˆ©ç”¨ Window çš„ flagï¼‰</p></blockquote><h3 id="Android-5-0"><a href="#Android-5-0" class="headerlink" title="Android 5.0"></a>Android 5.0</h3><p>ä¹‹å‰ç‰ˆæœ¬ <code>System bar</code> éƒ½æ˜¯ç”± WindowManager ç»˜åˆ¶çš„ï¼Œåœ¨ Android 5.0ï¼Œå¼•å…¥äº† <code>android:windowDrawsSystemBarBackgrounds</code>ï¼Œå½“ <code>windowDrawsSystemBarBackgrounds</code> ä¸º trueï¼ˆé»˜è®¤å€¼ï¼‰ æ—¶ï¼Œ<code>System bar</code> çš„ background åœ¨ Window å†…éƒ¨ã€‚å¦‚ä¸‹å›¾ï¼š<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/7tQy0G.jpg" alt="7tQy0G"></p><p>å¼€å‘è€…å¯ä»¥è°ƒç”¨ Window çš„æ–¹æ³•ä¸º <code>System bar</code> è®¾ç½®é¢œè‰²ï¼š<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/vFsSjI.jpg" alt="vFsSjI"><br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/tpnKKz.jpg" alt="tpnKKz"></p><blockquote><p>ğŸ“¢<strong>æ³¨æ„</strong>ï¼š<code>windowTranslucentStatus</code> å’Œ <code>windowTranslucentNavigation</code> <strong>è¦æ¯”ä¸º <code>System bar</code> è®¾ç½®è‡ªå®šä¹‰é¢œè‰²çš„ä¼˜å…ˆçº§æ›´é«˜</strong>ã€‚</p><p>å½“ <code>windowTranslucentStatus</code> æˆ– <code>windowTranslucentNavigation</code> è®¾ç½®ä¸º true åä¼šå¯¼è‡´ <code>windowDrawsSystemBarBackgrounds</code> ä¸º <strong>false</strong>ï¼Œ<code>System bar</code> background ç”± WindowManager æ¥ç®¡ã€‚</p></blockquote><p>è‡ª Android 5.0 åï¼Œå½“ <code>windowDrawsSystemBarBackgrounds</code> ä¸º true æ—¶ï¼Œ<code>System bar</code> ä½œä¸º window çš„ä¸€éƒ¨åˆ†ã€‚æ¢è¨€ä¹‹ï¼ŒDecorViewï¼ˆFrameLayout å­ç±»ï¼‰æœ‰<strong>ä¸‰ä¸ª</strong>å­ Viewï¼šæ˜¾ç¤º App å†…å®¹çš„ LinearLayout ä»¥åŠ <code>Status bar</code> å’Œ <code>Navigation bar</code>ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒApp çš„å†…å®¹æ˜¾ç¤ºåœ¨ <code>System bar</code> ä¸­é—´ã€‚</p><p>ç†è®ºä¸Šï¼Œæ˜¾ç¤º App å†…å®¹çš„ LinearLayout åº”è¯¥å……æ»¡å±å¹•ï¼Œ<strong>ç³»ç»Ÿä½¿ç”¨äº† paddingTop å’Œ marginBottom ä¸º <code>System bar</code> é¢„ç•™å‡ºäº†ç©ºé—´</strong>ã€‚<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/1WZMbK.jpg" alt="1WZMbK"></p><p>é‚£ä¹ˆ App çš„å†…å®¹åŒºåŸŸæ˜¯å¦‚ä½•ç»˜åˆ¶åˆ° <code>System bar</code> åé¢çš„ï¼Ÿå¾ˆç®€å•ï¼Œ<strong>LinearLayout æ²¡æœ‰ padding å’Œ marginï¼ˆæˆ‘ä»¬åœ¨åæ–‡ä»‹ç»åŸç†ï¼‰</strong>ï¼Œå……æ»¡å±å¹•ï¼š<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/0zX8PF.jpg" alt="0zX8PF"></p><h3 id="Android-10"><a href="#Android-10" class="headerlink" title="Android 10"></a>Android 10</h3><p>éšç€å…¨é¢å±è®¾å¤‡çš„æ™®åŠï¼Œè¶Šæ¥è¶Šå¤šçš„ Android è®¾å¤‡çªç ´äº† 16:9 çš„é™åˆ¶ï¼ŒAndroid 10 æ¨å‡ºäº†æ–°çš„å¯¼èˆªæ¨¡å¼ï¼šæ‰‹åŠ¿å¯¼èˆªã€‚<br><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/551e6750903b4e309fdd9c1558fc3322~tplv-k3u1fbpfcp-watermark.awebp"></p><p>æ–°çš„æ‰‹åŠ¿å¯¼èˆªä¸åŸæ¥çš„ä¸‰å¤§é‡‘åˆšé”®çš„ <code>Navigation bar</code> ä¸€æ ·ï¼Œåªä¸è¿‡é«˜åº¦å˜å°äº†ã€‚<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/HpzE2F.jpg" alt="HpzE2F"></p><p>å¦‚æœ <code>Navigation bar</code> æ˜¯é€æ˜çš„ï¼Œåº•éƒ¨çš„ã€Œå°ç™½æ¡ã€æ˜¯å¯ä»¥è·ŸéšèƒŒæ™¯åŠ¨æ€æ”¹å˜é¢œè‰²çš„ï¼ˆä¸ iOS ä¸€æ ·ï¼Œä¸çŸ¥é“è°æŠ„çš„è°ğŸ¤£ï¼‰<br><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c883a2db5a174d29888773b53506318d~tplv-k3u1fbpfcp-watermark.awebp"></p><h3 id="Android-11"><a href="#Android-11" class="headerlink" title="Android 11"></a>Android 11</h3><p>Android 11 å¼•å…¥äº† <code>WindowInsetsAnimation</code> å…è®¸ç›‘å¬ Insets çš„å˜åŒ–è¿›åº¦ï¼Œä½¿ç”¨æˆ·ä½“éªŒæ›´åŠ ä¸æ»‘ã€‚<br><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/541f8f3b1c1f486d9015214ff9bc53c7~tplv-k3u1fbpfcp-watermark.awebp"></p><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>ä¸ºäº†æ–¹ä¾¿å¼€å‘è€…æ›´åˆç†åœ°ä½¿ç”¨è®¾å¤‡å±å¹•ç»˜åˆ¶å†…å®¹ï¼ŒAndroid åœ¨å†ä»£ç‰ˆæœ¬ä¸æ–­è¿­ä»£ <code>System bar</code> æ§åˆ¶çš„ APIï¼ŒåŠŸèƒ½è¶Šæ¥è¶Šå®Œå–„ã€‚</p><p>å½“å¼€å‘è€…å°† App å†…å®¹ç»˜åˆ¶åˆ° <code>System bar</code> åé¢æ—¶è¦è€ƒè™‘è§†è§‰å†²çªå’Œæ‰‹åŠ¿å†²çªã€‚</p><p>ä¸ºäº†é˜²æ­¢ App å†…å®¹åŒºåŸŸä¸ <code>System bar</code> å‘ç”Ÿè§†è§‰å†²çªï¼Œå®˜æ–¹æä¾›äº†ä¸¤ç§ APIï¼Œ <code>WidowInsets</code> ä¸ <code>fitsSystemWindows</code> ã€‚</p><h2 id="WindowInsets"><a href="#WindowInsets" class="headerlink" title="WindowInsets"></a>WindowInsets</h2><p><code>WindowInsets</code> æè¿°äº†ä¸€ç»„ Window Content çš„ Insetsï¼Œæœªæ¥å¯èƒ½ä¼šç»§ç»­æ·»åŠ æ–°çš„ Insets ç±»å‹ã€‚ç›®å‰å·²æœ‰çš„ Insets ç±»å‹æœ‰ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">androidx<span class="token punctuation">.</span>core<span class="token punctuation">.</span>view</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WindowInsetsCompat</span> <span class="token punctuation">{</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Type</span> <span class="token punctuation">{</span>      <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">FIRST</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>      <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">STATUS_BARS</span> <span class="token operator">=</span> <span class="token constant">FIRST</span><span class="token punctuation">;</span>      <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">NAVIGATION_BARS</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span>      <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">CAPTION_BAR</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">IME</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span>        <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">SYSTEM_GESTURES</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span>      <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">MANDATORY_SYSTEM_GESTURES</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span>      <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">TAPPABLE_ELEMENT</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span>        <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">DISPLAY_CUTOUT</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">7</span><span class="token punctuation">;</span>        <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">LAST</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span>      <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">SIZE</span> <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>      <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">WINDOW_DECOR</span> <span class="token operator">=</span> <span class="token constant">LAST</span><span class="token punctuation">;</span>        <span class="token keyword">private</span> <span class="token class-name">Type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨ä½è¿ç®—ç®¡ç†çŠ¶æ€æ˜¯å¾ˆå¸¸è§å¹¶é«˜æ•ˆçš„æ–¹å¼ï¼Œå¦‚æœå¯¹è¿™éƒ¨åˆ†å†…å®¹ä¸äº†è§£ï¼Œå¯ä»¥ç§»æ­¥ <a href="https://juejin.cn/user/1081575170900958/posts">KunMinX</a> çš„ <a href="https://juejin.cn/post/6844903879155384333">è¿™ç¯‡æ–‡ç«  å°±ç®—ä¸å»ç«æ˜Ÿç§åœŸè±†ï¼Œä¹Ÿè¯·åŠ¡å¿…æŒæ¡çš„ Android çŠ¶æ€ç®¡ç†æœ€ä½³å®è·µï¼</a> å…¥é—¨</p><p><code>System bar</code> åŒ…æ‹¬ <code>Status bar</code>ï¼Œ<code>Navigation bar</code>ï¼Œ<code>Caption bar</code>ï¼Œä½†<strong>ä¸åŒ…æ‹¬è½¯é”®ç›˜</strong>ï¼ˆ<code>ime</code>ï¼‰<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/WymOx4.jpg" alt="WymOx4"></p><h3 id="onApplyWindowInsets-ä¸-setOnApplyWindowInsetsListener"><a href="#onApplyWindowInsets-ä¸-setOnApplyWindowInsetsListener" class="headerlink" title="onApplyWindowInsets ä¸ setOnApplyWindowInsetsListener"></a>onApplyWindowInsets ä¸ setOnApplyWindowInsetsListener</h3><p>å¼€å‘è€…å¯ä»¥é€šè¿‡åœ¨è‡ªå®šä¹‰ View ä¸­é‡å†™ <code>onApplyWindowInsets()</code> æ–¹æ³•æˆ–è°ƒç”¨ <code>setOnApplyWindowInsetsListener()</code> æ¥ç›‘å¬ <code>WindowInsets</code> çš„å˜åŒ–ï¼Œé€šè¿‡å¯¹ View æ·»åŠ  <code>margin</code> æˆ– <code>padding</code> çš„æ–¹å¼å¤„ç†è§£å†³å†²çªã€‚</p><p>è¿™ä¸¤ä¸ªæ–¹æ³•æ˜¯äº’æ–¥çš„ï¼Œå½“å­˜åœ¨ <code>OnApplyWindowInsetsListener</code> æ—¶ä¸ä¼šæ‰§è¡Œ <code>onApplyWindowInsets</code>ï¼š<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/ZrAubd.jpg" alt="ZrAubd"></p><blockquote><p>å¼€å‘è€…å¯ä»¥åœ¨ä¹Ÿå¯ <code>OnApplyWindowInsetsListener</code> æ‰‹åŠ¨è°ƒç”¨ <code>onApplyWindowInsets</code> ä½¿ä¸¤ä¸ªæ–¹æ³•åŒæ—¶è¢«æ‰§è¡Œã€‚</p></blockquote><h3 id="WindowInsets-åˆ†å‘"><a href="#WindowInsets-åˆ†å‘" class="headerlink" title="WindowInsets åˆ†å‘"></a>WindowInsets åˆ†å‘</h3><p>å‰æ–‡æˆ‘ä»¬æåˆ°ï¼Œå¦‚æœå¼€å‘è€…ç»˜åˆ¶çš„å†…å®¹å‡ºç°åœ¨äº†ç³»ç»Ÿ UI åŒºåŸŸå†…ï¼Œå°±å¯èƒ½å‡ºç°è§†è§‰ä¸æ‰‹åŠ¿çš„å†²çªã€‚å¼€å‘è€…å¯ä»¥å€ŸåŠ© Insets æŠŠ view ä»å±å¹•è¾¹ç¼˜å‘å†…ç§»åŠ¨åˆ°ä¸€ä¸ªåˆé€‚çš„ä½ç½®ï¼Œæ­¤æ—¶ <code>View#onApplyWindowInsets()</code> ä¼šè¢«è°ƒç”¨ã€‚é‚£ä¹ˆè¿™äº› Insets æ˜¯å¦‚ä½•åˆ†å‘ç»™ View çš„å‘¢ï¼Ÿ</p><p>ç¬”è€…åœ¨ <a href="https://juejin.cn/post/6911176251495579655" title="https://juejin.cn/post/6911176251495579655">View äº‹ä»¶åˆ†å‘æœºåˆ¶ï¼Œå¤§å‹èŒåœº PUA ç°åœº</a> ä¸€æ–‡ä¸­æŠŠ Android çš„è§†å›¾æ ‘æŠ½è±¡ä¸º <strong>N å‰æ ‘</strong>ã€‚</p><p>ä¸ View çš„äº‹ä»¶åˆ†å‘ä¸€æ ·ï¼Œ<code>WindowInsets</code> çš„åˆ†å‘ä¹Ÿæ˜¯ N å‰æ ‘çš„éå†è¿‡ç¨‹ï¼š</p><p>ä» N å‰æ ‘çš„æ ¹èŠ‚ç‚¹ï¼ˆDecoViewï¼‰å¼€å§‹ï¼ŒæŒ‰ç…§ <strong>æ·±åº¦ä¼˜å…ˆ</strong> çš„æ–¹å¼åˆ†å‘ç»™ å­ viewã€‚</p><p>Android 10 å’Œ Android 11 ä¸¤ä¸ªç‰ˆæœ¬å®˜æ–¹è¿ç»­ä¿®æ”¹äº† <code>ViewGroup#dispatchApplyWindowInsets()</code> çš„é€»è¾‘ï¼ˆå…·ä½“æˆ‘ä»¬åœ¨æºç è§£æç¯‡ä»‹ç»ï¼‰ã€‚</p><p>å¦‚æœ app <code>targetSdkVersion &lt; 30</code> ï¼Œå¦‚æœæŸä¸ªèŠ‚ç‚¹æ¶ˆè´¹äº† Insetsï¼Œ<strong>æ‰€æœ‰æ²¡éå†åˆ°çš„èŠ‚ç‚¹éƒ½ä¸ä¼š</strong>æ”¶åˆ° <code>WindowInsets</code> çš„åˆ†å‘ï¼›</p><p>å½“ app è¿è¡Œåœ¨ Android 11 ä»¥ä¸Šç‰ˆæœ¬çš„è®¾å¤‡ä¸Šä¸” <code>targetSdkVersion &gt;= 30</code>ï¼Œå¦‚æœæŸä¸ªèŠ‚ç‚¹æ¶ˆè´¹äº† Insetsï¼Œ<strong>è¯¥èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹ä¸ä¼š</strong>æ”¶åˆ° <code>WindowInsets</code> åˆ†å‘ã€‚<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/LfaBdL.jpg" alt="LfaBdL"></p><p>æ—§ç‰ˆæœ¬çš„åˆ†å‘æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ— æ³•åšåˆ°ä¸¤ä¸ªåŒçº§çš„ View åŒæ—¶æ¶ˆè´¹ <code>WindowInsets</code>ï¼Œå¦‚ä¸‹å›¾ï¼š<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/P8ykcX.jpg" alt="P8ykcX"></p><blockquote><p>æˆ‘ä»¬å¯ä»¥å°† Level2-1 å’Œ Level2-2 çœ‹æˆé¡¶éƒ¨å¯¼èˆªå’Œåº•éƒ¨å¯¼èˆªï¼ŒæŒ‰ç…§æ—§é€»è¾‘ï¼Œå½“ Level2-1 æ¶ˆè´¹äº† <code>WindowInsets</code>ï¼Œå¦ä¸€ä¸ª View ä¾¿æ²¡æœºä¼šäº†ã€‚</p></blockquote><h3 id="å°ç»“-1"><a href="#å°ç»“-1" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><ul><li>  ç”±äºå¼€å‘è€…å¯ä»¥å°† App å†…å®¹ç»˜åˆ¶åˆ°ä¸ç³»ç»Ÿ UI ç›¸äº¤çš„ä½ç½®ï¼Œå› æ­¤å®˜æ–¹ä¸ºå¼€å‘è€…æä¾›äº†è§£å†³è§†è§‰å†²çªçš„æ–¹å¼ï¼Œ<code>WindowInsets</code></li><li>  å¼€å‘è€…å¯ä»¥é‡å†™ <code>View#onApplyWindowInsets</code> æˆ– <code>View#setOnApplyWindowInsetsListener</code> æ¥æ ¹æ® WindowInsets å¯¹ç³»ç»Ÿ UI è¿›è¡Œä½ç½®é¿è®©ï¼ˆå¯¹ view è®¾ç½® padding æˆ– marginï¼‰ã€‚</li><li>  ä¸‹ä¸€èŠ‚ä»‹ç»çš„ <code>fitsSystemWindows</code> çš„é»˜è®¤è¡Œä¸ºä¹Ÿæ˜¯é€šè¿‡ <code>onApplyWindowInsets</code> å®ç°çš„ã€‚</li></ul><h1 id="fitsSystemWindows"><a href="#fitsSystemWindows" class="headerlink" title="fitsSystemWindows"></a>fitsSystemWindows</h1><p><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/b98jig.jpg" alt="b98jig"></p><p><code>setFitsSystemWindows</code> æ˜¯ View ä¸­ API 14 ååŠ å…¥çš„æ–¹æ³•ï¼Œå¯¹åº”çš„ xml å±æ€§æ˜¯ <code>android:fitsSystemWindows</code></p><p><strong><code>fitsSystemWindows</code> çš„é»˜è®¤è¡Œä¸ºæ˜¯ï¼šé€šè¿‡ padding ä¸º <code>System bar</code> é¢„ç•™å‡ºç©ºé—´</strong>ã€‚å¦‚å‰æ–‡æåˆ°çš„ DecorView çš„ LinearLayoutï¼Œå®ƒçš„ <code>paddingTop</code> å°±æ˜¯ <code>fitsSystemWindows = true</code> å½±å“çš„ã€‚<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/RspJPI.jpg" alt="RspJPI"></p><blockquote><p>é»˜è®¤æƒ…å†µä¸‹ DecorView çš„å­ view æ˜¯ inflate <code>screen_simple.xml</code> å¾—åˆ°çš„ã€‚</p></blockquote><p>é‚£ä¹ˆè¿™ä¸ª padding æ˜¯å¦‚ä½•è®¾ç½®çš„ï¼Ÿ</p><p><code>View#onApplyWindowInsets()</code> ä¸­ä¼šåˆ¤æ–­ <code>fitsSystemWindows</code> æœ€ç»ˆè°ƒç”¨åˆ° <code>internalSetPadding()</code> æ–¹æ³•ï¼š<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/wC8itg.jpg" alt="wC8itg"></p><blockquote><p>ğŸ“¢ æ³¨æ„ï¼š<strong>è¿™ä¼šä½¿å¼€å‘è€…åœ¨ xml ä¸­å®šä¹‰çš„ padding å¤±æ•ˆ</strong>ã€‚</p></blockquote><p><code>fitsSystemWindows</code> è¿™ä¸ª API å¦å¾ˆå¤šå¼€å‘è€…è¿·æƒ‘ï¼Œä¸€ä¸ªé‡è¦åŸå› æ˜¯å¾ˆå¤šæ—¶å€™ <code>fitsSystemWindows</code> å¹¶ä¸æ˜¯ä½¿ç”¨çš„é»˜è®¤è¡Œä¸ºï¼Œå¦‚ <code>DrawerLayout</code> å’Œ <code>CoordinatorLayout</code>ã€‚</p><h3 id="DrawerLayout"><a href="#DrawerLayout" class="headerlink" title="DrawerLayout"></a>DrawerLayout</h3><p>DrawerLayout <code>fitsSystemWindow = true</code> æ—¶ï¼š</p><ul><li>  API &gt; 21 æ—¶è®¾ç½® <code>setSystemUiVisibility(SYSTEM_UI_FLAG_LAYOUT_STABLE | SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN)</code></li><li>  <code>onMeasure()</code> æ—¶è°ƒç”¨å­ view <code>dispatchApplyWindowInsets()</code>ï¼ˆæ­£å¸¸çˆ¶ View æ¶ˆè´¹ <code>WindowInsets</code> åå­ View æ¥æ”¶ä¸åˆ°åˆ†å‘ï¼‰</li><li>  <code>onDraw()</code> æ—¶è°ƒç”¨ <code>setStatusBackground(?android:colorPrimaryDark)</code></li></ul><h2 id="CoordinatorLayout"><a href="#CoordinatorLayout" class="headerlink" title="CoordinatorLayout"></a>CoordinatorLayout</h2><p>CoordinatorLayout <code>fitsSystemWindow = true</code> æ—¶ï¼š</p><ul><li>  API &gt; 21 æ—¶è®¾ç½® <code>setSystemUiVisibility(SYSTEM_UI_FLAG_LAYOUT_STABLE | SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN)</code></li><li>  æ ¹æ®éœ€è¦ <code>setStatusBackground</code></li><li>  å…è®¸è®¾ç½® behavior çš„å­ View æ‹¦æˆªå¹¶å“åº” <code>WindowInsets</code> çš„å˜åŒ–</li></ul><h3 id="å°ç»“-2"><a href="#å°ç»“-2" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>å…³äº <code>fitsSystemWindows</code>ï¼Œä½ å¿…é¡»çŸ¥é“ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ul><li><code>fitsSystemWindows</code> æ˜¯æ·±åº¦ä¼˜å…ˆï¼ˆæˆ‘ä»¬å¯ä»¥å°†è§†å›¾æ ‘çœ‹æˆä¸€ä¸ª Nå‰æ ‘ï¼‰çš„ï¼Œç¬¬ä¸€ä¸ªè®¾ç½® <code>fitsSystemWindows</code> çš„ view ä¼šå»æ¶ˆè´¹ insets å¹¶å½±å“è§†è§‰ï¼›</li><li>padding åœ¨ view layout ä¹‹å‰å°±å·²ç»è®¾ç½®äº†ï¼Œå› æ­¤<strong>ä¸è¦</strong>è¯¯è®¤ä¸ºè®¾ç½®padding æ—¶äº†è§£ view æ‰€åœ¨çš„ä½ç½®</li><li>å¼€å‘è€…åœ¨ xml æˆ– view åˆå§‹åŒ–è®¾ç½®çš„ padding ä¼šè¢«<strong>è¦†ç›–</strong></li><li>  <a href="https://link.juejin.cn/?target=https://developer.android.com/reference/com/google/android/material/appbar/AppBarLayout.html" title="https://developer.android.com/reference/com/google/android/material/appbar/AppBarLayout.html">AppBarLayout</a>ï¼Œ<a href="https://link.juejin.cn/?target=https://developer.android.com/reference/androidx/coordinatorlayout/widget/CoordinatorLayout.html" title="https://developer.android.com/reference/androidx/coordinatorlayout/widget/CoordinatorLayout.html">CoordinatorLayout</a>ï¼Œ<a href="https://link.juejin.cn/?target=https://developer.android.com/reference/androidx/drawerlayout/widget/DrawerLayout.html" title="https://developer.android.com/reference/androidx/drawerlayout/widget/DrawerLayout.html">DrawerLayout</a> ç­‰ view ä¼šè‡ªå®šä¹‰ <code>fitsSystemWindows</code> çš„è¡Œä¸º</li></ul><h2 id="å¤„ç†-WindowInsets-çš„æœ€ä½³å®è·µ"><a href="#å¤„ç†-WindowInsets-çš„æœ€ä½³å®è·µ" class="headerlink" title="å¤„ç† WindowInsets çš„æœ€ä½³å®è·µ"></a>å¤„ç† WindowInsets çš„æœ€ä½³å®è·µ</h2><h3 id="ä½¿ç”¨-Jetpack-æä¾›çš„-Compat-API"><a href="#ä½¿ç”¨-Jetpack-æä¾›çš„-Compat-API" class="headerlink" title="ä½¿ç”¨ Jetpack æä¾›çš„ Compat API"></a>ä½¿ç”¨ Jetpack æä¾›çš„ Compat API</h3><p>Android Jetpack ç»„ä»¶åº“ä¸­çš„ <a href="https://link.juejin.cn/?target=https://developer.android.com/jetpack/androidx/releases/core" title="https://developer.android.com/jetpack/androidx/releases/core">androidx.core</a> æä¾›äº†å¤§é‡å…¼å®¹æ—§ç‰ˆæœ¬çš„ Compat APIï¼Œå¦‚ <code>ViewCompat</code>ï¼Œ<code>WindowInsetsCompat</code>ï¼Œ<code>WindowInsetsControllerCompat</code> ç­‰ç­‰ã€‚</p><p>ä¸‹å›¾æ˜¯ <code>ViewCompat#getWindowInsetsController</code> æ–¹æ³•ï¼Œç”¨äºè·å– <code>WindowInsetsController</code>ï¼ŒåŒæ—¶å…¼å®¹ä½ç‰ˆæœ¬ï¼š<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/HyNTRE.jpg" alt="HyNTRE"></p><h3 id="è·å–WindowInsets"><a href="#è·å–WindowInsets" class="headerlink" title="è·å–WindowInsets"></a>è·å–WindowInsets</h3><p><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/Baeg38.jpg" alt="Baeg38"></p><p>ä½¿ç”¨ <code>ViewCompat.getRootWindowInsets(view)</code> è·å– <code>WindowInsets</code>ã€‚è¯·æ³¨æ„ï¼š</p><ul><li>è¯¥æ–¹æ³•è¿”å›åˆ†å‘ç»™è§†å›¾æ ‘çš„<strong>åŸå§‹</strong> insets</li><li>insets åªæœ‰åœ¨ view attached æ‰æ˜¯å¯ç”¨çš„</li><li>  API 20 åŠä»¥ä¸‹ <strong>æ°¸è¿œ</strong> è¿”å› false</li></ul><h3 id="è·å–-System-bar-å’Œ-è½¯é”®ç›˜çš„é«˜åº¦"><a href="#è·å–-System-bar-å’Œ-è½¯é”®ç›˜çš„é«˜åº¦" class="headerlink" title="è·å– System bar å’Œ è½¯é”®ç›˜çš„é«˜åº¦"></a>è·å– System bar å’Œ è½¯é”®ç›˜çš„é«˜åº¦</h3><h4 id="âŒ-é”™è¯¯ç”¨æ³•"><a href="#âŒ-é”™è¯¯ç”¨æ³•" class="headerlink" title="âŒ é”™è¯¯ç”¨æ³•"></a>âŒ é”™è¯¯ç”¨æ³•</h4><h4 id="ğŸ™…ğŸ»â€â™€ï¸ä¸è¦å›ºå®š-status-bar-çš„é«˜åº¦"><a href="#ğŸ™…ğŸ»â€â™€ï¸ä¸è¦å›ºå®š-status-bar-çš„é«˜åº¦" class="headerlink" title="ğŸ™…ğŸ»â€â™€ï¸ä¸è¦å›ºå®š status bar çš„é«˜åº¦"></a>ğŸ™…ğŸ»â€â™€ï¸ä¸è¦å›ºå®š status bar çš„é«˜åº¦</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">res/values<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dimen</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>status_bar_size<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>25dp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dimen</span><span class="token punctuation">&gt;</span></span>res/values-v23<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dimen</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>status_bar_size<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>24dp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dimen</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸åŒ Android ç‰ˆæœ¬ <code>status bar</code> çš„é«˜åº¦æ˜¯ä¸åŒçš„ï¼ä¸åŒè®¾å¤‡ä¹Ÿå¯èƒ½å®šåˆ¶è‡ªå·±çš„é«˜åº¦ã€‚<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/cuO06T.jpg" alt="cuO06T"></p><h4 id="ğŸ™…ğŸ»â€â™€ï¸è¯»å–ç³»ç»Ÿå†…éƒ¨èµ„æº"><a href="#ğŸ™…ğŸ»â€â™€ï¸è¯»å–ç³»ç»Ÿå†…éƒ¨èµ„æº" class="headerlink" title="ğŸ™…ğŸ»â€â™€ï¸è¯»å–ç³»ç»Ÿå†…éƒ¨èµ„æº"></a>ğŸ™…ğŸ»â€â™€ï¸è¯»å–ç³»ç»Ÿå†…éƒ¨èµ„æº</h4><p>framework çš„ <code>dimens.xml</code> å­˜å‚¨äº†ä¸€äº›åˆ—ç³»ç»Ÿå†…éƒ¨èµ„æºã€‚<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/oMnMPK.jpg" alt="oMnMPK"></p><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token keyword">val</span> resourceId <span class="token operator">=</span> resources<span class="token punctuation">.</span><span class="token function">getIdentifier</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"status_bar_height"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"dimen"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"android"</span></span><span class="token punctuation">)</span><span class="token keyword">return</span> resources<span class="token punctuation">.</span><span class="token function">getDimensionPixelSize</span><span class="token punctuation">(</span>resourceId<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¦‚æœç³»ç»Ÿå†…éƒ¨èµ„æºåç§°å˜åŒ–æ€ä¹ˆåŠï¼Ÿ</p><p><strong>ã€Œé‡è·¯å­ã€ä»£ç å¯èƒ½æœ‰æ•ˆï¼Œä½†ä¸å¥å£®ã€‚</strong></p><h4 id="âœ…-æ­£ç¡®ç”¨æ³•"><a href="#âœ…-æ­£ç¡®ç”¨æ³•" class="headerlink" title="âœ… æ­£ç¡®ç”¨æ³•"></a>âœ… æ­£ç¡®ç”¨æ³•</h4><ol><li> è·å– <code>WindowInsets</code></li><li> é€šè¿‡ <code>WindowInsets#getInsets(type)</code> è·å– Insets</li><li> é€šè¿‡ Insets.top æˆ– Insets.bottom è·å– <code>System bar</code> é«˜åº¦</li></ol><p>ä¸ºäº†å…¼å®¹æ—§ç‰ˆæœ¬ï¼Œæˆ‘ä»¬ä½¿ç”¨ Compat APIï¼š</p><ol><li> <code>val windowInsetsCompat = ViewCompat.getRootWindowInsets(view)</code> è·å– WindowInsets</li><li> <code>val insets = windowInsetsCompat?.getInsets(WindowInsetsCompat.Type.statusBars())</code> è·å– Insets</li><li> <code>insets?.top</code> æˆ– <code>insets?.bottom</code> è·å– <code>System bar</code> é«˜åº¦</li></ol><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin">ViewCompat<span class="token punctuation">.</span><span class="token function">getRootWindowInsets</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>decorView<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">getInsets</span><span class="token punctuation">(</span>WindowInsetsCompat<span class="token punctuation">.</span>Type<span class="token punctuation">.</span><span class="token function">statusBars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span>topViewCompat<span class="token punctuation">.</span><span class="token function">getRootWindowInsets</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>decorView<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">getInsets</span><span class="token punctuation">(</span>WindowInsetsCompat<span class="token punctuation">.</span>Type<span class="token punctuation">.</span><span class="token function">statusBars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span>bottom<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å½“ <code>System bar</code> éšè—æ—¶ getInsets() è·å–çš„é«˜åº¦ä¸º 0ï¼Œå¦‚æœæƒ³åœ¨éšè—çŠ¶æ€æ—¶ä¹Ÿèƒ½è·å–é«˜åº¦ï¼Œå¯ä»¥ä½¿ç”¨ <code>getInsetsIgnoringVisibility()</code> æ–¹æ³•</p><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin">ViewCompat<span class="token punctuation">.</span><span class="token function">getRootWindowInsets</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>decorView<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">getInsetsIgnoringVisibility</span><span class="token punctuation">(</span>WindowInsetsCompat<span class="token punctuation">.</span>Type<span class="token punctuation">.</span><span class="token function">statusBars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span>topViewCompat<span class="token punctuation">.</span><span class="token function">getRootWindowInsets</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>decorView<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">getInsetsIgnoringVisibility</span><span class="token punctuation">(</span>WindowInsetsCompat<span class="token punctuation">.</span>Type<span class="token punctuation">.</span><span class="token function">statusBars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span>bottom<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e25896e1c9984e8186f5c7a24bec910c~tplv-k3u1fbpfcp-watermark.awebp"></p><h3 id="WindowInsetsController"><a href="#WindowInsetsController" class="headerlink" title="WindowInsetsController"></a>WindowInsetsController</h3><p>Android 30 å¼•å…¥äº† <code>WindowInsetsController</code> æ¥æ§åˆ¶ <code>WindowInsets</code>ï¼Œä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š</p><ul><li>  æ˜¾ç¤º/éšè— <code>System bar</code></li><li>  è®¾ç½® <code>System bar</code> å‰æ™¯ï¼ˆå¦‚çŠ¶æ€æ çš„æ–‡å­—å›¾æ ‡ï¼‰æ˜¯äº®è‰²è¿˜æ˜¯æš—è‰²</li><li>  é€å¸§æ§åˆ¶ insets åŠ¨ç”»ï¼Œä¾‹å¦‚å¯ä»¥è®©è½¯é”®ç›˜å¼¹å‡ºå¾—æ›´ä¸æ»‘</li></ul><h4 id="æ˜¾ç¤ºéšè—-System-bar"><a href="#æ˜¾ç¤ºéšè—-System-bar" class="headerlink" title="æ˜¾ç¤ºéšè— System bar"></a>æ˜¾ç¤ºéšè— System bar</h4><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// çŠ¶æ€æ æ˜¯å¦å¯è§</span>ViewCompat<span class="token punctuation">.</span><span class="token function">getRootWindowInsets</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">isVisible</span><span class="token punctuation">(</span>WindowInsetsCompat<span class="token punctuation">.</span>Type<span class="token punctuation">.</span><span class="token function">statusBars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?:</span> <span class="token boolean">true</span><span class="token comment">// æ˜¾ç¤ºçŠ¶æ€æ </span>ViewCompat<span class="token punctuation">.</span><span class="token function">getWindowInsetsController</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>WindowInsetsCompat<span class="token punctuation">.</span>Type<span class="token punctuation">.</span><span class="token function">statusBars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">// éšè—çŠ¶æ€æ </span>ViewCompat<span class="token punctuation">.</span><span class="token function">getWindowInsetsController</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span>WindowInsetsCompat<span class="token punctuation">.</span>Type<span class="token punctuation">.</span><span class="token function">statusBars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">// å¯¼èˆªæ æ˜¯å¦å¯è§</span>ViewCompat<span class="token punctuation">.</span><span class="token function">getRootWindowInsets</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">isVisible</span><span class="token punctuation">(</span>WindowInsetsCompat<span class="token punctuation">.</span>Type<span class="token punctuation">.</span><span class="token function">navigationBars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?:</span> <span class="token boolean">true</span><span class="token comment">// æ˜¾ç¤ºå¯¼èˆªæ </span>ViewCompat<span class="token punctuation">.</span><span class="token function">getWindowInsetsController</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>WindowInsetsCompat<span class="token punctuation">.</span>Type<span class="token punctuation">.</span><span class="token function">navigationBars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">// éšè—å¯¼èˆªæ </span>ViewCompat<span class="token punctuation">.</span><span class="token function">getWindowInsetsController</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span>WindowInsetsCompat<span class="token punctuation">.</span>Type<span class="token punctuation">.</span><span class="token function">navigationBars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">// è½¯é”®ç›˜æ˜¯å¦å¯è§</span>ViewCompat<span class="token punctuation">.</span><span class="token function">getRootWindowInsets</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">isVisible</span><span class="token punctuation">(</span>WindowInsetsCompat<span class="token punctuation">.</span>Type<span class="token punctuation">.</span><span class="token function">ime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?:</span> <span class="token boolean">false</span><span class="token comment">// æ˜¾ç¤ºè½¯é”®ç›˜</span>ViewCompat<span class="token punctuation">.</span><span class="token function">getWindowInsetsController</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>WindowInsetsCompat<span class="token punctuation">.</span>Type<span class="token punctuation">.</span><span class="token function">ime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">// éšè—è½¯é”®ç›˜</span>ViewCompat<span class="token punctuation">.</span><span class="token function">getWindowInsetsController</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span>WindowInsetsCompat<span class="token punctuation">.</span>Type<span class="token punctuation">.</span><span class="token function">ime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cdbb9ed084fa4b29a36730da2bec9f12~tplv-k3u1fbpfcp-watermark.awebp"></p><h4 id="è®¾ç½®-System-bar-å‰æ™¯äº®è‰²-æš—è‰²"><a href="#è®¾ç½®-System-bar-å‰æ™¯äº®è‰²-æš—è‰²" class="headerlink" title="è®¾ç½® System bar å‰æ™¯äº®è‰²/æš—è‰²"></a>è®¾ç½® System bar å‰æ™¯äº®è‰²/æš—è‰²</h4><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin">ViewCompat<span class="token punctuation">.</span><span class="token function">getWindowInsetsController</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span><span class="token punctuation">.</span>isAppearanceLightStatusBars <span class="token operator">=</span> isLightViewCompat<span class="token punctuation">.</span><span class="token function">getWindowInsetsController</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span><span class="token punctuation">.</span>isAppearanceLightNavigationBars <span class="token operator">=</span> isLight<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="é€‚é…-edge-to-edge"><a href="#é€‚é…-edge-to-edge" class="headerlink" title="é€‚é… edge-to-edge"></a>é€‚é… edge-to-edge</h2><p>ä½•ä¸º edge-to-edgeï¼Ÿå¦‚ä¸‹å›¾ï¼Œå³åº”ç”¨å†…å®¹çš„ç»˜åˆ¶èŒƒå›´ä»é¡¶éƒ¨çŠ¶æ€æ ä¸‹æ–¹å¼€å§‹ï¼Œå»¶ä¼¸è‡³åº•éƒ¨å¯¼èˆªæ ä¸Šæ–¹ï¼š<br><img src="https://developer.android.com/images/guide/navigation/e2e-intro.gif"></p><p>å…³äº edge-to-edge çš„é€‚é…ï¼Œ<a href="https://link.juejin.cn/?target=https://developer.android.com/training/gestures/edge-to-edge" title="https://developer.android.com/training/gestures/edge-to-edge">å®˜æ–¹æ–‡æ¡£</a> å†™å¾—å¾ˆå®Œæ•´ï¼Œä¸»è¦åˆ†ä¸‰æ­¥ï¼š</p><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// 1. ä½¿å†…å®¹åŒºåŸŸå…¨å±</span>WindowCompat<span class="token punctuation">.</span><span class="token function">setDecorFitsSystemWindows</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token comment">// 2. è®¾ç½® System bar é€æ˜</span>window<span class="token punctuation">.</span>statusBarColor <span class="token operator">=</span> Color<span class="token punctuation">.</span>TRANSPARENTwindow<span class="token punctuation">.</span>navigationBarColor <span class="token operator">=</span> Color<span class="token punctuation">.</span>TRANSPARENT<span class="token comment">// 3. å¯èƒ½å‡ºç°è§†è§‰å†²çªçš„ view å¤„ç† insets</span>ViewCompat<span class="token punctuation">.</span><span class="token function">setOnApplyWindowInsetsListener</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span> <span class="token punctuation">{</span> view<span class="token punctuation">,</span> windowInsets <span class="token operator">-&gt;</span>  <span class="token keyword">val</span> insets <span class="token operator">=</span> windowInsets<span class="token punctuation">.</span><span class="token function">getInsets</span><span class="token punctuation">(</span>WindowInsetsCompat<span class="token punctuation">.</span>Type<span class="token punctuation">.</span><span class="token function">systemBars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// æ­¤å¤„æ›´æ”¹çš„ marginï¼Œä¹Ÿå¯è®¾ç½® paddingï¼Œè§†æƒ…å†µè€Œå®š</span>  view<span class="token punctuation">.</span>updateLayoutParams<span class="token operator">&lt;</span>MarginLayoutParams<span class="token operator">&gt;</span> <span class="token punctuation">{</span>      topMargin <span class="token operator">=</span> insets<span class="token punctuation">.</span>top      leftMargin <span class="token operator">=</span> insets<span class="token punctuation">.</span>left      bottomMargin <span class="token operator">=</span> insets<span class="token punctuation">.</span>bottom      rightMargin <span class="token operator">=</span> insets<span class="token punctuation">.</span>right  <span class="token punctuation">}</span>  WindowInsetsCompat<span class="token punctuation">.</span>CONSUMED<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ³¨æ„ï¼š<strong>å¤„ç† insets æ—¶è¦ä¿è¯è®¡ç®—æ“ä½œæœ‰å¹‚ç­‰æ€§</strong>ï¼Œå³å¤šæ¬¡è¿›è¡Œè¯¥è®¡ç®—æ‰€å¾—åˆ°çš„ç»“æœåº”è¯¥ç›¸åŒï¼Œå¦åˆ™ margin/padding ä¼šè¶Šæ¥è¶Šå¤§ï¼</p><p>å¤„ç† insets ä¹Ÿå¯ä»¥é€šè¿‡ é‡å†™ <code>View#onApplyWindowInsets</code> æ¥æ“ä½œã€‚</p></blockquote><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><ul><li>  éšç€ Android çš„ä¸æ–­è¿­ä»£ï¼Œå¼€å‘è€…å¯ä»¥æ›´å……åˆ†åœ°åˆ©ç”¨å±å¹•ç©ºé—´ï¼Œèƒ½å¤Ÿå°†å†…å®¹ç»˜åˆ¶åœ¨ç³»ç»Ÿ UI åé¢ï¼›</li><li>  Android ä½¿ç”¨ Insets æ¥æè¿°ç³»ç»Ÿ UI ä¸å±å¹•ç›¸äº¤çš„åŒºåŸŸï¼Œå¼€å‘è€…å¯ä»¥ä½¿ç”¨ <code>fitsSystemWindows</code> å’Œ <code>WindowInsets</code> æ¥å¤„ç†è§†è§‰å’Œæ‰‹åŠ¿å†²çªï¼›</li><li>  <code>WindowInsets</code> çš„åˆ†å‘æ ¹æ® <code>targetSDKVersion</code> çš„ä¸åŒè€Œç•¥æœ‰å·®åˆ«ï¼›</li><li>  <code>fitsSystemWindows</code> çš„é»˜è®¤è¡Œä¸ºæ˜¯ï¼šé€šè¿‡ padding ä¸º <code>System bar</code> é¢„ç•™å‡ºç©ºé—´ï¼Œæœ¬è´¨ä¹Ÿæ˜¯åˆ©ç”¨ WindowInsets å¤„ç†è§†è§‰å†²çªï¼›</li><li>  ä¸€äº›è‡ªå®šä¹‰ view å¦‚ DrawerLayout ä¼šæ›´æ”¹ <code>fitsSystemWindows</code> çš„é»˜è®¤è¡Œä¸ºï¼›</li><li>  å¤„ç† <code>WindowInsets</code> å¯ä»¥ä½¿ç”¨ Jetpack <code>androidx.core</code> æä¾›çš„ä¸€äº›åˆ— Compat ç±»ï¼›</li><li>  ç‰¢è®°è·å– <code>Status bar</code> é«˜åº¦çš„æ­£ç¡®å§¿åŠ¿ï¼Œå¹¶é¿å…é”™è¯¯ç”¨æ³•ï¼›</li><li>  é€‚é… edge-to-edge ä»¥ç»™ç”¨æˆ·æ›´å¥½çš„ä½¿ç”¨ä½“éªŒ</li></ul><h1 id="æ¨èé˜…è¯»å’Œå‚è€ƒèµ„æº"><a href="#æ¨èé˜…è¯»å’Œå‚è€ƒèµ„æº" class="headerlink" title="æ¨èé˜…è¯»å’Œå‚è€ƒèµ„æº"></a>æ¨èé˜…è¯»å’Œå‚è€ƒèµ„æº</h1><ul><li>  <a href="https://juejin.cn/post/6844904001721335815" title="https://juejin.cn/post/6844904001721335815">å¼€å¯å…¨é¢å±ä½“éªŒ | æ‰‹åŠ¿å¯¼èˆª (ä¸€)</a></li><li>  <a href="https://juejin.cn/post/6844904006343458830" title="https://juejin.cn/post/6844904006343458830">å¤„ç†è§†è§‰å†²çª | æ‰‹åŠ¿å¯¼èˆª (äºŒ)</a></li><li>  <a href="https://juejin.cn/post/6844904021367472142" title="https://juejin.cn/post/6844904021367472142">å¦‚ä½•å¤„ç†æ‰‹åŠ¿å†²çª | æ‰‹åŠ¿å¯¼èˆªè¿è½½ (ä¸‰)</a></li><li>  <a href="https://juejin.cn/post/6844904034281717768" title="https://juejin.cn/post/6844904034281717768">æ²‰æµ¸æ¨¡å¼ | æ‰‹åŠ¿å¯¼èˆªè¿è½½ (å››)</a></li><li>  <a href="https://link.juejin.cn/?target=https://medium.com/androiddevelopers/why-would-i-want-to-fitssystemwindows-4e26d9ce1eec" title="https://medium.com/androiddevelopers/why-would-i-want-to-fitssystemwindows-4e26d9ce1eec">Why would I want to fitsSystemWindows?</a></li><li>  <a href="https://link.juejin.cn/?target=https://medium.com/androiddevelopers/windowinsets-listeners-to-layouts-8f9ccc8fa4d1" title="https://medium.com/androiddevelopers/windowinsets-listeners-to-layouts-8f9ccc8fa4d1">WindowInsets â€” listeners to layouts</a></li><li>  <a href="https://link.juejin.cn/?target=https://www.bilibili.com/video/BV11U4y1T7D1" title="https://www.bilibili.com/video/BV11U4y1T7D1">Becoming a master window fitterğŸ”§</a></li></ul><h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><p><a href="https://juejin.cn/post/7038422081528135687">Android Detailï¼šWindow ç¯‡â€”â€” WindowInsets ä¸ fitsSystemWindow</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> WindowInsets </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android é€†å‘ä¹‹ Smali è¯­æ³•</title>
      <link href="/20210809/android-smali-grammary/"/>
      <url>/20210809/android-smali-grammary/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><h3 id="APK"><a href="#APK" class="headerlink" title="APK"></a>APK</h3><p>APKå…¶å®å°±æ˜¯ä¸€ä¸ªZIPå‹ç¼©åŒ…ï¼Œå°†APKåç¼€æ”¹æˆZIPåå°±å¯ä»¥è§£å‹å‡ºAPKå†…éƒ¨æ–‡ä»¶ã€‚</p><h3 id="Dalvikå­—èŠ‚ç "><a href="#Dalvikå­—èŠ‚ç " class="headerlink" title="Dalvikå­—èŠ‚ç "></a>Dalvikå­—èŠ‚ç </h3><p>Dalvikæ˜¯googleä¸“é—¨ä¸ºAndroidæ“ä½œç³»ç»Ÿè®¾è®¡çš„ä¸€ä¸ªè™šæ‹Ÿæœºï¼Œç»è¿‡æ·±åº¦çš„ä¼˜åŒ–ã€‚è™½ç„¶Androidä¸Šçš„ç¨‹åºæ˜¯ä½¿ç”¨javaæ¥å¼€å‘çš„ï¼Œä½†æ˜¯Dalvikå’Œæ ‡å‡†çš„javaè™šæ‹ŸæœºJVMè¿˜æ˜¯ä¸¤å›äº‹ã€‚Dalvik VMæ˜¯<code>åŸºäºå¯„å­˜å™¨</code>çš„ï¼Œè€ŒJVMæ˜¯<code>åŸºäºæ ˆ</code>çš„ï¼›Dalvikæœ‰ä¸“å±çš„æ–‡ä»¶æ‰§è¡Œæ ¼å¼<code>dex(dalvik executable)</code>ï¼Œè€ŒJVMåˆ™æ‰§è¡Œçš„æ˜¯<code>javaå­—èŠ‚ç </code>ã€‚Dalvik VMæ¯”JVM<code>é€Ÿåº¦æ›´å¿«</code>ï¼Œ<code>å ç”¨ç©ºé—´æ›´å°‘</code>ã€‚</p><h2 id="å¦‚ä½•é€†å‘"><a href="#å¦‚ä½•é€†å‘" class="headerlink" title="å¦‚ä½•é€†å‘"></a>å¦‚ä½•é€†å‘</h2><h3 id="åç¼–è¯‘ä¸ºSmaliå·¥ç¨‹"><a href="#åç¼–è¯‘ä¸ºSmaliå·¥ç¨‹" class="headerlink" title="åç¼–è¯‘ä¸ºSmaliå·¥ç¨‹"></a>åç¼–è¯‘ä¸ºSmaliå·¥ç¨‹</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># weicools in ~/Downloads/AndroidReverse [14:30:45]</span>$ <span class="token builtin class-name">pwd</span>/Users/weicools/Downloads/AndroidReverse<span class="token comment"># weicools in ~/Downloads/AndroidReverse [14:30:47]</span>$ <span class="token function">ls</span>abc.apk<span class="token comment"># 1. apktoolåç¼–è¯‘apk</span><span class="token comment"># weicools in ~/Downloads/AndroidReverse [14:30:54]</span>$ apktool d --only-main-classe abc.apk<span class="token comment"># weicools in ~/Downloads/AndroidReverse [14:30:47]</span>$ <span class="token function">ls</span>abc    abc.apk<span class="token comment"># 2. é‡æ–°æ‰“åŒ…Apk</span><span class="token comment"># weicools in ~/Downloads/AndroidReverse [14:31:02] C:130</span>$ apktool b abc<span class="token comment"># 3. ç­¾åApk</span><span class="token comment"># weicools in ~/Downloads/AndroidReverse [14:31:13] C:130</span>$ jarsigner <span class="token parameter variable">-verbose</span> <span class="token parameter variable">-keystore</span> custom.keystore <span class="token parameter variable">-signedjar</span> abc_signed.apk /abc/dist/abc.apk custom<span class="token comment"># weicools in ~/Downloads/AndroidReverse [14:31:20] C:130</span>$ <span class="token builtin class-name">cd</span> filemagic<span class="token comment"># 4. æŸ¥çœ‹åç¼–è¯‘ç”Ÿæˆçš„å·¥ç¨‹ç›®å½•</span><span class="token comment"># weicools in ~/Downloads/AndroidReverse/filemagic on git:master o [14:31:33]</span>$ <span class="token function">ls</span>AndroidManifest.xml res                 smali_classes4smali               smali_classes5apktool.yml         lib                 smali_classes2      assets              smali_classes3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æŸ¥çœ‹æºç "><a href="#æŸ¥çœ‹æºç " class="headerlink" title="æŸ¥çœ‹æºç "></a>æŸ¥çœ‹æºç </h3><p>ä½¿ç”¨ <code>jadx-gui</code> æ‰“å¼€å¯¹å‘€Apkå³å¯ï¼ŒåŠ å›ºçš„Apkéœ€è¦å…ˆè„±å£³ æ‰èƒ½æŸ¥çœ‹æºç </p><h3 id="åˆ†ææ€è·¯"><a href="#åˆ†ææ€è·¯" class="headerlink" title="åˆ†ææ€è·¯"></a>åˆ†ææ€è·¯</h3><p>ä»£ç å¯ä»¥é€šè¿‡ <code>jadx-gui</code> æŸ¥çœ‹ï¼Œä½†æ˜¯è¿™ä¸ªå·¥å…·æŸ¥ä»£ç å¹¶ä¸æ–¹ä¾¿ï¼Œæ‰€ä»¥è¿˜æ˜¯æ¨èåœ¨ <code>jadx-gui</code> ä¸­<code>å¼€å¯åæ··æ·†</code>å¹¶æŠŠæºç <code>ä¿å­˜ä¸ºGradleå·¥ç¨‹</code>ï¼Œç„¶åä½¿ç”¨Android StudioæŸ¥çœ‹ï¼Œã€‚</p><ol><li>é¦–å…ˆçœ‹è¿™ä¸ªç±»æœ‰æ²¡æœ‰<code>é™æ€æ–¹æ³•</code>å’Œ<code>é™æ€ä»£ç å—</code>ï¼Œå› ä¸ºè¿™ç±»ä»£ç ä¼šåœ¨å¯¹è±¡åˆå§‹åŒ–å‰è¿è¡Œï¼Œå¯èƒ½åœ¨è¿™é‡Œ<code>åŠ è½½soæ–‡ä»¶</code>ï¼Œæˆ–è€…æ˜¯<code>åŠ å¯†æ ¡éªŒ</code>ç­‰æ“ä½œã€‚</li><li>å†çœ‹çœ‹è¿™ä¸ªç±»çš„<code>æ„é€ æ–¹æ³•</code>ã€‚</li><li>æœ€åçœ‹<code>ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</code>ã€‚</li></ol><h2 id="Smaliè¯­æ³•"><a href="#Smaliè¯­æ³•" class="headerlink" title="Smaliè¯­æ³•"></a>Smaliè¯­æ³•</h2><p>smaliå°±æ˜¯Dalvik VMå†…éƒ¨æ‰§è¡Œçš„æ ¸å¿ƒä»£ç ï¼Œå®ƒæœ‰è‡ªå·±çš„ä¸€å¥—è¯­æ³•ã€‚è¦äº†è§£ smali è¯­æ³•è§„èŒƒï¼Œå¯ä»¥å…ˆä»äº†è§£ Dalvik è™šæ‹Ÿæœºå­—èŠ‚ç çš„æŒ‡ä»¤æ ¼å¼å¼€å§‹ã€‚3.1 Dalvik è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤æ ¼å¼åœ¨ Android 4.0 æºç  Dalvik/docs ç›®å½•ä¸‹æä¾›äº†ä¸€ä»½æ–‡æ¡£ instruction-formats.htmlï¼Œé‡Œé¢è¯¦ç»†åˆ—ä¸¾äº† Dalvik è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤çš„æ‰€æœ‰æ ¼å¼ã€‚</p><h3 id="æŒ‡ä»¤ç±»å‹"><a href="#æŒ‡ä»¤ç±»å‹" class="headerlink" title="æŒ‡ä»¤ç±»å‹"></a>æŒ‡ä»¤ç±»å‹</h3><table><thead><tr><th align="left">æŒ‡ä»¤</th><th align="left">åŠŸèƒ½</th></tr></thead><tbody><tr><td align="left">.field private isFlag:z</td><td align="left">å®šä¹‰å˜é‡</td></tr><tr><td align="left">.method</td><td align="left">æ–¹æ³•</td></tr><tr><td align="left">.parameter</td><td align="left">æ–¹æ³•å‚æ•°</td></tr><tr><td align="left">.prologue</td><td align="left">æ–¹æ³•å¼€å§‹</td></tr><tr><td align="left">.line 12</td><td align="left">æ­¤æ–¹æ³•ä½äº12è¡Œ</td></tr><tr><td align="left">invoke-super</td><td align="left">è°ƒç”¨çˆ¶ç±»æ–¹æ³•</td></tr><tr><td align="left">const/high16 v0,0x7fo3</td><td align="left">æŠŠ0x7fo3èµ‹å€¼ç»™v0</td></tr><tr><td align="left">invoke-direct</td><td align="left">è°ƒç”¨å‡½æ•°</td></tr><tr><td align="left">return-void</td><td align="left">å‡½æ•°è¿”å›void</td></tr><tr><td align="left">.end method</td><td align="left">å‡½æ•°ç»“æŸ</td></tr><tr><td align="left">new-instance</td><td align="left">åˆ›å»ºå®ä¾‹</td></tr><tr><td align="left">input-object</td><td align="left">å¯¹è±¡èµ‹å€¼</td></tr><tr><td align="left">iget-object</td><td align="left">è°ƒç”¨å¯¹è±¡</td></tr><tr><td align="left">Invoke-static</td><td align="left">è°ƒç”¨é™æ€å‡½æ•°</td></tr></tbody></table><h3 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h3><table><thead><tr><th align="left">ç¬¦å·</th><th align="left">ç±»å‹</th></tr></thead><tbody><tr><td align="left">B</td><td align="left">byte</td></tr><tr><td align="left">C</td><td align="left">char</td></tr><tr><td align="left">D</td><td align="left">double</td></tr><tr><td align="left">F</td><td align="left">float</td></tr><tr><td align="left">I</td><td align="left">int</td></tr><tr><td align="left">J</td><td align="left">long</td></tr><tr><td align="left">S</td><td align="left">short</td></tr><tr><td align="left">V</td><td align="left">void-åªç”¨äºè¿”å›å€¼ç±»å‹</td></tr><tr><td align="left">Z</td><td align="left">boolean</td></tr><tr><td align="left">[XXX</td><td align="left">Array</td></tr><tr><td align="left">Lxxx/yyy</td><td align="left">Object</td></tr></tbody></table><blockquote><p>æ•°ç»„ï¼š</p><p>åœ¨åŸºæœ¬ç±»å‹å‰åŠ ä¸Šå‰ä¸­æ‹¬å·â€œ[â€ï¼Œä¾‹å¦‚intæ•°ç»„å’Œfloatæ•°ç»„åˆ†åˆ«è¡¨ç¤ºä¸ºï¼š[Iã€[F</p><p>å¯¹è±¡ï¼š</p><p>ä»¥Lä½œä¸ºå¼€å¤´ï¼Œæ ¼å¼æ˜¯<code>LpackageName/objectName;</code></p><p>Stringå¯¹è±¡åœ¨smaliä¸­ä¸ºï¼š<code>Ljava/lang/String;</code></p><p>ç±»é‡Œé¢çš„å†…éƒ¨ç±»ï¼š<code>LpackageName/objectName$subObjectName;</code></p></blockquote><h3 id="å‡½æ•°å½¢å¼"><a href="#å‡½æ•°å½¢å¼" class="headerlink" title="å‡½æ•°å½¢å¼"></a>å‡½æ•°å½¢å¼</h3><p>å‡½æ•°å…¬å¼ä¸ºï¼š</p><pre class="line-numbers language-none"><code class="language-none">FuncName (ParamType1ParamType2ParamType3...)ReturnType<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‚æ•°ä¹‹é—´æ²¡æœ‰é—´éš”ã€‚ä¸¾ä¾‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">foo ()V --&gt; void foo()foo (III)Z --&gt; boolean foo(int, int, int)foo (Z[I[ILjava/lang/String;J)Ljava/lang/String; --&gt; String foo(boolean, int[], int[], String, long)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ–‡ä»¶åˆ†æ-TODO"><a href="#æ–‡ä»¶åˆ†æ-TODO" class="headerlink" title="æ–‡ä»¶åˆ†æ - TODO"></a>æ–‡ä»¶åˆ†æ - TODO</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token keyword">public</span> <span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span><span class="token constant">WMW</span><span class="token operator">/</span><span class="token class-name">WMWActivity</span><span class="token punctuation">;</span> <span class="token punctuation">.</span><span class="token keyword">super</span> <span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span>common<span class="token operator">/</span><span class="token class-name">BaseActivity</span><span class="token punctuation">;</span><span class="token punctuation">.</span>source <span class="token string">"WMWActivity.java"</span># interfaces<span class="token punctuation">.</span><span class="token keyword">implements</span> <span class="token class-name">Lcom</span><span class="token operator">/</span>burstly<span class="token operator">/</span>lib<span class="token operator">/</span>ui<span class="token operator">/</span><span class="token class-name">IBurstlyAdListener</span><span class="token punctuation">;</span># annotations<span class="token punctuation">.</span>annotation system <span class="token class-name">Ldalvik</span><span class="token operator">/</span>annotation<span class="token operator">/</span><span class="token class-name">MemberClasses</span><span class="token punctuation">;</span>    value <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span><span class="token constant">WMW</span><span class="token operator">/</span><span class="token class-name">WMWActivity</span>$<span class="token class-name">MessageHandler</span><span class="token punctuation">;</span><span class="token punctuation">,</span>        <span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span><span class="token constant">WMW</span><span class="token operator">/</span><span class="token class-name">WMWActivity</span>$<span class="token class-name">FinishActivityArgs</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">.</span>end annotation# <span class="token keyword">static</span> fields<span class="token punctuation">.</span>field <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token constant">PREFS_INSTALLATION_ID</span><span class="token operator">:</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span><span class="token punctuation">;</span> <span class="token operator">=</span> <span class="token string">"installationId"</span><span class="token comment">//...</span># instance fields<span class="token punctuation">.</span>field <span class="token keyword">private</span> _activityPackageName<span class="token operator">:</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span><span class="token punctuation">;</span><span class="token comment">//...</span># direct methods<span class="token punctuation">.</span>method <span class="token keyword">static</span> constructor <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">V</span>    <span class="token punctuation">.</span>locals <span class="token number">3</span>    <span class="token punctuation">.</span>prologue    <span class="token comment">//...</span>    <span class="token keyword">return</span><span class="token operator">-</span><span class="token keyword">void</span><span class="token punctuation">.</span>end method<span class="token punctuation">.</span>method <span class="token keyword">public</span> constructor <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">V</span>    <span class="token punctuation">.</span>locals <span class="token number">3</span>    <span class="token punctuation">.</span>prologue    <span class="token comment">//...</span>    <span class="token keyword">return</span><span class="token operator">-</span><span class="token keyword">void</span><span class="token punctuation">.</span>end method<span class="token punctuation">.</span>method <span class="token keyword">static</span> synthetic access$<span class="token function">100</span><span class="token punctuation">(</span><span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span><span class="token constant">WMW</span><span class="token operator">/</span><span class="token class-name">WMWActivity</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">V</span>    <span class="token punctuation">.</span>locals <span class="token number">0</span>    <span class="token punctuation">.</span>parameter <span class="token string">"x0"</span>    <span class="token punctuation">.</span>prologue    <span class="token punctuation">.</span>line <span class="token number">37</span>    invoke<span class="token operator">-</span>direct <span class="token punctuation">{</span>p0<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span><span class="token constant">WMW</span><span class="token operator">/</span><span class="token class-name">WMWActivity</span><span class="token punctuation">;</span><span class="token operator">-&gt;</span><span class="token function">initIap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">V</span>    <span class="token keyword">return</span><span class="token operator">-</span><span class="token keyword">void</span><span class="token punctuation">.</span>end method<span class="token punctuation">.</span>method <span class="token keyword">static</span> synthetic access$<span class="token function">200</span><span class="token punctuation">(</span><span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span><span class="token constant">WMW</span><span class="token operator">/</span><span class="token class-name">WMWActivity</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span>common<span class="token operator">/</span><span class="token class-name">WMWView</span><span class="token punctuation">;</span>    <span class="token punctuation">.</span>locals <span class="token number">1</span>    <span class="token punctuation">.</span>parameter <span class="token string">"x0"</span>    <span class="token punctuation">.</span>prologue    <span class="token punctuation">.</span>line <span class="token number">37</span>    iget<span class="token operator">-</span>object v0<span class="token punctuation">,</span> p0<span class="token punctuation">,</span> <span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span><span class="token constant">WMW</span><span class="token operator">/</span><span class="token class-name">WMWActivity</span><span class="token punctuation">;</span><span class="token operator">-&gt;</span>_view<span class="token operator">:</span><span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span>common<span class="token operator">/</span><span class="token class-name">WMWView</span><span class="token punctuation">;</span>    <span class="token keyword">return</span><span class="token operator">-</span>object v0<span class="token punctuation">.</span>end method<span class="token comment">//...</span>#virtual methods<span class="token punctuation">.</span>method <span class="token keyword">public</span> <span class="token function">captureScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">V</span>    <span class="token punctuation">.</span>locals <span class="token number">4</span>    <span class="token punctuation">.</span>prologue    <span class="token comment">//...</span>    <span class="token keyword">goto</span> <span class="token operator">:</span>goto_0<span class="token punctuation">.</span>end method<span class="token punctuation">.</span>method <span class="token keyword">public</span> <span class="token function">didScreenCaptured</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">V</span>    <span class="token punctuation">.</span>locals <span class="token number">6</span>    <span class="token punctuation">.</span>prologue    <span class="token comment">//...</span>    <span class="token keyword">goto</span> <span class="token operator">:</span>goto_0<span class="token punctuation">.</span>end method<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="smaliå¯„å­˜å™¨"><a href="#smaliå¯„å­˜å™¨" class="headerlink" title="smaliå¯„å­˜å™¨"></a>smaliå¯„å­˜å™¨</h4><p>Dalvik VMä¸JVMçš„æœ€å¤§çš„åŒºåˆ«ä¹‹ä¸€å°±æ˜¯Dalvik VMæ˜¯<code>åŸºäºå¯„å­˜å™¨</code>çš„ã€‚åŸºäºå¯„å­˜å™¨æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨smalié‡Œçš„æ‰€æœ‰æ“ä½œéƒ½å¿…é¡»ç»è¿‡å¯„å­˜å™¨æ¥è¿›è¡Œï¼š</p><p><code>æœ¬åœ°å¯„å­˜å™¨</code>ç”¨<code>vå¼€å¤´æ•°å­—ç»“å°¾</code>çš„ç¬¦å·æ¥è¡¨ç¤ºï¼Œå¦‚v0ã€v1ã€v2ã€â€¦</p><p><code>å‚æ•°å¯„å­˜å™¨</code>ç”¨<code>på¼€å¤´æ•°å­—ç»“å°¾</code>çš„ç¬¦å·æ¥è¡¨ç¤ºï¼Œå¦‚p0ã€p1ã€p2ã€â€¦</p><p>ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œp0ä¸ä¸€å®šæ˜¯å‡½æ•°ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼š</p><ul><li>åœ¨<code>éstaticå‡½æ•°</code>ä¸­ï¼Œp0ä»£æŒ‡<code>this</code>ï¼Œp1è¡¨ç¤ºå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œp2ä»£è¡¨å‡½æ•°ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°â€¦</li><li>åœ¨<code>staticå‡½æ•°</code>ä¸­p0æ‰å¯¹åº”ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆå› ä¸ºJavaçš„staticæ–¹æ³•ä¸­æ²¡æœ‰thisæ–¹æ³•ï¼‰ã€‚</li></ul><p>æœ¬åœ°å¯„å­˜å™¨æ²¡æœ‰é™åˆ¶ï¼Œç†è®ºä¸Šæ˜¯å¯ä»¥ä»»æ„ä½¿ç”¨çš„ï¼Œä¸‹é¢æ˜¯ä¾‹å­ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">const</span><span class="token operator">/</span><span class="token number">4</span> v0<span class="token punctuation">,</span> <span class="token number">0x0</span>iput<span class="token operator">-</span><span class="token keyword">boolean</span> v0<span class="token punctuation">,</span> p0<span class="token punctuation">,</span> <span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span><span class="token constant">WMW</span><span class="token operator">/</span><span class="token class-name">WMWActivity</span><span class="token punctuation">;</span><span class="token operator">-&gt;</span>isRunning<span class="token operator">:</span><span class="token class-name">Z</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åœ¨ä¸Šé¢çš„ä¸¤å¥ä¸­ï¼Œä½¿ç”¨äº†v0æœ¬åœ°å¯„å­˜å™¨ï¼Œå¹¶æŠŠå€¼0x0å­˜åˆ°v0ä¸­ï¼Œç„¶åç¬¬äºŒå¥ç”¨<code>iput-boolean</code>è¿™ä¸ªæŒ‡ä»¤æŠŠv0ä¸­çš„å€¼å­˜æ”¾åˆ°<code>com.disney.WMW.WMWActivity.isRunning</code>è¿™ä¸ªæˆå‘˜å˜é‡ä¸­ã€‚</p><p>å³ç›¸å½“äºï¼š<code>this.isRunning = false;</code>ï¼ˆä¸Šé¢è¯´è¿‡ï¼Œåœ¨éstaticå‡½æ•°ä¸­p0ä»£è¡¨çš„æ˜¯<code>this</code>ï¼Œåœ¨è¿™é‡Œå°±æ˜¯com.disney.WMW.WMWActivityå®ä¾‹ï¼‰ã€‚</p><h4 id="smaliä¸­çš„ç»§æ‰¿ã€æ¥å£ã€åŒ…ä¿¡æ¯"><a href="#smaliä¸­çš„ç»§æ‰¿ã€æ¥å£ã€åŒ…ä¿¡æ¯" class="headerlink" title="smaliä¸­çš„ç»§æ‰¿ã€æ¥å£ã€åŒ…ä¿¡æ¯"></a>smaliä¸­çš„ç»§æ‰¿ã€æ¥å£ã€åŒ…ä¿¡æ¯</h4><pre class="line-numbers language-lang-smali" data-language="lang-smali"><code class="language-lang-smali">.class public Lcom/disney/WMW/WMWActivity; .super Lcom/disney/common/BaseActivity;.source "WMWActivity.java"# interfaces.implements Lcom/burstly/lib/ui/IBurstlyAdListener;# annotations.annotation system Ldalvik/annotation/MemberClasses;    value = {        Lcom/disney/WMW/WMWActivity$MessageHandler;,        Lcom/disney/WMW/WMWActivity$FinishActivityArgs;    }.end annotation<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬1è¡Œ: <code>.class</code> æ˜¯com.disney.WMWè¿™ä¸ªpackageä¸‹çš„ä¸€ä¸ªç±»</p><p>ç¬¬2è¡Œ: <code>.super</code> ç»§æ‰¿è‡ªcom.disney.common.BaseActivity</p><p>ç¬¬3è¡Œ: <code>.source</code> æ˜¯ä¸€ä¸ªç”±WMWActivity.javaç¼–è¯‘å¾—åˆ°çš„smaliæ–‡ä»¶</p><p>ç¬¬5-6è¡Œ: <code>.implements</code> å®ç°äº†ä¸€ä¸ªcom.burstly.lib.uiè¿™ä¸ªpackageä¸‹ï¼ˆä¸€ä¸ªå¹¿å‘ŠSDKï¼‰çš„IBurstyAdListeneræ¥å£</p><p>ç¬¬8-14è¡Œ: å®šä¹‰äº†å†…éƒ¨ç±»ï¼šå®ƒæœ‰ä¸¤ä¸ªæˆå‘˜å†…éƒ¨ç±»â€”â€”MessageHandlerå’ŒFinishActivityArgsï¼Œå†…éƒ¨ç±»å°†åœ¨åé¢å°èŠ‚ä¸­ä¼šæœ‰æåŠ</p><p>æ‰€ä»¥å¯¹åº”çš„Javaä»£ç å¤§æ¦‚æ˜¯è¿™æ ·ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">WMWActivity</span> <span class="token keyword">extends</span> <span class="token class-name">BaseActivity</span> <span class="token keyword">implements</span> <span class="token class-name">IBurstlyAdListener</span><span class="token punctuation">{</span>    <span class="token comment">//...</span>    <span class="token keyword">class</span> <span class="token class-name">MessageHandler</span> <span class="token punctuation">{</span>        <span class="token comment">//...</span>    <span class="token punctuation">}</span>    <span class="token keyword">class</span> <span class="token class-name">FinishActivityArgs</span><span class="token punctuation">{</span>        <span class="token comment">//...</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="smaliä¸­çš„æˆå‘˜å˜é‡"><a href="#smaliä¸­çš„æˆå‘˜å˜é‡" class="headerlink" title="smaliä¸­çš„æˆå‘˜å˜é‡"></a>smaliä¸­çš„æˆå‘˜å˜é‡</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"># <span class="token keyword">static</span> fields<span class="token punctuation">.</span>field <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token constant">PREFS_INSTALLATION_ID</span><span class="token operator">:</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span><span class="token punctuation">;</span> <span class="token operator">=</span> <span class="token string">"installationId"</span><span class="token comment">//...</span># instance fields<span class="token punctuation">.</span>field <span class="token keyword">private</span> _activityPackageName<span class="token operator">:</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span><span class="token punctuation">;</span><span class="token comment">//...</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šé¢å®šä¹‰çš„<code>static fields</code>å’Œ<code>instance fields</code>å‡ä¸ºæˆå‘˜å˜é‡ï¼Œæ ¼å¼æ˜¯ï¼š</p><pre class="line-numbers language-none"><code class="language-none">.field public/private [static] [final] varName:&lt;ç±»å‹&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶è€Œstatic fieldså’Œinstance fieldsè¿˜æ˜¯æœ‰åŒºåˆ«çš„ï¼Œå½“ç„¶åŒºåˆ«å¾ˆæ˜æ˜¾ï¼Œé‚£å°±æ˜¯static fieldsæ˜¯staticçš„ï¼Œè€Œinstanceåˆ™ä¸æ˜¯ã€‚</p><p>æ ¹æ®è¿™ä¸ªåŒºåˆ«æ¥è·å–è¿™äº›ä¸åŒçš„æˆå‘˜å˜é‡æ—¶ä¹Ÿæœ‰ä¸åŒçš„æŒ‡ä»¤ã€‚</p><p>è·å–çš„æŒ‡ä»¤æœ‰ï¼š<code>iget/sget</code>ã€<code>iget-boolean/sget-boolean</code>ã€<code>iget-object/sget-object</code>ç­‰ï¼Œ</p><p>æ“ä½œçš„æŒ‡ä»¤æœ‰ï¼š<code>iput/sput</code>ã€<code>iput-boolean/sput-boolean</code>ã€<code>iput-object/sput-object</code>ç­‰ã€‚</p><p>æ²¡æœ‰â€œ-objectâ€åç¼€çš„è¡¨ç¤ºæ“ä½œçš„æˆå‘˜å˜é‡å¯¹è±¡æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå¸¦â€œ-objectâ€è¡¨ç¤ºæ“ä½œçš„æˆå‘˜å˜é‡æ˜¯å¯¹è±¡ç±»å‹ï¼Œç‰¹åˆ«åœ°ï¼Œbooleanç±»å‹åˆ™ä½¿ç”¨å¸¦â€œ-booleanâ€çš„æŒ‡ä»¤æ“ä½œã€‚</p><h5 id="è·å–static-fieldsæŒ‡ä»¤ç¤ºä¾‹"><a href="#è·å–static-fieldsæŒ‡ä»¤ç¤ºä¾‹" class="headerlink" title="è·å–static fieldsæŒ‡ä»¤ç¤ºä¾‹"></a>è·å–static fieldsæŒ‡ä»¤ç¤ºä¾‹</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java">sget<span class="token operator">-</span>object v0<span class="token punctuation">,</span> <span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span><span class="token constant">WMW</span><span class="token operator">/</span><span class="token class-name">WMWActivity</span><span class="token punctuation">;</span><span class="token operator">-&gt;</span><span class="token constant">PREFS_INSTALLATION_ID</span><span class="token operator">:</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>sget-object</code> å°±æ˜¯ç”¨æ¥è·å–å˜é‡å€¼å¹¶ä¿å­˜åˆ°ç´§æ¥ç€çš„<code>æœ¬åœ°å¯„å­˜å™¨</code>ä¸­ï¼Œåœ¨è¿™é‡Œï¼ŒæŠŠä¸Šé¢å‡ºç°çš„<code>PREFS_INSTALLATION_ID</code>è¿™ä¸ªStringæˆå‘˜å˜é‡è·å–å¹¶æ”¾åˆ°v0å¯„å­˜å™¨ä¸­ï¼Œ<strong>æ³¨æ„ï¼šå‰é¢éœ€è¦è¯¥å˜é‡æ‰€å±çš„ç±»çš„ç±»å‹ï¼Œåé¢éœ€è¦åŠ ä¸€ä¸ªå†’å·å’Œè¯¥æˆå‘˜å˜é‡çš„ç±»å‹</strong>ï¼Œä¸­é—´æ˜¯ <code>-&gt;</code> è¡¨ç¤ºæ‰€å±å…³ç³»ã€‚</p><h5 id="è·å–instance-fieldsæŒ‡ä»¤ç¤ºä¾‹"><a href="#è·å–instance-fieldsæŒ‡ä»¤ç¤ºä¾‹" class="headerlink" title="è·å–instance fieldsæŒ‡ä»¤ç¤ºä¾‹"></a>è·å–instance fieldsæŒ‡ä»¤ç¤ºä¾‹</h5><p>æŒ‡ä»¤ä¸static fieldsçš„åŸºæœ¬ä¸€æ ·ï¼Œåªæ˜¯ç”±äºä¸æ˜¯staticå˜é‡ï¼Œä¸èƒ½ä»…ä»…æŒ‡å‡ºè¯¥å˜é‡æ‰€åœ¨ç±»çš„ç±»å‹ï¼Œè¿˜éœ€è¦è¯¥å˜é‡æ‰€åœ¨ç±»çš„å®ä¾‹ã€‚çœ‹ä¾‹å­ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">iget<span class="token operator">-</span>object v0<span class="token punctuation">,</span> p0<span class="token punctuation">,</span> <span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span><span class="token constant">WMW</span><span class="token operator">/</span><span class="token class-name">WMWActivity</span><span class="token punctuation">;</span><span class="token operator">-&gt;</span>_view<span class="token operator">:</span><span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span>common<span class="token operator">/</span><span class="token class-name">WMWView</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°<code>iget-object</code>æŒ‡ä»¤æ¯”<code>sget-object</code>å¤šäº†ä¸€ä¸ªå‚æ•°ï¼Œå°±æ˜¯è¯¥å˜é‡æ‰€åœ¨ç±»çš„å®ä¾‹ï¼Œåœ¨è¿™é‡Œå°±æ˜¯p0å³<code>this</code>ã€‚</p><h5 id="è·å–arrayæŒ‡ä»¤-agetå’Œaget-object"><a href="#è·å–arrayæŒ‡ä»¤-agetå’Œaget-object" class="headerlink" title="è·å–arrayæŒ‡ä»¤: agetå’Œaget-object"></a>è·å–arrayæŒ‡ä»¤: agetå’Œaget-object</h5><p>æŒ‡ä»¤ä½¿ç”¨å’Œä¸Šè¿°ç±»ä¼¼ï¼Œä¸ç»†è¿°ã€‚</p><h5 id="putæŒ‡ä»¤ä½¿ç”¨å’ŒgetæŒ‡ä»¤ç›¸ä¼¼"><a href="#putæŒ‡ä»¤ä½¿ç”¨å’ŒgetæŒ‡ä»¤ç›¸ä¼¼" class="headerlink" title="putæŒ‡ä»¤ä½¿ç”¨å’ŒgetæŒ‡ä»¤ç›¸ä¼¼"></a>putæŒ‡ä»¤ä½¿ç”¨å’ŒgetæŒ‡ä»¤ç›¸ä¼¼</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">const</span><span class="token operator">/</span><span class="token number">4</span> v3<span class="token punctuation">,</span> <span class="token number">0x0</span>sput<span class="token operator">-</span>object v3<span class="token punctuation">,</span> <span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span><span class="token constant">WMW</span><span class="token operator">/</span><span class="token class-name">WMWActivity</span><span class="token punctuation">;</span><span class="token operator">-&gt;</span>globalIapHandler<span class="token operator">:</span><span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span>config<span class="token operator">/</span><span class="token class-name">GlobalPurchaseHandler</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç›¸å½“äºï¼š<code>this.globalIapHandler = null;</code>ï¼ˆnull = 0x0ï¼‰</p><pre class="line-numbers language-lang-java" data-language="lang-java"><code class="language-lang-java">.local v0, wait:Landroid/os/Message;const/4 v1, 0x2iput v1, v0, Landroid/os/Message;-&gt;what:I<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç›¸å½“äºï¼š<code>wait.what = 0x2;</code>ï¼ˆwaitæ˜¯Messageçš„å®ä¾‹ï¼‰</p><h4 id="smaliä¸­çš„å‡½æ•°è°ƒç”¨"><a href="#smaliä¸­çš„å‡½æ•°è°ƒç”¨" class="headerlink" title="smaliä¸­çš„å‡½æ•°è°ƒç”¨"></a>smaliä¸­çš„å‡½æ•°è°ƒç”¨</h4><p>smaliä¸­çš„å‡½æ•°å’Œæˆå‘˜å˜é‡ä¸€æ ·ä¹Ÿåˆ†ä¸ºä¸¤ç§ç±»å‹ï¼Œä½†æ˜¯ä¸åŒæˆå‘˜å˜é‡ä¸­çš„<code>staticå’Œinstanceä¹‹åˆ†</code>ï¼Œè€Œæ˜¯<code>directå’Œvirtualä¹‹åˆ†</code>ã€‚é‚£ä¹ˆdirect methodå’Œvirtual methodæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p><p>ç›´ç™½åœ°è®²ï¼Œdirect methodå°±æ˜¯<code>privateå‡½æ•°</code>ï¼Œå…¶ä½™çš„<code>publicå’Œprotectedå‡½æ•°</code>éƒ½å±äºvirtual methodã€‚æ‰€ä»¥åœ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œæœ‰<code>invoke-direct</code>ï¼Œ<code>invoke-virtual</code>ï¼Œå¦å¤–è¿˜æœ‰<code>invoke-static</code>ã€<code>invoke-super</code>ä»¥åŠ<code>invoke-interface</code>ç­‰å‡ ç§ä¸åŒçš„æŒ‡ä»¤ã€‚å½“ç„¶å…¶å®è¿˜æœ‰<code>invoke-XXX/range</code>æŒ‡ä»¤çš„ï¼Œè¿™æ˜¯å‚æ•°å¤šäº4ä¸ªçš„æ—¶å€™è°ƒç”¨çš„æŒ‡ä»¤ï¼Œæ¯”è¾ƒå°‘è§ï¼Œäº†è§£ä¸‹å³å¯ã€‚</p><h5 id="invoke-static"><a href="#invoke-static" class="headerlink" title="invoke-static"></a>invoke-static</h5><p>é¡¾åæ€ä¹‰å°±æ˜¯è°ƒç”¨staticå‡½æ•°çš„ï¼Œå› ä¸ºæ˜¯staticå‡½æ•°ï¼Œæ‰€ä»¥æ¯”èµ·å…¶ä»–è°ƒç”¨å°‘ä¸€ä¸ªå‚æ•°</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">invoke<span class="token operator">-</span><span class="token keyword">static</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span><span class="token constant">WMW</span><span class="token operator">/</span><span class="token class-name">UnlockHelper</span><span class="token punctuation">;</span><span class="token operator">-&gt;</span><span class="token function">unlockCrankypack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">Z</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™é‡Œæ³¨æ„åˆ°invoke-staticåé¢æœ‰ä¸€å¯¹å¤§æ‹¬å·â€œ{}â€ï¼Œå…¶å®æ˜¯<strong>è°ƒç”¨è¯¥æ–¹æ³•çš„å®ä¾‹+å‚æ•°åˆ—è¡¨</strong>ï¼Œç”±äºè¿™ä¸ªæ–¹æ³•æ—¢ä¸éœ€å‚æ•°ä¹Ÿæ˜¯staticçš„ï¼Œæ‰€ä»¥{}å†…ä¸ºç©ºï¼Œå†çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">const</span><span class="token operator">-</span>string v0<span class="token punctuation">,</span> <span class="token string">"fmodex"</span>invoke<span class="token operator">-</span><span class="token keyword">static</span> <span class="token punctuation">{</span>v0<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">System</span><span class="token punctuation">;</span><span class="token operator">-&gt;</span><span class="token function">loadLibrary</span><span class="token punctuation">(</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">V</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¿™ä¸ªæ˜¯è°ƒç”¨<code>static void System.loadLibrary(String)</code>æ¥åŠ è½½NDKç¼–è¯‘çš„soåº“ç”¨çš„æ–¹æ³•ï¼ŒåŒæ ·ä¹Ÿæ˜¯è¿™é‡Œv0å°±æ˜¯å‚æ•°<code>â€fmodexâ€</code>äº†ã€‚</p><h5 id="invoke-super"><a href="#invoke-super" class="headerlink" title="invoke-super"></a>invoke-super</h5><p>è°ƒç”¨çˆ¶ç±»æ–¹æ³•ç”¨çš„æŒ‡ä»¤ï¼Œåœ¨onCreateã€onDestroyç­‰æ–¹æ³•éƒ½èƒ½çœ‹åˆ°ï¼Œç•¥ã€‚</p><h5 id="invoke-direct"><a href="#invoke-direct" class="headerlink" title="invoke-direct"></a>invoke-direct</h5><p>è°ƒç”¨privateå‡½æ•°çš„ï¼Œä¾‹å¦‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">invoke<span class="token operator">-</span>direct <span class="token punctuation">{</span>p0<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span><span class="token constant">WMW</span><span class="token operator">/</span><span class="token class-name">WMWActivity</span><span class="token punctuation">;</span><span class="token operator">-&gt;</span><span class="token function">getGlobalIapHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span>config<span class="token operator">/</span><span class="token class-name">GlobalPurchaseHandler</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™é‡ŒGlobalPurchaseHandler getGlobalIapHandler()å°±æ˜¯å®šä¹‰åœ¨WMWActivityä¸­çš„ä¸€ä¸ªprivateå‡½æ•°ï¼Œå¦‚æœä¿®æ”¹smaliæ—¶é”™ç”¨invoke-virtualæˆ–invoke-staticå°†åœ¨å›ç¼–è¯‘åç¨‹åºè¿è¡Œæ—¶å¼•å‘ä¸€ä¸ªå¸¸è§çš„VerifyError</p><h5 id="invoke-virtual"><a href="#invoke-virtual" class="headerlink" title="invoke-virtual"></a>invoke-virtual</h5><p>ç”¨äºè°ƒç”¨protectedæˆ–publicå‡½æ•°ï¼ŒåŒæ ·æ³¨æ„ä¿®æ”¹smaliæ—¶ä¸è¦é”™ç”¨invoke-directæˆ–invoke-staticï¼Œä¾‹å­</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">sget<span class="token operator">-</span>object v0<span class="token punctuation">,</span> <span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span><span class="token constant">WMW</span><span class="token operator">/</span><span class="token class-name">WMWActivity</span><span class="token punctuation">;</span><span class="token operator">-&gt;</span>shareHandler<span class="token operator">:</span><span class="token class-name">Landroid</span><span class="token operator">/</span>os<span class="token operator">/</span><span class="token class-name">Handler</span><span class="token punctuation">;</span>invoke<span class="token operator">-</span>virtual <span class="token punctuation">{</span>v0<span class="token punctuation">,</span> v3<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token class-name">Landroid</span><span class="token operator">/</span>os<span class="token operator">/</span><span class="token class-name">Handler</span><span class="token punctuation">;</span><span class="token operator">-&gt;</span><span class="token function">removeCallbacksAndMessages</span><span class="token punctuation">(</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Object</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">V</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>v0æ˜¯shareHandler:Landroid/os/Handlerï¼Œv3æ˜¯ä¼ é€’ç»™removeCallbackAndMessageæ–¹æ³•çš„Ljava/lang/Objectå‚æ•°å°±å¯ä»¥äº†ã€‚</p><h5 id="invoke-xxx-range"><a href="#invoke-xxx-range" class="headerlink" title="invoke-xxx/range"></a>invoke-xxx/range</h5><p>å½“æ–¹æ³•çš„å‚æ•°å¤šäº5ä¸ªæ—¶ï¼ˆå«5ä¸ªï¼‰ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨ä»¥ä¸Šçš„æŒ‡ä»¤ï¼Œè€Œæ˜¯åœ¨åé¢åŠ ä¸Šâ€œ/rangeâ€ï¼Œä½¿ç”¨æ–¹æ³•ä¹Ÿæœ‰æ‰€ä¸åŒï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">invoke<span class="token operator">-</span><span class="token keyword">static</span><span class="token operator">/</span>range <span class="token punctuation">{</span>v0 <span class="token punctuation">.</span><span class="token punctuation">.</span> v5<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token class-name">Lcn</span><span class="token operator">/</span>game189<span class="token operator">/</span>sms<span class="token operator">/</span><span class="token constant">SMS</span><span class="token punctuation">;</span><span class="token operator">-&gt;</span><span class="token function">checkFee</span><span class="token punctuation">(</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span><span class="token punctuation">;</span><span class="token class-name">Landroid</span><span class="token operator">/</span>app<span class="token operator">/</span><span class="token class-name">Activity</span><span class="token punctuation">;</span><span class="token class-name">Lcn</span><span class="token operator">/</span>game189<span class="token operator">/</span>sms<span class="token operator">/</span><span class="token class-name">SMSListener</span><span class="token punctuation">;</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span><span class="token punctuation">;</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span><span class="token punctuation">;</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">Z</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆšæ‰çœ‹åˆ°çš„ä¾‹å­éƒ½æ˜¯â€œè°ƒç”¨å‡½æ•°â€è¿™ä¸ªæ“ä½œè€Œå·²ï¼Œè²Œä¼¼æ²¡æœ‰å–å‡½æ•°è¿”å›çš„ç»“æœçš„æ“ä½œï¼Ÿ</p><p>åœ¨Javaä»£ç ä¸­<code>è°ƒç”¨å‡½æ•°å’Œè¿”å›å‡½æ•°ç»“æœ</code>æ˜¯ä¸€æ¡è¯­å¥å®Œæˆçš„ï¼Œè€Œåœ¨smalié‡Œåˆ™éœ€è¦åˆ†å¼€æ¥å®Œæˆï¼Œåœ¨ä½¿ç”¨ä¸Šè¿°æŒ‡ä»¤åï¼Œå¦‚æœè°ƒç”¨çš„å‡½æ•°è¿”å›évoidï¼Œé‚£ä¹ˆè¿˜éœ€è¦ç”¨åˆ°<code>move-result</code>ï¼ˆè¿”å›åŸºæœ¬æ•°æ®ç±»å‹ï¼‰å’Œ<code>move-result-object</code>ï¼ˆè¿”å›å¯¹è±¡ï¼‰æŒ‡ä»¤ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">const</span><span class="token operator">/</span><span class="token number">4</span> v2<span class="token punctuation">,</span> <span class="token number">0x0</span>invoke<span class="token operator">-</span>virtual <span class="token punctuation">{</span>p0<span class="token punctuation">,</span> v2<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span><span class="token constant">WMW</span><span class="token operator">/</span><span class="token class-name">WMWActivity</span><span class="token punctuation">;</span><span class="token operator">-&gt;</span><span class="token function">getPreferences</span><span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token class-name">Landroid</span><span class="token operator">/</span>content<span class="token operator">/</span><span class="token class-name">SharedPreferences</span><span class="token punctuation">;</span>move<span class="token operator">-</span>result<span class="token operator">-</span>object v1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>v1ä¿å­˜çš„å°±æ˜¯è°ƒç”¨getPreferences(int)æ–¹æ³•è¿”å›çš„SharedPreferenceså®ä¾‹</p><pre class="line-numbers language-lang-java" data-language="lang-java"><code class="language-lang-java">invoke-virtual {v2}, Ljava/lang/String;-&gt;length()Imove-result v2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>v2ä¿å­˜çš„åˆ™æ˜¯è°ƒç”¨String.length()è¿”å›çš„æ•´å‹ã€‚</p><h4 id="smaliä¸­å‡½æ•°å®ä½“åˆ†æ"><a href="#smaliä¸­å‡½æ•°å®ä½“åˆ†æ" class="headerlink" title="smaliä¸­å‡½æ•°å®ä½“åˆ†æ"></a>smaliä¸­å‡½æ•°å®ä½“åˆ†æ</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token punctuation">.</span>method <span class="token keyword">protected</span> <span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">V</span>    <span class="token punctuation">.</span>locals <span class="token number">0</span>    <span class="token punctuation">.</span>prologue    <span class="token punctuation">.</span>line <span class="token number">277</span>    invoke<span class="token operator">-</span><span class="token keyword">super</span> <span class="token punctuation">{</span>p0<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token class-name">Lcom</span><span class="token operator">/</span>disney<span class="token operator">/</span>common<span class="token operator">/</span><span class="token class-name">BaseActivity</span><span class="token punctuation">;</span><span class="token operator">-&gt;</span><span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">V</span>    <span class="token punctuation">.</span>line <span class="token number">279</span>    <span class="token keyword">return</span><span class="token operator">-</span><span class="token keyword">void</span><span class="token punctuation">.</span>end method<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ˜¯<code>onDestroy()</code>å‡½æ•°ï¼Œå®ƒçš„ä½œç”¨å¤§å®¶éƒ½çŸ¥é“ã€‚é¦–å…ˆçœ‹åˆ°å‡½æ•°å†…ç¬¬ä¸€å¥ï¼š<code>.local 0</code>ï¼Œè¿™å¥è¯å¾ˆé‡è¦ï¼Œæ ‡æ˜äº†ä½ åœ¨è¿™ä¸ªå‡½æ•°ä¸­<code>æœ€å°‘è¦ç”¨åˆ°çš„æœ¬åœ°å¯„å­˜å™¨çš„ä¸ªæ•°</code>ã€‚è¿™é‡Œç”±äºåªéœ€è¦è°ƒç”¨ä¸€ä¸ª<code>çˆ¶ç±»çš„onDestroy()</code>å¤„ç†ï¼Œæ‰€ä»¥åªéœ€è¦ç”¨åˆ°p0ï¼Œæ‰€ä»¥ä½¿ç”¨åˆ°çš„æœ¬åœ°å¯„å­˜å™¨æ•°ä¸º0ã€‚å¦‚æœä¸æ¸…æ¥šè¿™ä¸ªè§„åˆ™ï¼Œå¾ˆå®¹æ˜“åœ¨æ¤å…¥ä»£ç å<code>å¿˜è®°ä¿®æ”¹.local</code> çš„å€¼ï¼Œé‚£ä¹ˆå›ç¼–è¯‘åè¿è¡Œæ—¶å°†ä¼šå¾—åˆ°ä¸€ä¸ªVerifyErroré”™è¯¯ï¼Œè€Œä¸”æéš¾å‘ç°é—®é¢˜æ‰€åœ¨ã€‚æˆ‘æ­£æ˜¯è¢«è¿™ä¸ªé—®é¢˜å›°æ‰°äº†å¾ˆå¤šæ¬¡ï¼Œæœ€åç ”ç©¶å‘ç°.localçš„å€¼æœ‰è¿™ä¸ªè§„å¾‹ï¼Œäºæ˜¯åœ¨æ–‡æ¡£æŸ¥è¯äº†ä¸€ä¸‹æœç„¶æ˜¯è¿™ä¸ªé—®é¢˜ã€‚ä¾‹å¦‚æˆ‘å¾€<code>onDestroy()</code>å¢åŠ ä¸€å¥ï¼š<code>this.existed = true;</code> é‚£ä¹ˆåº”è¯¥æ”¹ä¸ºï¼ˆæ³¨æ„ä¿®æ”¹.localçš„å€¼ä¸º1â€”â€”ä½¿ç”¨åˆ°äº†v0è¿™ä¸€ä¸ªæœ¬åœ°å¯„å­˜å™¨ï¼‰ï¼š</p><pre class="line-numbers language-lang-java" data-language="lang-java"><code class="language-lang-java">.method protected onDestroy()V    .locals 1    .prologue    .line 277    const/4 v0, 0x1    iput-boolean v0, p0, Lcom/disney/WMW/WMWActivity;-&gt;exited:Z    invoke-super {p0}, Lcom/disney/common/BaseActivity;-&gt;onDestroy()V    .line 279    return-void.end method<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦å¤–æ³¨æ„åˆ°<code>.line</code>è¿™ä¸ªæ ‡è¯†ï¼Œå®ƒæ˜¯æ ‡æ³¨äº†è¯¥ä»£ç åœ¨<code>åŸJavaæ–‡ä»¶ä¸­çš„è¡Œæ•°</code>ï¼ŒDalvik VMè¿è¡Œåˆ°<code>.line XX</code>æ—¶å°±å°†è¿™ä¸ªå€¼å­˜èµ·æ¥ï¼Œå¦‚æœåœ¨è¿™ä¸€è¡Œè¿è¡Œæ—¶å‡ºé”™äº†ï¼Œå°±å¾€catLogè¾“å‡ºè¿™ä¸ªå€¼ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½çœ‹åˆ°å…·ä½“æ˜¯å“ªä¸€è¡Œçš„é—®é¢˜äº†ã€‚</p><h3 id="smaliæ’æ¡©"><a href="#smaliæ’æ¡©" class="headerlink" title="smaliæ’æ¡©"></a>smaliæ’æ¡©</h3><p>ä½•ä¸ºæ’æ¡©ï¼Œå¼•ç”¨ä¸€ä¸‹wikiçš„è§£é‡Šï¼šç¨‹åºæ’æ¡©ï¼Œæœ€æ—©æ˜¯ç”±J.C. Huang æ•™æˆæå‡ºçš„ï¼Œå®ƒæ˜¯åœ¨ä¿è¯è¢«æµ‹ç¨‹åºåŸæœ‰é€»è¾‘å®Œæ•´æ€§çš„åŸºç¡€ä¸Šåœ¨ç¨‹åºä¸­æ’å…¥ä¸€äº›æ¢é’ˆï¼ˆåˆç§°ä¸ºâ€œæ¢æµ‹ä»ªâ€ï¼‰ï¼Œé€šè¿‡æ¢é’ˆçš„æ‰§è¡Œå¹¶æŠ›å‡ºç¨‹åºè¿è¡Œçš„ç‰¹å¾æ•°æ®ï¼Œé€šè¿‡å¯¹è¿™äº›æ•°æ®çš„åˆ†æï¼Œå¯ä»¥è·å¾—ç¨‹åºçš„æ§åˆ¶æµå’Œæ•°æ®æµä¿¡æ¯ï¼Œè¿›è€Œå¾—åˆ°é€»è¾‘è¦†ç›–ç­‰åŠ¨æ€ä¿¡æ¯ï¼Œä»è€Œå®ç°æµ‹è¯•ç›®çš„çš„æ–¹æ³•ã€‚</p><p>æ’æ¡©æ€è·¯æ˜¯ï¼Œæ¯”å¦‚æœ‰äº›åº”ç”¨ä¸ºé˜²æ­¢è¢«ä¿®æ”¹ï¼Œä¼šåœ¨å¼€å¯çš„æ—¶å€™æ£€æŸ¥ç­¾åï¼Œç­¾åç»“æœä¸ºfalseçš„æ—¶å€™å°±ä¼šé€€å‡ºåº”ç”¨ã€‚æ‰€ä»¥å°±è¦å®šä½æ£€æŸ¥çš„å‡½æ•°ï¼Œç„¶åé€šè¿‡logæŠŠç›®æ ‡å€¼æ‰“å°å‡ºæ¥ã€‚</p><ol><li><p>å†™ä¸€ä¸ªæ‰“å°logçš„é™æ€ç±»</p></li><li><p>å°†å…¶è½¬æ¢æˆsmaliæ–‡ä»¶</p></li><li><p>æŠŠæ–‡ä»¶æ”¾å…¥å·¥ç¨‹é‡Œ</p></li><li><p>åœ¨è¦æ‰“å°logçš„åœ°æ–¹æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">invoke<span class="token operator">-</span><span class="token keyword">static</span> <span class="token punctuation">{</span>v1<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token class-name">Lcom</span><span class="token operator">/</span>softard<span class="token operator">/</span><span class="token class-name">MyLog</span><span class="token punctuation">;</span><span class="token operator">-&gt;</span><span class="token class-name">Log</span><span class="token punctuation">(</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Object</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">V</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>é‡æ–°æ‰“åŒ…APKï¼Œè¿è¡Œï¼Œå°±å¯ä»¥çœ‹åˆ°æ‰“å°ç»“æœ</p></li></ol><p>è¡¥å……ä¸€ä»½å®ä¾‹ï¼šå…ˆå†™ä¸€ä¸ªLogç±»ï¼š</p><pre class="line-numbers language-lang-java" data-language="lang-java"><code class="language-lang-java">package com.softard.xxxx;import android.util.Log;public class LogUtil {    public static final String TAG = "WOW";    public static void print() {        Log.d(TAG, "Code running in here.");    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åAndroid Studioå°†javaä»£ç è½¬æ¢æˆ<code>smali</code></p><pre class="line-numbers language-lang-smali" data-language="lang-smali"><code class="language-lang-smali">.class public Lcom/softard/xxxx/LogUtil;.super Ljava/lang/Object;.source "LogUtil.java"# static fields.field public static final TAG:Ljava/lang/String; = "WOW"# direct methods.method public constructor ()V    .registers 1    .prologue    .line 10    invoke-direct {p0}, Ljava/lang/Object;-&gt;()V    return-void.end method.method public static print()V    .registers 2    .prologue    .line 14    const-string v0, "WOW"    const-string v1, "Code running in here."    invoke-static {v0, v1}, Landroid/util/Log;-&gt;d(Ljava/lang/String;Ljava/lang/String;)I    .line 15    return-void.end method<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åæŠŠ<code>LogUtil.smali</code>æ–‡ä»¶æ”¾åˆ°åç¼–è¯‘åçš„<code>smali</code>æ–‡ä»¶å¤¹ä¸‹çš„æ ¹ç›®å½•ã€‚æ”¾æ ¹ç›®å½•æ˜¯ä¸ºäº†ç»•è¿‡åŒ…åçš„å½±å“ï¼Œæ–¹ä¾¿è°ƒç”¨ï¼Œæ‰€ä»¥<code>LogUtil.smali</code>æ–‡ä»¶çš„åŒ…åè¦å»æ‰ï¼š</p><pre class="line-numbers language-lang-smali" data-language="lang-smali"><code class="language-lang-smali">.class public Lcom/softard/xxxx/LogUtil; -&gt; .class public LLogUtil;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶ååœ¨ç›®æ ‡ä½ç½®è°ƒç”¨æ‰“å°æ–¹æ³•ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">invoke<span class="token operator">-</span>virtual <span class="token punctuation">{</span>p1<span class="token punctuation">,</span> v0<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token class-name">Landroid</span><span class="token operator">/</span>view<span class="token operator">/</span><span class="token class-name">View</span><span class="token punctuation">;</span><span class="token operator">-&gt;</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token class-name">Landroid</span><span class="token operator">/</span>view<span class="token operator">/</span><span class="token class-name">View</span>$<span class="token class-name">OnClickListener</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">V</span>invoke<span class="token operator">-</span><span class="token keyword">static</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token class-name">LLogUtil</span><span class="token punctuation">;</span><span class="token operator">-&gt;</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">V</span>  <span class="token operator">&lt;</span><span class="token operator">-</span>åœ¨æ­¤è°ƒç”¨<span class="token punctuation">.</span>line <span class="token number">51</span>invoke<span class="token operator">-</span><span class="token keyword">static</span> <span class="token punctuation">{</span>p0<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token class-name">Lcom</span><span class="token operator">/</span>softard<span class="token operator">/</span>rxdemo<span class="token operator">/</span>demo<span class="token operator">/</span><span class="token class-name">Chapter9</span><span class="token punctuation">;</span><span class="token operator">-&gt;</span><span class="token function">practice1</span><span class="token punctuation">(</span><span class="token class-name">Landroid</span><span class="token operator">/</span>content<span class="token operator">/</span><span class="token class-name">Context</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">V</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>åŠ ä»£ç çš„æ—¶å€™è¦æ³¨æ„ï¼Œè¦æ‰¾å¯¹åœ°æ–¹åŠ ï¼Œå°±æ˜¯åœ¨ä¸Šä¸ªæ–¹æ³•è°ƒç”¨å®Œåæ·»åŠ ï¼Œæ¯”å¦‚<code>invoke-virtual</code> <code>invoke-static</code>ç­‰ã€‚è€Œä¸”è¿™äº›æŒ‡ä»¤åé¢ä¸èƒ½æœ‰<code>move-result-object</code>ï¼Œå› ä¸ºè¿™ä¸ªæŒ‡ä»¤æ˜¯è·å–æ–¹æ³•çš„è¿”å›å€¼ï¼Œæ‰€ä»¥ä¸€èˆ¬è¿™ä¹ˆåŠ ä»£ç ï¼š</p><ul><li>åœ¨invoke-static/invoke-virtual æŒ‡ä»¤è¿”å›ç±»å‹æ˜¯<code>V</code>ä¹‹åå¯ä»¥åŠ å…¥</li><li>åœ¨invoke-static/invoke-virtual æŒ‡ä»¤è¿”å›ç±»å‹ä¸æ˜¯<code>V</code>ï¼Œé‚£ä¹ˆåœ¨<code>move-result-object</code>å‘½ä»¤ä¹‹åå¯ä»¥åŠ å…¥</li></ul></blockquote><p>ç„¶åæ‰“åŒ…ç­¾åå®‰è£…è¿è¡Œï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬è¦çš„log</p><pre class="line-numbers language-lang-txt" data-language="lang-txt"><code class="language-lang-txt">&gt; adb logcat -s WOW16:12:55.443 26400 26400 D WOW     : Code running in here.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="smaliä¿®æ”¹"><a href="#smaliä¿®æ”¹" class="headerlink" title="smaliä¿®æ”¹"></a>smaliä¿®æ”¹</h3><p>ä¸€èˆ¬ä¸ä¼šå¤§é‡ä¿®æ”¹ä»£ç ï¼Œè€Œæ˜¯ä¼šæ”¹ä¸€äº›å…³é”®é€»è¾‘ã€‚æ¯”å¦‚ifï¼Œæœ‰æ—¶å€™ä¿®æ”¹ä¸€ä¸ªåˆ¤æ–­å°±å¯ä»¥è¾¾åˆ°é€»è¾‘è·³è½¬çš„ç›®çš„ã€‚</p><pre class="line-numbers language-lang-java" data-language="lang-java"><code class="language-lang-java">if-eq vA, VB, cond_** å¦‚æœvAç­‰äºvBåˆ™è·³è½¬åˆ°cond_**ã€‚ç›¸å½“äºif (vA==vB)if-ne vA, VB, cond_** å¦‚æœvAä¸ç­‰äºvBåˆ™è·³è½¬åˆ°cond_**ã€‚ç›¸å½“äºif (vA!=vB)if-lt vA, VB, cond_** å¦‚æœvAå°äºvBåˆ™è·³è½¬åˆ°cond_**ã€‚ç›¸å½“äºif (vAvB)if-ge vA, VB, cond_** å¦‚æœvAå¤§äºç­‰äºvBåˆ™è·³è½¬åˆ°cond_**ã€‚ç›¸å½“äºif (vA&gt;=vB)if-eqz vA, :cond_** å¦‚æœvAç­‰äº0åˆ™è·³è½¬åˆ°:cond_** ç›¸å½“äºif (VA==0)if-nez vA, :cond_** å¦‚æœvAä¸ç­‰äº0åˆ™è·³è½¬åˆ°:cond_**ç›¸å½“äºif (VA!=0)if-ltz vA, :cond_** å¦‚æœvAå°äº0åˆ™è·³è½¬åˆ°:cond_**ç›¸å½“äºif (VA&lt;0)if-lez vA, :cond_** å¦‚æœvAå°äºç­‰äº0åˆ™è·³è½¬åˆ°:cond_**ç›¸å½“äºif (VA&lt;=0)if-gtz vA, :cond_** å¦‚æœvAå¤§äº0åˆ™è·³è½¬åˆ°:cond_**ç›¸å½“äºif (VA&gt;0)if-gez vA, :cond_** å¦‚æœvAå¤§äºç­‰äº0åˆ™è·³è½¬åˆ°:cond_**ç›¸å½“äºif (VA&gt;=0)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸å»ºè®®åœ¨ç¨‹åºåŸæœ‰çš„æ–¹æ³•ä¸Šå¢åŠ å¤§é‡é€»è¾‘ï¼Œè¿™æ ·å¯èƒ½ä¼šå‡ºç°å¾ˆå¤šå¯„å­˜å™¨æ–¹é¢çš„é”™è¯¯å¯¼è‡´ç¼–è¯‘å¤±è´¥ã€‚æ¯”è¾ƒå¥½çš„æ–¹æ³•æ˜¯ï¼š</p><ol><li>æŠŠæƒ³è¦å¢åŠ çš„é€»è¾‘å…ˆç”¨javaå†™æˆä¸€ä¸ªapk</li><li>ç„¶åæŠŠè¿™ä¸ªapkåç¼–è¯‘æˆsmaliæ–‡ä»¶ï¼ŒéšåæŠŠåç¼–è¯‘åçš„è¿™éƒ¨åˆ†é€»è¾‘çš„smaliæ–‡ä»¶æ’å…¥åˆ°ç›®æ ‡ç¨‹åºçš„smaliæ–‡ä»¶å¤¹ä¸­</li><li>ç„¶åå†åœ¨åŸæ¥çš„æ–¹æ³•ä¸Šé‡‡ç”¨invokeçš„æ–¹å¼è°ƒç”¨æ–°åŠ å…¥çš„é€»è¾‘ã€‚è¿™æ ·çš„è¯ä¸ç®¡åŠ å…¥å†å¤šçš„é€»è¾‘ï¼Œä¹Ÿåªæ˜¯ä¿®æ”¹äº†åŸç¨‹åºçš„å‡ è¡Œä»£ç è€Œå·²ã€‚</li></ol><h2 id="æ±‡ç¼–ARMæŒ‡ä»¤"><a href="#æ±‡ç¼–ARMæŒ‡ä»¤" class="headerlink" title="æ±‡ç¼–ARMæŒ‡ä»¤"></a>æ±‡ç¼–ARMæŒ‡ä»¤</h2><h3 id="ARMæŒ‡ä»¤ä¸­å¯»å€æ–¹å¼"><a href="#ARMæŒ‡ä»¤ä¸­å¯»å€æ–¹å¼" class="headerlink" title="ARMæŒ‡ä»¤ä¸­å¯»å€æ–¹å¼"></a>ARMæŒ‡ä»¤ä¸­å¯»å€æ–¹å¼</h3><ul><li><p>ç«‹å³æ•°å¯»å€</p><p>ä¹Ÿå«ç«‹å³å¯»å€ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šå¯»å€æ–¹å¼ã€‚æ“ä½œæ•°æœ¬èº«åŒ…å«åœ¨æŒ‡ä»¤ä¸­ï¼Œåªè¦å–å‡ºæŒ‡ä»¤ä¹Ÿå°±å–åˆ°äº†æ“ä½œæ•°ï¼Œè¯¥æ“ä½œæ•°å«ç«‹å³æ•°ï¼Œå¯¹åº”å¯»å€æ–¹å¼å«åšç«‹å³å¯»å€ã€‚</p></li></ul><pre class="line-numbers language-none"><code class="language-none">MOV R0, #64; R0â†64<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p>å¯„å­˜å™¨å¯»å€</p><p>åˆ©ç”¨å¯„å­˜å™¨ä¸­çš„æ•°å€¼ä½œä¸ºæ“ä½œæ•°ï¼Œä¹Ÿç§°ä¸ºå¯„å­˜å™¨ç›´æ¥å¯»å€ã€‚</p></li></ul><pre class="line-numbers language-none"><code class="language-none">ADD R0, R1, R2; R0â†R1+R2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p>å¯„å­˜å™¨é—´æ¥å¯»å€</p><p>æŠŠå¯„å­˜å™¨ä¸­çš„å€¼ä½œä¸ºåœ°å€ï¼Œé€šè¿‡è¿™ä¸ªåœ°å€å»å–å¾—æ“ä½œæ•°ï¼Œæ“ä½œæ•°æœ¬èº«å­˜æ”¾åœ¨å­˜å‚¨å™¨ä¸­ã€‚</p></li></ul><pre class="line-numbers language-none"><code class="language-none">LDR R0,[R1]; R0â†[R1]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p>å¯„å­˜å™¨åç§»å¯»å€</p><p>è¿™æ˜¯ARMæŒ‡ä»¤é›†ç‰¹æœ‰çš„å¯»å€æ–¹å¼ï¼Œå®ƒæ˜¯åœ¨å¯„å­˜å™¨å¯»å€å¾—åˆ°æ“ä½œæ•°åå†è¿›è¡Œä½ç§»æ“ä½œï¼Œå¾—åˆ°æœ€ç»ˆæ“ä½œæ•°ã€‚</p></li></ul><pre class="line-numbers language-none"><code class="language-none">MOV R0,R2,LSL #3; R0â†R2*8, R2çš„å€¼å·¦ç§»3ä½ï¼Œç»“æœèµ‹å€¼ç»™R0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p>å¯„å­˜å™¨åŸºå€å˜å€å¯»å€</p><p>æ˜¯åœ¨å¯„å­˜å™¨é—´æ¥å¯»å€çš„åŸºç¡€ä¸Šæ‰©å±•æ¥çš„ã€‚å®ƒå°†å¯„å­˜å™¨ä¸­çš„å€¼ä¸æŒ‡ä»¤ä¸­ç»™å‡ºçš„åœ°å€åç§»é‡ç›¸åŠ ï¼Œä»è€Œå¾—åˆ°ä¸€ä¸ªåœ°å€ï¼Œé€šè¿‡è¿™ä¸ªåœ°å€å–å¾—æ“ä½œæ•°ã€‚</p></li></ul><pre class="line-numbers language-none"><code class="language-none">LDR R0,[R1, #4]; R0â†[R1+4] å°†R1çš„å†…å®¹åŠ ä¸Š4å½¢æˆæ“ä½œæ•°åœ°å€ï¼Œå–å¾—çš„æ“ä½œæ•°å­˜å…¥å¯„å­˜å™¨R0ä¸­<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p>å¤šå¯„å­˜å™¨å¯»å€</p><p>å¯ä»¥ä¸€æ¬¡å®Œæˆå¤šä¸ªå¯„å­˜å™¨å€¼çš„ä¼ é€</p></li></ul><pre class="line-numbers language-none"><code class="language-none">LDMIA R0,{R1,R2,R3,R4}; R1â†[R0], R2â†[R0+4], R3â†[R0+8], R4â†[R0+12]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p>å †æ ˆå¯»å€</p><p>å †æ ˆæŒ‰å…ˆè¿›åå‡ºå·¥ä½œï¼Œä½¿ç”¨å †æ ˆæŒ‡é’ˆSPæŒ‡ç¤ºå½“å‰çš„æ“ä½œä½ç½®ï¼Œå †æ ˆæŒ‡é’ˆæ€»æ˜¯æŒ‡å‘æ ˆé¡¶</p></li></ul><pre class="line-numbers language-none"><code class="language-none">STMFD SP!, {R1 - R7, LR} å°†R1-R7 LRå‹å…¥å †æ ˆã€‚æ»¡é€’å‡å †æ ˆLDMED SP!,{R1 - R7, LR} å°†å †æ ˆä¸­çš„æ•°æ®å–å›åˆ°R1-R7ï¼ŒLRå¯„å­˜å™¨ã€‚ç©ºé€’å‡å †æ ˆ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="ARMä¸­å¯„å­˜å™¨"><a href="#ARMä¸­å¯„å­˜å™¨" class="headerlink" title="ARMä¸­å¯„å­˜å™¨"></a>ARMä¸­å¯„å­˜å™¨</h3><ul><li><strong>R0-R3</strong>: ç”¨äºå‡½æ•°å‚æ•°åŠè¿”å›å€¼çš„ä¼ é€’</li><li><strong>R4-R6,R8,R10-R11</strong>: æ²¡æœ‰ç‰¹æ®Šè§„å®šï¼Œå°±æ˜¯æ™®é€šçš„é€šç”¨å¯„å­˜å™¨</li><li><strong>R7</strong>: æ ˆå¸§æŒ‡é’ˆï¼ˆFrame Pointerï¼‰æŒ‡å‘å‰ä¸€ä¸ªä¿å­˜çš„æ ˆå¸§å’Œé“¾æ¥å¯„å­˜å™¨ï¼ˆlink register lrï¼‰åœ¨æ ˆä¸Šçš„åœ°å€</li><li><strong>R9</strong>: æ“ä½œç³»ç»Ÿä¿ç•™</li><li><strong>R12</strong>: IP intra-procedure scratch</li><li><strong>R13</strong>: SP stack pointer æ ˆé¡¶æŒ‡é’ˆ</li><li><strong>R14</strong>: link register å­˜æ”¾å‡½æ•°çš„è¿”å›åœ°å€</li><li><strong>R15</strong>: pogram counter æŒ‡å‘å½“å‰æŒ‡ä»¤åœ°å€</li></ul><h3 id="ARMå¸¸ç”¨æŒ‡ä»¤"><a href="#ARMå¸¸ç”¨æŒ‡ä»¤" class="headerlink" title="ARMå¸¸ç”¨æŒ‡ä»¤"></a>ARMå¸¸ç”¨æŒ‡ä»¤</h3><ul><li><strong>ADD</strong> åŠ æŒ‡ä»¤</li><li><strong>SUB</strong> å‡æŒ‡ä»¤</li><li><strong>STR</strong> æŠŠå¯„å­˜å™¨å†…å®¹å­˜åˆ°æ ˆä¸Š</li><li><strong>LDR</strong> æŠŠæ ˆä¸Šå†…å®¹è½½å…¥ä¸€ä¸ªå¯„å­˜å™¨ä¸­</li><li><strong>.W</strong> æ˜¯ä¸€ä¸ªå¯é€‰æŒ‡ä»¤å®½åº¦è¯´æ˜ç¬¦ã€‚ä¸ä¼šå½±å“ä¸ºæ­¤æŒ‡ä»¤çš„è¡Œä¸ºï¼Œå®ƒåªæ˜¯ç¡®ä¿ç”Ÿæˆ32ä½æŒ‡ä»¤ã€‚</li><li><strong>BL</strong> æ‰§è¡Œå‡½æ•°è°ƒç”¨ï¼Œå¹¶æŠŠä½¿lræŒ‡å‘è°ƒç”¨è€…çš„ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œå³å‡½æ•°çš„è¿”å›åœ°å€</li><li><strong>BLX</strong> åŒä¸Šï¼Œä½†æ˜¯åœ¨ARMå’ŒthumbæŒ‡ä»¤é›†é—´åˆ‡æ¢</li><li><strong>CMP</strong> æŒ‡ä»¤è¿›è¡Œæ¯”è¾ƒä¸¤ä¸ªæ“ä½œæ•°çš„å¤§å°</li></ul><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li>[Android é€†å‘ä¹‹ smali]( <a href="http://wossoneri.github.io/2019/09/12/">http://wossoneri.github.io/2019/09/12/</a> [Android][Security]Decompile-smali/)</li><li><a href="https://misakikata.github.io/2019/01/Android-%E9%80%86%E5%90%91Smali%E8%AF%AD%E8%A8%80%E5%88%9D%E8%AF%86/">Android é€†å‘Smaliè¯­è¨€åˆè¯†</a></li><li><a href="https://juejin.im/post/6844903732774174734">Smali è¯­æ³•è§£æâ€”â€”Hello World</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨ Kotlin  å®ç°é«˜æ•ˆåŠ¨æ€ç¼–å†™å¸ƒå±€, Drawable, Animation</title>
      <link href="/20200625/android-fluent-ui/"/>
      <url>/20200625/android-fluent-ui/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="Getting-started"><a href="#Getting-started" class="headerlink" title="Getting started"></a>Getting started</h2><p>In your <code>build.gradle</code>:</p><pre class="line-numbers language-groovy" data-language="groovy"><code class="language-groovy">allprojects <span class="token punctuation">{</span>  repositories <span class="token punctuation">{</span>    <span class="token function">mavenCentral</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>In your <code>module/build.gradle</code>:</p><pre class="line-numbers language-groovy" data-language="groovy"><code class="language-groovy">dependencies <span class="token punctuation">{</span>  implementation <span class="token string">'com.weicools:fluent-ui:1.0.1'</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h3><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token keyword">val</span> rootView <span class="token operator">=</span> constraintLayout <span class="token punctuation">{</span>  layoutParams <span class="token operator">=</span> <span class="token function">defaultParams</span><span class="token punctuation">(</span>matchParent<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span>  <span class="token function">imageView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>iconId<span class="token punctuation">)</span> <span class="token punctuation">{</span>    layoutParams <span class="token operator">=</span> <span class="token function">constraintParams</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">.</span>dp<span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span> <span class="token punctuation">{</span>      leftToLeft <span class="token operator">=</span> parentId      centerVerticalOf <span class="token operator">=</span> parentId      leftMargin <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">.</span>dp    <span class="token punctuation">}</span>    imageResource <span class="token operator">=</span> R<span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>ic_arrow  <span class="token punctuation">}</span>  <span class="token function">textView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textId<span class="token punctuation">)</span> <span class="token punctuation">{</span>    layoutParams <span class="token operator">=</span> <span class="token function">constraintParams</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> wrapContent<span class="token punctuation">)</span> <span class="token punctuation">{</span>      leftToRight <span class="token operator">=</span> R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>iconId      rightToRight <span class="token operator">=</span> parentId      centerVerticalOf <span class="token operator">=</span> parentId      leftMargin <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">.</span>dp      rightMargin <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">.</span>dp    <span class="token punctuation">}</span>    text <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"layout title"</span></span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>Note ğŸ“¢<br>The main process is automatically initialized context by default, Multiple processes need to be initialized manually: [FluentUiInitializer.initialize]<br>Avoid using <code>xxxResourceOf</code> methods (such as <code>colorResourceOf</code>, <code>dimenResourceOf</code>, etc.) in View/Layout (which internally depends on appContext).<br>Using them directly can cause the View/Layout to fail to preview because during preview, appContext is not initialized and cannot access the relevant resources.</p></blockquote><h3 id="Screenshots"><a href="#Screenshots" class="headerlink" title="Screenshots"></a>Screenshots</h3><p><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/NWvJSz.png" alt="Usage sample"></p><h2 id="Structure"><a href="#Structure" class="headerlink" title="Structure"></a>Structure</h2><pre class="line-numbers language-none"><code class="language-none">com.weikeet.uiâ”œâ”€â”€ animation   -&gt; åŠ¨ç”»: Kotlin dsl æ„å»ºåŠ¨ç”»â”œâ”€â”€ app         -&gt; åº”ç”¨: app context ä»¥åŠé€šè¿‡ app context è·å–ç›¸å…³èµ„æºâ”œâ”€â”€ graphics    -&gt; å›¾å½¢: Kotlin dsl æ„å»º drawableâ”œâ”€â”€ res         -&gt; èµ„æº: color, dimen, drawable, font, stringâ”œâ”€â”€ unit        -&gt; å•ä½: dp, sp, px è½¬æ¢â”œâ”€â”€ view        -&gt; è§†å›¾: Kotlin dsl æ„å»º view, viewgroupâ”œâ”€â”€ widget      -&gt; æ§ä»¶: Kotlin æ§ä»¶å±æ€§æ‰©å±•â””â”€â”€ window      -&gt; çª—å£: WindowInsets(StatusBar, NavigationBar, ime) ç›¸å…³ç›‘å¬<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="animation"><a href="#animation" class="headerlink" title="animation"></a>animation</h3><p>å¿«é€Ÿåˆ›å»ºåŠ¨ç”» animator</p><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token function">startFloatAnimation</span><span class="token punctuation">(</span><span class="token number">0f</span><span class="token punctuation">,</span> <span class="token number">1f</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  doOnFloatUpdate <span class="token punctuation">{</span> animatedValue <span class="token operator">-&gt;</span>    <span class="token comment">// do something</span>  <span class="token punctuation">}</span>  doOnStart <span class="token punctuation">{</span>    <span class="token comment">// do something</span>  <span class="token punctuation">}</span>  doOnEnd <span class="token punctuation">{</span>    <span class="token comment">// do something</span>  <span class="token punctuation">}</span>  duration <span class="token operator">=</span> <span class="token number">240</span>  <span class="token comment">// repeatCount = 0</span>  <span class="token comment">// repeatMode = </span>  <span class="token comment">// startDelay = 0</span>  <span class="token comment">// interpolator = LinearInterpolator()</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>more uses see <a href="library/src/main/kotlin/com/weikeet/ui/animation/Animator.kt">Animator.kt</a></p><h3 id="app"><a href="#app" class="headerlink" title="app"></a>app</h3><blockquote><p>é¿å…åœ¨ View/Layout ç›´æ¥ä½¿ç”¨ <code>dpOf(xx)</code> å’Œ <code>xxxResourceOf</code> æ–¹æ³• (å¦‚ <code>colorResourceOf</code>, <code>dimenResourceOf</code> ç­‰),<br>ç›´æ¥ä½¿ç”¨ä¼šå¯¼è‡´ View/Layout é¢„è§ˆå¤±è´¥, å› ä¸ºé¢„è§ˆæ—¶ appContext æœªåˆå§‹åŒ–, æ— æ³•è®¿é—®ç›¸å…³èµ„æº.<br>åº”è¯¥ä½¿ç”¨ xx.dp, dip(xx), <code>xxxResources</code> æ–¹æ³• (å¦‚ <code>colorResources</code>, <code>dimenResources</code> ç­‰)</p></blockquote><p>èµ„æºè·å–</p><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// get resource using app context</span><span class="token keyword">val</span> color <span class="token operator">=</span> <span class="token function">colorResourceOf</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>color<span class="token punctuation">.</span>colorPrimary<span class="token punctuation">)</span><span class="token keyword">val</span> colorList <span class="token operator">=</span> <span class="token function">colorStateListOf</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>color<span class="token punctuation">.</span>colorPrimary<span class="token punctuation">)</span><span class="token keyword">val</span> dimen16 <span class="token operator">=</span> <span class="token function">dimenResourceOf</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>dimen<span class="token punctuation">.</span>padding_16<span class="token punctuation">)</span><span class="token keyword">val</span> dimenSize16 <span class="token operator">=</span> <span class="token function">dimenSizeResourceOf</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>dimen<span class="token punctuation">.</span>padding_16<span class="token punctuation">)</span><span class="token keyword">val</span> dimenOffset16 <span class="token operator">=</span> <span class="token function">dimenOffsetResourceOf</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>dimen<span class="token punctuation">.</span>padding_16<span class="token punctuation">)</span><span class="token keyword">val</span> drawable <span class="token operator">=</span> <span class="token function">drawableResourceOf</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>ic_arrow<span class="token punctuation">)</span><span class="token keyword">val</span> font <span class="token operator">=</span> <span class="token function">fontResourceOf</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>font<span class="token punctuation">.</span>font_name<span class="token punctuation">)</span><span class="token keyword">val</span> string <span class="token operator">=</span> <span class="token function">stringResourceOf</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>string<span class="token punctuation">.</span>app_name<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Unit è½¬æ¢</p><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// Convert dp to px using app context</span><span class="token keyword">val</span> dp10 <span class="token operator">=</span> <span class="token function">dpOf</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token keyword">val</span> dp10f <span class="token operator">=</span> <span class="token function">dpOf</span><span class="token punctuation">(</span><span class="token number">10f</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="graphics"><a href="#graphics" class="headerlink" title="graphics"></a>graphics</h3><p>ä½¿ç”¨ Kotlin dsl åƒ xml ä¸€æ ·æ„å»º drawable</p><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// create drawable using kotlin dsl</span><span class="token keyword">val</span> drawable <span class="token operator">=</span> shapeDrawable <span class="token punctuation">{</span>  corners <span class="token punctuation">{</span>    radius <span class="token operator">=</span> <span class="token number">20f</span><span class="token punctuation">.</span>dp  <span class="token punctuation">}</span>  solidColor <span class="token operator">=</span> <span class="token number">0xff00ff00</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>more uses see</p><ul><li><a href="library/src/main/kotlin/com/weikeet/ui/graphics/drawable/Drawable.kt">Drawable.kt</a></li><li><a href="library/src/main/kotlin/com/weikeet/ui/graphics/drawable/Shapes.kt">Shapes.kt</a></li><li><a href="library/src/main/kotlin/com/weikeet/ui/graphics/drawable/States.kt">States.kt</a></li></ul><h3 id="res"><a href="#res" class="headerlink" title="res"></a>res</h3><p>Context/Fragment/View å¿«æ·è·å–èµ„æº</p><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// get color using context/fragment/view resource</span><span class="token keyword">val</span> color <span class="token operator">=</span> <span class="token function">colorResources</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>color<span class="token punctuation">.</span>colorPrimary<span class="token punctuation">)</span><span class="token keyword">val</span> colorList <span class="token operator">=</span> <span class="token function">colorStateList</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>color<span class="token punctuation">.</span>colorPrimary<span class="token punctuation">)</span><span class="token keyword">val</span> dimen16 <span class="token operator">=</span> <span class="token function">dimenResources</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>dimen<span class="token punctuation">.</span>padding_16<span class="token punctuation">)</span><span class="token keyword">val</span> dimenSize16 <span class="token operator">=</span> <span class="token function">dimenSizeResources</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>dimen<span class="token punctuation">.</span>padding_16<span class="token punctuation">)</span><span class="token keyword">val</span> dimenOffset16 <span class="token operator">=</span> <span class="token function">dimenOffsetResources</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>dimen<span class="token punctuation">.</span>padding_16<span class="token punctuation">)</span><span class="token keyword">val</span> drawable <span class="token operator">=</span> <span class="token function">drawableResources</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>ic_arrow<span class="token punctuation">)</span><span class="token keyword">val</span> font <span class="token operator">=</span> <span class="token function">fontResources</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>font<span class="token punctuation">.</span>font_name<span class="token punctuation">)</span><span class="token keyword">val</span> string <span class="token operator">=</span> <span class="token function">stringResources</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>string<span class="token punctuation">.</span>app_name<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="unit"><a href="#unit" class="headerlink" title="unit"></a>unit</h3><p>dp, px è½¬æ¢</p><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// Convert dp to px using context/fragment/view resource</span><span class="token keyword">val</span> dp10 <span class="token operator">=</span> <span class="token function">dp</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token keyword">val</span> dp10f <span class="token operator">=</span> <span class="token function">dp</span><span class="token punctuation">(</span><span class="token number">10f</span><span class="token punctuation">)</span><span class="token comment">// Convert sp to px using system resource</span><span class="token keyword">val</span> dp20 <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">.</span>dp<span class="token keyword">val</span> dp20f <span class="token operator">=</span> <span class="token number">20f</span><span class="token punctuation">.</span>dp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="view"><a href="#view" class="headerlink" title="view"></a>view</h3><p>ä½¿ç”¨ Kotlin dsl åƒ xml ä¸€æ ·æ„å»º View, ViewGroup</p><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token keyword">val</span> rootView <span class="token operator">=</span> constraintLayout <span class="token punctuation">{</span>  layoutParams <span class="token operator">=</span> <span class="token function">defaultParams</span><span class="token punctuation">(</span>matchParent<span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span>  <span class="token function">imageView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>iconId<span class="token punctuation">)</span> <span class="token punctuation">{</span>    layoutParams <span class="token operator">=</span> <span class="token function">constraintParams</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">.</span>dp<span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token comment">// ...</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token function">textView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textId<span class="token punctuation">)</span> <span class="token punctuation">{</span>    layoutParams <span class="token operator">=</span> <span class="token function">constraintParams</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> wrapContent<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token comment">// ...</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>more uses see <a href="library/src/main/kotlin/com/weikeet/ui/view">ui/view</a></p><h3 id="widget"><a href="#widget" class="headerlink" title="widget"></a>widget</h3><p>kotlin æ§ä»¶å±æ€§æ‰©å±•</p><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin">context<span class="token punctuation">.</span><span class="token function">textView</span> <span class="token punctuation">{</span>  textColorResource <span class="token operator">=</span> R<span class="token punctuation">.</span>color<span class="token punctuation">.</span>colorPrimary  stringResource <span class="token operator">=</span> R<span class="token punctuation">.</span>string<span class="token punctuation">.</span>app_name  <span class="token comment">// ...</span><span class="token punctuation">}</span>context<span class="token punctuation">.</span><span class="token function">imageView</span> <span class="token punctuation">{</span>  imageResource <span class="token operator">=</span> R<span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>ic_arrow  <span class="token comment">// ...</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>more uses see <a href="library/src/main/kotlin/com/weikeet/ui/widget">ui/widget</a></p><h3 id="window"><a href="#window" class="headerlink" title="window"></a>window</h3><p>WindowInsets ç›¸å…³ç›‘å¬</p><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token comment">// adapt edge to edge</span><span class="token function">WindowInsetsEdgeDelegate</span><span class="token punctuation">(</span>activity<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// listen window insets</span>view<span class="token punctuation">.</span><span class="token function">doOnApplyWindowInsets</span> <span class="token punctuation">{</span> windowInsets <span class="token operator">-&gt;</span>  <span class="token comment">// do something</span>  <span class="token comment">// eg: view.updatePadding(top = windowInsets.systemBarTop)</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>more uses see <a href="library/src/main/kotlin/com/weikeet/ui/window">ui/window</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> View </tag>
            
            <tag> Kotlin </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨FRPè¿›è¡Œå†…ç½‘ç©¿é€</title>
      <link href="/20200404/intranet-penetration-by-frp/"/>
      <url>/20200404/intranet-penetration-by-frp/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä½¿ç”¨frpè¿›è¡Œå†…ç½‘ç©¿é€"><a href="#ä½¿ç”¨frpè¿›è¡Œå†…ç½‘ç©¿é€" class="headerlink" title="ä½¿ç”¨frpè¿›è¡Œå†…ç½‘ç©¿é€"></a>ä½¿ç”¨frpè¿›è¡Œå†…ç½‘ç©¿é€</h1><p>FRPé¡¹ç›®åœ°å€ï¼š<a href="https://github.com/fatedier/frp">https://github.com/fatedier/frp</a><br>FRPä¸­æ–‡è¯´æ˜ï¼š<a href="https://github.com/fatedier/frp/blob/master/README_zh.md">https://github.com/fatedier/frp/blob/master/README_zh.md</a></p><h2 id="frpæ˜¯ä»€ä¹ˆ"><a href="#frpæ˜¯ä»€ä¹ˆ" class="headerlink" title="frpæ˜¯ä»€ä¹ˆ"></a>frpæ˜¯ä»€ä¹ˆ</h2><p>ç®€å•åœ°è¯´:frpå°±æ˜¯ä¸€ä¸ª<a href="https://www.zhihu.com/question/24723688">åå‘ä»£ç†è½¯ä»¶</a>ï¼Œå®ƒä½“ç§¯è½»é‡ä½†åŠŸèƒ½å¾ˆå¼ºå¤§ï¼Œå¯ä»¥<strong>ä½¿å¤„äºå†…ç½‘æˆ–é˜²ç«å¢™åçš„è®¾å¤‡å¯¹å¤–ç•Œæä¾›æœåŠ¡</strong>ï¼Œå®ƒæ”¯æŒ <strong>HTTPã€TCPã€UDP</strong>ç­‰ä¼—å¤šåè®®ã€‚</p><h2 id="ä¸ºä»€ä¹ˆéœ€è¦å†…ç½‘ç©¿é€"><a href="#ä¸ºä»€ä¹ˆéœ€è¦å†…ç½‘ç©¿é€" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦å†…ç½‘ç©¿é€"></a>ä¸ºä»€ä¹ˆéœ€è¦å†…ç½‘ç©¿é€</h2><p><strong>ä»å…¬ç½‘ä¸­è®¿é—®è‡ªå·±çš„ç§æœ‰è®¾å¤‡å‘æ¥æ˜¯ä¸€ä»¶éš¾äº‹å„¿ã€‚</strong><br>è‡ªå·±çš„ä¸»åŠ›å°å¼æœºã€NASç­‰ç­‰è®¾å¤‡ï¼Œå®ƒä»¬å¯èƒ½å¤„äºè·¯ç”±å™¨åï¼Œæˆ–è€…è¿è¥å•†å› ä¸ºIPåœ°å€çŸ­ç¼ºä¸ç»™ä½ åˆ†é…å…¬ç½‘IPåœ°å€ã€‚å¦‚æœæˆ‘ä»¬æƒ³ç›´æ¥è®¿é—®åˆ°è¿™äº›è®¾å¤‡ï¼ˆè¿œç¨‹æ¡Œé¢ï¼Œè¿œç¨‹æ–‡ä»¶ï¼ŒSSHç­‰ç­‰ï¼‰ï¼Œä¸€èˆ¬æ¥è¯´è¦é€šè¿‡ä¸€äº›è½¬å‘æˆ–è€…P2Pç»„ç½‘è½¯ä»¶çš„å¸®åŠ©ã€‚<br>æˆ‘æœ‰ä¸€å°è®¡ç®—æœºä½äºä¸€ä¸ªå¾ˆå¤æ‚çš„å±€åŸŸç½‘ä¸­ï¼Œæˆ‘æƒ³è¦å®ç°è¿œç¨‹æ¡Œé¢å’Œæ–‡ä»¶è®¿é—®ï¼Œç›®å‰æ¥çœ‹å…¶æ‰€å¤„çš„ç½‘ç»œç¯å¢ƒå¾ˆéš¾é€šè¿‡ç®€å•çš„ç«¯å£æ˜ å°„å°†å…¶æš´éœ²åœ¨å…¬ç½‘ä¹‹ä¸­ï¼Œæˆ‘è¯•è¿‡è¿™ä¹ˆå‡ ç§æ–¹æ³•ï¼š</p><span id="more"></span><ol><li>è¿œç¨‹æ¡Œé¢ä½¿ç”¨TeamViewerã€‚å¯ç”¨ï¼Œä½†éœ€è¦è®¿é—®ç«¯ä¹Ÿæ‹¥æœ‰TeamViewerè½¯ä»¶ï¼Œä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œå¸Œæœ›èƒ½ä½¿ç”¨Windowsè‡ªå¸¦çš„è¿œç¨‹æ¡Œé¢ã€‚ä¸”TeamViewerä¸æ˜“å®ç°è¿œç¨‹æ–‡ä»¶è®¿é—®ã€‚</li><li>ä½¿ç”¨è’²å…¬è‹±VPNè½¯ä»¶è¿›è¡Œç»„ç½‘ï¼Œå¯ç”¨ï¼Œä½†å…è´¹ç‰ˆæœ¬ç½‘ç»œé€Ÿåº¦ææ…¢ï¼Œä½“éªŒä¸ä½³ï¼Œå‡ ä¹æ— æ³•æ­£å¸¸ä½¿ç”¨ã€‚</li><li>ä½¿ç”¨èŠ±ç”Ÿå£³è½¯ä»¶è¿›è¡ŒDDNSè§£æï¼Œå¯ç”¨ï¼Œä½†åŒç¬¬äºŒç‚¹æ‰€è¿°ï¼Œå…è´¹ç‰ˆæœ¬æœ‰å¸¦å®½é™åˆ¶ï¼Œæ— æ³•å®é™…ä½¿ç”¨ã€‚</li><li><strong>æ­å»ºfrpæœåŠ¡å™¨è¿›è¡Œå†…ç½‘ç©¿é€ï¼Œå¯ç”¨ä¸”æ¨èï¼Œå¯ä»¥è¾¾åˆ°ä¸é”™çš„é€Ÿåº¦ï¼Œä¸”ç†è®ºä¸Šå¯ä»¥å¼€æ”¾ä»»ä½•æƒ³è¦çš„ç«¯å£ï¼Œå¯ä»¥å®ç°çš„åŠŸèƒ½è¿œä¸æ­¢è¿œç¨‹æ¡Œé¢æˆ–è€…æ–‡ä»¶å…±äº«ã€‚</strong></li></ol><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><p>æ­å»ºä¸€ä¸ªå®Œæ•´çš„frpæœåŠ¡é“¾ï¼Œæˆ‘ä»¬éœ€è¦</p><ol><li>VPSä¸€å°ï¼ˆä¹Ÿå¯ä»¥æ˜¯å…·æœ‰å…¬ç½‘IPçš„å®ä½“æœºï¼‰</li><li>è®¿é—®ç›®æ ‡è®¾å¤‡ï¼ˆå°±æ˜¯ä½ æœ€ç»ˆè¦è®¿é—®çš„è®¾å¤‡ï¼Œä¾‹å¦‚ï¼šPCï¼ŒNASï¼Œè·¯ç”±å™¨ï¼‰</li><li>ç®€å•çš„LinuxåŸºç¡€ï¼ˆä¼šç”¨cpç­‰å‡ ä¸ªç®€å•å‘½ä»¤å³å¯ï¼‰</li></ol><h3 id="VPSç›¸å…³"><a href="#VPSç›¸å…³" class="headerlink" title="VPSç›¸å…³"></a>VPSç›¸å…³</h3><ul><li>å› ä¸ºfrpçš„åŸç†æ˜¯åˆ©ç”¨æœåŠ¡ç«¯ï¼ˆæ‰€å‡†å¤‡çš„VPSï¼‰è¿›è¡Œè½¬å‘ï¼Œå› è€ŒVPSçš„é€Ÿåº¦ç›´æ¥å†³å®šäº†ä¹‹åè¿æ¥çš„è´¨é‡ï¼Œè¯·æ ¹æ®è‡ªå·±çš„éœ€è¦é€‰æ‹©ç›¸åº”ä¸»æœºé…ç½®ã€‚</li><li>æœ¬äººä½¿ç”¨äº†æ¬ç“¦å·¥çš„æ´›æ‰çŸ¶æœºæˆ¿ï¼ŒåŒ—äº¬è”é€šä¸‹æµ‹è¯•é€Ÿåº¦ä¹Ÿè¿˜è¿‡å¾—å»ã€‚</li><li>ç³»ç»Ÿä½¿ç”¨Ubuntu 16.04.5 x64ï¼Œfrpå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æœ¬èº«åŒæ—¶å‡æ”¯æŒLinuxå’ŒWindowsï¼Œä¸”é…ç½®æ–¹æ³•ä¸€æ ·ï¼Œè¯·æ ¹æ®å®é™…ç¯å¢ƒè‡ªè¡Œæµ‹è¯•ï¼Œå¦‚æœä½ æ˜¯æ–°å»ºçš„VPSï¼Œé‚£é€‰æ‹©Ubuntu 16.04.5 x64å°±å¯ä»¥äº†ã€‚</li></ul><h2 id="æœåŠ¡ç«¯è®¾ç½®"><a href="#æœåŠ¡ç«¯è®¾ç½®" class="headerlink" title="æœåŠ¡ç«¯è®¾ç½®"></a>æœåŠ¡ç«¯è®¾ç½®</h2><p>SSHè¿æ¥åˆ°VPSä¹‹åè¿è¡Œå¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹å¤„ç†å™¨æ¶æ„ï¼Œæ ¹æ®æ¶æ„ä¸‹è½½ä¸åŒç‰ˆæœ¬çš„frp</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@Weicools:/home<span class="token comment"># arch</span>x86_64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="ä¸‹è½½å®‰è£…"><a href="#ä¸‹è½½å®‰è£…" class="headerlink" title="ä¸‹è½½å®‰è£…"></a>ä¸‹è½½å®‰è£…</h3><p>è¿™é‡Œé€‰æ‹©çš„æ˜¯Linux x86_64çš„ç‰ˆæœ¬ï¼šfrp_0.32.1_linux_amd64.tar.gz</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># ä¸‹è½½frpç¨‹åº</span>root@Weicools:/home<span class="token comment"># </span><span class="token function">wget</span> https://github.com/fatedier/frp/releases/download/v0.32.1/frp_0.32.1_linux_amd64.tar.gz<span class="token comment"># è§£å‹</span>root@Weicools:/home<span class="token comment"># </span><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> frp_0.32.1_linux_amd64.tar.gz<span class="token comment"># æ”¹ä¸ªåå­—</span>root@Weicools:/home<span class="token comment"># </span><span class="token function">cp</span> <span class="token parameter variable">-r</span> frp_0.32.1_linux_amd64 frp<span class="token comment"># è¿›å…¥frpç¨‹åºç›®å½•</span>root@Weicools:/home<span class="token comment"># </span><span class="token builtin class-name">cd</span> frproot@Weicools:/home/frp<span class="token comment"># </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬åªéœ€è¦å…³æ³¨å¦‚ä¸‹å‡ ä¸ªæ–‡ä»¶</p><ul><li>frps æœåŠ¡ç«¯ç¨‹åº</li><li>frps.ini æœåŠ¡ç«¯é…ç½®æ–‡ä»¶</li><li>frpc å®¢æˆ·ç«¯ç¨‹åº</li><li>frpc.ini å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶</li></ul><h3 id="æœåŠ¡ç«¯é…ç½®"><a href="#æœåŠ¡ç«¯é…ç½®" class="headerlink" title="æœåŠ¡ç«¯é…ç½®"></a>æœåŠ¡ç«¯é…ç½®</h3><p>ç¼–è¾‘frpæœåŠ¡ç«¯é…ç½®æ–‡ä»¶</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@Weicools:/home/frp<span class="token comment"># </span><span class="token function">vim</span> frps.ini<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æœåŠ¡ç«¯é…ç½®æ–‡ä»¶å†…å®¹æ ¹æ®éœ€æ±‚è‡ªè¡Œé…ç½®ï¼Œç¼–è¾‘å®Œæˆåä¿å­˜ï¼ˆvimä¿å­˜å¦‚æœä¸ä¼šè¯·è‡ªè¡Œæœç´¢ï¼‰ã€‚</p><h4 id="ç®€æ´ç‰ˆæœ¬"><a href="#ç®€æ´ç‰ˆæœ¬" class="headerlink" title="ç®€æ´ç‰ˆæœ¬"></a>ç®€æ´ç‰ˆæœ¬</h4><pre class="line-numbers language-none"><code class="language-none">[common]                                                                                                                   bind_port = 7000token = 12345678<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="å¸¦Dashboardç‰ˆæœ¬"><a href="#å¸¦Dashboardç‰ˆæœ¬" class="headerlink" title="å¸¦Dashboardç‰ˆæœ¬"></a>å¸¦Dashboardç‰ˆæœ¬</h4><pre class="line-numbers language-none"><code class="language-none">[common]bind_port = 7000dashboard_port = 7500token = 12345678    dashboard_user = admindashboard_pwd = adminvhost_http_port = 10080vhost_https_port = 10443<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="é…ç½®æ³¨æ„äº‹é¡¹"><a href="#é…ç½®æ³¨æ„äº‹é¡¹" class="headerlink" title="é…ç½®æ³¨æ„äº‹é¡¹"></a>é…ç½®æ³¨æ„äº‹é¡¹</h4><ul><li><code>bind_port = 7000</code> å¯ä»¥è‡ªè¡Œä¿®æ”¹ï¼ˆå¦‚æœæ²¡æœ‰å¿…è¦ï¼Œç«¯å£å‡å¯ä½¿ç”¨é»˜è®¤å€¼ï¼‰ï¼Œä½†è¦å’Œæ¥åé¢å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶ä¸­çš„ <code>bind_port</code> ç›¸åŒï¼Œä¸”æœåŠ¡ç«¯çš„7000ç«¯å£éœ€è¦æ”¾è¡Œï¼Œå…·ä½“å¯ä»¥ç”¨å®å¡”é¢æ¿ï¼ˆå®‰å…¨é€‰é¡¹ï¼‰è¿›è¡Œè®¾ç½®ï¼Œæˆ–è€…ç½‘ä¸ŠæŸ¥è¯¢å‘½ä»¤è®¾ç½®æ”¾è¡Œçš„æ–¹æ³•ã€‚</li><li><code>dashboard_port</code> æ˜¯æœåŠ¡ç«¯ä»ªè¡¨æ¿çš„ç«¯å£ï¼Œè‹¥ä½¿ç”¨7500ç«¯å£ï¼ˆéœ€è¦æ”¾è¡Œï¼‰ï¼Œåœ¨é…ç½®å®ŒæˆæœåŠ¡å¯åŠ¨åå¯ä»¥é€šè¿‡æµè§ˆå™¨è®¿é—® x.x.x.x:7500 ï¼ˆå…¶ä¸­x.x.x.xä¸ºVPSçš„IPï¼‰æŸ¥çœ‹frpæœåŠ¡è¿è¡Œä¿¡æ¯ã€‚</li><li><code>token</code> æ˜¯ç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯è¿æ¥çš„å£ä»¤ï¼Œè¯·è‡ªè¡Œè®¾ç½®å¹¶è®°å½•ï¼Œç¨åä¼šç”¨åˆ°ã€‚</li><li><code>dashboard_user</code> å’Œ <code>dashboard_pwd</code> è¡¨ç¤ºæ‰“å¼€ä»ªè¡¨æ¿é¡µé¢ç™»å½•çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œè‡ªè¡Œè®¾ç½®å³å¯ã€‚</li><li><code>vhost_http_port</code> å’Œ <code>vhost_https_port</code> ç”¨äºåå‘ä»£ç†HTTPä¸»æœºæ—¶ä½¿ç”¨ï¼Œæœ¬æ–‡ä¸æ¶‰åŠHTTPåè®®ï¼Œå› è€Œç…§æŠ„æˆ–è€…åˆ é™¤è¿™ä¸¤æ¡å‡å¯ã€‚</li></ul><h3 id="è¿è¡ŒfrpsæœåŠ¡ç«¯"><a href="#è¿è¡ŒfrpsæœåŠ¡ç«¯" class="headerlink" title="è¿è¡ŒfrpsæœåŠ¡ç«¯"></a>è¿è¡ŒfrpsæœåŠ¡ç«¯</h3><p>é…ç½®å®ŒæˆæœåŠ¡ç«¯é…ç½®æ–‡ä»¶ä¹‹åæˆ‘ä»¬å°±å¯ä»¥è¿è¡Œfrpsçš„æœåŠ¡ç«¯äº†</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@Weicools:/home/frp<span class="token comment"># </span>./frps <span class="token parameter variable">-c</span> frps.ini<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¦‚æœçœ‹åˆ°å±å¹•è¾“å‡ºä¸€ä¸‹è¿™æ ·çš„å†…å®¹ï¼Œå³è¡¨ç¤ºè¿è¡Œæ­£å¸¸ï¼Œå¦‚æœå‡ºç°é”™è¯¯æç¤ºï¼Œè¯·æ£€æŸ¥ä¸Šé¢çš„æ­¥éª¤ã€‚</p><pre class="line-numbers language-none"><code class="language-none">2020/04/03 22:22:39 [I] [service.go:130] frps tcp listen on 0.0.0.0:70002020/04/03 22:22:39 [I] [service.go:172] http service listen on 0.0.0.0:100802020/04/03 22:22:39 [I] [service.go:193] https service listen on 0.0.0.0:104432020/04/03 22:22:39 [I] [service.go:216] Dashboard listen on 0.0.0.0:75002020/04/03 22:22:39 [I] [root.go:210] Start frps success<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤æ—¶è®¿é—® <code>æœåŠ¡ç«¯IP:7500</code> å¹¶ä½¿ç”¨è‡ªå·±è®¾ç½®çš„ç”¨æˆ·åå¯†ç ç™»å½•ï¼Œå³å¯çœ‹åˆ°ä»ªè¡¨æ¿ç•Œé¢<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/FIRUx8.png" alt="frpæœåŠ¡ç«¯ä»ªè¡¨æ¿ç•Œé¢"></p><h3 id="æœåŠ¡ç«¯åå°è¿è¡Œå’Œè‡ªå¯"><a href="#æœåŠ¡ç«¯åå°è¿è¡Œå’Œè‡ªå¯" class="headerlink" title="æœåŠ¡ç«¯åå°è¿è¡Œå’Œè‡ªå¯"></a>æœåŠ¡ç«¯åå°è¿è¡Œå’Œè‡ªå¯</h3><h4 id="åå°è¿è¡Œæ–¹æ³•-nohup"><a href="#åå°è¿è¡Œæ–¹æ³•-nohup" class="headerlink" title="åå°è¿è¡Œæ–¹æ³•-nohup"></a>åå°è¿è¡Œæ–¹æ³•-nohup</h4><p>è‡³æ­¤ï¼Œæˆ‘ä»¬çš„æœåŠ¡ç«¯ä»…è¿è¡Œåœ¨å‰å°ï¼Œå¦‚æœCtrl+Cåœæ­¢æˆ–è€…å…³é—­SSHçª—å£åï¼Œfrpså‡ä¼šåœæ­¢è¿è¡Œï¼Œå› è€Œæˆ‘ä»¬ä½¿ç”¨ <a href="https://ehlxr.me/2017/01/18/Linux-%E7%9A%84-nohup-%E5%91%BD%E4%BB%A4%E7%9A%84%E7%94%A8%E6%B3%95/">nohupå‘½ä»¤</a>ï¼ˆnohupåå°ç¨‹åºç®¡ç†æˆ–å…³é—­ç›¸å…³å‘½ä»¤å¯è‡ªè¡ŒæŸ¥è¯¢èµ„æ–™ï¼‰å°†å…¶è¿è¡Œåœ¨åå°ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@Weicools:/home/frp<span class="token comment"># </span><span class="token function">nohup</span> ./frps <span class="token parameter variable">-c</span> frps.ini <span class="token operator">&amp;</span><span class="token comment"># æˆ–è€…</span>root@Weicools:/home/frp<span class="token comment"># </span><span class="token function">nohup</span> ./frps <span class="token parameter variable">-c</span> frps.ini <span class="token operator">&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹å†…å®¹å³è¡¨ç¤ºæ­£å¸¸è¿è¡Œ</p><pre class="line-numbers language-none"><code class="language-none">nohup: ignoring input and appending output to 'nohup.out'<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ­¤æ—¶å¯å…ˆä½¿ç”¨ <code>Ctrl+C</code> å…³é—­ nohupï¼Œfrpsä¾ç„¶ä¼šåœ¨åå°è¿è¡Œï¼Œä½¿ç”¨ <code>jobs</code> å‘½ä»¤æŸ¥çœ‹åå°è¿è¡Œçš„ç¨‹åºï¼Œåœ¨ç»“æœä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°frpsæ­£åœ¨åå°æ­£å¸¸è¿è¡Œ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@Weicools:/home/frp<span class="token comment"># jobs</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>+  Running    <span class="token function">nohup</span> ./frps <span class="token parameter variable">-c</span> frps.ini <span class="token operator">&amp;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ­¤æ—¶è®¿é—® x.x.x.x:7500 ä¾ç„¶å¯ä»¥æ‰“å¼€ä»ªè¡¨æ¿ç•Œé¢ï¼Œè‡³æ­¤ï¼ŒæœåŠ¡ç«¯å³è®¾ç½®å®Œæˆï¼Œå°±å¯ä»¥å…³é—­SSHçª—å£äº†ã€‚</p><h4 id="åå°è¿è¡Œæ–¹æ³•-systemctl"><a href="#åå°è¿è¡Œæ–¹æ³•-systemctl" class="headerlink" title="åå°è¿è¡Œæ–¹æ³•-systemctl"></a>åå°è¿è¡Œæ–¹æ³•-systemctl</h4><h5 id="è¿è¡ŒæœåŠ¡åˆ›å»º"><a href="#è¿è¡ŒæœåŠ¡åˆ›å»º" class="headerlink" title="è¿è¡ŒæœåŠ¡åˆ›å»º"></a>è¿è¡ŒæœåŠ¡åˆ›å»º</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@Weicools:/home<span class="token comment"># </span><span class="token function">vim</span> /lib/systemd/system/frps.service<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>frps.serviceæ–‡ä»¶å†…å®¹</p><pre class="line-numbers language-none"><code class="language-none">[Unit]Description=frps serviceAfter=network.target syslog.targetWants=network.target[Service]Type=simpleExecStart=/home/frp/frps -c /home/frp/frps.ini[Install]WantedBy=multi-user.target<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="å¯åŠ¨åå°æœåŠ¡"><a href="#å¯åŠ¨åå°æœåŠ¡" class="headerlink" title="å¯åŠ¨åå°æœåŠ¡"></a>å¯åŠ¨åå°æœåŠ¡</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@Weicools:/home<span class="token comment"># </span>systemctl start frps<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h5 id="å¼€å¯è‡ªå¯åŠ¨"><a href="#å¼€å¯è‡ªå¯åŠ¨" class="headerlink" title="å¼€å¯è‡ªå¯åŠ¨"></a>å¼€å¯è‡ªå¯åŠ¨</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@Weicools:/home<span class="token comment"># </span>systemctl <span class="token builtin class-name">enable</span> frps<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="åœæ­¢frpæœåŠ¡ç«¯"><a href="#åœæ­¢frpæœåŠ¡ç«¯" class="headerlink" title="åœæ­¢frpæœåŠ¡ç«¯"></a>åœæ­¢frpæœåŠ¡ç«¯</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å…ˆæ‰¾åˆ°è¿™ä¸ªè¿›ç¨‹</span>root@Weicools:/home<span class="token comment"># </span><span class="token function">ps</span> -aux<span class="token operator">|</span><span class="token function">grep</span> frp<span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token function">grep</span>root    <span class="token number">22416</span>  <span class="token number">0.0</span>  <span class="token number">1.2</span> <span class="token number">114188</span> <span class="token number">12432</span> ?    Sl    <span class="token number">2019</span>   <span class="token number">1</span>:05 ./frps <span class="token parameter variable">-c</span> ./frps.ini<span class="token comment"># ç„¶åkill -9 è¿›ç¨‹å·</span>root@Weicools:/home<span class="token comment"># </span><span class="token function">kill</span> <span class="token parameter variable">-9</span> <span class="token number">22416</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å®¢æˆ·ç«¯è®¾ç½®"><a href="#å®¢æˆ·ç«¯è®¾ç½®" class="headerlink" title="å®¢æˆ·ç«¯è®¾ç½®"></a>å®¢æˆ·ç«¯è®¾ç½®</h2><p>æ ¹æ®è®¾å¤‡çš„æƒ…å†µé€‰æ‹©ç›¸åº”çš„frpç¨‹åºè¿›è¡Œ<a href="https://github.com/fatedier/frp/releases">ä¸‹è½½</a></p><p>Windowsä¸‹ä¸‹è½½å’Œè§£å‹ç­‰æ­¥éª¤ä¸å†æè¿°ã€‚å‡å®šä½ ä¸‹è½½äº† <code>frp_0.32.1_windows_amd64.zip</code>ï¼Œå°†å…¶è§£å‹åœ¨äº†Dç›˜æ ¹ç›®å½•ä¸‹ï¼Œå¹¶ä¸”å°†æ–‡ä»¶å¤¹é‡å‘½åä¸º <code>frp</code>ã€‚</p><p>ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€frpc.iniï¼Œä¸æœåŠ¡ç«¯ç±»ä¼¼ï¼Œå†…å®¹å¦‚ä¸‹ã€‚</p><pre class="line-numbers language-none"><code class="language-none">[common]server_addr = x.x.x.xserver_port = 7000token = 12345678[RDP]type = tcplocal_ip = 127.0.0.1           local_port = 3389remote_port = 7001  [SMB]type = tcplocal_ip = 127.0.0.1local_port = 445remote_port = 7002<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol><li>RDPå³Remote Desktop è¿œç¨‹æ¡Œé¢ï¼ŒWindowsçš„RDPé»˜è®¤ç«¯å£æ˜¯3389ï¼Œåè®®ä¸ºTCPï¼Œå»ºè®®ä½¿ç”¨frpè¿œç¨‹è¿æ¥å‰ï¼Œåœ¨å±€åŸŸç½‘ä¸­æµ‹è¯•å¥½ï¼Œèƒ½å¤ŸæˆåŠŸè¿æ¥åå†ä½¿ç”¨frpç©¿é€è¿æ¥ã€‚</li><li>SMBå³Windowsæ–‡ä»¶å…±äº«æ‰€ä½¿ç”¨çš„åè®®ï¼Œé»˜è®¤ç«¯å£å·445ï¼Œåè®®TCPï¼Œæœ¬æ¡è§„åˆ™å¯å®ç°è¿œç¨‹æ–‡ä»¶è®¿é—®ã€‚</li></ol><p>å…¶ä¸­commonå­—æ®µä¸‹çš„ä¸‰é¡¹å³ä¸ºæœåŠ¡ç«¯çš„è®¾ç½®ã€‚</p><ul><li><code>server_addr</code> ä¸ºæœåŠ¡ç«¯IPåœ°å€ï¼Œå¡«å…¥å³å¯ã€‚</li><li><code>server_port</code> ä¸ºæœåŠ¡å™¨ç«¯å£ï¼Œå¡«å…¥ä½ è®¾ç½®çš„ç«¯å£å·å³å¯ï¼ŒæœåŠ¡ç«¯é…ç½®çš„ <code>bind_port</code> ä¾‹å¦‚ï¼š7000</li><li><code>token</code> æ˜¯ä½ åœ¨æœåŠ¡å™¨ä¸Šè®¾ç½®çš„è¿æ¥å£ä»¤ï¼ŒåŸæ ·å¡«å…¥å³å¯ã€‚</li></ul><h3 id="è‡ªå®šä¹‰è§„åˆ™"><a href="#è‡ªå®šä¹‰è§„åˆ™" class="headerlink" title="è‡ªå®šä¹‰è§„åˆ™"></a>è‡ªå®šä¹‰è§„åˆ™</h3><p>frpå®é™…ä½¿ç”¨æ—¶ï¼Œä¼šæŒ‰ç…§ç«¯å£å·è¿›è¡Œå¯¹åº”çš„è½¬å‘ï¼ŒåŸç†å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/gZRQkk.jpg" alt="gZRQkk"></p><p>ä¸Šé¢ <code>frpc.ini</code> çš„ <code>Remote Desktop</code> <code>SMB</code> å­—æ®µéƒ½æ˜¯è‡ªå·±å®šä¹‰çš„è§„åˆ™ï¼Œè‡ªå®šä¹‰ç«¯å£å¯¹åº”æ—¶æ ¼å¼å¦‚ä¸‹</p><pre class="line-numbers language-none"><code class="language-none">[xxx]type = tcplocal_ip = 127.0.0.1           local_port = 1234remote_port = 5678 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>[xxx]</code> è¡¨ç¤ºä¸€ä¸ªè§„åˆ™åç§°ï¼Œè‡ªå·±å®šä¹‰ï¼Œä¾¿äºæŸ¥è¯¢å³å¯ã€‚</li><li><code>type</code> è¡¨ç¤ºè½¬å‘çš„åè®®ç±»å‹ï¼Œæœ‰TCPå’ŒUDPç­‰é€‰é¡¹å¯ä»¥é€‰æ‹©ï¼Œå¦‚æœ‰éœ€è¦è¯·è‡ªè¡ŒæŸ¥è¯¢frpæ‰‹å†Œã€‚</li><li><code>local_port</code> æ˜¯æœ¬åœ°åº”ç”¨çš„ç«¯å£å·ï¼ŒæŒ‰ç…§å®é™…åº”ç”¨å·¥ä½œåœ¨æœ¬æœºçš„ç«¯å£å·å¡«å†™å³å¯ã€‚</li><li><code>remote_port</code> æ˜¯è¯¥æ¡è§„åˆ™åœ¨æœåŠ¡ç«¯å¼€æ”¾çš„ç«¯å£å·ï¼Œè‡ªå·±å¡«å†™å¹¶è®°å½•å³å¯ã€‚</li></ul><h3 id="è¿è¡Œfrpc"><a href="#è¿è¡Œfrpc" class="headerlink" title="è¿è¡Œfrpc"></a>è¿è¡Œfrpc</h3><p>é…ç½®å®Œæˆfrpc.iniåï¼Œå°±å¯ä»¥è¿è¡Œfrpcäº†</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># ä½¿ç”¨å‘½ä»¤æç¤ºç¬¦æˆ–Powershellè¿›å…¥è¯¥ç›®å½•ä¸‹</span><span class="token builtin class-name">cd</span> D:<span class="token punctuation">\</span>frp`<span class="token comment"># æ‰§è¡Œ</span>./frpc <span class="token parameter variable">-c</span> frpc.ini<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œfrpcç¨‹åºï¼Œçª—å£ä¸­è¾“å‡ºå¦‚ä¸‹å†…å®¹è¡¨ç¤ºè¿è¡Œæ­£å¸¸ã€‚</p><pre class="line-numbers language-none"><code class="language-none">2020/04/03 23:14:56 [I] [service.go:205] login to server success, get run id [2b65b4e58a5917ac], server udp port [0]2020/04/03 23:14:56 [I] [proxy_manager.go:136] [2b65b4e58a5917ac] proxy added: [rdp smb]2020/04/03 23:14:56 [I] [control.go:143] [smb] start proxy success2020/04/03 23:14:56 [I] [control.go:143] [rdp] start proxy success<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸è¦å…³é—­å‘½ä»¤è¡Œçª—å£ï¼Œæ­¤æ—¶å¯ä»¥åœ¨å±€åŸŸç½‘å¤–ä½¿ç”¨ç›¸åº”ç¨‹åºè®¿é—® x.x.x.x:xxxx ï¼ˆIPä¸ºVPSçš„IPï¼Œç«¯å£ä¸ºè‡ªå®šä¹‰çš„remote_portï¼‰å³å¯è®¿é—®åˆ°ç›¸åº”æœåŠ¡ã€‚</p><h3 id="å®¢æˆ·ç«¯åå°è¿è¡ŒåŠè‡ªå¯"><a href="#å®¢æˆ·ç«¯åå°è¿è¡ŒåŠè‡ªå¯" class="headerlink" title="å®¢æˆ·ç«¯åå°è¿è¡ŒåŠè‡ªå¯"></a>å®¢æˆ·ç«¯åå°è¿è¡ŒåŠè‡ªå¯</h3><h4 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h4><p>frpcè¿è¡Œæ—¶å§‹ç»ˆæœ‰ä¸€ä¸ªå‘½ä»¤è¡Œçª—å£è¿è¡Œåœ¨å‰å°ï¼Œå½±å“ç¾è§‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ‰¹å¤„ç†æ–‡ä»¶æ¥å°†å…¶è¿è¡Œåœ¨åå°ï¼Œè€Œä¸”å¯ä»¥åŒå‡»æ‰§è¡Œï¼Œæ¯æ¬¡æ‰“å¼€frpcä¸ç”¨å†è‡ªå·±è¾“å‘½ä»¤äº†ã€‚<br>åœ¨ä»»ä½•ä¸€ä¸ªç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶å¹¶å°†å…¶é‡å‘½åä¸º<code>frpc.bat</code>ï¼Œç¼–è¾‘ï¼Œç²˜è´´å¦‚ä¸‹å†…å®¹å¹¶ä¿å­˜ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">@echo off<span class="token keyword">if</span> <span class="token string">"%1"</span> <span class="token operator">==</span> <span class="token string">"h"</span> goto beginmshta vbscript:createobject<span class="token punctuation">(</span><span class="token string">"wscript.shell"</span><span class="token punctuation">)</span>.run<span class="token punctuation">(</span><span class="token string">""</span>"%~nx0<span class="token string">""</span> h",0<span class="token punctuation">)</span><span class="token punctuation">(</span>window.close<span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token builtin class-name">exit</span>:beginREM<span class="token builtin class-name">cd</span> D:<span class="token punctuation">\</span>frpfrpc <span class="token parameter variable">-c</span> frpc.ini<span class="token builtin class-name">exit</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°†cdåçš„è·¯å¾„æ›´æ”¹ä¸ºä½ çš„frpcå®é™…å­˜æ”¾çš„ç›®å½•ã€‚</p><p>ä¹‹åç›´æ¥è¿è¡Œè¿™ä¸ª <code>.bat</code> æ–‡ä»¶å³å¯å¯åŠ¨frpcå¹¶éšè—çª—å£ï¼ˆå¯åœ¨ä»»åŠ¡ç®¡ç†å™¨ä¸­é€€å‡ºï¼‰ã€‚<br>è‡³äºå¼€æœºå¯åŠ¨ï¼ŒæŠŠè¿™ä¸ª .bat æ–‡ä»¶ç›´æ¥æ‰”è¿›Windowsçš„å¼€æœºå¯åŠ¨æ–‡ä»¶å¤¹å°±å¥½äº†)<br>è‡³æ­¤ï¼ŒWindowså®¢æˆ·ç«¯é…ç½®å®Œæˆï¼Œä¹‹åå°±æ˜¯ä½ è‡ªå·±æ ¹æ®éœ€è¦åœ¨frpc.iniåè¿½åŠ è§„åˆ™å³å¯ã€‚</p><p>å®¢æˆ·ç«¯å¯åŠ¨åå°è¿è¡Œ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nohup</span> ./frpc <span class="token parameter variable">-c</span> frpc.ini <span class="token operator">&amp;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nohup</span> /mnt/user/moedata/frp/frpc <span class="token parameter variable">-c</span> /mnt/user/moedata/frp/frpc.ini <span class="token operator">&amp;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å®¢æˆ·ç«¯åœæ­¢åå°è¿è¡Œ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ps</span> -aux<span class="token operator">|</span><span class="token function">grep</span> frp<span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token function">grep</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> NAS </tag>
            
            <tag> Network </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨NPSè¿›è¡Œå†…ç½‘ç©¿é€</title>
      <link href="/20200316/intranet-penetration-by-nps/"/>
      <url>/20200316/intranet-penetration-by-nps/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="æœåŠ¡ç«¯"><a href="#æœåŠ¡ç«¯" class="headerlink" title="æœåŠ¡ç«¯"></a>æœåŠ¡ç«¯</h3><h4 id="ä¸‹è½½-NPS-ç¨‹åºå®‰è£…"><a href="#ä¸‹è½½-NPS-ç¨‹åºå®‰è£…" class="headerlink" title="ä¸‹è½½ NPS ç¨‹åºå®‰è£…"></a>ä¸‹è½½ NPS ç¨‹åºå®‰è£…</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># è¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œæ ¹æ®CPUæ¶æ„ï¼Œé€‰æ‹©ç›¸åº”ç‰ˆæœ¬å¹¶è¿›è¡Œä¸‹è½½</span><span class="token function">wget</span> https://github.com/ehang-io/nps/releases/download/v0.26.6/linux_amd64_server.tar.gz<span class="token comment"># è§£å‹</span><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> linux_amd64_server.tar.gz<span class="token comment"># æ–‡ä»¶å¤¹æ”¹ä¸ªåï¼Œæ–¹ä¾¿ä½¿ç”¨</span><span class="token function">cp</span> <span class="token parameter variable">-r</span> linux_amd64_server nps_server<span class="token comment"># è¿›å…¥nps_server</span><span class="token builtin class-name">cd</span> nps_server<span class="token comment"># å¼€å¯Nps</span>./nps start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><span id="more"></span><h4 id="Docker-å®‰è£…"><a href="#Docker-å®‰è£…" class="headerlink" title="Docker å®‰è£…"></a>Docker å®‰è£…</h4><pre class="line-numbers language-none"><code class="language-none"># dockeræ–¹å¼docker run -d --name npsserver --net=host -v /home/npsconf:/conf ffdfgdfg/nps<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="nps-conf-å…³é”®é…ç½®"><a href="#nps-conf-å…³é”®é…ç½®" class="headerlink" title="nps.conf å…³é”®é…ç½®"></a>nps.conf å…³é”®é…ç½®</h4><pre class="line-numbers language-none"><code class="language-none"># Public password, which clients can use to connect to the server# After the connection, the server will be able to open relevant ports and parse related domain names according to its own configuration file.public_vkey=abcdx#webweb_host=1.2.3.4web_username=UserNameweb_password=xzyweb_port = 8012<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å®¢æˆ·ç«¯"><a href="#å®¢æˆ·ç«¯" class="headerlink" title="å®¢æˆ·ç«¯"></a>å®¢æˆ·ç«¯</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@WeicoolsNAS:/mnt/user/moedata/<span class="token comment">#</span><span class="token function">mkdir</span> NpsClientroot@WeicoolsNAS:/mnt/user/moedata/<span class="token comment">#</span><span class="token builtin class-name">cd</span> NpsClientroot@WeicoolsNAS:/mnt/user/moedata/NpsClient<span class="token comment">#</span><span class="token function">wget</span> https://github.com/cnlh/nps/releases/download/v0.26.6/linux_amd64_client.tar.gzroot@WeicoolsNAS:/mnt/user/moedata/NpsClient<span class="token comment">#</span><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> linux_amd64_client.tar.gz<span class="token comment"># ä¸´æ—¶è¿è¡Œæµ‹è¯•</span>root@WeicoolsNAS:/mnt/user/moedata/NpsClient<span class="token comment">#</span>./npc <span class="token parameter variable">-server</span><span class="token operator">=</span><span class="token number">104.36</span>.64.74:8024 <span class="token parameter variable">-vkey</span><span class="token operator">=</span>weicools@2233 <span class="token parameter variable">-type</span><span class="token operator">=</span>tcp<span class="token comment"># åå°è¿è¡Œ</span>root@WeicoolsNAS:/mnt/user/moedata/NpsClient<span class="token comment">#</span><span class="token function">nohup</span> ./npc <span class="token parameter variable">-server</span><span class="token operator">=</span>weicools.tk:8024 <span class="token parameter variable">-vkey</span><span class="token operator">=</span>weicools@2233 <span class="token parameter variable">-type</span><span class="token operator">=</span>tcp<span class="token function">nohup</span> ./npc <span class="token parameter variable">-server</span><span class="token operator">=</span>weicools.tk:8024 <span class="token parameter variable">-vkey</span><span class="token operator">=</span>weicools@12138 <span class="token parameter variable">-type</span><span class="token operator">=</span>tcp<span class="token function">nohup</span> ./npc <span class="token parameter variable">-server</span><span class="token operator">=</span><span class="token number">104.36</span>.64.74:8024 <span class="token parameter variable">-vkey</span><span class="token operator">=</span>weicools@2233 <span class="token parameter variable">-type</span><span class="token operator">=</span>tcp<span class="token function">nohup</span> ./npc <span class="token parameter variable">-server</span><span class="token operator">=</span><span class="token number">104.36</span>.64.74:8024 <span class="token parameter variable">-vkey</span><span class="token operator">=</span>weicools@12138 <span class="token parameter variable">-type</span><span class="token operator">=</span>tcp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="NPS-å¼€æœºè‡ªå¯"><a href="#NPS-å¼€æœºè‡ªå¯" class="headerlink" title="NPS å¼€æœºè‡ªå¯"></a>NPS å¼€æœºè‡ªå¯</h3><h4 id="ç¾¤æ™–"><a href="#ç¾¤æ™–" class="headerlink" title="ç¾¤æ™–"></a>ç¾¤æ™–</h4><blockquote><p><a href="https://www.jianshu.com/p/2f4d13636e38">https://www.jianshu.com/p/2f4d13636e38</a></p></blockquote><pre class="line-numbers language-none"><code class="language-none">Weicools@WeicoolsSyno:~$ sudo -ivi /usr/syno/etc.defaults/rc.sysv/autonps.shinput: /var/services/homes/Weicools/NpsClient/./npc -server=weicools.tk:8024 -vkey=weicools@12138 -type=tcpvi /etc/rcinput(:$):# Auto start nps client/usr/syno/etc.defaults/rc.sysv/autonps.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Unraid"><a href="#Unraid" class="headerlink" title="Unraid"></a>Unraid</h4><p><a href="https://www.vediotalk.com/archives/4184">https://www.vediotalk.com/archives/4184</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> NAS </tag>
            
            <tag> Network </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç«¯å£å·å ç”¨è§£å†³æ–¹æ³•</title>
      <link href="/20200306/port-number-occupy-solution/"/>
      <url>/20200306/port-number-occupy-solution/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ç«¯å£å·å ç”¨è§£å†³æ–¹æ³•"><a href="#ç«¯å£å·å ç”¨è§£å†³æ–¹æ³•" class="headerlink" title="ç«¯å£å·å ç”¨è§£å†³æ–¹æ³•"></a>ç«¯å£å·å ç”¨è§£å†³æ–¹æ³•</h1><h2 id="Linux-ç«¯å£å·å ç”¨è§£å†³æ–¹æ³•"><a href="#Linux-ç«¯å£å·å ç”¨è§£å†³æ–¹æ³•" class="headerlink" title="Linux ç«¯å£å·å ç”¨è§£å†³æ–¹æ³•"></a>Linux ç«¯å£å·å ç”¨è§£å†³æ–¹æ³•</h2><h3 id="æŸ¥è¯¢ç«¯å£å·"><a href="#æŸ¥è¯¢ç«¯å£å·" class="headerlink" title="æŸ¥è¯¢ç«¯å£å·"></a>æŸ¥è¯¢ç«¯å£å·</h3><ol><li>ä½¿ç”¨<code>netstat</code>å‘½ä»¤<br>netstat -tunlp ä¼šæ˜¾ç¤ºæ‰€æœ‰ç«¯å£å’Œæ‰€æœ‰å¯¹åº”çš„ç¨‹åºï¼Œå¦‚æœåƒå¾—åˆ°è‡ªå·±å…³ç³»çš„ç»“æœï¼Œå¯ä»¥ä½¿ç”¨ grep å¯¹ç»“æœé›†è¿›è¡Œè¿‡æ»¤ã€‚ä¾‹å¦‚ï¼š</li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">netstat</span> <span class="token parameter variable">-tunlp</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token function">java</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ ·å°±èƒ½è¿‡æ»¤å‡ºåªå¸¦æœ‰ java è¿›ç¨‹çš„æ‰€æœ‰ç«¯å£è¢«å ç”¨çš„æƒ…å†µã€‚</p><span id="more"></span><ol start="2"><li>ä½¿ç”¨<code>lsof -i:æŸä¸ªç«¯å£</code></li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># æŸ¥çœ‹22å·ç«¯å£è¢«å ç”¨çš„ç¨‹åº</span><span class="token function">lsof</span> <span class="token parameter variable">-i:22</span><span class="token comment"># é€šè¿‡ä¸Šè¿°å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹åˆ°ç›¸åº”çš„è¿›ç¨‹å·ï¼Œå¦‚æœè¿˜æƒ³æŸ¥çœ‹è¯¥è¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯å¯ä»¥ä½¿ç”¨ï¼š</span><span class="token function">ps</span> <span class="token parameter variable">-ef</span> <span class="token operator">|</span> <span class="token function">grep</span> è¿›ç¨‹å·<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ€æ‰è¿›ç¨‹"><a href="#æ€æ‰è¿›ç¨‹" class="headerlink" title="æ€æ‰è¿›ç¨‹"></a>æ€æ‰è¿›ç¨‹</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">kill</span> <span class="token parameter variable">-9</span> PIDå·<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="windows-ç«¯å£å ç”¨è§£å†³æ–¹æ³•"><a href="#windows-ç«¯å£å ç”¨è§£å†³æ–¹æ³•" class="headerlink" title="windows ç«¯å£å ç”¨è§£å†³æ–¹æ³•"></a>windows ç«¯å£å ç”¨è§£å†³æ–¹æ³•</h2><p>æŸ¥çœ‹æ‰€æœ‰çš„ç«¯å£å ç”¨æƒ…å†µ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">netstat</span> <span class="token parameter variable">-ano</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŸ¥æ‰¾æŒ‡å®šç«¯å£çš„å ç”¨æƒ…å†µ<br>ä¾‹å¦‚æŸ¥æ‰¾ 8080 ç«¯å£ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">netstat</span> <span class="token parameter variable">-ano</span> <span class="token operator">|</span> findstr <span class="token string">"8080"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é€šè¿‡æŸ¥æ‰¾ç«¯å£å·å°±èƒ½æ‰¾åˆ°ç›¸åº”çš„è¿›ç¨‹å·ï¼Œé€šè¿‡æŸ¥æ‰¾ç›¸åº”çš„è¿›ç¨‹å·å°±èƒ½æ‰¾åˆ°ç›¸åº”è¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯<br>æŸ¥çœ‹å¯¹åº” PID å¯¹åº”çš„è¿›ç¨‹</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">tasklist <span class="token operator">|</span> findstr <span class="token string">"5555"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é€šè¿‡ tasklist å¯ä»¥åˆ—å‡ºå…·ä½“çš„è¿›ç¨‹ä¿¡æ¯<br>é€šè¿‡è¿›ç¨‹åï¼Œåœæ­¢è¿›ç¨‹</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">taskkill /f /t /im xxx.exetaskkill <span class="token parameter variable">-PID</span> <span class="token operator">&lt;</span>è¿›ç¨‹å·<span class="token operator">&gt;</span> <span class="token parameter variable">-F</span> //å¼ºåˆ¶å…³é—­æŸä¸ªè¿›ç¨‹ ï¼Œä¾‹å¦‚ï¼štaskkill <span class="token parameter variable">-PID</span> <span class="token number">5555</span> <span class="token parameter variable">-F</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> Network </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android TabLayout</title>
      <link href="/20200225/android-widget-tablayout/"/>
      <url>/20200225/android-widget-tablayout/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Android-TabLayout"><a href="#Android-TabLayout" class="headerlink" title="Android TabLayout"></a>Android TabLayout</h1><h2 id="ä¼˜é›…åœ°ä¿®æ”¹æŒ‡ç¤ºå™¨å®½åº¦"><a href="#ä¼˜é›…åœ°ä¿®æ”¹æŒ‡ç¤ºå™¨å®½åº¦" class="headerlink" title="ä¼˜é›…åœ°ä¿®æ”¹æŒ‡ç¤ºå™¨å®½åº¦"></a>ä¼˜é›…åœ°ä¿®æ”¹æŒ‡ç¤ºå™¨å®½åº¦</h2><p>åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šç¢°åˆ°æŠŠæŒ‡ç¤ºå™¨çš„å®½åº¦ï¼Œåšçš„å’Œæ–‡å­—å®½åº¦ä¸€æ ·ï¼Œæˆ–è€…æ¯”æ–‡å­—å®½åº¦è¿˜è¦çŸ­çš„è®¾è®¡ã€‚ä½¿ç”¨ TabLayout æˆ‘ä»¬å¯ä»¥å¿«é€Ÿå®ç°ä¸€ä¸ª Material Design é£æ ¼çš„æ ‡ç­¾æ ï¼Œä½† TabLayout çš„æŒ‡ç¤ºçº¿ Indicator é»˜è®¤æ˜¯å æ»¡ä¸€æ ¼ Tab çš„ï¼Œä¸”å®˜æ–¹æœªç›´æ¥æä¾›ä¿®æ”¹ Indicator å®½åº¦çš„æ–¹æ³•ã€‚</p><h3 id="åå°„"><a href="#åå°„" class="headerlink" title="åå°„"></a>åå°„</h3><p>å¦‚æœä½ çš„é¡¹ç›®ä¸­ä¹Ÿæœ‰ä¿®æ”¹æŒ‡ç¤ºçº¿å®½åº¦çš„éœ€æ±‚ï¼Œå¹¶ä¸”å·²ç»åœ¨ç½‘ä¸Šæ‰¾è¿‡ä¿®æ”¹æ–¹æ³•ï¼Œå¾ˆå¯èƒ½ä½ ç°åœ¨é¡¹ç›®ä¸­ç”¨çš„å°±æ˜¯è¿™ä¸ªæ–¹æ³•ã€‚é€šè¿‡åˆ†ææºç ç”¨åå°„å®ç°çš„ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setIndicatorWidth</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token keyword">final</span> <span class="token class-name">TabLayout</span> tabLayout<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token keyword">int</span> margin<span class="token punctuation">)</span> <span class="token punctuation">{</span>    tabLayout<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token annotation punctuation">@Override</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                <span class="token class-name">Field</span> mTabStripField <span class="token operator">=</span> tabLayout<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">"mTabStrip"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                mTabStripField<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token class-name">LinearLayout</span> mTabStrip <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">LinearLayout</span><span class="token punctuation">)</span> mTabStripField<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>tabLayout<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> mTabStrip<span class="token punctuation">.</span><span class="token function">getChildCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token class-name">View</span> tabView <span class="token operator">=</span> mTabStrip<span class="token punctuation">.</span><span class="token function">getChildAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token class-name">Field</span> mTextViewField <span class="token operator">=</span> tabView<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">"mTextView"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    mTextViewField<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token class-name">TextView</span> mTextView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">TextView</span><span class="token punctuation">)</span> mTextViewField<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>tabView<span class="token punctuation">)</span><span class="token punctuation">;</span>                    tabView<span class="token punctuation">.</span><span class="token function">setPadding</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">int</span> width <span class="token operator">=</span> mTextView<span class="token punctuation">.</span><span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>width <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        mTextView<span class="token punctuation">.</span><span class="token function">measure</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        width <span class="token operator">=</span> mTextView<span class="token punctuation">.</span><span class="token function">getMeasuredWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span>                    <span class="token class-name">LinearLayout<span class="token punctuation">.</span>LayoutParams</span> params <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">LinearLayout<span class="token punctuation">.</span>LayoutParams</span><span class="token punctuation">)</span> tabView<span class="token punctuation">.</span><span class="token function">getLayoutParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    params<span class="token punctuation">.</span>width <span class="token operator">=</span> width<span class="token punctuation">;</span>                    params<span class="token punctuation">.</span>leftMargin <span class="token operator">=</span> margin<span class="token punctuation">;</span>                    params<span class="token punctuation">.</span>rightMargin <span class="token operator">=</span> margin<span class="token punctuation">;</span>                    tabView<span class="token punctuation">.</span><span class="token function">setLayoutParams</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>                    tabView<span class="token punctuation">.</span><span class="token function">invalidate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·åšæ˜¯åœ¨ 28 ä»¥ä¸‹æ²¡é—®é¢˜çš„ï¼Œä½†å¦‚æœæŠŠé¡¹ç›®çš„ SDK å‡çº§åˆ° 28 æˆ–ä»¥ä¸Šï¼Œå®ƒå°±ä¸å†æœ‰æ•ˆäº†ï¼ŒåŸå› æ˜¯ TabLayout æºç ä¸­çš„å˜é‡åä¿®æ”¹äº†ï¼Œæ‰€ä»¥ä»£ç ä¹Ÿè¦æ”¹æˆè¿™æ ·ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setIndicatorWidth</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token keyword">final</span> <span class="token class-name">TabLayout</span> tabLayout<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token keyword">int</span> margin<span class="token punctuation">)</span> <span class="token punctuation">{</span>    tabLayout<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token annotation punctuation">@Override</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                <span class="token class-name">Field</span> slidingTabIndicatorField <span class="token operator">=</span> tabLayout<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">"slidingTabIndicator"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                slidingTabIndicatorField<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token class-name">LinearLayout</span> mTabStrip <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">LinearLayout</span><span class="token punctuation">)</span> slidingTabIndicatorField<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>tabLayout<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> mTabStrip<span class="token punctuation">.</span><span class="token function">getChildCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token class-name">View</span> tabView <span class="token operator">=</span> mTabStrip<span class="token punctuation">.</span><span class="token function">getChildAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token class-name">Field</span> textViewField <span class="token operator">=</span> tabView<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">"textView"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    textViewField<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token class-name">TextView</span> mTextView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">TextView</span><span class="token punctuation">)</span> textViewField<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>tabView<span class="token punctuation">)</span><span class="token punctuation">;</span>                    tabView<span class="token punctuation">.</span><span class="token function">setPadding</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">int</span> width <span class="token operator">=</span> mTextView<span class="token punctuation">.</span><span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>width <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        mTextView<span class="token punctuation">.</span><span class="token function">measure</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        width <span class="token operator">=</span> mTextView<span class="token punctuation">.</span><span class="token function">getMeasuredWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span>                    <span class="token class-name">LinearLayout<span class="token punctuation">.</span>LayoutParams</span> params <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">LinearLayout<span class="token punctuation">.</span>LayoutParams</span><span class="token punctuation">)</span> tabView<span class="token punctuation">.</span><span class="token function">getLayoutParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    params<span class="token punctuation">.</span>width <span class="token operator">=</span> width<span class="token punctuation">;</span>                    params<span class="token punctuation">.</span>leftMargin <span class="token operator">=</span> margin<span class="token punctuation">;</span>                    params<span class="token punctuation">.</span>rightMargin <span class="token operator">=</span> margin<span class="token punctuation">;</span>                    tabView<span class="token punctuation">.</span><span class="token function">setLayoutParams</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>                    tabView<span class="token punctuation">.</span><span class="token function">invalidate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡åå°„è™½ç„¶å¯ä»¥å®ç°ï¼Œä½†æ˜¯åå°„ä¸å¤Ÿä¼˜é›…ï¼Œå¹¶ä¸”å®ƒæœ‰å¯èƒ½å› ä¸º SDK çš„å‡çº§è€Œå¤±æ•ˆã€‚</p><h3 id="è‡ªå®šä¹‰-Tab"><a href="#è‡ªå®šä¹‰-Tab" class="headerlink" title="è‡ªå®šä¹‰ Tab"></a>è‡ªå®šä¹‰ Tab</h3><p>TabLayout ä¸­çš„ Tab æ˜¯å…è®¸è‡ªå®šä¹‰çš„ï¼Œä½† Indicator ä¸å±äº Tabã€‚<br>æ‰€ä»¥æœ‰è¿™æ ·ä¸€ç§è§£å†³æ–¹æ¡ˆï¼ŒæŠŠ Indicator éšè—æ‰ï¼Œç„¶ååœ¨è‡ªå®šä¹‰ Tab çš„å¸ƒå±€ä¸­åŠ å…¥æŒ‡ç¤ºçº¿ã€‚<br>æˆ‘ä»¬å¯ä»¥é€šè¿‡æŠŠ Indicator çš„é¢œè‰²è®¾ä¸ºé€æ˜æ¥éšè—å®ƒï¼š</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>android.support.design.widget.TabLayout</span>    <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/tab_layout<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">app:</span>tabIndicatorColor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@android:color/transparent<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ä»£ç ä¸­ï¼Œå½“ Tab æ·»åŠ å®Œæ¯•åï¼Œæ›¿æ¢æˆè‡ªå®šä¹‰çš„ Tabï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">TabLayout<span class="token punctuation">.</span>Tab</span> tab <span class="token operator">=</span> tabLayout<span class="token punctuation">.</span><span class="token function">getTabAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>tab<span class="token punctuation">.</span><span class="token function">setCustomView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>layout_tab<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">TextView</span> tv <span class="token operator">=</span> tab<span class="token punctuation">.</span><span class="token function">getCustomView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>text_view<span class="token punctuation">)</span><span class="token punctuation">;</span>tv<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>tab<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å¹¶ä¸”è¿˜éœ€è¦ç›‘å¬ Tab çš„åˆ‡æ¢ï¼Œæ§åˆ¶æŒ‡ç¤ºçº¿çš„æ˜¾ç¤ºéšè—ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">tabLayout<span class="token punctuation">.</span><span class="token function">addOnTabSelectedListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TabLayout<span class="token punctuation">.</span>OnTabSelectedListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onTabSelected</span><span class="token punctuation">(</span><span class="token class-name">TabLayout<span class="token punctuation">.</span>Tab</span> tab<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">// TODO åˆ·æ–°Tab</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onTabUnselected</span><span class="token punctuation">(</span><span class="token class-name">TabLayout<span class="token punctuation">.</span>Tab</span> tab<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">// TODO åˆ·æ–°Tab</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onTabReselected</span><span class="token punctuation">(</span><span class="token class-name">TabLayout<span class="token punctuation">.</span>Tab</span> tab<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”¨è¿™ç§æ–¹æ³•ï¼Œä»€ä¹ˆæ ·å¼éƒ½èƒ½å®ç°äº†ã€‚ä½†æœ‰ä¸ªç¼ºç‚¹æ˜¯: åœ¨ Tab åˆ‡æ¢çš„æ—¶å€™ï¼Œæ²¡æœ‰äº†æŒ‡ç¤ºçº¿çš„ç§»åŠ¨åŠ¨ç”»ã€‚</p><h3 id="Support-v28-å±æ€§é…ç½®"><a href="#Support-v28-å±æ€§é…ç½®" class="headerlink" title="Support v28+ å±æ€§é…ç½®"></a>Support v28+ å±æ€§é…ç½®</h3><p>å¦‚æœä½ ä½¿ç”¨çš„ SDK ç‰ˆæœ¬æ˜¯ 28 æˆ–ä»¥ä¸Šï¼Œå¹¶ä¸”éœ€è¦å°† Indicator çš„å®½åº¦ä¿®æ”¹æˆå’Œæ–‡å­—å®½åº¦ä¸€æ ·ï¼Œé‚£ä¹ˆå¤ªæ£’äº†ï¼Œç°åœ¨ä½ åªéœ€è¦ç»™ TabLayout é…ç½®ä¸€ä¸ªå±æ€§å°±å¥½äº†ï¼š</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>android.support.design.widget.TabLayout</span>    <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/tab_layout<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">app:</span>tabIndicatorFullWidth</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“ tabIndicatorFullWidth å– false çš„æ—¶å€™ï¼ŒIndicator çš„å®½åº¦ä¼šå’Œæ–‡å­—çš„å®½åº¦ä¸€æ ·ï¼Œä½†è¿™ä¹Ÿæ„å‘³ç€ï¼Œå½“ä¸åŒ Tab é‡Œçš„æ–‡å­—å®½åº¦ä¸ä¸€æ ·æ—¶ï¼ŒIndicator çš„å®½åº¦ä¹Ÿä¼šä¸ä¸€æ ·ï¼Œåƒä¸‹é¢è¿™æ ·ã€‚</p><p>//todo è´´å›¾</p><p>å¦‚æœè®¾è®¡è¦æ±‚ Indicator çš„å®½åº¦å¿…é¡»å›ºå®šï¼Œæˆ–è€…å®½åº¦è¦æ¯”æ–‡å­—çŸ­ï¼Œé‚£æˆ‘ä»¬è¿˜è¦æ¥ç€æ‰¾åˆ«çš„è§£å†³æ–¹æ¡ˆã€‚</p><h3 id="ä½¿ç”¨-Drawable-æ ·å¼"><a href="#ä½¿ç”¨-Drawable-æ ·å¼" class="headerlink" title="ä½¿ç”¨ Drawable æ ·å¼"></a>ä½¿ç”¨ Drawable æ ·å¼</h3><p>è¿™ç§æ–¹æ¡ˆå¯èƒ½æ˜¯æœ€ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆï¼Œä½¿ç”¨ä¹Ÿç‰¹åˆ«ç®€å•ã€‚<br>Indicator æ˜¯å…è®¸æˆ‘ä»¬è®¾ç½® drawable æ¥è‡ªå®šä¹‰æ ·å¼çš„ï¼Œæ¯”å¦‚æ·»åŠ åœ†è§’ä»€ä¹ˆçš„ã€‚ä½†æ— è®ºä»€ä¹ˆæ ·å¼ï¼ŒIndicator ä¾ç„¶æ˜¯å æ»¡ Tab å®½åº¦çš„ã€‚æ²¡å…³ç³»ï¼Œæˆ‘ä»¬æŠŠå®ƒçš„èƒŒæ™¯è®¾æˆé€æ˜ï¼ŒåŒ…å«ä¸€ä¸ªå›ºå®šå®½åº¦çš„ shape å°±å¥½äº†ï¼Œåƒè¿™æ ·ï¼š</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layer-list</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res/android<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>shape</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>rectangle<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span> <span class="token attr-name"><span class="token namespace">android:</span>gravity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>shape</span><span class="token punctuation">&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>size</span>                <span class="token attr-name"><span class="token namespace">android:</span>width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>16dp<span class="token punctuation">"</span></span>                <span class="token attr-name"><span class="token namespace">android:</span>height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>4dp<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>corners</span> <span class="token attr-name"><span class="token namespace">android:</span>radius</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>4dp<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>solid</span> <span class="token attr-name"><span class="token namespace">android:</span>color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@color/colorAccent<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>shape</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>layer-list</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶ååœ¨å¸ƒå±€æ–‡ä»¶ä¸­é…ç½® tabIndicator å±æ€§ï¼š</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!-- app:tabIndicator éœ€è¦å‡çº§Supportåº“åˆ°v28 --&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>android.support.design.widget.TabLayout</span>    <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@+id/tab_layout<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">app:</span>tabIndicatorHeight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>10dp<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">app:</span>tabIndicator</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@drawable/tab_indicator<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¹Ÿå¯ä»¥åœ¨ä»£ç ä¸­è®¾ç½®ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// setSelectedTabIndicator éœ€è¦å‡çº§Supportåº“åˆ°v28</span>tabLayout<span class="token punctuation">.</span><span class="token function">setSelectedTabIndicator</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>tab_indicator<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä»ä¸Šé¢è¿™ä¸ªä¾‹å­è¿˜å¯ä»¥å‘ç°ï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¸ä»…å¯ä»¥åœ¨è§†è§‰ä¸Šå¢åŠ  Indicator çš„å·¦å³è¾¹è·ï¼Œè¿˜å¯ä»¥å¢åŠ å®ƒçš„ä¸Šä¸‹è¾¹è·ã€‚</p><p>å¥½å•¦ï¼Œå…¶å®å°±æ˜¯é…ç½®ä¸€ä¸ª Drawable æ–‡ä»¶è¿™ä¹ˆç®€å•ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Widget </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IADB æ‰©å±•</title>
      <link href="/20200106/iadb/"/>
      <url>/20200106/iadb/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="IADB-å·¥å…·"><a href="#IADB-å·¥å…·" class="headerlink" title="IADB å·¥å…·"></a>IADB å·¥å…·</h1><p>ADB æ‰©å±•å·¥å…·</p><p>å«ä¹‰ï¼ši adb &amp;&amp; IA Debug Bridge<br>å®ç°æ­¥éª¤ï¼š</p><ol><li>Shell è„šæœ¬ï¼šiadb.shï¼ˆè°ƒç”¨ adb å‘½ä»¤ï¼‰</li><li>äºŒè¿›åˆ¶ç¨‹åºï¼šiadbï¼ˆä½¿ç”¨ shc å°è£…æˆå¯æ‰§è¡Œç¨‹åºï¼‰<span id="more"></span></li></ol><p><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/Ns2t4O.png"></p><h2 id="å‚æ•°-1"><a href="#å‚æ•°-1" class="headerlink" title="å‚æ•° 1"></a>å‚æ•° 1</h2><table><thead><tr><th>Param</th><th>AppName</th><th>PackageName</th></tr></thead><tbody><tr><td>sp</td><td>SpaceK</td><td>com.oneapp.max.cleaner.booster.cn</td></tr><tr><td>op</td><td>Optimizer-K</td><td>com.oneapp.max.cn</td></tr><tr><td>pp</td><td>PPP-K</td><td>com.oneapp.max.security.pro.cn</td></tr><tr><td>wa</td><td>Walk-K</td><td>Com.walk.sports.cn</td></tr></tbody></table><h2 id="å‚æ•°-2"><a href="#å‚æ•°-2" class="headerlink" title="å‚æ•° 2"></a>å‚æ•° 2</h2><table><thead><tr><th>Param</th><th>è¯´æ˜</th><th>ä½¿ç”¨</th></tr></thead><tbody><tr><td>rp</td><td>Revoke Permissions</td><td></td></tr><tr><td>rp-r</td><td>Revoke Permissions and Restart</td><td></td></tr><tr><td>uninstall</td><td>Uninstall App</td><td></td></tr><tr><td>kill</td><td>Kill App</td><td></td></tr><tr><td>start</td><td>Start App</td><td></td></tr><tr><td>restart</td><td>Restart App</td><td></td></tr><tr><td>clear</td><td>Clear App Data</td><td></td></tr><tr><td>clear-r</td><td>Clear App Data and&nbsp;Restart</td><td></td></tr></tbody></table><h3 id="Revoke-Permissions"><a href="#Revoke-Permissions" class="headerlink" title="Revoke Permissions"></a>Revoke Permissions</h3><h3 id="Revoke-Permissions-and-Restart"><a href="#Revoke-Permissions-and-Restart" class="headerlink" title="Revoke Permissions and Restart"></a>Revoke Permissions and Restart</h3><h3 id="Uninstall-App"><a href="#Uninstall-App" class="headerlink" title="Uninstall App"></a>Uninstall App</h3><pre class="line-numbers language-none"><code class="language-none">adb uninstall [-k] &lt;packagename&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><packagename> è¡¨ç¤ºåº”ç”¨çš„åŒ…åï¼Œ-k å‚æ•°å¯é€‰ï¼Œè¡¨ç¤ºå¸è½½åº”ç”¨ä½†ä¿ç•™æ•°æ®å’Œç¼“å­˜ç›®å½•</packagename></p><h3 id="Kill-App"><a href="#Kill-App" class="headerlink" title="Kill App"></a>Kill App</h3><h3 id="Start-App"><a href="#Start-App" class="headerlink" title="Start App"></a>Start App</h3><h3 id="Restart-App"><a href="#Restart-App" class="headerlink" title="Restart App"></a>Restart App</h3><h3 id="Clear-App-Data"><a href="#Clear-App-Data" class="headerlink" title="Clear App Data"></a>Clear App Data</h3><pre class="line-numbers language-none"><code class="language-none">adb shell pm clear &lt;packagename&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>&lt;packagename&gt;</code> è¡¨ç¤ºåº”ç”¨ååŒ…ï¼Œè¿™æ¡å‘½ä»¤çš„æ•ˆæœç›¸å½“äºåœ¨è®¾ç½®é‡Œçš„åº”ç”¨ä¿¡æ¯ç•Œé¢ç‚¹å‡»äº†ã€Œæ¸…é™¤ç¼“å­˜ã€å’Œã€Œæ¸…é™¤æ•°æ®ã€</p><h3 id="Clear-App-Data-and-Restart"><a href="#Clear-App-Data-and-Restart" class="headerlink" title="Clear App Data and&nbsp;Restart"></a>Clear App Data and&nbsp;Restart</h3><p>è„šæœ¬çš„å¥½å¤„æ˜¯ä¾¿æ·ã€é«˜æ•ˆï¼Œæ‹¿èµ·æ¥å°±å¯ä»¥å†™ï¼Œå†™å®Œå°±èƒ½è·‘ï¼Œéƒ½ä¸ç”¨ç¼–è¯‘</p><p>ä½†åå¤„ä¹Ÿæ˜¾è€Œæ˜“è§ï¼Œä¸€äº›æ•æ„Ÿçš„ã€ä¸æƒ³è®©å¤–äººçŸ¥é“çš„ä¸œè¥¿éƒ½æ˜¯æ˜æ–‡å†™åœ¨é‡Œé¢çš„ï¼Œæ‰€ä»¥ï¼Œåœ¨è¿™æ¨èä¸€æ¬¾ç¥å¥‡çš„è„šæœ¬å°è£…ç¨‹åºâ€”â€”shcï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">brew <span class="token function">install</span> shc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ—¥å¸¸ç”¨æ³•ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">shc <span class="token parameter variable">-r</span> <span class="token parameter variable">-f</span> /shellfile.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿è¡ŒæˆåŠŸåä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼š</p><pre class="line-numbers language-none"><code class="language-none">shellfile.sh.xshellfile.sh.c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><code>shellfile.sh.x</code>æ˜¯è„šæœ¬æ‰€å¯¹åº”çš„å¯æ‰§è¡Œç¨‹åº</p><p><code>shellfile.sh.c</code>æ˜¯<code>shellfile.sh.x</code>å¯¹åº”çš„ c è¯­è¨€å®ç°çš„æºç </p><p>shc æ ¹æ®è„šæœ¬æ–‡ä»¶çš„ç¬¬ä¸€è¡Œ<code>#!/bin/bash</code>æˆ–å…¶ä»– shell å°†è„šæœ¬ç¿»è¯‘æˆç›¸åº”çš„ c æºç å¹¶ç”Ÿæˆå¯æ‰§è¡Œç¨‹åºã€‚</p><p>ä½† shc ä¼¼ä¹æ— æ³•è¯†åˆ« expect</p><p>å°è£…åçš„è„šæœ¬å®‰å…¨æ€§ä¼šæœ‰æ‰€æé«˜ï¼Œä½†è¿™ä¹Ÿä»…èƒ½é˜²ä¸ªå›å­ï¼Œé€šè¿‡ gdb æˆ–å…¶ä»–è°ƒè¯•å·¥å…·ä»ç„¶èƒ½è·å¾—æœ€åˆçš„æºç </p><p>test adb</p>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Script </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Talk-With-Moe</title>
      <link href="/20191222/talk-with-moe/"/>
      <url>/20191222/talk-with-moe/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Talk-With-Me"><a href="#Talk-With-Me" class="headerlink" title="Talk With Me"></a>Talk With Me</h1><p>å•¦å•¦å•¦å•¦å•¦ç•¥ç•¥ç•¥ç•¥ç•¥å•¦å•¦å•¦å•¦å•¦ç•¥ç•¥ç•¥ç•¥ç•¥å•¦å•¦å•¦å•¦å•¦ç•¥ç•¥ç•¥ç•¥ç•¥å•¦å•¦å•¦å•¦å•¦ç•¥ç•¥ç•¥ç•¥ç•¥å•¦å•¦å•¦å•¦å•¦ç•¥ç•¥ç•¥ç•¥ç•¥ï¼Œæ­¤å¤„çœç•¥ä¸€ä¸‡å­—â€¦â€¦</p><span id="more"></span><h3 id="æœ€é«˜å¢ƒç•Œæ˜¯ï¼šæ¯ä¸€å¥éƒ½æœ‰èŠä¸‹å»çš„æ¬²æœ›"><a href="#æœ€é«˜å¢ƒç•Œæ˜¯ï¼šæ¯ä¸€å¥éƒ½æœ‰èŠä¸‹å»çš„æ¬²æœ›" class="headerlink" title="æœ€é«˜å¢ƒç•Œæ˜¯ï¼šæ¯ä¸€å¥éƒ½æœ‰èŠä¸‹å»çš„æ¬²æœ›"></a>æœ€é«˜å¢ƒç•Œæ˜¯ï¼šæ¯ä¸€å¥éƒ½æœ‰èŠä¸‹å»çš„æ¬²æœ›</h3><p>æ¯•ç«Ÿï¼Œå’Œäººå°¬èŠï¼Œä¸æ˜¯ä¸€ä»¶å…‰å½©çš„äº‹ï¼ŒèŠå¤©è¿‡ç¨‹ä¸­ï¼Œè¯·ä½ ä»¬è°¨è®°</p><p>â€œä¸‰ä¸â€å¿ƒæ³•ï¼š</p><ul><li>ä¸è¦è·ªèˆ”</li><li>ä¸è¦è¡¨ç™½</li><li>ä¸è¦ç»ç’ƒå¿ƒ</li></ul><h3 id="æœ‹å‹åœˆæ‰“é€ "><a href="#æœ‹å‹åœˆæ‰“é€ " class="headerlink" title="æœ‹å‹åœˆæ‰“é€ "></a>æœ‹å‹åœˆæ‰“é€ </h3><p>åœ¨è®²èŠå¤©ä¹‹å‰ï¼Œæœ‰ä¸€ä»¶å¾ˆé‡è¦å´åˆéå¸¸å®¹æ˜“è¢«å¿½è§†çš„äº‹æƒ…â€”â€”æœ‹å‹åœˆæ‰“é€ ã€‚WHATï¼Ÿ</p><p>å‡ ä¹æ¯ä¸€ä¸ªäººæ·»åŠ å¥½å‹ä¹‹åï¼Œç¬¬ä¸€ä»¶äº‹å°±æ˜¯å»ç¿»çœ‹æµè§ˆå¯¹æ–¹çš„æœ‹å‹åœˆã€‚ç¿»çœ‹å®Œåï¼Œéƒ½ä¼šåœ¨å¿ƒé‡Œç»™è¿™ä¸ªäººæ‰“ä¸€ä¸ªå°è±¡åˆ†ã€‚</p><p>å¯ä»¥è¯´ï¼Œæœ‹å‹åœˆæ˜¯æˆ‘ä»¬ç¤¾äº¤çš„ç¬¬äºŒèº«ä»½è¯ã€‚WHATï¼Ÿï¼Ÿ</p><h3 id="ä¸€ã€çŸ¥å·±çŸ¥å½¼"><a href="#ä¸€ã€çŸ¥å·±çŸ¥å½¼" class="headerlink" title="ä¸€ã€çŸ¥å·±çŸ¥å½¼"></a>ä¸€ã€çŸ¥å·±çŸ¥å½¼</h3><p>å³â€œäº†è§£ä»–æ˜¯ä»€ä¹ˆæ ·çš„äººï¼Œäº†è§£è‡ªå·±æƒ³æˆä¸ºä»€ä¹ˆæ ·çš„äººâ€ã€‚</p><p>æœ€èµ·ç ï¼Œä½ éœ€è¦äº†è§£ä»–çš„åŸºæœ¬æ€§æ ¼ï¼š<br>æ´»æ³¼å¼€æœ—ï¼Ÿ<br>å†…æ•›ç¾æ¶©ï¼Ÿ<br>æ²‰é»˜å¯¡è¨€ï¼Ÿ<br>é£è¶£å¹½é»˜ï¼Ÿ<br>ç¿æ™ºå¥è°ˆï¼Ÿ</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä»–æ˜¯ä»€ä¹ˆç±»å‹çš„äººï¼Œä¹Ÿå†³å®šäº†ä»–<strong>å¯¹ä»€ä¹ˆæ ·çš„å¥³å­æ„Ÿå…´è¶£</strong></p><p>äº†è§£äº†å¯¹æ–¹ï¼Œä½ è¿˜éœ€è¦çŸ¥é“è‡ªå·±æƒ³æˆä¸ºä»€ä¹ˆæ ·çš„äººã€‚</p><p>ä¸å»ºè®®ä¸€ä¸ªå¥³ç”Ÿä¸ºäº†è®¨å¥½ç”·ç”Ÿï¼Œå»ä¼ªè£…æˆä»–å–œæ¬¢çš„æ ·å­ï¼Œè€Œå¤±å»è‡ªæˆ‘ã€‚</p><p>ä¸€æ¥ä½ ä¹Ÿè£…ä¸äº†å¤šä¹…ï¼›<br>äºŒæ¥ç”¨ä½ çš„ä¸ªæ€§å»å¸å¼•ä»–ï¼Œæ¯”è£…å‡ºä»–å–œæ¬¢çš„æ ·å­æ›´èƒ½ç»´æŒé•¿ä¹…çš„æ„Ÿæƒ…ã€‚</p><h3 id="äºŒã€èŠå¤©æ–¹æ³•è®º"><a href="#äºŒã€èŠå¤©æ–¹æ³•è®º" class="headerlink" title="äºŒã€èŠå¤©æ–¹æ³•è®º"></a>äºŒã€èŠå¤©æ–¹æ³•è®º</h3><h4 id="1ã€èŠ‚å¥ï¼šå¾ªæ¬¡æ¸è¿‘"><a href="#1ã€èŠ‚å¥ï¼šå¾ªæ¬¡æ¸è¿‘" class="headerlink" title="1ã€èŠ‚å¥ï¼šå¾ªæ¬¡æ¸è¿‘"></a>1ã€èŠ‚å¥ï¼šå¾ªæ¬¡æ¸è¿‘</h4><p>èŠå¤©å°±æ˜¯æ²Ÿé€šï¼Œæ²Ÿé€šå°±æ˜¯ä½ æ¥æˆ‘å¾€çš„äº‹æƒ…ã€‚</p><p>å¥½å¤šäººï¼Œä¸€æ¿€åŠ¨èµ·æ¥å°±è‡ªå—¨ï¼Œå”§å”§å“‡å“‡è¯´ä¸€å¤§å †ï¼Œé—®ä¸€å¤§å †é—®é¢˜ï¼Œè¿™æ ·ä¼šè®©äººæ²¡æœ‰èŠä¸‹å»çš„æ¬²æœ›ã€‚</p><h4 id="2ã€æ°”æ°›ï¼šè¯­è¨€è½»å¿«ã€èˆ’æœã€å¹½é»˜"><a href="#2ã€æ°”æ°›ï¼šè¯­è¨€è½»å¿«ã€èˆ’æœã€å¹½é»˜" class="headerlink" title="2ã€æ°”æ°›ï¼šè¯­è¨€è½»å¿«ã€èˆ’æœã€å¹½é»˜"></a>2ã€æ°”æ°›ï¼šè¯­è¨€è½»å¿«ã€èˆ’æœã€å¹½é»˜</h4><p>ä¸€å®šè¦æœ‰è¡¨æƒ…åŒ…ï¼x 3<br>ä»€ä¹ˆè¡¨æƒ…åŒ…ï¼Ÿè¦å¯çˆ±ã€æœ‰è¶£ã€å°æš§æ˜§ï¼</p><h4 id="3ã€è¯é¢˜ï¼šè¦å­¦ä¼šâ€œå†·è¯»æœ¯â€ã€‚"><a href="#3ã€è¯é¢˜ï¼šè¦å­¦ä¼šâ€œå†·è¯»æœ¯â€ã€‚" class="headerlink" title="3ã€è¯é¢˜ï¼šè¦å­¦ä¼šâ€œå†·è¯»æœ¯â€ã€‚"></a>3ã€è¯é¢˜ï¼šè¦å­¦ä¼šâ€œå†·è¯»æœ¯â€ã€‚</h4><p>å†·è¯»ä»–çš„åŸºæœ¬ä¿¡æ¯ï¼šå¤´åƒã€æ˜µç§°ã€ä¸ªæ€§ç­¾åï¼Œå°¤å…¶æ˜¯æœ‹å‹åœˆï¼</p><p>è¿˜å¯ä»¥é€šè¿‡å…¶ä»–é€”å¾„æ‰“å¬ï¼Œä»¥åŠä»–åœ¨èŠå¤©æ—¶é€éœ²çš„ä¿¡æ¯ã€‚</p><p>èŠå¤©æœ€é‡è¦çš„è¿˜æ˜¯ä»â€œå…´è¶£â€åˆ‡å…¥ã€‚</p><p>æˆ‘æ€»ç»“äº†ç”·å¥³ä¹‹é—´èƒ½èŠçš„å…´è¶£ç‚¹å¤§æŠµæ˜¯è¿™ 5 ä¸ªï¼š</p><pre class="line-numbers language-none"><code class="language-none">è¿åŠ¨ã€æ—…æ¸¸ã€å¥èº«ã€ç¾é£Ÿã€å­¦ä¹ <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>èŠå·¥ä½œè¡Œä¸è¡Œï¼Ÿ<br>ä¸å»ºè®®èŠå¤ªå¤šå·¥ä½œï¼Œå› ä¸ºå¾ˆå¤šæ—¶å€™èŠå·¥ä½œéƒ½åœ¨<code>æŠ±æ€¨</code>ï¼Œè€Œä¸”å¾ˆå®¹æ˜“æŠŠèŠå¤©æ°›å›´èŠæˆ<code>å•†ä¸šä¼šè°ˆ</code></p><p>å¦å¤–ï¼Œä½ æœ‹å‹åœˆå‘çš„å†…å®¹ï¼Œä»–ç‚¹èµæˆ–è¯„è®ºäº†ï¼Œè¯´æ˜è¿™ä¸ªè¯é¢˜å¼•èµ·äº†ä»–çš„æ³¨æ„ã€‚</p><h3 id="ç¦å¿Œ"><a href="#ç¦å¿Œ" class="headerlink" title="ç¦å¿Œ"></a>ç¦å¿Œ</h3><h4 id="ä¸è¦èŠä¸æ“…é•¿çš„å†…å®¹"><a href="#ä¸è¦èŠä¸æ“…é•¿çš„å†…å®¹" class="headerlink" title="ä¸è¦èŠä¸æ“…é•¿çš„å†…å®¹"></a>ä¸è¦èŠä¸æ“…é•¿çš„å†…å®¹</h4><p>å¾ˆå®¹æ˜“é™·å…¥å°¬èŠ</p><h4 id="ä¸è¦ä¸€æœ¬æ­£ç»çš„è¯´åºŸè¯"><a href="#ä¸è¦ä¸€æœ¬æ­£ç»çš„è¯´åºŸè¯" class="headerlink" title="ä¸è¦ä¸€æœ¬æ­£ç»çš„è¯´åºŸè¯"></a>ä¸è¦ä¸€æœ¬æ­£ç»çš„è¯´åºŸè¯</h4><p>è¯´å›ä»–å–œæ¬¢ç¯®çƒï¼Œæœ‰äº›å¥³ç”Ÿè¿™æ ·èŠï¼šè¿åŠ¨æŒºå¥½çš„ï¼è¿åŠ¨æœ‰ç›Šå¥åº·ï¼å¤šè¿åŠ¨ä¸é”™ï¼ä½ é™¤äº†çˆ±æ‰“ç¯®çƒè¿˜çˆ±åšä»€ä¹ˆè¿åŠ¨â€¦â€¦</p><p>æ¥æ¥å»å»éƒ½æ˜¯è¯´è¿™å‡ å¥å®¢å¥—è¯</p><h3 id="å­¦ä¼šæ‹“å±•è¯é¢˜ã€‚è¿™å¾ˆé‡è¦ï¼"><a href="#å­¦ä¼šæ‹“å±•è¯é¢˜ã€‚è¿™å¾ˆé‡è¦ï¼" class="headerlink" title="å­¦ä¼šæ‹“å±•è¯é¢˜ã€‚è¿™å¾ˆé‡è¦ï¼"></a>å­¦ä¼šæ‹“å±•è¯é¢˜ã€‚è¿™å¾ˆé‡è¦ï¼</h3><p>è¿˜æ˜¯è¯´å›ä»–å–œæ¬¢ç¯®çƒï¼Œä½ å¯ä»¥è¿™æ ·èŠï¼š</p><p>ç¯®çƒæˆ‘æ˜¯çœŸä¸æ‡‚ï¼Œä¸è¿‡ä»¥å‰è¯»ä¹¦æˆ‘ä»¬ç­ç¯®çƒå€’æ˜¯æ‹¿äº†å¹´çº§ç¬¬ 2 åï¼Œåæ­£æˆ‘å°±è·Ÿç€é‚£äº›å¥³ç”Ÿä»¬ä¸€èµ·å‚»å‚»çš„å°–å«ã€é¼“æŒï¼Œå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ ï¼ä½ æ‰“ç¯®çƒæ—¶æ˜¯ä¸æ˜¯ä¹Ÿæœ‰ä¸€å¸®å¥³ç²‰ä¸å•Šï¼Ÿï¼ä½ æ˜¯ mvp å—ï¼Ÿï¼æœ‰æœºä¼šå¸¦æˆ‘å»ç›®ç¹ä¸€ä¸‹ä½ åœ¨çƒåœºä¸Šçš„è‹±å§¿æ‰è¡Œå‘ï½<br>ç¯®çƒæˆ‘æ˜¯çœŸä¸æ‡‚ï¼Œæˆ‘æ¯”è¾ƒå–œæ¬¢æ‰“ç¾½æ¯›çƒï¼Œä½ ä¼šä¸ä¼šæ‰“ï¼Ÿï¼å“å‘¦ï¼Œçœ‹æ¥æˆ‘é‡åˆ°å¤§ç¥äº†ï¼ï¼å¤§ç¥æ±‚å¸¦ï¼ï¼pk å—ï¼Ÿèµ¢äº†è¯·ä½ åƒé¥­ï¼Œæ•¢ä¸æ•¢ï¼Ÿ<br>ç¯®çƒæˆ‘æ˜¯çœŸä¸æ‡‚ï¼Œæˆ‘è¿åŠ¨ç»†èƒä¸ºé›¶ï½æˆ‘å°æ—¶å€™â€¦â€¦ï¼ä½ çœ‹èµ·æ¥å¾ˆçˆ±è¿åŠ¨ï¼Œæˆ‘æƒ³æˆ‘æ˜¯å› ä¸ºä¸€ç›´æ²¡æœ‰ä¸€ä¸ªå¥½çš„æ•™ç»ƒå¸¦æˆ‘æ‰é‚£ä¹ˆçƒ‚ï¼è€å¸ˆæ±‚å¸¦ï¼<br>â€¦â€¦ï¼ˆè®°å¾—è¦é…åˆè¡¨æƒ…ä½¿ç”¨ï¼Œå¯çˆ±æœ‰è¶£çš„è¡¨æƒ…ã€‚ï¼‰</p><p>èŠå¤©ï¼Œä¸ä¸€å®šè¦å±€é™äºè¿™ä¸ªâ€œè¯é¢˜çš„æ·±åº¦â€ï¼Œå¯ä»¥æ‹“å±•â€œè¯é¢˜çš„å¹¿åº¦â€ã€‚<br>æ¯”å¦‚èŠç¯®çƒä¸æ˜¯ä¸€å®šè¦å»å“ªåœºæ¯”èµ›è°è¾“è°èµ¢ã€å“ªä¸ªçƒæ˜Ÿæ€æ ·ï¼Œè€Œæ˜¯èƒ½ä»æˆ‘ä»¬ç”Ÿæ´»ç†Ÿæ‚‰çš„åœºæ™¯åˆ‡å…¥å»æ‹“å±•ã€‚</p><h3 id="å¸¸ç”¨æŠ€å·§"><a href="#å¸¸ç”¨æŠ€å·§" class="headerlink" title="å¸¸ç”¨æŠ€å·§"></a>å¸¸ç”¨æŠ€å·§</h3><p>èŠå¤©æŠ€å·§åªä¸è¿‡æ˜¯è¾…åŠ©å·¥å…·ï¼Œå‰ææ˜¯è¦æœ‰ä¸€ä¸ªçœŸè¯šçš„å¿ƒã€‚</p><p>èŠå¤©çš„æŠ€å·§éå¸¸éå¸¸å¤šï¼šè®²æ•…äº‹ï¼Œå†·è¯»ï¼Œæ‰¾å…±æ€§ï¼Œå¤¸å¥–ä¸è¯·æ•™ï¼Œé­…åŠ›å€¼å±•ç¤ºï¼ˆè®©ä»–è¿½é€ä½ ï¼‰ï¼Œè°ƒæˆï¼Œæ›²è§£ï¼Œåˆ‡æ–­å…´è¶£ï¼Œå€Ÿé¢˜å‘æŒ¥ï¼Œå¯»æ‰¾æ¼æ´ï¼Œç ´æ¡†æ¶ï¼Œæ¨æ‹‰ï¼Œæƒ…æ„Ÿè¿‡å±±è½¦ï¼Œåˆ—æ¡†æ¶ï¼Œæƒ©ç½šï¼Œå¥–åŠ±â€¦â€¦</p><p>æˆ‘è®²å‡ ç‚¹éå¸¸é‡è¦çš„å†…å®¹ï¼</p><h4 id="1-å¼•èµ·ä»–çš„å¥½å¥‡å¿ƒ"><a href="#1-å¼•èµ·ä»–çš„å¥½å¥‡å¿ƒ" class="headerlink" title="1. å¼•èµ·ä»–çš„å¥½å¥‡å¿ƒ"></a>1. å¼•èµ·ä»–çš„å¥½å¥‡å¿ƒ</h4><pre class="line-numbers language-none"><code class="language-none">è®²æ•…äº‹ï¼šä½ ï¼šå“ˆå“ˆå“ˆå“ˆå“ˆ ä½ è®©æˆ‘æƒ³èµ·äº†ä¸€ä»¶äº‹å¾ˆæœ‰æ„æ€çš„äº‹ã€‚ç”·ï¼šä»€ä¹ˆäº‹ï¼Ÿä½ ï¼šæˆ‘â€¦â€¦<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è®²æ•…äº‹æ˜¯ä½ çš„åŠ åˆ†é¡¹</strong>ï¼Œæ˜¯å¾ˆå¥½å±•ç¤ºä½ é­…åŠ›å€¼çš„æœºä¼šï¼Œè®©ä»–å¯¹ä½ åˆä¸€ä¸ªæ·±å…¥çš„äº†è§£ã€‚ä¸ä¸€å®šæ˜¯ä½ å¤šç¾å¤šä¼˜ç§€ï¼Œå¯ä»¥è¯´æ˜¯ä½ å¾ˆå¥½ç©ï¼Œä½ å¯¹äººå¯¹äº‹çš„å¿ƒæ€ã€è§‚ç‚¹å’Œæƒ³æ³•ç­‰ç­‰ã€‚</p><pre class="line-numbers language-none"><code class="language-none">å†·è¯»+åˆ‡æ–­å…´è¶£+è°ƒæˆï¼šä½ ï¼šæˆ‘å‘ç°ä½ æœ‰ä¸‰ä¸ªä¼˜ç‚¹ã€‚ï¼ˆå†·è¯»ï¼‰ç”·ï¼šè¯´æ¥çœ‹çœ‹ä½ ï¼šæˆ‘ä¸ï¼ˆåˆ‡æ–­å…´è¶£ï¼‰ï¼Œè¦ä¸ä½ ç»™æˆ‘å‘ä¸€ä¸ªçº¢åŒ…ï¼Œæˆ‘å°±å‘Šè¯‰ä½ ä¸€ä¸ªã€‚ï¼ˆè°ƒæˆï¼Œä¸æ˜¯çœŸçš„è¦ï¼Œåªæ˜¯ä¸€ç§æ€è·¯ï¼‰<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-å»ºç«‹äº²å’Œæ„Ÿ"><a href="#2-å»ºç«‹äº²å’Œæ„Ÿ" class="headerlink" title="2. å»ºç«‹äº²å’Œæ„Ÿ"></a>2. å»ºç«‹äº²å’Œæ„Ÿ</h4><p>æ‰¾å…±æ€§ï¼š<br>æœ‰æ„æ— æ„çš„é€éœ²å‡ºä½ è·Ÿä»–æœ‰å…±åŒç‚¹<br>æ¯”å¦‚ä½ çŸ¥é“ä»–å–œæ¬¢å¥èº«ï¼Œä½ å¶å°”å‘ä½ å¥èº«çš„æœ‹å‹åœˆï¼›å½“ä»–é—®ä½ åœ¨å¹²å˜›ï¼Œä½ è¯´ï¼šâ€œåˆšå¥èº«å›æ¥ï¼Œæœ€è¿‘æœ‰ç‚¹å°å·æ‡’äº†ï¼Œè·Ÿä¸ä¸Šäº†ã€‚â€</p><p>è®¤åŒä»–<br>å¤¸å¥–ä¸è¯·æ•™ã€é­…åŠ›å€¼å±•ç¤ºï¼ˆè®©ä»–è¿½é€ä½ ï¼‰</p><h4 id="3-å¹½é»˜ç¼“è§£å°´å°¬"><a href="#3-å¹½é»˜ç¼“è§£å°´å°¬" class="headerlink" title="3. å¹½é»˜ç¼“è§£å°´å°¬"></a>3. å¹½é»˜ç¼“è§£å°´å°¬</h4><p>å€Ÿé¢˜å‘æŒ¥ï¼š</p><pre class="line-numbers language-none"><code class="language-none">æ¯”å¦‚ä½ è·Ÿä»–èŠæ˜Ÿåº§ç”·ï¼šæ˜Ÿåº§éƒ½æ˜¯éª—äººçš„ï¼Œè¿˜é‚£ä¹ˆå¤šäººä¿¡ã€‚ä½ ï¼šçˆ±æƒ…ä¹Ÿæ˜¯éª—äººçš„ï¼Œä¹Ÿé‚£ä¹ˆå¤šäººè°ˆå‘¢ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å€Ÿæœºè°ƒä¾ƒï¼š</p><pre class="line-numbers language-none"><code class="language-none">å¥³ï¼šå¤©å¤©åŠ ç­å—ï¼Ÿç”·ï¼šæ²¡æœ‰ï¼Œå¤©å¤©åŠ ç­ä¼šçŒæ­»å¥³ï¼šæ±‚ç”Ÿæ¬²å¾ˆå¼ºå•Šï¼ï¼ï¼ˆå¦‚æœä½ å›â€œè¦æ³¨æ„èº«ä½“â€ï¼Œé‚£å°±å¾ˆæ— è¶£äº†ã€‚ï¼‰<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç ´æ¡†æ¶ï¼š</p><pre class="line-numbers language-none"><code class="language-none">å¦‚æœä½ è¯´çš„ä¸œè¥¿ï¼Œä»–ä¸æ„Ÿå…´è¶£æˆ–è€…æ²‰é»˜ä½ ï¼šæ²¡å…³ç³»ï¼Œæˆ‘çŸ¥é“ä½ æ™ºå•†æ¯”è¾ƒä½ï¼Œè·Ÿä¸ä¸Šæˆ‘ã€‚å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ›²è§£ï¼š</p><pre class="line-numbers language-none"><code class="language-none">å½“æœ‰äººåœ¨å¤§å®¶é¢å‰çŒ›å¤¸ä½ æ¼‚äº®ï¼Œä½ å¯ä»¥è¯´ï¼šèƒ–å­çš„æ˜¥å¤©æ¥äº†å—ï¼Ÿï¼‰<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="4-å»ºç«‹æš§æ˜§"><a href="#4-å»ºç«‹æš§æ˜§" class="headerlink" title="4. å»ºç«‹æš§æ˜§"></a>4. å»ºç«‹æš§æ˜§</h4><p>è¿™æ˜¯éå¸¸éå¸¸é‡è¦çš„ä¸€ä¸ªå†…å®¹ï¼ï¼è¿™ä¸ªå†…å®¹é‡Œæœ€é‡è¦çš„ç²¾é«“åœ¨äºï¼š<strong>å¼•å¯¼çº¦ä¼šè§é¢</strong></p><p>åˆ—æ¡†æ¶+æƒ©ç½šä»–ï¼š</p><pre class="line-numbers language-none"><code class="language-none">ç”·ï¼šä¸å¥½æ„æ€ï¼Œæ˜¨æ™šç¡ç€äº†ï¼Œæ²¡çœ‹åˆ°ä¿¡æ¯ã€‚ä½ ï¼šæˆ‘è¿˜ä»¥ä¸ºä½ æ‰“ç®—å¤±è¸ªäº†å‘¢+å˜Ÿå˜´ä¸æ»¡çš„è¡¨æƒ…ç”·ï¼šä¸ä¼šå•¦ä½ ï¼šä»¥åç¡å‰è¦è¯´æ™šå®‰ï¼Œä¸å¦‚æœ‰äººä¼šçç­‰çš„ã€‚ï¼ˆåˆ—æ¡†æ¶ï¼‰ç”·ï¼šå—¯ï¼Œå¥½çš„ä½ ï¼šç½šï½å¾—ç½šä½ â€¦â€¦<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¥–åŠ±ä»–ï¼š</p><pre class="line-numbers language-none"><code class="language-none">ä½ å¸®æˆ‘æ‰“æ¸¸æˆï¼Œèµ¢äº†10å±€è¯·ä½ åƒé¥­pkå—ï¼Ÿèµ¢äº†è¯·ä½ åƒé¥­è¿™ä¹ˆå‰å®³ï¼Ÿæˆ‘ä¸ä¿¡ï¼Œä½ è¦æ˜¯çœŸèµ¢äº†ï¼Œæˆ‘è¯·ä½ åƒé¥­ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¤¸å¥–ä¸è¯·æ•™ï¼š</p><pre class="line-numbers language-none"><code class="language-none">è¿™ä¹ˆå‰å®³ï¼å“‡ï¼å¤§ç¥æ±‚å¸¦ï¼<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é­…åŠ›å€¼å±•ç¤ºï¼ˆè®©ä»–è¿½é€ä½ ï¼‰ï¼š</p><pre class="line-numbers language-none"><code class="language-none">ä½ å±•ç¤ºé­…åŠ›å€¼æ—¶ï¼Œå½“ä½ å‘ç°ä»–æ„Ÿå…´è¶£æˆ–è€…å¤¸èµä½ ï¼Œä½ å¯ä»¥å¼•å¯¼ä»–è¿½é€ä½ ã€‚æ¯”å¦‚ä½ å»ä¸€ä¸ªå¾ˆæ¼‚äº®çš„åœ°æ–¹æ—…æ¸¸ï¼Œ- ä»–è¯´ï¼šä¸é”™å“¦ï¼Œé£æ™¯å¾ˆæ¼‚äº®ï¼Œäººæ›´æ¼‚äº®- ä½ å¯ä»¥è¯´ï¼šæ˜¯ä¸æ˜¯å¾ˆæ¼‚äº®ï¼Œå¾ˆå€¼å¾—ä¸€å»å“¦ï½æˆ‘è®¡åˆ’ä¸‹æ¬¡å»xxï¼Œè¦æ˜¯æœ‰æœºä¼šä¸€èµ·å»ç©å•Šï¼å†æ¯”å¦‚ä»–è§‰å¾—ä½ ç¾½æ¯›çƒæ‰“å¾—å¾ˆå¥½- ä½ å¯ä»¥è¯´ï¼šå¤šæ‰“å¤šç»ƒä½ ä¹Ÿå¯ä»¥å“¦ï½ä¸‹æ¬¡çº¦ä¸€æ¬¡æ‰“å’¯<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ›²è§£ï¼š</p><pre class="line-numbers language-none"><code class="language-none">ç”·ï¼šä»Šå¤©å¤©æ°”å¾ˆå¥½å¥³ï¼šé‚£å½“ç„¶ï¼Œä¹Ÿä¸çœ‹çœ‹æ˜¯è·Ÿè°å‡ºæ¥<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è°ƒæˆ+åˆ‡æ–­å…´è¶£</p><pre class="line-numbers language-none"><code class="language-none">ä½ ï¼šä½ çœ‹æˆ‘åœ¨å¹²å˜›+ç¾é£Ÿå›¾ç‰‡+æƒ³ä¸æƒ³åƒç”·ï¼šæƒ³å•Šï¼Œæ‰“åŒ…å¥³ï¼šæƒ³çš„ç¾ï¼Œä¸ç»™ï¼Œ100ä¸€å—<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å»ºç«‹æš§æ˜§æ˜¯éå¸¸éå¸¸é‡è¦çš„ä¸€ä¸ªå†…å®¹ï¼Œä¸€ä¸ªä¸ªæš§æ˜§çš„ç§å­ç§ä¸‹ï¼Œæ˜¯ä¸ºäº†æ¥ä¸‹æ¥çš„<strong>å¼€èŠ±ç»“æœ</strong></p><h4 id="5-æœ€åï¼Œä¸»åŠ¨ç»“æŸè¯é¢˜"><a href="#5-æœ€åï¼Œä¸»åŠ¨ç»“æŸè¯é¢˜" class="headerlink" title="5. æœ€åï¼Œä¸»åŠ¨ç»“æŸè¯é¢˜"></a>5. æœ€åï¼Œä¸»åŠ¨ç»“æŸè¯é¢˜</h4><p>åœ¨èŠçš„å¾ˆå—¨çš„æ—¶å€™ï¼Œä¸»åŠ¨ç»“æŸè¯é¢˜ï¼Œè®©ä»–ä¸€ä¸ªæ™šä¸Šéƒ½æ„çŠ¹æœªå°½ï¼Œä½ å°±æˆåŠŸäº†ã€‚</p><p>ç‰¹åˆ«æ³¨æ„ âš ï¸ ï¼šåƒä¸‡ä¸è¦å»äº‰è®ºã€è¾ƒçœŸï¼ è¿™ä¼šæ˜¾å¾—ä½ ä¸å¥½ç›¸å¤„ã€‚</p><h3 id="ä¸é€‚ç”¨"><a href="#ä¸é€‚ç”¨" class="headerlink" title="ä¸é€‚ç”¨"></a>ä¸é€‚ç”¨</h3><p>åŒçƒ¦ï¼Œä¸æ­ç†</p>]]></content>
      
      
      
        <tags>
            
            <tag> Interview </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android Resource é‡‘é“¶åŒºåˆ«</title>
      <link href="/20191216/android-resource-refs/"/>
      <url>/20191216/android-resource-refs/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="å’Œ-ï¼Ÿç¬¦å·çš„å¼•ç”¨åŒºåˆ«"><a href="#å’Œ-ï¼Ÿç¬¦å·çš„å¼•ç”¨åŒºåˆ«" class="headerlink" title="@ å’Œ ï¼Ÿç¬¦å·çš„å¼•ç”¨åŒºåˆ«"></a>@ å’Œ ï¼Ÿç¬¦å·çš„å¼•ç”¨åŒºåˆ«</h3><p>åœ¨ Android é¡¹ç›®å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šç”¨ <code>@</code> æˆ– <code>?</code> ç¬¦å·å»å¼•ç”¨ç³»ç»Ÿæˆ–è€…æˆ‘ä»¬åº”ç”¨å†…æ·»åŠ çš„èµ„æºï¼Œè¿™ä¸¤ç§ç¬¦å·çš„å¼•ç”¨æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Œ<code>?attr/</code> ä¸ <code>?android:attr/</code> ä¹‹é—´åˆæœ‰æ€æ ·çš„ä¸åŒå‘¢ï¼Ÿæœ¬æ–‡æˆ‘ä»¬ä¸å¦¨é—²èŠä¸€ä¸‹ã€‚</p><p> <code>@</code> ä¸ <code>?</code> ç¬¦å·çš„å¼•ç”¨åœ¨ä½¿ç”¨æ—¶éƒ½æœ‰ä¸€ä¸ªè§„èŒƒçš„æ ¼å¼ï¼š<code>@[+][package:]type:name</code> , <code>?[package:][type:]name</code> å¯ä»¥çœ‹åˆ°ï¼ŒäºŒè€…å‡åŒ…å«å¼•ç”¨ç¬¦å·ã€èµ„æºæ‰€å±çš„åŒ…ã€èµ„æºç±»å‹å’Œèµ„æºåç§°ã€‚</p><h4 id="èµ„æºå¼•ç”¨"><a href="#èµ„æºå¼•ç”¨" class="headerlink" title="@ èµ„æºå¼•ç”¨"></a>@ èµ„æºå¼•ç”¨</h4><p><code>@</code> ç¬¦å·ç”¨äºå¼•ç”¨ç³»ç»Ÿå’Œæˆ‘ä»¬åœ¨é¡¹ç›®ä¸­æ·»åŠ çš„ä¸€äº›å›ºæœ‰èµ„æºï¼ˆdrawableï¼Œstring ç­‰ï¼‰ï¼Œæˆ–è€…å®šä¹‰çš„ style æ ·å¼ã€‚æ¯”å¦‚ï¼š</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">android:text="@string/app_name"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™é‡Œçš„ app_name å°±æ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰åœ¨é¡¹ç›®æ–‡ä»¶ <code>values/strings.xml</code> ä¸­çš„å­—ç¬¦ä¸²èµ„æºã€‚</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">android:text="@android:string/cancel"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è€Œè¿™é‡Œçš„ cancel å±äº Android SDK ä¸­çš„ç³»ç»Ÿå­—ç¬¦ä¸²èµ„æºï¼Œæ‰€ä»¥éœ€è¦æ·»åŠ  <code>@android:</code> æ¥æŒ‡æ˜å¼•ç”¨æ¥æºã€‚</p><h4 id="å±æ€§å¼•ç”¨"><a href="#å±æ€§å¼•ç”¨" class="headerlink" title="? å±æ€§å¼•ç”¨"></a>? å±æ€§å¼•ç”¨</h4><p><code>?</code> ç¬¦å·ç”¨äºå¼•ç”¨å½“å‰ä¸»é¢˜ä¸­å®šä¹‰çš„ä¸€äº›å±æ€§å€¼ã€‚æ³¨æ„ï¼Œ <code>?</code> ç¬¦å·é€šè¿‡å±æ€§åå­—é—´æ¥å¼•ç”¨å½“å‰ä¸»é¢˜ä¸­çš„å¯¹åº”å±æ€§å€¼ï¼Œè€Œä¸æ˜¯å±æ€§æœ¬èº«ã€‚ä¸¾ä¸ªä¾‹å­ï¼š</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">android:divider="?android:listDivider"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™é‡Œçš„ â€œ?â€ ç¬¦å·é€šè¿‡å±æ€§å android:listDivider é—´æ¥è·å–å½“å‰ä¸»é¢˜èµ‹äºˆè¯¥å±æ€§çš„å€¼ã€‚å¦‚åŒ <strong>@android:</strong> ä¸€èˆ¬ï¼Œ**?android:** è¡¨ç¤ºè¯¥å€¼æºè‡ª Android SDK ç³»ç»Ÿå±æ€§ã€‚ç”±äºåœ¨å½“å‰ä¸»é¢˜ä¸­å¯»æ‰¾å¯¹åº”å±æ€§åçš„å€¼ï¼Œæ‰€ä»¥æ²¡æœ‰æŒ‡å®šå±æ€§ç±»å‹ï¼Œå…¶å®ç­‰åŒäºï¼š**?android:attr/listDivider**ã€‚</p><p>é‚£å¦‚ä½•å¼•ç”¨é¡¹ç›®ä¸­è‡ªå®šä¹‰çš„å±æ€§å‘¢ï¼Ÿæˆ‘ä»¬åœ¨ <code>attrs.xml</code> ä¸­å®šä¹‰ä¸€ä¸ªå±æ€§ï¼Œå¦‚ï¼š</p><pre class="line-numbers language-none"><code class="language-none">&lt;declare-styleable name="CustomTextView"&gt;    &lt;attr name="colorTextCustom" format="reference|color"/&gt;&lt;/declare-styleable&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ˜¾ç„¶ï¼Œæ­¤æ—¶æˆ‘ä»¬å®šä¹‰çš„ colorTextCustom å±æ€§æ˜¯æ²¡æœ‰å€¼çš„ï¼Œç›´æ¥å¼•ç”¨æ²¡æœ‰ä»»ä½•ä½œç”¨ã€‚éœ€è¦åœ¨ä¸»é¢˜ style ä¸­èµ‹å€¼ï¼š</p><pre class="line-numbers language-none"><code class="language-none">&lt;style name="BaseTheme" parent="Theme.AppCompat.Light.NoActionBar"&gt;    &lt;item name="colorTextCustom"&gt;#FF0000&lt;/item&gt;&lt;/style&gt;&lt;style name="AppTheme" parent="BaseTheme"&gt;    &lt;item name="android:textColor"&gt;?colorTextCustom&lt;/item&gt;&lt;/style&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œåœ¨ BaseTheme ä¸­å¯¹ colorTextCustom å±æ€§èµ‹å€¼ï¼Œå¹¶åœ¨ AppTheme ä¸­é€šè¿‡ â€œ?colorTextCustomâ€ å¼•ç”¨è¯¥å±æ€§å€¼ã€‚ç”±äºæ˜¯æœ¬åœ°é¡¹ç›®ä¸­å®šä¹‰çš„å±æ€§ï¼Œæ‰€ä»¥æ²¡æœ‰æ·»åŠ  <strong>android:</strong> å‘½åç©ºé—´ã€‚å…¶å®ï¼Œè¿™ç§åšæ³•çš„å¥½å¤„æ˜¯ï¼ŒAppTheme æ‰€è¦†ç›–çš„ View å‡å¯é€šè¿‡æ„é€ å‡½æ•°è·å–å½“å‰ä¸»é¢˜ä¸­çš„ colorTextCustom å±æ€§å€¼ã€‚</p><h4 id="R-attr-amp-R-style"><a href="#R-attr-amp-R-style" class="headerlink" title="R.attr &amp; R.style"></a>R.attr &amp; R.style</h4><p>Android SDK ä¸­å®šä¹‰æœ‰å¾ˆå¤šå±æ€§å’Œä¸»é¢˜å¯ä¾›ä½¿ç”¨ï¼Œè¯¦è§å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://developer.android.com/reference/android/R.attr.html">R.attr</a> &amp; <a href="https://developer.android.com/reference/android/R.style.html">R.style</a>ã€‚ä½¿ç”¨ç³»ç»Ÿèµ„æºçš„å¥½å¤„å°±æ˜¯ï¼Œæ»¡è¶³ä¸åŒç³»ç»Ÿçš„é€‚é…éœ€æ±‚ï¼Œè¾ƒä¸ºçµæ´»ã€‚</p><p>è¿™é‡Œä¸¾å‡ ä¸ªå¸¸ç”¨çš„ï¼š</p><p><strong>style=â€?android:attr/borderlessButtonStyleâ€</strong></p><p>Android 5.0 é»˜è®¤ Button çš„æ ·å¼è‡ªå¸¦è¾¹æ¡†é˜´å½±ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªç³»ç»Ÿæ ·å¼å»é™¤è¯¥æ ·å¼ã€‚å½“ç„¶ï¼Œè¿™æ˜¯å•ç‹¬è®¾ç½®æ—¶çš„æ“ä½œï¼Œä¸ºäº†æ–¹ä¾¿å…¨å±€æ§åˆ¶ï¼Œå¯ä»¥åœ¨ <code>styles.xml</code> ä¸­è‡ªå®šä¹‰ä¸€ä¸ªæ ·å¼ï¼Œç»§æ‰¿ä¸€ä¸ªæ— è¾¹æ¡†æ ·å¼ä½œä¸º parentï¼š</p><pre class="line-numbers language-none"><code class="language-none">&lt;style name="CustomBorderlessButtonStyle" parent="@style/Widget.AppCompat.Button.Borderless"&gt;    &lt;item name="android:textColor"&gt;@android:color/white&lt;/item&gt;    ...&lt;/style&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>android:background=â€?android:attr/selectableItemBackgroundâ€</strong></p><p>å¯ç”¨äºè®¾ç½®ä¸€äº› List Itemã€Button ä¹‹ç±»å¸¦ç‚¹å‡»æ•ˆæœçš„èƒŒæ™¯ã€‚è¯¥æ ·å¼è‡ªå¸¦è§¦æ‘¸ç‚¹å‡»æ•ˆæœï¼Œåœ¨ 5.0 å’Œæ›´é«˜ç‰ˆæœ¬ä¸Šï¼Œæ›´æ˜¯é™„æœ‰ Ripple æ¶Ÿæ¼ªæ•ˆæœï¼Œçœå»æˆ‘ä»¬è‡ªå·±å®ç° selector é€‰æ‹©å™¨çš„è¿‡ç¨‹ã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±ä½¿ç”¨ <code>&lt;ripple&gt;</code> æ ‡ç­¾å®šä¹‰ä¸€ä¸ª drawable æ–‡ä»¶å®ç°æ¶Ÿæ¼ªæ•ˆæœï¼Œåªæ˜¯éœ€è¦æ³¨æ„ç‰ˆæœ¬é™åˆ¶ã€‚è¿™é‡Œä¸¾ä¸ªä¾‹å­ï¼Œä½¿ç”¨ <code>&lt;ripple&gt;</code> æ ‡ç­¾åˆ›å»ºä¸€ä¸ªç±»ä¼¼ FloatingActionButton æ ·å¼çš„æŒ‰é’®ï¼ˆminSdkVersion ä¸º 21ï¼‰ï¼š</p><p>æ–°å»º res/drawable/shape_ripple.xml æ–‡ä»¶ï¼Œæ„å»ºç±»ä¼¼ FAB å½¢çŠ¶ï¼š</p><pre class="line-numbers language-none"><code class="language-none">&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="oval"&gt;    &lt;corners android:radius="48dp"/&gt;    &lt;solid android:color="@android:color/white" /&gt;&lt;/shape&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ–°å»º res/drawable/ripple_fab.xml æ–‡ä»¶ï¼Œæ„å»º ripple è§¦æ‘¸æ•ˆæœï¼š</p><pre class="line-numbers language-none"><code class="language-none">&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;ripple android:color="@android:color/darker_gray" xmlns:android="http://schemas.android.com/apk/res/android"&gt;    &lt;item android:drawable="@drawable/shape_fab"&gt;&lt;/item&gt;&lt;/ripple&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>åº”ç”¨åœ¨ layout æ–‡ä»¶ä¸­çš„ Button æ§ä»¶ä¸­ï¼š</p><pre class="line-numbers language-none"><code class="language-none">&lt;Button    android:layout_width="56dp"    android:layout_height="56dp"    android:minHeight="0dp"    android:minWidth="0dp"    android:text="+"    android:textSize="40sp"    android:gravity="center"    android:background="@drawable/ripple_fab"    app:elevation="1dp"    android:fontFamily="sans-serif-light"    android:layout_alignParentEnd="true"/&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åŸºäºè¿™æ ·çš„å¤„ç†ï¼Œæœ€ç»ˆè¿è¡Œæ—¶çš„æ•ˆæœå¦‚å›¾ï¼š</p><p><img src="http://blog.ancard.top/1491399243.gif" alt="img"></p><p><strong>android:background=â€?android:attr/dividerVerticalâ€</strong></p><p>å®ç°åˆ†å‰²çº¿èƒŒæ™¯ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android TextView</title>
      <link href="/20181210/android-widget-textview/"/>
      <url>/20181210/android-widget-textview/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="Autosizing-TextView"><a href="#Autosizing-TextView" class="headerlink" title="Autosizing TextView"></a>Autosizing TextView</h2><p>ä½¿ç”¨ Android 8.0ï¼ˆAPI çº§åˆ« 26ï¼‰åŠæ›´é«˜ç‰ˆæœ¬ï¼Œå¯ä»¥è®© <code>TextView</code>æ–‡æœ¬å¤§å°è‡ªåŠ¨æ‰©å±•æˆ–æ”¶ç¼©ï¼Œä»¥æ ¹æ®å…¶<code>TextView</code>ç‰¹å¾å’Œè¾¹ç•Œå¡«å……å…¶å¸ƒå±€ ã€‚æ­¤è®¾ç½®å¯ä»¥æ›´è½»æ¾åœ°ä½¿ç”¨åŠ¨æ€å†…å®¹ä¼˜åŒ–ä¸åŒå±å¹•ä¸Šçš„æ–‡æœ¬å¤§å°ã€‚</p><p>Support Library 26.0 å®Œå…¨æ”¯æŒ <code>TextView</code>åœ¨ Android 8.0ï¼ˆAPI çº§åˆ« 26ï¼‰ä¹‹å‰è¿è¡Œ Android ç‰ˆæœ¬çš„è®¾å¤‡ä¸Šçš„è‡ªåŠ¨è°ƒæ•´åŠŸèƒ½ã€‚è¯¥åº“æä¾›å¯¹ Android 4.0ï¼ˆAPI çº§åˆ« 14ï¼‰åŠæ›´é«˜ç‰ˆæœ¬çš„æ”¯æŒã€‚è¯¥<code>android.support.v4.widget</code> è½¯ä»¶åŒ…å«<code>TextViewCompat</code>ä»¥å‘åå…¼å®¹æ–¹å¼è®¿é—®åŠŸèƒ½çš„ç±»</p><span id="more"></span><h3 id="è®¾ç½®-TextView-è‡ªåŠ¨è°ƒæ•´å¤§å°"><a href="#è®¾ç½®-TextView-è‡ªåŠ¨è°ƒæ•´å¤§å°" class="headerlink" title="è®¾ç½® TextView è‡ªåŠ¨è°ƒæ•´å¤§å°"></a>è®¾ç½® TextView è‡ªåŠ¨è°ƒæ•´å¤§å°</h3><p>å¯ä»¥ä½¿ç”¨æ¡†æ¶æˆ–æ”¯æŒåº“ä»¥ <code>TextView</code>ç¼–ç¨‹æ–¹å¼æˆ–ä»¥ XML æ ¼å¼è®¾ç½®è‡ªåŠ¨è°ƒæ•´å¤§å°ã€‚è¦è®¾ç½® XML å±æ€§ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ Android Studio ä¸­çš„â€œ <strong>å±æ€§â€</strong>çª—å£ã€‚</p><p>æœ‰ä¸‰ç§æ–¹æ³•å¯ä»¥è®¾ç½®è‡ªåŠ¨è°ƒæ•´ <code>TextView</code>ï¼š<a href="https://developer.android.com/guide/topics/ui/look-and-feel/autosizing-textview#default">é»˜è®¤</a>, <a href="https://developer.android.com/guide/topics/ui/look-and-feel/autosizing-textview#granularity">ç²’åº¦</a>, <a href="https://developer.android.com/guide/topics/ui/look-and-feel/autosizing-textview#preset-sizes">é¢„è®¾å°ºå¯¸</a></p><p><strong>æ³¨</strong>ï¼šå¦‚æœè®¾ç½®åœ¨ä¸€ä¸ª XML æ–‡ä»¶è‡ªåŠ¨è°ƒæ•´å¤§å°ï¼Œä¸å»ºè®®ä½¿ç”¨å€¼â€œWRAP_CONTENTâ€ä¸º <code>layout_width</code>æˆ–<code>layout_height</code>çš„å±æ€§<code>TextView</code>ã€‚å®ƒå¯èƒ½ä¼šäº§ç”Ÿæ„å¤–çš„ç»“æœã€‚</p><h3 id="é»˜è®¤"><a href="#é»˜è®¤" class="headerlink" title="é»˜è®¤"></a>é»˜è®¤</h3><p>é»˜è®¤è®¾ç½®å…è®¸<code>TextView</code>åœ¨æ°´å¹³è½´å’Œå‚ç›´è½´ä¸Šå‡åŒ€åœ°è‡ªåŠ¨è°ƒæ•´åˆ»åº¦ã€‚</p><ul><li><p>è¦ä»¥ Code æ–¹å¼å®šä¹‰é»˜è®¤è®¾ç½®ï¼Œè¯·è°ƒç”¨ <code>setAutoSizeTextTypeWithDefaults(int autoSizeTextType)</code> æ–¹æ³•ã€‚æä¾› <code>AUTO_SIZE_TEXT_TYPE_NONE</code> å…³é—­è‡ªåŠ¨è°ƒæ•´åŠŸèƒ½æˆ–<code>AUTO_SIZE_TEXT_TYPE_UNIFORM</code>å‡åŒ€ç¼©æ”¾æ°´å¹³è½´å’Œå‚ç›´è½´ã€‚</p></li><li><p><strong>æ³¨</strong>ï¼šä¸ºç»Ÿä¸€ç¼©æ”¾çš„é»˜è®¤å°ºå¯¸<code>minTextSize = 12sp</code>ï¼Œ <code>maxTextSize = 112sp</code>ä»¥åŠ <code>granularity = 1px.</code></p></li><li><p>è¦åœ¨ XML ä¸­å®šä¹‰é»˜è®¤è®¾ç½®ï¼Œè¯·ä½¿ç”¨<code>android</code>å‘½åç©ºé—´å¹¶å°†<code>autoSizeTextType</code>å±æ€§è®¾ç½®ä¸º <code>none</code> æˆ– <code>uniform</code></p></li></ul><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>200dp<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>autoSizeTextType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>uniform<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ä½¿ç”¨æ”¯æŒåº“"><a href="#ä½¿ç”¨æ”¯æŒåº“" class="headerlink" title="ä½¿ç”¨æ”¯æŒåº“"></a>ä½¿ç”¨æ”¯æŒåº“</h4><ul><li><p>è¦é€šè¿‡æ”¯æŒåº“ä»¥ç¼–ç¨‹æ–¹å¼å®šä¹‰é»˜è®¤è®¾ç½®ï¼Œè¯·è°ƒç”¨è¯¥<code>TextViewCompat.setAutoSizeTextTypeWithDefaults(TextView textview, int autoSizeTextType)</code> æ–¹æ³•ã€‚æä¾›<code>TextView</code>çª—å£å°éƒ¨ä»¶çš„å®ä¾‹å’Œå…¶ä¸­ä¸€ç§æ–‡æœ¬ç±»å‹ï¼Œä¾‹å¦‚ <code>TextViewCompat.AUTO_SIZE_TEXT_TYPE_NONE</code>æˆ–<code>TextViewCompat.AUTO_SIZE_TEXT_TYPE_UNIFORM</code>ã€‚</p></li><li><p>è¦é€šè¿‡æ”¯æŒåº“åœ¨ XML ä¸­å®šä¹‰é»˜è®¤è®¾ç½®ï¼Œè¯·ä½¿ç”¨ <code>app</code>å‘½åç©ºé—´å¹¶å°†<code>autoSizeTextType</code> å±æ€§è®¾ç½®ä¸º <code>none</code> or <code>uniform</code></p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span>    <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res/android<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">xmlns:</span>app</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res-auto<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>      <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>200dp<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">app:</span>autoSizeTextType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>uniform<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h3 id="ç²’åº¦"><a href="#ç²’åº¦" class="headerlink" title="ç²’åº¦"></a>ç²’åº¦</h3><p>å¯ä»¥å®šä¹‰æœ€å°å’Œæœ€å¤§æ–‡æœ¬å¤§å°çš„èŒƒå›´ä»¥åŠæŒ‡å®šæ¯ä¸ªæ­¥éª¤å¤§å°çš„ç»´åº¦ã€‚çš„ <code>TextView</code>å‡åŒ€çš„æœ€å°å’Œæœ€å¤§å°ºå¯¸çš„å±æ€§ä¹‹é—´çš„èŒƒå›´å†…çš„é³ç‰‡ã€‚æ¯ä¸ªå¢é‡æŒ‰ç²’åº¦å±æ€§ä¸­è®¾ç½®çš„æ­¥é•¿è¿›è¡Œã€‚</p><ul><li><p>è¦ä»¥ç¼–ç¨‹æ–¹å¼å®šä¹‰æ–‡æœ¬å¤§å°èŒƒå›´å’Œç»´åº¦ï¼Œè¯·è°ƒç”¨è¯¥ <code>setAutoSizeTextTypeUniformWithConfiguration(int autoSizeMinTextSize, int autoSizeMaxTextSize, int autoSizeStepGranularity, int unit)</code> æ–¹æ³•ã€‚æä¾›æœ€å¤§å€¼ï¼Œæœ€å°å€¼ï¼Œç²’åº¦å€¼å’Œä»»ä½•<code>TypedValue</code>ç»´åº¦å•ä½ã€‚</p></li><li><p>è¦åœ¨ XML ä¸­å®šä¹‰ä¸€ç³»åˆ—æ–‡æœ¬å¤§å°å’Œç»´åº¦ï¼Œè¯·ä½¿ç”¨<code>android</code>å‘½åç©ºé—´å¹¶è®¾ç½®ä»¥ä¸‹å±æ€§ï¼š</p><ul><li>å°† <a href="https://developer.android.com/reference/android/widget/TextView.html#attr_android:autoSizeText"><code>autoSizeText</code></a> å±æ€§è®¾ç½®ä¸º* none <em>æˆ–</em> uniform<em>ã€‚</em>none* æ˜¯é»˜è®¤å€¼ï¼Œ<em>uniform <em>å¯ä»¥ <code>TextView</code>åœ¨æ°´å¹³å’Œå‚ç›´è½´ä¸Š</em>å‡åŒ€</em>ç¼©æ”¾ã€‚</li><li>è®¾ç½® <a href="https://developer.android.com/reference/android/widget/TextView.html#attr_android:autoSizeMinTextSize"><code>autoSizeMinTextSize</code></a>ï¼Œ <a href="https://developer.android.com/reference/android/widget/TextView.html#attr_android:autoSizeMaxTextSize"><code>autoSizeMaxTextSize</code></a> å’Œ <a href="https://developer.android.com/reference/android/widget/TextView.html#attr_android:autoSizeStepGranularity"><code>autoSizeStepGranularity</code></a> å±æ€§ä»¥å®šä¹‰è‡ªåŠ¨è°ƒæ•´å¤§å°çš„ç»´åº¦ <code>TextView</code>ã€‚</li></ul><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>200dp<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>autoSizeTextType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>uniform<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>autoSizeMinTextSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>12sp<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>autoSizeMaxTextSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100sp<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>autoSizeStepGranularity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2sp<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h4 id="ä½¿ç”¨æ”¯æŒåº“-1"><a href="#ä½¿ç”¨æ”¯æŒåº“-1" class="headerlink" title="ä½¿ç”¨æ”¯æŒåº“"></a>ä½¿ç”¨æ”¯æŒåº“</h4><ul><li><p>è¦é€šè¿‡æ”¯æŒåº“ä»¥ç¼–ç¨‹æ–¹å¼å®šä¹‰æ–‡æœ¬å¤§å°èŒƒå›´å’Œç»´åº¦ï¼Œè¯·è°ƒç”¨è¯¥<code>TextViewCompat.setAutoSizeTextTypeUniformWithConfiguration(int autoSizeMinTextSize, int autoSizeMaxTextSize, int autoSizeStepGranularity, int unit)</code> æ–¹æ³•ã€‚æä¾›æœ€å¤§å€¼ï¼Œæœ€å°å€¼ï¼Œç²’åº¦å€¼å’Œä»»ä½•<code>TypedValue</code>ç»´åº¦å•ä½ã€‚</p></li><li><p>è¦å®šä¹‰èŒƒå›´çš„æ–‡æœ¬å¤§å°ï¼Œå¹¶é€šè¿‡æ”¯æŒåº“ä¸­çš„ XML æ ¼å¼çš„å°ºå¯¸ï¼Œä½¿ç”¨çš„<code>app</code>å‘½åç©ºé—´å’Œè®¾ç½® <code>autoSizeText</code>ï¼Œ<code>autoSizeMinTextSize</code>ï¼Œ <code>autoSizeMaxTextSize</code>ï¼Œå’Œ <code>autoSizeStepGranularity</code>å¸ƒå±€ XML æ–‡ä»¶ä¸­çš„å±æ€§ã€‚</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span>    <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res/android<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">xmlns:</span>app</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res-auto<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>      <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>200dp<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">app:</span>autoSizeTextType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>uniform<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">app:</span>autoSizeMinTextSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>12sp<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">app:</span>autoSizeMaxTextSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100sp<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">app:</span>autoSizeStepGranularity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2sp<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h3 id="é¢„è®¾å°ºå¯¸"><a href="#é¢„è®¾å°ºå¯¸" class="headerlink" title="é¢„è®¾å°ºå¯¸"></a>é¢„è®¾å°ºå¯¸</h3><p>é¢„è®¾å°ºå¯¸å…è®¸æ‚¨æŒ‡å®š<code>TextView</code>è‡ªåŠ¨è°ƒæ•´æ–‡æœ¬å¤§å°æ—¶é€‰æ‹©çš„æ‰€æœ‰å€¼ ã€‚</p><ul><li><p>è¦ä½¿ç”¨é¢„è®¾å¤§å°ä»¥<code>TextView</code>ç¼–ç¨‹æ–¹å¼è®¾ç½®è‡ªåŠ¨è°ƒæ•´å¤§å° ï¼Œè¯·è°ƒç”¨è¯¥<code>setAutoSizeTextTypeUniformWithPresetSizes(int[] presetSizes, int unit)</code> æ–¹æ³•ã€‚ä¸ºå°ºå¯¸æä¾›å°ºå¯¸å’Œä»»ä½•<code>TypedValue</code> å°ºå¯¸å•ä½çš„æ•°ç»„ã€‚</p></li><li><p>è¦ä½¿ç”¨é¢„è®¾å¤§å°è®¾ç½® <code>TextView</code> XML çš„è‡ªåŠ¨è°ƒæ•´å¤§å°ï¼Œè¯·ä½¿ç”¨<code>android</code>å‘½åç©ºé—´å¹¶è®¾ç½®ä»¥ä¸‹å±æ€§ï¼š</p><ul><li>å°† <a href="https://developer.android.com/reference/android/widget/TextView.html#attr_android:autoSizeText"><code>autoSizeText</code></a> å±æ€§è®¾ç½®ä¸º* none <em>æˆ–</em> uniform<em>ã€‚</em>none* æ˜¯é»˜è®¤å€¼ï¼Œ<em>uniform <em>å¯ä»¥ <code>TextView</code>åœ¨æ°´å¹³å’Œå‚ç›´è½´ä¸Š</em>å‡åŒ€</em>ç¼©æ”¾ã€‚</li><li>å°† <a href="https://developer.android.com/reference/android/widget/TextView.html#attr_android:autoSizePresetSizes"><code>autoSizePresetSizes</code></a> å±æ€§è®¾ç½® ä¸ºé¢„è®¾å¤§å°çš„æ•°ç»„ã€‚è¦å°†æ•°ç»„ä½œä¸ºèµ„æºè®¿é—®ï¼Œè¯·åœ¨<code>res/values/arrays.xml</code> æ–‡ä»¶ä¸­å®šä¹‰æ•°ç»„ã€‚</li></ul><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resources</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>array</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>autosize_text_sizes<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">&gt;</span></span>10sp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">&gt;</span></span>12sp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">&gt;</span></span>20sp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">&gt;</span></span>40sp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">&gt;</span></span>100sp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>array</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resources</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>200dp<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>autoSizeTextType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>uniform<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>autoSizePresetSizes</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@array/autosize_text_sizes<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h4 id="ä½¿ç”¨æ”¯æŒåº“-2"><a href="#ä½¿ç”¨æ”¯æŒåº“-2" class="headerlink" title="ä½¿ç”¨æ”¯æŒåº“"></a>ä½¿ç”¨æ”¯æŒåº“</h4><ul><li><p>è¦ä½¿ç”¨é¢„è®¾å¤§å°<code>TextView</code>é€šè¿‡æ”¯æŒåº“ä»¥ç¼–ç¨‹æ–¹å¼è®¾ç½®è‡ªåŠ¨è°ƒæ•´å¤§å° ï¼Œè¯·è°ƒç”¨è¯¥<code>TextViewCompat.setAutoSizeTextTypeUniformWithPresetSizes(TextView textView, int[] presetSizes, int unit)</code> æ–¹æ³•ã€‚æä¾›<code>TextView</code>ç±»çš„å®ä¾‹ï¼Œå¤§å°æ•°ç»„ä»¥åŠå¤§å°çš„ä»»ä½•<code>TypedValue</code>ç»´åº¦å•ä½ã€‚</p></li><li><p>è¦ä½¿ç”¨é¢„è®¾å¤§å°<code>TextView</code>é€šè¿‡æ”¯æŒåº“è®¾ç½® XML çš„è‡ªåŠ¨è°ƒæ•´å¤§å° ï¼Œè¯·ä½¿ç”¨å¸ƒå±€ XML æ–‡ä»¶ä¸­çš„ <code>app</code>å‘½åç©ºé—´å’Œ set <code>autoSizeText</code>å’Œ <code>autoSizePresetSizes</code>attributesã€‚</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resources</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>array</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>autosize_text_sizes<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">&gt;</span></span>10sp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">&gt;</span></span>12sp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">&gt;</span></span>20sp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">&gt;</span></span>40sp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">&gt;</span></span>100sp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>array</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resources</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span>    <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res/android<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">xmlns:</span>app</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res-auto<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>      <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>match_parent<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>200dp<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">app:</span>autoSizeTextType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>uniform<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">app:</span>autoSizePresetSizes</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@array/autosize_text_sizes<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h2 id="XML-ä¸­çš„å­—ä½“"><a href="#XML-ä¸­çš„å­—ä½“" class="headerlink" title="XML ä¸­çš„å­—ä½“"></a>XML ä¸­çš„å­—ä½“</h2><p>Android 8.0ï¼ˆAPI çº§åˆ« 26ï¼‰å¼•å…¥äº†ä¸€é¡¹æ–°åŠŸèƒ½ï¼Œå³ XML ä¸­çš„å­—ä½“ï¼Œå®ƒå…è®¸æ‚¨å°†å­—ä½“ç”¨ä½œèµ„æºã€‚æ‚¨å¯ä»¥åœ¨<code>font</code>æ–‡ä»¶<code>res/font/</code>å¤¹ä¸­æ·»åŠ æ–‡ä»¶ä»¥å°†å­—ä½“æ†ç»‘ä¸ºèµ„æºã€‚è¿™äº›å­—ä½“åœ¨æ‚¨çš„<code>R</code>æ–‡ä»¶ä¸­ç¼–è¯‘ï¼Œå¹¶åœ¨ Android Studio ä¸­è‡ªåŠ¨æä¾›ã€‚æ‚¨å¯ä»¥å€ŸåŠ©æ–°èµ„æºç±»å‹è®¿é—®å­—ä½“èµ„æº<code>font</code>ã€‚ä¾‹å¦‚ï¼Œè¦è®¿é—®å­—ä½“èµ„æºï¼Œè¯·ä½¿ç”¨<code>@font/myfont</code>æˆ–<code>R.font.myfont</code>ã€‚</p><p>è¦åœ¨è¿è¡Œ Android 4.1ï¼ˆAPI çº§åˆ« 16ï¼‰åŠæ›´é«˜ç‰ˆæœ¬çš„è®¾å¤‡ä¸Šä½¿ç”¨å­—ä½“ XML åŠŸèƒ½ï¼Œè¯·ä½¿ç”¨æ”¯æŒåº“ 26. æœ‰å…³ä½¿ç”¨æ”¯æŒåº“çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜… <a href="https://developer.android.com/guide/topics/ui/look-and-feel/fonts-in-xml#using-support-lib">ä½¿ç”¨æ”¯æŒåº“</a> éƒ¨åˆ†ã€‚</p><p>è¦å°†å­—ä½“æ·»åŠ ä¸ºèµ„æºï¼Œè¯·åœ¨ Android Studio ä¸­æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p><ol><li>å³é”®å•å‡» res æ–‡ä»¶å¤¹ï¼Œç„¶åè½¬åˆ°â€œ æ–°å»ºâ€&gt;â€œAndroid èµ„æºç›®å½•â€ã€‚å°†å‡ºç°â€œ <em>æ–°å»ºèµ„æºç›®å½•â€</em>çª—å£ã€‚</li><li>åœ¨â€œèµ„æºç±»å‹â€åˆ—è¡¨ä¸­ï¼Œé€‰æ‹©â€œ å­—ä½“â€ï¼Œç„¶åå•å‡»â€œ ç¡®å®šâ€ã€‚<strong>æ³¨æ„</strong>ï¼šèµ„æºç›®å½•çš„åç§°å¿…é¡»æ˜¯ <strong>font</strong></li></ol><p><img src="http://blog-1251678165.coscd.myqcloud.com/2018-12-27-055422.jpg" alt="å›¾ 1 æ·»åŠ å­—ä½“èµ„æºç›®å½•"> 3. åœ¨å­—ä½“æ–‡ä»¶å¤¹ä¸­æ·»åŠ å­—ä½“æ–‡ä»¶ã€‚ä¸‹é¢çš„æ–‡ä»¶å¤¹ç»“æ„ç”Ÿæˆ <code>R.font.dancing_script</code>ï¼Œ<code>R.font.lobster</code>å’Œ <code>R.font.typo_graphica</code>ã€‚</p><p><img src="http://blog-1251678165.coscd.myqcloud.com/2018-12-27-055530.jpg" alt="åœ¨èµ„æºç›®å½•ä¸­æ·»åŠ å­—ä½“æ–‡ä»¶"> 4. åŒå‡»å­—ä½“æ–‡ä»¶ä»¥åœ¨ç¼–è¾‘å™¨ä¸­é¢„è§ˆæ–‡ä»¶çš„å­—ä½“ã€‚</p><p><img src="http://blog-1251678165.coscd.myqcloud.com/2018-12-27-055559.jpg" alt="é¢„è§ˆå­—ä½“æ–‡ä»¶"></p><h3 id="åˆ›å»º-font-family"><a href="#åˆ›å»º-font-family" class="headerlink" title="åˆ›å»º font family"></a>åˆ›å»º font family</h3><p>font family æ˜¯ä¸€ç»„å­—ä½“æ–‡ä»¶åŠå…¶æ ·å¼å’Œé‡é‡è¯¦ç»†ä¿¡æ¯ã€‚åœ¨ Android ä¸­ï¼Œæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„å­—ä½“ç³»åˆ—ä½œä¸º XML èµ„æºï¼Œå¹¶å°†å…¶ä½œä¸ºå•ä¸ªå•å…ƒè®¿é—®ï¼Œè€Œä¸æ˜¯å°†æ¯ä¸ªæ ·å¼å’Œæƒé‡ä½œä¸ºå•ç‹¬çš„èµ„æºå¼•ç”¨ã€‚é€šè¿‡è¿™æ ·åšï¼Œç³»ç»Ÿå¯ä»¥æ ¹æ®æ‚¨å°è¯•ä½¿ç”¨çš„æ–‡æœ¬æ ·å¼é€‰æ‹©æ­£ç¡®çš„å­—ä½“ã€‚</p><p>è¦åˆ›å»ºå­—ä½“ç³»åˆ—ï¼Œè¯·åœ¨ Android Studio ä¸­æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p><ol><li><p>å³é”®å•å‡»è¯¥<code>font</code>æ–‡ä»¶å¤¹ï¼Œç„¶åè½¬åˆ°â€œ <strong>æ–°å»ºâ€&gt;â€œå­—ä½“èµ„æºæ–‡ä»¶â€</strong>ã€‚å°†å‡ºç°â€œ <em>æ–°å»ºèµ„æºæ–‡ä»¶â€</em>çª—å£ã€‚</p></li><li><p>è¾“å…¥æ–‡ä»¶åï¼Œç„¶åå•å‡»â€œ <strong>ç¡®å®šâ€</strong>ã€‚æ–°çš„å­—ä½“èµ„æº XML åœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€ã€‚</p></li><li><p>å°†æ¯ä¸ªå­—ä½“æ–‡ä»¶ï¼Œæ ·å¼å’Œæƒé‡å±æ€§åŒ…å«åœ¨<code>&lt;font</code> å…ƒç´ ä¸­ã€‚ä»¥ä¸‹ XML è¯´æ˜äº†åœ¨å­—ä½“èµ„æº XML ä¸­æ·»åŠ ä¸å­—ä½“ç›¸å…³çš„å±æ€§ï¼š</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font-family</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res/android<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span>        <span class="token attr-name"><span class="token namespace">android:</span>fontStyle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>normal<span class="token punctuation">"</span></span>        <span class="token attr-name"><span class="token namespace">android:</span>fontWeight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span>        <span class="token attr-name"><span class="token namespace">android:</span>font</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@font/lobster_regular<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span>        <span class="token attr-name"><span class="token namespace">android:</span>fontStyle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>italic<span class="token punctuation">"</span></span>        <span class="token attr-name"><span class="token namespace">android:</span>fontWeight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span>        <span class="token attr-name"><span class="token namespace">android:</span>font</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@font/lobster_italic<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font-family</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><h3 id="åœ¨-XML-å¸ƒå±€ä¸­ä½¿ç”¨å­—ä½“"><a href="#åœ¨-XML-å¸ƒå±€ä¸­ä½¿ç”¨å­—ä½“" class="headerlink" title="åœ¨ XML å¸ƒå±€ä¸­ä½¿ç”¨å­—ä½“"></a>åœ¨ XML å¸ƒå±€ä¸­ä½¿ç”¨å­—ä½“</h3><p>åœ¨<code>TextView</code>å¯¹è±¡æˆ–æ ·å¼ä¸­ä½¿ç”¨å­—ä½“ï¼Œå¯ä»¥æ˜¯å•ä¸ªå­—ä½“æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯å­—ä½“ç³»åˆ—ä¸­çš„å­—ä½“ã€‚è¦<code>TextView</code>åœ¨æ ·å¼ä¸­æ·»åŠ å­—ä½“ï¼Œè¯·ä½¿ç”¨è¯¥ <code>fontFamily</code>å±æ€§ã€‚ <strong>æ³¨æ„ï¼š</strong>å½“æ‚¨ä½¿ç”¨å­—ä½“ç³»åˆ—æ—¶ï¼Œ <code>TextView</code>äº¤æ¢æœºå¯ä»¥æ ¹æ®éœ€è¦è‡ªè¡Œä½¿ç”¨è¯¥ç³»åˆ—ä¸­çš„å­—ä½“æ–‡ä»¶ã€‚</p><h4 id="å°†å­—ä½“æ·»åŠ åˆ°-TextView"><a href="#å°†å­—ä½“æ·»åŠ åˆ°-TextView" class="headerlink" title="å°†å­—ä½“æ·»åŠ åˆ° TextView"></a>å°†å­—ä½“æ·»åŠ åˆ° TextView</h4><p>è¦ä¸ºå…¶è®¾ç½®å­—ä½“<code>TextView</code>ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œä¹‹ä¸€ï¼š</p><ul><li><p>åœ¨å¸ƒå±€ XML æ–‡ä»¶ä¸­ï¼Œå°†<code>fontFamily</code>å±æ€§è®¾ç½®ä¸ºè¦è®¿é—®çš„å­—ä½“æ–‡ä»¶ã€‚</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wrap_content<span class="token punctuation">"</span></span>        <span class="token attr-name"><span class="token namespace">android:</span>fontFamily</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@font/lobster<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li></ul><p>Android Studio å¸ƒå±€é¢„è§ˆï¼ˆå¦‚å›¾ 5 æœ€å³ä¾§çª—æ ¼æ‰€ç¤ºï¼‰å…è®¸æ‚¨é¢„è§ˆä¸­çš„å­—ä½“é›†<code>TextView</code>ã€‚</p><p><img src="http://blog-1251678165.coscd.myqcloud.com/2018-12-27-060116.jpg" alt="åœ¨å¸ƒå±€é¢„è§ˆä¸­é¢„è§ˆå­—ä½“"></p><h4 id="å°†å­—ä½“æ·»åŠ åˆ°-Style"><a href="#å°†å­—ä½“æ·»åŠ åˆ°-Style" class="headerlink" title="å°†å­—ä½“æ·»åŠ åˆ° Style"></a>å°†å­—ä½“æ·»åŠ åˆ° Style</h4><p>æ‰“å¼€<code>styles.xml</code>ï¼Œå¹¶å°†<code>fontFamily</code> å±æ€§è®¾ç½®ä¸ºæ‚¨è¦è®¿é—®çš„å­—ä½“æ–‡ä»¶ã€‚</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>customfontstyle<span class="token punctuation">"</span></span> <span class="token attr-name">parent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@android:style/TextAppearance.Small<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">    &lt;item name=<span class="token string">"android:fontFamily"</span>&gt;@font/lobster&lt;/item&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="åœ¨-Java-Kotlin-ä¸­ä½¿ç”¨å­—ä½“"><a href="#åœ¨-Java-Kotlin-ä¸­ä½¿ç”¨å­—ä½“" class="headerlink" title="åœ¨ Java/Kotlin ä¸­ä½¿ç”¨å­—ä½“"></a>åœ¨ Java/Kotlin ä¸­ä½¿ç”¨å­—ä½“</h3><p>è¦åœ¨ Java/Kotlin ä¸­ä½¿ç”¨å­—ä½“ï¼Œè¯·è°ƒç”¨<code>getFont(int)</code>æ–¹æ³•å¹¶æä¾›è¦ä½¿ç”¨çš„å­—ä½“ çš„èµ„æºæ ‡è¯†ç¬¦ã€‚æ­¤æ–¹æ³•è¿”å›ä¸€ä¸ª <code>Typeface</code>å¯¹è±¡ã€‚è™½ç„¶ç³»ç»Ÿä»å­—ä½“ä¿¡æ¯ä¸­ä¸ºæ‚¨é€‰æ‹©æœ€ä½³æ ·å¼ï¼Œä½†æ‚¨å¯ä»¥ä½¿ç”¨è¯¥ <code>setTypeface(android.graphics.Typeface, int)</code> æ–¹æ³•è®¾ç½®å…·æœ‰ç‰¹å®šæ ·å¼çš„å­—ä½“ã€‚</p><h4 id="Kotin"><a href="#Kotin" class="headerlink" title="Kotin"></a>Kotin</h4><pre class="line-numbers language-kotlin" data-language="kotlin"><code class="language-kotlin"><span class="token keyword">val</span> typeface <span class="token operator">=</span> resources<span class="token punctuation">.</span><span class="token function">getFont</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>font<span class="token punctuation">.</span>myfont<span class="token punctuation">)</span>textView<span class="token punctuation">.</span>typeface <span class="token operator">=</span> typeface<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Typeface</span> typeface <span class="token operator">=</span> <span class="token function">getResources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFont</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>font<span class="token punctuation">.</span>myfont<span class="token punctuation">)</span><span class="token punctuation">;</span>textView<span class="token punctuation">.</span><span class="token function">setTypeface</span><span class="token punctuation">(</span>typeface<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="ä½¿ç”¨æ”¯æŒåº“-3"><a href="#ä½¿ç”¨æ”¯æŒåº“-3" class="headerlink" title="ä½¿ç”¨æ”¯æŒåº“"></a>ä½¿ç”¨æ”¯æŒåº“</h3><p>Support Library 26.0 åœ¨è¿è¡Œ Android 4.1ï¼ˆAPI çº§åˆ« 16ï¼‰åŠæ›´é«˜ç‰ˆæœ¬çš„è®¾å¤‡ä¸Šæä¾›å¯¹ XML å­—ä½“åŠŸèƒ½çš„æ”¯æŒã€‚</p><p><strong>æ³¨æ„</strong>ï¼šé€šè¿‡æ”¯æŒåº“åœ¨ XML å¸ƒå±€ä¸­å£°æ˜å­—ä½“ç³»åˆ—æ—¶ï¼Œè¯·ä½¿ç”¨ <strong>app</strong> å‘½åç©ºé—´æ¥ç¡®ä¿åŠ è½½å­—ä½“</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font-family</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>app</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.android.com/apk/res-auto<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name"><span class="token namespace">app:</span>fontStyle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>normal<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">app:</span>fontWeight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">app:</span>font</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@font/myfont-Regular<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name"><span class="token namespace">app:</span>fontStyle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>italic<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">app:</span>fontWeight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">app:</span>font</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@font/myfont-Italic<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font-family</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ Java/Kotlin ä¸­ä½¿ç”¨å­—ä½“ï¼Œè¯·è°ƒç”¨ <code>ResourceCompat.getFont(Context, int)</code>æ–¹æ³•å¹¶æä¾› Context å’Œèµ„æºæ ‡è¯†ç¬¦çš„å®ä¾‹ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Widget </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¯”è¾ƒåˆé€‚çš„Hexoå¤šè®¾å¤‡åŒæ­¥æ–¹æ³•</title>
      <link href="/20181111/hexo-sync-onmultidevice/"/>
      <url>/20181111/hexo-sync-onmultidevice/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="æ¯”è¾ƒåˆé€‚çš„-Hexo-å¤šè®¾å¤‡åŒæ­¥æ–¹æ³•"><a href="#æ¯”è¾ƒåˆé€‚çš„-Hexo-å¤šè®¾å¤‡åŒæ­¥æ–¹æ³•" class="headerlink" title="æ¯”è¾ƒåˆé€‚çš„ Hexo å¤šè®¾å¤‡åŒæ­¥æ–¹æ³•"></a>æ¯”è¾ƒåˆé€‚çš„ Hexo å¤šè®¾å¤‡åŒæ­¥æ–¹æ³•</h1><p>ç»å¸¸æˆ‘ä»¬æœ‰ä¸€ä¸ªåœºæ™¯ï¼šéœ€è¦åœ¨å…¬å¸æˆ–è€…å®¶åº­å¤šä¸ªç”µè„‘å®Œæˆ Hexo çš„åšå®¢æ’°å†™å’Œå‘å¸ƒå·¥ä½œã€‚è¿™å°±æ¶‰åŠåˆ° Hexo å¤šç”µè„‘çš„åŒæ­¥é—®é¢˜ã€‚</p><p>ç½‘ä¸Šçš„æ–¹æ¡ˆåŸºæœ¬ä¸Šéƒ½æ˜¯å¤šåˆ†æ”¯æ–¹æ¡ˆï¼Œä¹Ÿå°±æ˜¯åœ¨åŒä¸€ä¸ªä»“åº“åˆ›å»ºä¸¤ä¸ªåˆ†æ”¯ï¼š</p><ol><li>Hexo åˆ†æ”¯ â€“ ç”¨æ¥ä¿å­˜æ‰€æœ‰ Hexo çš„æºæ–‡ä»¶</li><li>master åˆ†æ”¯ â€“ ç”¨æ¥ä¿å­˜ Hexo ç”Ÿæˆçš„åšå®¢æ–‡ä»¶</li></ol><p>åœ¨åˆ›å»º GitHub Pages æˆ–è€… Coding Pages æ—¶ï¼Œä»¥ master åˆ†æ”¯ä¸º pages åˆ†æ”¯ã€‚<br>Hexo çš„ deploy æŒ‡å‘ master åˆ†æ”¯éƒ¨ç½² pagesï¼Œgit çš„ç®¡ç†æŒ‡å‘ Hexo åˆ†æ”¯ã€‚</p><span id="more"></span><p>å› ä¸ºæˆ‘çš„ GitHub Pages å¯¹åº”çš„ä»“åº“æ˜¯ public çš„ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´ Hexo æºæ–‡ä»¶æš´éœ²åœ¨å…¬å¼€çš„ä»“åº“äº†ã€‚è¿™æ ·ä¹Ÿå°±ä¼šæŠŠæˆ‘çš„åšå®¢çš„ä¸€äº›å¯†é’¥ã€ç»Ÿè®¡ç®¡ç†é…ç½®ç­‰æš´éœ²åœ¨å…¬å¼€ä»“åº“åˆ†æ”¯äº†ã€‚å¦‚æœå¯¹è¿™äº›é…ç½®çš„<code>_config.yml</code>è¿›è¡Œå•ç‹¬ç®¡ç†çš„è¯ï¼Œä¹Ÿå¾ˆéº»çƒ¦ã€‚</p><p>æ‰€ä»¥<strong>Hexo æœ€å®Œç¾çš„å¤šç”µè„‘åŒæ­¥æ–¹æ³•</strong>æ˜¯ï¼Œåˆ›å»ºä¸¤ä¸ªä»“åº“ï¼š</p><ol><li>Hexo ç§æœ‰ä»“åº“ â€“ ç”¨æ¥ä¿å­˜æ‰€æœ‰ Hexo çš„æºæ–‡ä»¶</li><li>master å…¬å¼€ä»“åº“ â€“ ç”¨æ¥ä¿å­˜ Hexo ç”Ÿæˆçš„åšå®¢æ–‡ä»¶</li></ol><h2 id="æˆ‘çš„-Blog-é…ç½®"><a href="#æˆ‘çš„-Blog-é…ç½®" class="headerlink" title="æˆ‘çš„ Blog é…ç½®"></a>æˆ‘çš„ Blog é…ç½®</h2><ol><li>åˆ©ç”¨ hexo d ç›´æ¥ deploy Hexo åšå®¢åˆ° GitHub pages</li><li>ä½¿ç”¨ hexo-theme-material ä¸»é¢˜ï¼Œå¹¶ä½œäº†å¾ˆå¤šé…ç½®</li></ol><h2 id="åˆ›å»ºè¿œç¨‹ç§æœ‰ä»“åº“"><a href="#åˆ›å»ºè¿œç¨‹ç§æœ‰ä»“åº“" class="headerlink" title="åˆ›å»ºè¿œç¨‹ç§æœ‰ä»“åº“"></a>åˆ›å»ºè¿œç¨‹ç§æœ‰ä»“åº“</h2><p>æˆ‘æ˜¯åœ¨ Coding ä¸Šåˆ›å»ºçš„ï¼ˆå¦‚æœåœ¨ GitHub å¯ä»¥åˆ›å»º Private ä»“åº“ä¹Ÿå¯ä»¥åœ¨ GitHub ä¸Šåˆ›å»ºï¼‰åå­—å°±å« blogã€‚</p><h2 id="å»ºç«‹æœ¬åœ°-git-ä»“åº“"><a href="#å»ºç«‹æœ¬åœ°-git-ä»“åº“" class="headerlink" title="å»ºç«‹æœ¬åœ° git ä»“åº“"></a>å»ºç«‹æœ¬åœ° git ä»“åº“</h2><p>è¿›å…¥ä½ ç°æœ‰çš„æœ¬åœ° hexo åšå®¢æ–‡ä»¶å¤¹ï¼Œå…ˆåˆ é™¤ç¬¬ä¸‰æ–¹ä¸»é¢˜çš„ git é…ç½®ï¼Œå¦‚å¯¹<code>hexo-theme-material</code>ä¸»é¢˜</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">rm</span> <span class="token parameter variable">-fr</span> ./themes/hexo-theme-material/.git/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åå»ºç«‹æœ¬åœ°çš„ git ä»“åº“</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> init<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆ›å»ºä¸€ä¸ª<code>.gitignore</code>æ–‡ä»¶ï¼Œå¹¶æ”¾åœ¨ Hexo çš„æ ¹ç›®å½•ï¼Œå†…å®¹ä¸ºï¼š</p><pre class="line-numbers language-none"><code class="language-none">.DS_StoreThumbs.dbdb.json*.lognode_modules/public/.deploy*/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/2018-11-11-055806.png"></p><h2 id="Push-åˆ°ç§æœ‰ä»“åº“"><a href="#Push-åˆ°ç§æœ‰ä»“åº“" class="headerlink" title="Push åˆ°ç§æœ‰ä»“åº“"></a>Push åˆ°ç§æœ‰ä»“åº“</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> remote <span class="token function">add</span> origin https://git.coding.net/<span class="token operator">&lt;</span>yourname<span class="token operator">&gt;</span>/blog.git<span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span><span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">"init my private hexo blog"</span><span class="token function">git</span> push <span class="token parameter variable">-u</span> origin master<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è‡³æ­¤ï¼Œå°±å®Œæˆäº†æœ¬åœ° Hexo æºç çš„å…¨å¤‡ä»½</p><h2 id="åœ¨å¦ä¸€å°ç”µè„‘è¿›è¡Œ-Hexo-å†™ä½œ"><a href="#åœ¨å¦ä¸€å°ç”µè„‘è¿›è¡Œ-Hexo-å†™ä½œ" class="headerlink" title="åœ¨å¦ä¸€å°ç”µè„‘è¿›è¡Œ Hexo å†™ä½œ"></a>åœ¨å¦ä¸€å°ç”µè„‘è¿›è¡Œ Hexo å†™ä½œ</h2><p>é¦–å…ˆå’Œæœ€å¼€å§‹ä½¿ç”¨ Hexo ä¸€æ ·ï¼Œéƒ½æœ‰å®Œæˆ gitã€nodeã€hexo ç­‰ç¯å¢ƒçš„æ­å»ºå’Œé…ç½®</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">brew <span class="token function">install</span> <span class="token function">git</span>brew <span class="token function">install</span> <span class="token function">node</span>brew <span class="token function">install</span> <span class="token function">npm</span><span class="token function">npm</span> <span class="token function">install</span> hexo-cli <span class="token parameter variable">-g</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ‹‰å–-Hexo-blog"><a href="#æ‹‰å–-Hexo-blog" class="headerlink" title="æ‹‰å– Hexo blog"></a>æ‹‰å– Hexo blog</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone https://git.coding.net/<span class="token operator">&lt;</span>yourname<span class="token operator">&gt;</span>/blog.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ ·ä½ å°±æ‹¥æœ‰äº†ä½ çš„æ‰€æœ‰ Hexo æºæ–‡ä»¶</p><h3 id="Hexo-ç¼–å†™å’Œå‘å¸ƒ"><a href="#Hexo-ç¼–å†™å’Œå‘å¸ƒ" class="headerlink" title="Hexo ç¼–å†™å’Œå‘å¸ƒ"></a>Hexo ç¼–å†™å’Œå‘å¸ƒ</h3><p>å°½ç®¡æ‹‰å–ä¸‹æ¥äº†ï¼Œè¿˜éœ€è¦å»ºç«‹ä¸€ä¸‹ Hexo çš„ç¯å¢ƒï¼Œè¿™é‡Œéœ€è¦æ ¼å¤–æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼š<br>åƒä¸‡ä¸è¦ç”¨<code>hexo init</code>å‘½ä»¤ã€‚åŸå› æ˜¯å½“å‰ç›®å½•å·²ç»å»ºç«‹äº† git ä»“åº“ç¯å¢ƒ, <code>hexo init</code>ä¼šè¦†ç›–åˆ°å½“å‰çš„ git ç¯å¢ƒï¼Œé‡å»ºä¸€ä¸ªæ–°çš„ï¼Œè¿™æ ·å’Œæˆ‘ä»¬çš„ç§æœ‰ Hexo æºç ä»“åº“è„±ç¦»äº†è”ç³»ã€‚</p><p>æ­£ç¡®çš„åšæ³•æ˜¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">npm</span> <span class="token function">install</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å› ä¸º<code>package.json</code>é‡Œé¢å·²ç»ä¿å­˜äº†<code>hexo</code>çš„å¿…å¤‡èµ„æºåŒ…ä¿¡æ¯ï¼Œ<code>npm install</code>å Hexo ç¯å¢ƒå°±å»ºç«‹èµ·æ¥äº†ã€‚</p><p>å¦‚æœéœ€è¦æ›´æ–° Hexo ç‰ˆæœ¬æˆ–è€…æ’ä»¶ç‰ˆæœ¬ï¼Œç›´æ¥ä½¿ç”¨<code>npm update</code>å³å¯ï¼Œç„¶åå°±å¯ä»¥çœ‹åˆ° package.json é‡Œé¢å‡çº§äº†å“ªäº›æ’ä»¶ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">npm</span> update<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ¥ä¸‹æ¥å°±è¿›è¡Œæ­£å¸¸çš„ç¼–å†™å’Œå‘å¸ƒå°±å¥½ã€‚æœ¬åœ°é¢„è§ˆçš„å‘½ä»¤è¿˜æ˜¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexo ghexo s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>Hexo çš„å‘å¸ƒå‘½ä»¤æ˜¯<code>hexo d</code></p><p>æœ€åæ‰§è¡Œ<code>git status</code>æŠŠæ›´æ”¹çš„æ–°æ–‡ä»¶<code>git add</code>å’Œ<code>git commit</code>ï¼Œæœ€å<code>git push</code>åˆ°ç§æœ‰ä»“åº“ï¼Œåˆä¼šå®Œæˆ Hexo æºç ä»“åº“çš„åŒæ­¥ã€‚</p><h2 id="END"><a href="#END" class="headerlink" title="END"></a>END</h2><p>ä»æ­¤ï¼Œä¸–ç•Œæ˜¯å¦‚æ­¤çš„ç¾å¥½ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> GitHub </tag>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EventBus æºç è§£æ</title>
      <link href="/20180913/codeanalysis-eventbus/"/>
      <url>/20180913/codeanalysis-eventbus/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="EventBus-æºç è§£æ"><a href="#EventBus-æºç è§£æ" class="headerlink" title="EventBus æºç è§£æ"></a>EventBus æºç è§£æ</h1><h2 id="EventBus-ç®€ä»‹"><a href="#EventBus-ç®€ä»‹" class="headerlink" title="EventBus ç®€ä»‹"></a>EventBus ç®€ä»‹</h2><p><a href="http://a.codekk.com/detail/Android/Trinea/EventBus%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90"></a></p><p>EventBus æ˜¯ Android ç«¯ä¼˜åŒ–çš„ publish/subscribe æ¶ˆæ¯æ€»çº¿ï¼Œç®€åŒ–äº†åº”ç”¨ç¨‹åºå†…å„ç»„ä»¶é—´ã€ç»„ä»¶ä¸åå°çº¿ç¨‹çš„é€šä¿¡ï¼Œä¸»è¦ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆ:</p><ul><li><p>äº‹ä»¶ Event: å¯ä»¥æ˜¯ä»»æ„å¯¹è±¡ï¼Œé€šè¿‡äº‹ä»¶çš„å‘å¸ƒè€…å°†äº‹ä»¶è¿›è¡Œä¼ é€’</p></li><li><p>äº‹ä»¶è®¢é˜…è€… Subscriber: æ¥æ”¶ç‰¹å®šäº‹ä»¶</p></li><li><p>äº‹ä»¶å‘å¸ƒè€… Publisher: ç”¨äºé€šçŸ¥ Subscriber æœ‰äº‹ä»¶å‘ç”Ÿï¼Œå¯ä»¥åœ¨ä»»æ„çº¿ç¨‹ä»»æ„ä½ç½®å‘é€äº‹ä»¶</p><span id="more"></span><p><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/2018-11-13-142814.jpg"></p><p>ä¸Šå›¾è§£é‡Šäº†æ•´ä¸ª EventBus çš„å¤§æ¦‚å·¥ä½œæµç¨‹ï¼š<code>å‘å¸ƒè€…Publisher</code>å°†äº‹ä»¶ Event é€šè¿‡<code>post()æ–¹æ³•</code>å‘é€ï¼›EventBus å†…éƒ¨è¿›è¡Œå¤„ç†ï¼Œæ‰¾åˆ°è®¢é˜…äº†è¯¥<code>äº‹ä»¶Event</code>çš„<code>è®¢é˜…è€…Subscriber</code>ï¼›ç„¶åè¯¥äº‹ä»¶ Event çš„è®¢é˜…è€… Subscriber é€šè¿‡<code>onEvent()æ–¹æ³•</code>æ¥æ”¶äº‹ä»¶è¿›è¡Œç›¸å…³å¤„ç†ï¼ˆå…³äº onEvent()åœ¨ EventBus 3.0 ä¸­æœ‰æ”¹åŠ¨ï¼Œä¸‹é¢è¯¦ç»†è¯´æ˜ï¼‰</p></li></ul><h2 id="EventBus-ç®€å•ä½¿ç”¨"><a href="#EventBus-ç®€å•ä½¿ç”¨" class="headerlink" title="EventBus ç®€å•ä½¿ç”¨"></a>EventBus ç®€å•ä½¿ç”¨</h2><p>æ·»åŠ  EventBus ä¾èµ–åˆ°é¡¹ç›® <code>implementation 'org.greenrobot:eventbus:3.1.1'</code><br>æ„é€ äº‹ä»¶ï¼ˆEventï¼‰å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯å‘é€æ¶ˆæ¯ç±» æ¯ä¸€ä¸ªæ¶ˆæ¯ç±»ï¼Œå¯¹åº”ä¸€ç§äº‹ä»¶ã€‚è¿™é‡Œæˆ‘ä»¬å®šä¹‰ä¸¤ä¸ªæ¶ˆæ¯å‘é€ç±»ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NewsEvent</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> message<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">NewsEvent</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> message<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> message<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMessage</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> message<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ToastEvent</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> content<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">ToastEvent</span><span class="token punctuation">(</span><span class="token class-name">String</span> content<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> content<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> content<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setContent</span><span class="token punctuation">(</span><span class="token class-name">String</span> content<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> content<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨å†Œ/è§£é™¤äº‹ä»¶è®¢é˜…ï¼ˆSubscriberï¼‰ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//ä¸€èˆ¬åœ¨onCreate()æ–¹æ³•ä¸­è¿›è¡Œæ³¨å†Œè®¢é˜…ã€‚åœ¨onDestory()æ–¹æ³•ä¸­è¿›è¡Œè§£é™¤è®¢é˜…</span><span class="token annotation punctuation">@Override</span><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//æ³¨å†Œäº‹ä»¶ å…¶ä¸­thisä»£è¡¨è®¢é˜…è€…</span>    <span class="token comment">//é€šè¿‡register(this)æ¥è¡¨ç¤ºè¯¥è®¢é˜…è€…è¿›è¡Œäº†è®¢é˜…</span>    <span class="token class-name">EventBus</span><span class="token punctuation">.</span><span class="token function">getDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token annotation punctuation">@Override</span><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//è§£é™¤æ³¨å†Œäº‹ä»¶</span>    <span class="token class-name">EventBus</span><span class="token punctuation">.</span><span class="token function">getDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unregister</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…·ä½“æ³¨å†Œäº†å¯¹ä»€ä¹ˆäº‹ä»¶çš„è®¢é˜…ï¼Œè¿™ä¸ªéœ€è¦ onEvent()æ–¹æ³•æ¥è¯´æ˜ã€‚åœ¨ EventBus 3.0 ä¹‹å‰ï¼ŒonEvent()æ–¹æ³•æ˜¯ç”¨æ¥æ¥æ”¶æŒ‡å®šäº‹ä»¶ï¼ˆEventï¼‰ç±»å‹å¯¹è±¡ï¼Œç„¶åè¿›è¡Œç›¸å…³å¤„ç†æ“ä½œã€‚åœ¨ EventBus 3.0 ä¹‹åï¼ŒonEvent()æ–¹æ³•å¯ä»¥è‡ªå®šä¹‰æ–¹æ³•åï¼Œä¸è¿‡è¦åŠ å…¥æ³¨è§£@Subscribeã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Subscribe</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onToastEvent</span><span class="token punctuation">(</span><span class="token class-name">ToastEvent</span> event<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//é€šè¿‡onToastEvent(ToastEvent event)è¡¨ç¤ºæŒ‡å®šå¯¹äº‹ä»¶ToastEventçš„è®¢é˜…</span><span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span>event<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token constant">LENGTH_SHORT</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‘é€æ¶ˆæ¯ è®¢é˜…å·²ç»å®Œæˆï¼Œé‚£ä¹ˆä¾¿å¯ä»¥å‘é€è®¢é˜…äº†<code>EventBus.getDefault().post(new ToastEvent("Toast,å‘ä¸ªæç¤ºï¼Œç¥å¤§å®¶æ–°å¹´å¿«ä¹ï¼"));</code><br>é‚£ä¹ˆ onToastEvent(ToastEvent event)ä¼šæ”¶åˆ°äº‹ä»¶ï¼Œå¹¶å¼¹å‡ºæç¤ºï¼ŒEventBus çš„åŸºç¡€ä½¿ç”¨æµç¨‹å°±æ˜¯è¿™æ ·çš„ã€‚</p><h2 id="EventBus-è¿›é˜¶ä½¿ç”¨"><a href="#EventBus-è¿›é˜¶ä½¿ç”¨" class="headerlink" title="EventBus è¿›é˜¶ä½¿ç”¨"></a>EventBus è¿›é˜¶ä½¿ç”¨</h2><h3 id="çº¿ç¨‹æ¨¡å¼-ThreadMode"><a href="#çº¿ç¨‹æ¨¡å¼-ThreadMode" class="headerlink" title="çº¿ç¨‹æ¨¡å¼ ThreadMode"></a>çº¿ç¨‹æ¨¡å¼ ThreadMode</h3><p>å½“ä½ æ¥æ”¶çš„çš„äº‹ä»¶åï¼Œå¦‚æœå¤„äºé UI çº¿ç¨‹ï¼Œä½ è¦æ›´æ–° UI æ€ä¹ˆåŠï¼Ÿå¦‚æœå¤„äº UI çº¿ç¨‹ï¼Œä½ è¦è¿›è¡Œè€—æ—¶æ“ä½œï¼Œæ€ä¹ˆåŠ?ç­‰ç­‰å…¶ä»–æƒ…å†µï¼Œé€šè¿‡ ThreadMode ç»Ÿç»Ÿå¸®ä½ è§£å†³</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Subscribe</span><span class="token punctuation">(</span>threadMode <span class="token operator">=</span> <span class="token class-name">ThreadMode<span class="token punctuation">.</span>MainThread</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">void</span>  <span class="token function">onNewsEvent</span><span class="token punctuation">(</span><span class="token class-name">NewsEvent</span> event<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token class-name">String</span> message <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    mTv_message<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨èµ·æ¥å¾ˆç®€å•ï¼Œé€šè¿‡@Subscribe(threadMode = ThreadMode.MainThread)å³å¯æŒ‡å®šã€‚ ä¸‹é¢å…·ä½“ä»‹ç»ä¸‹ ThreadModeï¼š</p><ol><li><strong>PostThread</strong>ï¼šäº‹ä»¶çš„å¤„ç†åœ¨å’Œäº‹ä»¶çš„å‘é€åœ¨ç›¸åŒçš„è¿›ç¨‹ï¼Œæ‰€ä»¥äº‹ä»¶å¤„ç†æ—¶é—´ä¸åº”å¤ªé•¿ï¼Œä¸ç„¶å½±å“äº‹ä»¶çš„å‘é€çº¿ç¨‹</li><li><strong>MainThread</strong>ï¼šäº‹ä»¶çš„å¤„ç†ä¼šåœ¨ UI çº¿ç¨‹ä¸­æ‰§è¡Œã€‚äº‹ä»¶å¤„ç†æ—¶é—´ä¸èƒ½å¤ªé•¿ï¼Œè¿™ä¸ªä¸ç”¨è¯´çš„ï¼Œé•¿äº†ä¼š ANR çš„</li><li><strong>BackgroundThread</strong>ï¼šå¦‚æœäº‹ä»¶æ˜¯åœ¨ UI çº¿ç¨‹ä¸­å‘å¸ƒå‡ºæ¥çš„ï¼Œé‚£ä¹ˆäº‹ä»¶å¤„ç†å°±ä¼šåœ¨å­çº¿ç¨‹ä¸­è¿è¡Œï¼Œå¦‚æœäº‹ä»¶æœ¬æ¥å°±æ˜¯å­çº¿ç¨‹ä¸­å‘å¸ƒå‡ºæ¥çš„ï¼Œé‚£ä¹ˆäº‹ä»¶å¤„ç†ç›´æ¥åœ¨è¯¥å­çº¿ç¨‹ä¸­æ‰§è¡Œã€‚æ‰€æœ‰å¾…å¤„ç†äº‹ä»¶ä¼šè¢«åŠ åˆ°ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œç”±å¯¹åº”çº¿ç¨‹ä¾æ¬¡å¤„ç†è¿™äº›äº‹ä»¶ï¼Œå¦‚æœæŸä¸ªäº‹ä»¶å¤„ç†æ—¶é—´å¤ªé•¿ï¼Œä¼šé˜»å¡åé¢çš„äº‹ä»¶çš„æ´¾å‘æˆ–å¤„ç†</li><li><strong>Async</strong>ï¼šäº‹ä»¶å¤„ç†ä¼šåœ¨å•ç‹¬çš„çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œä¸»è¦ç”¨äºåœ¨åå°çº¿ç¨‹ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œï¼Œæ¯ä¸ªäº‹ä»¶ä¼šå¼€å¯ä¸€ä¸ªçº¿ç¨‹</li></ol><h3 id="priority-äº‹ä»¶ä¼˜å…ˆçº§"><a href="#priority-äº‹ä»¶ä¼˜å…ˆçº§" class="headerlink" title="priority äº‹ä»¶ä¼˜å…ˆçº§"></a>priority äº‹ä»¶ä¼˜å…ˆçº§</h3><p>äº‹ä»¶çš„ä¼˜å…ˆçº§ç±»ä¼¼å¹¿æ’­çš„ä¼˜å…ˆçº§ï¼Œä¼˜å…ˆçº§è¶Šé«˜ä¼˜å…ˆè·å¾—æ¶ˆæ¯ï¼Œç”¨æ³•å±•ç¤ºï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Subscribe</span><span class="token punctuation">(</span>priority <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onToastEvent</span><span class="token punctuation">(</span><span class="token class-name">ToastEvent</span> event<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> event<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token constant">LENGTH_SHORT</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å½“å¤šä¸ªè®¢é˜…è€…ï¼ˆSubscriberï¼‰å¯¹åŒä¸€ç§äº‹ä»¶ç±»å‹è¿›è¡Œè®¢é˜…æ—¶ï¼Œå³å¯¹åº”çš„äº‹ä»¶å¤„ç†æ–¹æ³•ä¸­æ¥æ”¶çš„äº‹ä»¶ç±»å‹ä¸€è‡´ï¼Œåˆ™ä¼˜å…ˆçº§é«˜ï¼ˆpriority è®¾ç½®çš„å€¼è¶Šå¤§ï¼‰ï¼Œåˆ™<strong>ä¼šå…ˆæ¥æ”¶äº‹ä»¶è¿›è¡Œå¤„ç†ï¼›ä¼˜å…ˆçº§ä½ï¼ˆpriority è®¾ç½®çš„å€¼è¶Šå°ï¼‰ï¼Œåˆ™ä¼šåæ¥æ”¶äº‹ä»¶è¿›è¡Œå¤„ç†</strong></p><p>é™¤æ­¤ä¹‹å¤–ï¼ŒEventBus ä¹Ÿå¯ä»¥ç»ˆæ­¢å¯¹äº‹ä»¶ç»§ç»­ä¼ é€’çš„åŠŸèƒ½ï¼Œè¿™æ ·å…¶ä»–ä¼˜å…ˆçº§æ¯” 100 ä½ï¼Œå¹¶ä¸”è®¢é˜…äº†è¯¥äº‹ä»¶çš„è®¢é˜…è€…å°±ä¼šæ¥æ”¶ä¸åˆ°è¯¥äº‹ä»¶</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Subscribe</span><span class="token punctuation">(</span>priority <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onToastEvent</span><span class="token punctuation">(</span><span class="token class-name">ToastEvent</span> event<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> event<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token constant">LENGTH_SHORT</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//æ‹¦æˆªäº‹ä»¶</span>    <span class="token class-name">EventBus</span><span class="token punctuation">.</span><span class="token function">getDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">cancelEventDelivery</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="EventBus-é»æ€§äº‹ä»¶"><a href="#EventBus-é»æ€§äº‹ä»¶" class="headerlink" title="EventBus é»æ€§äº‹ä»¶"></a>EventBus é»æ€§äº‹ä»¶</h3><p>EventBus é™¤äº†æ™®é€šäº‹ä»¶ä¹Ÿæ”¯æŒç²˜æ€§äº‹ä»¶ã€‚å¯ä»¥ç†è§£æˆï¼šè®¢é˜…åœ¨å‘å¸ƒäº‹ä»¶ä¹‹åï¼Œä½†åŒæ ·å¯ä»¥æ”¶åˆ°äº‹ä»¶ã€‚è®¢é˜…/è§£é™¤è®¢é˜…å’Œæ™®é€šäº‹ä»¶ä¸€æ ·ï¼Œä½†æ˜¯å¤„ç†è®¢é˜…çš„æ–¹æ³•æœ‰æ‰€ä¸åŒï¼Œéœ€è¦æ³¨è§£ä¸­æ·»åŠ <code>sticky = true</code></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Subscribe</span><span class="token punctuation">(</span>priority <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> sticky <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onToastEvent</span><span class="token punctuation">(</span><span class="token class-name">ToastEvent</span> event<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> event<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token constant">LENGTH_SHORT</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//æ‹¦æˆªäº‹ä»¶</span>    <span class="token class-name">EventBus</span><span class="token punctuation">.</span><span class="token function">getDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">cancelEventDelivery</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·å‡è®¾ä¸€ä¸ª ToastEvent çš„äº‹ä»¶å·²ç»å‘å¸ƒï¼Œæ­¤æ—¶è¿˜æ²¡æœ‰æ³¨å†Œè®¢é˜…ã€‚å½“è®¾ç½®äº† sticky = trueï¼Œåœ¨ ToastEvent çš„äº‹ä»¶å‘å¸ƒåï¼Œè¿›è¡Œæ³¨å†Œï¼Œä¾ç„¶èƒ½å¤Ÿæ¥æ”¶åˆ°ä¹‹å‰å‘å¸ƒçš„äº‹ä»¶ã€‚<br>ä¸è¿‡è¿™ä¸ªæ—¶å€™ï¼Œå‘å¸ƒäº‹ä»¶çš„æ–¹å¼å°±æ”¹å˜äº†ï¼š<code>EventBus.getDefault().postSticky(new ToastEvent("Toast,å‘ä¸ªæç¤ºï¼Œç¥å¤§å®¶æ–°å¹´å¿«ä¹ï¼"));</code><br>æˆ‘ä»¬å¦‚æœä¸å†éœ€è¦è¯¥ç²˜æ€§äº‹ä»¶æˆ‘ä»¬å¯ä»¥ç§»é™¤ï¼š<code>EventBus.getDefault().removeStickyEvent(ToastEvent.class);</code><br>æˆ–è€…è°ƒç”¨ç§»é™¤æ‰€æœ‰ç²˜æ€§äº‹ä»¶ï¼š<code>EventBus.getDefault().removeAllStickyEvents();</code></p><h3 id="EventBus-é…ç½®"><a href="#EventBus-é…ç½®" class="headerlink" title="EventBus é…ç½®"></a>EventBus é…ç½®</h3><p>EventBus åœ¨ 2.3 ç‰ˆæœ¬ä¸­æ·»åŠ äº† EventBuilder å»é…ç½® EventBus çš„å„æ–¹å„é¢ã€‚æ¯”å¦‚ï¼šå¦‚ä½•å»æ„å»ºä¸€ä¸ªåœ¨å‘å¸ƒäº‹ä»¶æ—¶æ²¡æœ‰è®¢é˜…è€…æ—¶ä¿æŒæ²‰é»˜çš„ EventBusã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">EventBus</span> eventBus <span class="token operator">=</span> <span class="token class-name">EventBus</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">logNoSubscriberMessages</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendNoSubscriberEvent</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡ä¸Šè¿°è®¾ç½®ï¼Œå½“ä¸€ä¸ªäº‹ä»¶æ²¡æœ‰è®¢é˜…è€…æ—¶ï¼Œä¸ä¼šè¾“å‡º log ä¿¡æ¯ï¼Œä¹Ÿä¸ä¼šå‘å¸ƒä¸€æ¡é»˜è®¤ä¿¡æ¯ã€‚</p><p>é…ç½®é»˜è®¤çš„ EventBus å®ä¾‹ï¼Œä½¿ç”¨ EventBus.getDefault()æ˜¯ä¸€ä¸ªç®€å•çš„æ–¹æ³•ã€‚è·å–ä¸€ä¸ªå•ä¾‹çš„ EventBus å®ä¾‹ã€‚EventBusBuilder ä¹Ÿå…è®¸ä½¿ç”¨ installDefaultEventBus æ–¹æ³•å»é…ç½®é»˜è®¤çš„ EventBus å®ä¾‹ã€‚</p><p>æ³¨æ„ï¼šä¸åŒçš„ EventBus çš„å¯¹è±¡çš„æ•°æ®æ˜¯ä¸å…±äº«çš„ã€‚é€šè¿‡ä¸€ä¸ª EventBus å¯¹è±¡å»å‘å¸ƒäº‹ä»¶ï¼Œåªæœ‰é€šè¿‡åŒä¸€ä¸ª EventBus å¯¹è±¡è®¢é˜…äº‹ä»¶ï¼Œæ‰èƒ½æ¥æ”¶è¯¥äº‹ä»¶ã€‚æ‰€ä»¥ä»¥ä¸Šä½¿ç”¨ EventBus.getDefault()è·å¾—çš„éƒ½æ˜¯åŒä¸€ä¸ªå®ä¾‹ã€‚</p><h2 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h2><ol><li><p>æ³¨å†Œè®¢é˜…ï¼š<code>EventBus.getDefault().register(this);</code></p></li><li><p>äº‹ä»¶å¤„ç†</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Subscribe</span><span class="token punctuation">(</span>threadMode <span class="token operator">=</span> <span class="token class-name">ThreadMode<span class="token punctuation">.</span>MainThread</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">void</span>  <span class="token function">onNewsEvent</span><span class="token punctuation">(</span><span class="token class-name">NewsEvent</span> event<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token class-name">String</span> message <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    mTv_message<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>å‘å¸ƒäº‹ä»¶ï¼š<code>EventBus.getDefault().post(new NewsEvent("æˆ‘æ˜¯æ¥è‡ªSecondActivityçš„æ¶ˆæ¯ï¼Œä½ å¥½ï¼"));</code></p></li></ol><p>ä»¥ä¸Šæ˜¯ EventBus çš„åŸºæœ¬ä½¿ç”¨ã€‚æˆ‘ä»¬å…ˆä» getDefault è¯´èµ·</p><h3 id="getDefault"><a href="#getDefault" class="headerlink" title="getDefault()"></a>getDefault()</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span> <span class="token keyword">volatile</span> <span class="token class-name">EventBus</span> defaultInstance<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">EventBus</span> <span class="token function">getDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>defaultInstance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token class-name">EventBus</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>defaultInstance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                defaultInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventBus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> defaultInstance<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡ä¸Šè¿°ä»£ç å¯ä»¥å¾—çŸ¥ï¼ŒgetDefault()ä¸­é€šè¿‡åŒæ£€æŸ¥é”ï¼ˆDCLï¼‰æœºåˆ¶å®ç°äº† EventBus çš„å•ä¾‹æœºåˆ¶ï¼Œè·å¾—äº†ä¸€ä¸ªé»˜è®¤é…ç½®çš„ EventBus å¯¹è±¡</p><h3 id="register"><a href="#register" class="headerlink" title="register()"></a>register()</h3><p>åœ¨äº†è§£ register()ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¦äº†è§£ä¸€ä¸‹ EventBus ä¸­çš„å‡ ä¸ªå…³é”®çš„æˆå‘˜å˜é‡ã€‚æ–¹ä¾¿å¯¹ä¸‹é¢å†…å®¹çš„ç†è§£ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** Map&lt;è®¢é˜…äº‹ä»¶, è®¢é˜…è¯¥äº‹ä»¶çš„è®¢é˜…è€…é›†åˆ&gt; */</span><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">CopyOnWriteArrayList</span><span class="token punctuation">&lt;</span><span class="token class-name">Subscription</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> subscriptionsByEventType<span class="token punctuation">;</span><span class="token comment">/** Map&lt;è®¢é˜…è€…, è®¢é˜…äº‹ä»¶é›†åˆ&gt; */</span><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> typesBySubscriber<span class="token punctuation">;</span><span class="token comment">/** Map&lt;è®¢é˜…äº‹ä»¶ç±»ç±»å‹,è®¢é˜…äº‹ä»¶å®ä¾‹å¯¹è±¡&gt;. */</span><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> stickyEvents<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸‹é¢çœ‹å…·ä½“çš„ register()ä¸­æ‰§è¡Œçš„ä»£ç ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token class-name">Object</span> subscriber<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">//è®¢é˜…è€…ç±»å‹</span>    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> subscriberClass <span class="token operator">=</span> subscriber<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//åˆ¤æ–­è¯¥ç±»æ˜¯ä¸æ˜¯åŒ¿åç±»ï¼Œå¦‚æœæ˜¯åŒ¿åç´¯è¦ä½¿ç”¨åå°„</span>    <span class="token keyword">boolean</span> forceReflection <span class="token operator">=</span> subscriberClass<span class="token punctuation">.</span><span class="token function">isAnonymousClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//è·å–è®¢é˜…è€…å…¨éƒ¨çš„å“åº”å‡½æ•°ä¿¡æ¯ï¼ˆå³ä¸Šé¢çš„onNewsEvent()ä¹‹ç±»çš„æ–¹æ³•ï¼‰</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SubscriberMethod</span><span class="token punctuation">&gt;</span></span> subscriberMethods <span class="token operator">=</span> subscriberMethodFinder<span class="token punctuation">.</span><span class="token function">findSubscriberMethods</span><span class="token punctuation">(</span>subscriberClass<span class="token punctuation">,</span> forceReflection<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//å¾ªç¯æ¯ä¸€ä¸ªäº‹ä»¶å“åº”å‡½æ•°ï¼Œæ‰§è¡Œ subscribe()æ–¹æ³•ï¼Œæ›´æ–°è®¢é˜…ç›¸å…³ä¿¡æ¯</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SubscriberMethod</span> subscriberMethod <span class="token operator">:</span> subscriberMethods<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">subscribe</span><span class="token punctuation">(</span>subscriber<span class="token punctuation">,</span> subscriberMethod<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”±æ­¤å¯è§ï¼Œregister()ç¬¬ä¸€æ­¥è·å–è®¢é˜…è€…çš„ç±»ç±»å‹. ç¬¬äºŒæ­¥,é€šè¿‡ SubscriberMethodFinder ç±»æ¥è§£æè®¢é˜…è€…ç±»,è·å–æ‰€æœ‰çš„å“åº”å‡½æ•°é›†åˆ. ç¬¬ä¸‰æ­¥,éå†è®¢é˜…å‡½æ•°,æ‰§è¡Œ subscribe()æ–¹æ³•ï¼Œæ›´æ–°è®¢é˜…ç›¸å…³ä¿¡æ¯ã€‚ å…³äº subscriberMethodFinder è¿™é‡Œå°±ä¸ä»‹ç»äº†ã€‚å…ˆè·Ÿç€çº¿ç´¢ï¼Œç»§ç»­çœ‹ subscribe()æ–¹æ³•ã€‚</p><p>subscribe å‡½æ•°åˆ†ä¸‰æ­¥ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//ç¬¬ä¸€æ­¥: é€šè¿‡subscriptionsByEventTypeå¾—åˆ°è¯¥äº‹ä»¶ç±»å‹æ‰€æœ‰è®¢é˜…è€…ä¿¡æ¯é˜Ÿåˆ—ï¼Œæ ¹æ®ä¼˜å…ˆçº§å°†å½“å‰è®¢é˜…è€…ä¿¡æ¯æ’å…¥åˆ°è®¢é˜…è€…é˜Ÿåˆ—subscriptionsByEventTypeä¸­ï¼›</span><span class="token comment">//è·å–è®¢é˜…çš„äº‹ä»¶ç±»å‹</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> eventType <span class="token operator">=</span> subscriberMethod<span class="token punctuation">.</span>eventType<span class="token punctuation">;</span><span class="token comment">//è·å–è®¢é˜…è¯¥äº‹ä»¶çš„è®¢é˜…è€…é›†åˆ</span><span class="token class-name">CopyOnWriteArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Subscription</span><span class="token punctuation">&gt;</span></span> subscriptions <span class="token operator">=</span> subscriptionsByEventType<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>eventType<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æŠŠé€šè¿‡register()è®¢é˜…çš„è®¢é˜…è€…åŒ…è£…æˆSubscription å¯¹è±¡</span><span class="token class-name">Subscription</span> newSubscription <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Subscription</span><span class="token punctuation">(</span>subscriber<span class="token punctuation">,</span> subscriberMethod<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è®¢é˜…è€…é›†åˆä¸ºç©ºï¼Œåˆ›å»ºæ–°çš„é›†åˆï¼Œå¹¶æŠŠnewSubscription åŠ å…¥</span><span class="token keyword">if</span> <span class="token punctuation">(</span>subscriptions <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  subscriptions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CopyOnWriteArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Subscription</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  subscriptionsByEventType<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>eventType<span class="token punctuation">,</span> subscriptions<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>  <span class="token comment">//é›†åˆä¸­å·²ç»æœ‰è¯¥è®¢é˜…è€…ï¼ŒæŠ›å‡ºå¼‚å¸¸ã€‚ä¸èƒ½é‡å¤è®¢é˜…</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>subscriptions<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>newSubscription<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">EventBusException</span><span class="token punctuation">(</span>        <span class="token string">"Subscriber "</span> <span class="token operator">+</span> subscriber<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" already registered to event "</span> <span class="token operator">+</span> eventType<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">//æŠŠæ–°çš„è®¢é˜…è€…æŒ‰ç…§ä¼˜å…ˆçº§åŠ å…¥åˆ°è®¢é˜…è€…é›†åˆä¸­ã€‚</span><span class="token keyword">synchronized</span> <span class="token punctuation">(</span>subscriptions<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">int</span> size <span class="token operator">=</span> subscriptions<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> size <span class="token operator">||</span> subscriberMethod<span class="token punctuation">.</span>priority <span class="token operator">&gt;</span> subscriptions<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>subscriberMethod<span class="token punctuation">.</span>priority<span class="token punctuation">)</span> <span class="token punctuation">{</span>      subscriptions<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> newSubscription<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">//ç¬¬äºŒæ­¥: åœ¨typesBySubscriberä¸­å¾—åˆ°å½“å‰è®¢é˜…è€…è®¢é˜…çš„æ‰€æœ‰äº‹ä»¶é˜Ÿåˆ—ï¼Œå°†æ­¤äº‹ä»¶ä¿å­˜åˆ°é˜Ÿåˆ—typesBySubscriberä¸­ï¼Œç”¨äºåç»­å–æ¶ˆè®¢é˜…</span><span class="token comment">//æ ¹æ®è®¢é˜…è€…ï¼Œè·å¾—è¯¥è®¢é˜…è€…è®¢é˜…çš„äº‹ä»¶ç±»å‹é›†åˆ</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> subscribedEvents <span class="token operator">=</span> typesBySubscriber<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>subscriber<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœäº‹ä»¶ç±»å‹é›†åˆä¸ºç©ºï¼Œåˆ›å»ºæ–°çš„é›†åˆï¼Œå¹¶åŠ å…¥æ–°è®¢é˜…çš„äº‹ä»¶ç±»å‹ã€‚</span><span class="token keyword">if</span> <span class="token punctuation">(</span>subscribedEvents <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  subscribedEvents <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  typesBySubscriber<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>subscriber<span class="token punctuation">,</span> subscribedEvents<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">//å¦‚æœäº‹ä»¶ç±»å‹é›†åˆä¸ä¸ºç©ºï¼ŒåŠ å…¥æ–°è®¢é˜…çš„äº‹ä»¶ç±»å‹</span>subscribedEvents<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>eventType<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç¬¬ä¸‰æ­¥: æ£€æŸ¥è¿™ä¸ªäº‹ä»¶æ˜¯å¦æ˜¯ Sticky äº‹ä»¶ï¼Œå¦‚æœæ˜¯åˆ™ä»stickyEventsäº‹ä»¶ä¿å­˜é˜Ÿåˆ—ä¸­å–å‡ºè¯¥äº‹ä»¶ç±»å‹æœ€åä¸€ä¸ªäº‹ä»¶å‘é€ç»™å½“å‰è®¢é˜…è€…</span><span class="token comment">//è¯¥äº‹ä»¶æ˜¯stick=trueã€‚</span><span class="token keyword">if</span> <span class="token punctuation">(</span>subscriberMethod<span class="token punctuation">.</span>sticky<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">//å“åº”è®¢é˜…äº‹ä»¶çš„çˆ¶ç±»äº‹ä»¶</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>eventInheritance<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> entries <span class="token operator">=</span> stickyEvents<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//å¾ªç¯è·å¾—æ¯ä¸ªstickyEventäº‹ä»¶</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> entry <span class="token operator">:</span> entries<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> candidateEventType <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//æ˜¯è¯¥ç±»çš„çˆ¶ç±»</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>eventType<span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>candidateEventType<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//è¯¥äº‹ä»¶ç±»å‹æœ€æ–°çš„äº‹ä»¶å‘é€ç»™å½“å‰è®¢é˜…è€…ã€‚</span>        <span class="token class-name">Object</span> stickyEvent <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">checkPostStickyEventToSubscription</span><span class="token punctuation">(</span>newSubscription<span class="token punctuation">,</span> stickyEvent<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token class-name">Object</span> stickyEvent <span class="token operator">=</span> stickyEvents<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>eventType<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">checkPostStickyEventToSubscription</span><span class="token punctuation">(</span>newSubscription<span class="token punctuation">,</span> stickyEvent<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ°æ­¤ï¼Œä¾¿å®Œæˆäº†è®¢é˜…åŠŸèƒ½ã€‚ä¸‹é¢æ˜¯è®¢é˜…çš„å…·ä½“æµç¨‹å›¾ï¼š<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/2018-11-13-150526.jpg"></p><h3 id="unregister"><a href="#unregister" class="headerlink" title="unregister()"></a>unregister()</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> unregister <span class="token punctuation">(</span><span class="token class-name">Object</span> subscriber<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">// è·å–è¯¥è®¢é˜…è€…æ‰€æœ‰çš„è®¢é˜…äº‹ä»¶ç±»ç±»å‹é›†åˆ.</span>  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> subscribedTypes <span class="token operator">=</span> typesBySubscriber<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>subscriber<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>subscribedTypes <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> eventType <span class="token operator">:</span> subscribedTypes<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token function">unsubscribeByEventType</span><span class="token punctuation">(</span>subscriber<span class="token punctuation">,</span> eventType<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">// ä»typesBySubscriberåˆ é™¤è¯¥&lt;è®¢é˜…è€…å¯¹è±¡,è®¢é˜…äº‹ä»¶ç±»ç±»å‹é›†åˆ&gt;</span>    typesBySubscriber<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>subscriber<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">"EventBus"</span><span class="token punctuation">,</span> <span class="token string">"Subscriber to unregister was not registered before: "</span> <span class="token operator">+</span> subscriber<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">private</span> <span class="token keyword">void</span> unsubscribeByEventType <span class="token punctuation">(</span><span class="token class-name">Object</span> subscriber<span class="token punctuation">,</span> <span class="token class-name">Class</span> <span class="token generics"><span class="token punctuation">&lt;</span> <span class="token operator">?</span><span class="token punctuation">&gt;</span></span>eventType<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">// è·å–è®¢é˜…äº‹ä»¶å¯¹åº”çš„è®¢é˜…è€…ä¿¡æ¯é›†åˆ.</span>  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Subscription</span><span class="token punctuation">&gt;</span></span> subscriptions <span class="token operator">=</span> subscriptionsByEventType<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>eventType<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>subscriptions <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> size <span class="token operator">=</span> subscriptions<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token class-name">Subscription</span> subscription <span class="token operator">=</span> subscriptions<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// ä»è®¢é˜…è€…é›†åˆä¸­åˆ é™¤ç‰¹å®šçš„è®¢é˜…è€….</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>subscription<span class="token punctuation">.</span>subscriber <span class="token operator">==</span> subscriber<span class="token punctuation">)</span> <span class="token punctuation">{</span>        subscription<span class="token punctuation">.</span>active <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        subscriptions<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        i<span class="token operator">--</span><span class="token punctuation">;</span>        size<span class="token operator">--</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>unregister()æ–¹æ³•æ¯”è¾ƒç®€å•ï¼Œä¸»è¦å®Œæˆäº† subscriptionsByEventType ä»¥åŠ typesBySubscriber ä¸¤ä¸ªé›†åˆçš„åŒæ­¥</p><h3 id="post"><a href="#post" class="headerlink" title="post()"></a>post()</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> post <span class="token punctuation">(</span><span class="token class-name">Object</span> event<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">// è·å–å½“å‰çº¿ç¨‹çš„PostingçŠ¶æ€.</span>  <span class="token class-name">PostingThreadState</span> postingState <span class="token operator">=</span> currentPostingThreadState<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// è·å–å½“å‰çº¿ç¨‹çš„äº‹ä»¶é˜Ÿåˆ—.</span>  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> eventQueue <span class="token operator">=</span> postingState<span class="token punctuation">.</span>eventQueue<span class="token punctuation">;</span>  <span class="token comment">//å°†å½“å‰äº‹ä»¶æ·»åŠ åˆ°å…¶äº‹ä»¶é˜Ÿåˆ—</span>  eventQueue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//åˆ¤æ–­æ–°åŠ å…¥çš„äº‹ä»¶æ˜¯å¦åœ¨åˆ†å‘ä¸­</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>postingState<span class="token punctuation">.</span>isPosting<span class="token punctuation">)</span> <span class="token punctuation">{</span>    postingState<span class="token punctuation">.</span>isMainThread <span class="token operator">=</span> <span class="token class-name">Looper</span><span class="token punctuation">.</span><span class="token function">getMainLooper</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Looper</span><span class="token punctuation">.</span><span class="token function">myLooper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    postingState<span class="token punctuation">.</span>isPosting <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>postingState<span class="token punctuation">.</span>canceled<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">EventBusException</span><span class="token punctuation">(</span><span class="token string">"Internal error. Abort state was not reset"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>      <span class="token comment">// å¾ªç¯å¤„ç†å½“å‰çº¿ç¨‹eventQueueä¸­çš„æ¯ä¸€ä¸ªeventå¯¹è±¡.</span>      <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>eventQueue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">postSingleEvent</span><span class="token punctuation">(</span>eventQueue<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> postingState<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>      <span class="token comment">// å¤„ç†å®ŒçŸ¥ä¹é‡ç½®postingStateä¸€äº›æ ‡è¯†ä¿¡æ¯.</span>      postingState<span class="token punctuation">.</span>isPosting <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>      postingState<span class="token punctuation">.</span>isMainThread <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>post å‡½æ•°ä¼šé¦–å…ˆå¾—åˆ°å½“å‰çº¿ç¨‹çš„ post ä¿¡æ¯ PostingThreadStateï¼Œå…¶ä¸­åŒ…å«äº‹ä»¶é˜Ÿåˆ—ï¼Œå°†å½“å‰äº‹ä»¶æ·»åŠ åˆ°å…¶äº‹ä»¶é˜Ÿåˆ—ä¸­ï¼Œç„¶åå¾ªç¯è°ƒç”¨ postSingleEvent å‡½æ•°å‘å¸ƒé˜Ÿåˆ—ä¸­çš„æ¯ä¸ªäº‹ä»¶</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">void</span> postSingleEvent <span class="token punctuation">(</span><span class="token class-name">Object</span> event<span class="token punctuation">,</span> <span class="token class-name">PostingThreadState</span> postingState<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">//åˆ†å‘äº‹ä»¶çš„ç±»å‹</span>  <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> eventClass <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">boolean</span> subscriptionFound <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  <span class="token comment">//å“åº”è®¢é˜…äº‹ä»¶çš„çˆ¶ç±»äº‹ä»¶</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>eventInheritance<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">//æ‰¾å‡ºå½“å‰è®¢é˜…äº‹ä»¶ç±»ç±»å‹eventClassçš„æ‰€æœ‰çˆ¶ç±»çš„ç±»ç±»å‹å’Œå…¶å®ç°çš„æ¥å£çš„ç±»ç±»å‹</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> eventTypes <span class="token operator">=</span> <span class="token function">lookupAllEventTypes</span><span class="token punctuation">(</span>eventClass<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> countTypes <span class="token operator">=</span> eventTypes<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> h <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> h <span class="token operator">&lt;</span> countTypes<span class="token punctuation">;</span> h<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> clazz <span class="token operator">=</span> eventTypes<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//å‘å¸ƒæ¯ä¸ªäº‹ä»¶åˆ°æ¯ä¸ªè®¢é˜…è€…</span>      subscriptionFound <span class="token operator">|=</span> <span class="token function">postSingleEventForEventType</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> postingState<span class="token punctuation">,</span> clazz<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    subscriptionFound <span class="token operator">=</span> <span class="token function">postSingleEventForEventType</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> postingState<span class="token punctuation">,</span> eventClass<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment">//....................................</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è°ƒç”¨ postSingleEventForEventType å‡½æ•°å‘å¸ƒæ¯ä¸ªäº‹ä»¶åˆ°æ¯ä¸ªè®¢é˜…è€…</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">boolean</span> postSingleEventForEventType <span class="token punctuation">(</span><span class="token class-name">Object</span> event<span class="token punctuation">,</span> <span class="token class-name">PostingThreadState</span> postingState<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> eventClass<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token class-name">CopyOnWriteArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Subscription</span><span class="token punctuation">&gt;</span></span> subscriptions<span class="token punctuation">;</span>  <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// è·å–è®¢é˜…äº‹ä»¶ç±»ç±»å‹å¯¹åº”çš„è®¢é˜…è€…ä¿¡æ¯é›†åˆ.(registerå‡½æ•°æ—¶æ„é€ çš„é›†åˆ)</span>    subscriptions <span class="token operator">=</span> subscriptionsByEventType<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>eventClass<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>subscriptions <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>subscriptions<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Subscription</span> subscription <span class="token operator">:</span> subscriptions<span class="token punctuation">)</span> <span class="token punctuation">{</span>      postingState<span class="token punctuation">.</span>event <span class="token operator">=</span> event<span class="token punctuation">;</span>      postingState<span class="token punctuation">.</span>subscription <span class="token operator">=</span> subscription<span class="token punctuation">;</span>      <span class="token keyword">boolean</span> aborted <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>      <span class="token keyword">try</span> <span class="token punctuation">{</span>        <span class="token comment">// å‘å¸ƒè®¢é˜…äº‹ä»¶ç»™è®¢é˜…å‡½æ•°</span>        <span class="token function">postToSubscription</span><span class="token punctuation">(</span>subscription<span class="token punctuation">,</span> event<span class="token punctuation">,</span> postingState<span class="token punctuation">.</span>isMainThread<span class="token punctuation">)</span><span class="token punctuation">;</span>        aborted <span class="token operator">=</span> postingState<span class="token punctuation">.</span>canceled<span class="token punctuation">;</span>      <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>        postingState<span class="token punctuation">.</span>event <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        postingState<span class="token punctuation">.</span>subscription <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        postingState<span class="token punctuation">.</span>canceled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>aborted<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è°ƒç”¨ postToSubscription å‡½æ•°å‘æ¯ä¸ªè®¢é˜…è€…å‘å¸ƒäº‹ä»¶ã€‚ postToSubscription å‡½æ•°ä¸­ä¼šåˆ¤æ–­è®¢é˜…è€…çš„ ThreadModeï¼Œä»è€Œå†³å®šåœ¨ä»€ä¹ˆ Mode ä¸‹æ‰§è¡Œäº‹ä»¶å“åº”å‡½æ•°ã€‚è¿™é‡Œå°±ä¸è´´æºç äº†ã€‚åç»­è¿˜ç‰µç€åˆ°åå°„ä»¥åŠçº¿ç¨‹è°ƒåº¦é—®é¢˜ï¼Œè¿™é‡Œå°±ä¸å±•å¼€äº†ã€‚ ä»¥ä¸Šå°±æ˜¯ post çš„æµç¨‹ï¼Œä¸‹é¢æ˜¯å…·ä½“çš„ post çš„æµç¨‹å›¾:<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/2018-11-13-150953.jpg"></p>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> SourceCode Analysis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Telegram ä»£ç†è®¾ç½®</title>
      <link href="/20180514/telegram-proxy-method/"/>
      <url>/20180514/telegram-proxy-method/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Telegram-ä»£ç†è®¾ç½®"><a href="#Telegram-ä»£ç†è®¾ç½®" class="headerlink" title="Telegram ä»£ç†è®¾ç½®"></a>Telegram ä»£ç†è®¾ç½®</h1><p>æœ¬æ¬¡æµ‹è¯•çš„æ˜¯ Mac ShadowsocksX-NG + Telegram<br><img src="http://blog-1251678165.coscd.myqcloud.com/2018-05-14-064147.png"></p><h2 id="Shadowsocks"><a href="#Shadowsocks" class="headerlink" title="Shadowsocks"></a>Shadowsocks</h2><ol><li><a href="https://github.com/shadowsocks/ShadowsocksX-NG/releases">ShadowsocksX-NG</a></li><li>æ‰“å¼€åå¥½è®¾ç½®ï¼Œé«˜çº§é€‰é¡¹ï¼ŒæŸ¥çœ‹ SOCKS5 ç«¯å£<br><img src="http://blog-1251678165.coscd.myqcloud.com/2018-05-14-064557.png"><span id="more"></span></li></ol><h2 id="Telegram"><a href="#Telegram" class="headerlink" title="Telegram"></a>Telegram</h2><ol><li>æ‰“å¼€ Settingsâ€“&gt;Privacy and Securityâ€“&gt;Use Proxy<br><img src="http://blog-1251678165.coscd.myqcloud.com/2018-05-14-064745.png"></li><li>å¤åˆ¶åœ°å€å’Œç«¯å£å·<br><img src="http://blog-1251678165.coscd.myqcloud.com/2018-05-14-064948.png"></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Network </tag>
            
            <tag> Shadowsocks </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Gitä½¿ç”¨æ‰‹å†Œ</title>
      <link href="/20180112/git-manual/"/>
      <url>/20180112/git-manual/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Git-ä½¿ç”¨æ‰‹å†Œ"><a href="#Git-ä½¿ç”¨æ‰‹å†Œ" class="headerlink" title="Git ä½¿ç”¨æ‰‹å†Œ"></a>Git ä½¿ç”¨æ‰‹å†Œ</h1><h2 id="Git-é…ç½®"><a href="#Git-é…ç½®" class="headerlink" title="Git é…ç½®"></a>Git é…ç½®</h2><h3 id="é…ç½®-Git-Config"><a href="#é…ç½®-Git-Config" class="headerlink" title="é…ç½® Git Config"></a>é…ç½® Git Config</h3><p>å¯ä»¥ç›´æ¥ä½¿ç”¨ httpsï¼Œæ–¹ä¾¿ä»£ç†ï¼Œæ— éœ€ä½¿ç”¨ ssh</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># é…ç½®UserName å’Œ Email</span>$ <span class="token function">git</span> config <span class="token parameter variable">--global</span> user.name <span class="token string">"weimiku"</span>$ <span class="token function">git</span> config <span class="token parameter variable">--global</span> user.email <span class="token string">"1570682285@qq.com"</span>$ <span class="token function">mkdir</span> .ssh$ <span class="token builtin class-name">cd</span> ~/.ssh<span class="token comment"># ç”Ÿæˆ RSA Key</span>$ ssh-keygen <span class="token parameter variable">-t</span> rsa <span class="token parameter variable">-C</span> <span class="token string">"1570682285@qq.com"</span>Generating public/private rsa key pair.Enter <span class="token function">file</span> <span class="token keyword">in</span> <span class="token function">which</span> to save the key <span class="token punctuation">(</span>/Users/weicools/.ssh/id_rsa<span class="token punctuation">)</span>: WeicoolsGitHubEnter passphrase <span class="token punctuation">(</span>empty <span class="token keyword">for</span> no passphrase<span class="token punctuation">)</span>:Enter same passphrase again:Your identification has been saved <span class="token keyword">in</span> WeicoolsGitHub.Your public key has been saved <span class="token keyword">in</span> WeicoolsGitHub.pub.weicools$ <span class="token function">cat</span> ~/.ssh/WeicoolsGitHub.pubxxx<span class="token punctuation">..</span>.xxx <span class="token number">1570682285</span>@qq.com<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¤åˆ¶ WeicoolsGitHub.pub å†…å®¹åˆ° Git ä¸Šçš„ SSH key é…ç½®ä¸­</p><h3 id="æ£€æŸ¥-Git-Config"><a href="#æ£€æŸ¥-Git-Config" class="headerlink" title="æ£€æŸ¥ Git Config"></a>æ£€æŸ¥ Git Config</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">git</span> config <span class="token parameter variable">--list</span>$ <span class="token function">git</span> config user.name<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="Git-é¡¹ç›®åˆ›å»ºå’Œæäº¤"><a href="#Git-é¡¹ç›®åˆ›å»ºå’Œæäº¤" class="headerlink" title="Git é¡¹ç›®åˆ›å»ºå’Œæäº¤"></a>Git é¡¹ç›®åˆ›å»ºå’Œæäº¤</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># åˆ›å»ºä¸€ä¸ªé¡¹ç›®hello-world</span>$ <span class="token function">mkdir</span> ~/hello-world<span class="token comment"># è¿›å…¥è¿™ä¸ªé¡¹ç›®</span>$ <span class="token builtin class-name">cd</span> ~/hello-world<span class="token comment"># åˆå§‹åŒ–Git</span>$ <span class="token function">git</span> init<span class="token comment"># new READMEæ–‡ä»¶</span>$ <span class="token function">touch</span> README<span class="token comment"># add READMEæ–‡ä»¶</span>$ <span class="token function">git</span> <span class="token function">add</span> README<span class="token comment"># æäº¤æ›´æ–°ï¼Œå¹¶æ³¨é‡Šä¿¡æ¯â€œfirst commitâ€</span>$ <span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">'first commit'</span><span class="token comment"># è¿æ¥è¿œç¨‹GitHubé¡¹ç›®</span>$ <span class="token function">git</span> remote <span class="token function">add</span> origin git@github.com:xxx/yyyy.git<span class="token comment"># å°†æœ¬åœ°é¡¹ç›®æ›´æ–°åˆ°GitHub</span>$ <span class="token function">git</span> push <span class="token parameter variable">-u</span> origin master<span class="token comment"># åç»­æäº¤ git push å³å¯</span>$ <span class="token function">git</span> push<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h2><p><a href="https://www.ruanyifeng.com/blog/2015/12/git-cheat-sheet.html">https://www.ruanyifeng.com/blog/2015/12/git-cheat-sheet.html</a></p><h2 id="Git-é…ç½®-Q-amp-A"><a href="#Git-é…ç½®-Q-amp-A" class="headerlink" title="Git é…ç½® Q &amp; A"></a>Git é…ç½® Q &amp; A</h2><h3 id="ä¸ºä»“åº“è®¾ç½®-Git-ç”¨æˆ·å"><a href="#ä¸ºä»“åº“è®¾ç½®-Git-ç”¨æˆ·å" class="headerlink" title="ä¸ºä»“åº“è®¾ç½® Git ç”¨æˆ·å"></a>ä¸ºä»“åº“è®¾ç½® Git ç”¨æˆ·å</h3><pre class="line-numbers language-zsh" data-language="zsh"><code class="language-zsh">$ git config user.name "name"$ git config user.email "email"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="ç»‘å®š-Remote-Repository"><a href="#ç»‘å®š-Remote-Repository" class="headerlink" title="ç»‘å®š Remote Repository"></a>ç»‘å®š Remote Repository</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">git</span> remote set-url origin https://github.com/user/repository.git$ <span class="token function">git</span> branch --set-upstream-to origin/master master<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="æ·»åŠ -Remote-Repository"><a href="#æ·»åŠ -Remote-Repository" class="headerlink" title="æ·»åŠ  Remote Repository"></a>æ·»åŠ  Remote Repository</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">git</span> remote <span class="token function">add</span> origin https://github.com/user/repository.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="git-åˆ é™¤æœ¬åœ°å’Œè¿œç¨‹æ–‡ä»¶"><a href="#git-åˆ é™¤æœ¬åœ°å’Œè¿œç¨‹æ–‡ä»¶" class="headerlink" title="git åˆ é™¤æœ¬åœ°å’Œè¿œç¨‹æ–‡ä»¶"></a>git åˆ é™¤æœ¬åœ°å’Œè¿œç¨‹æ–‡ä»¶</h3><pre class="line-numbers language-zsh" data-language="zsh"><code class="language-zsh"># åˆ é™¤æ–‡ä»¶ï¼šgit rm æ–‡ä»¶å# åˆ é™¤æ–‡ä»¶å¤¹ï¼šgit rm -r æ–‡ä»¶å¤¹å# æ³¨æ„# è¦åˆ é™¤æ–‡ä»¶å¿…é¡»å…ˆæ·»åŠ åˆ°ä»“åº“æ‰å¯ä»¥è¿›è¡Œä¸Šè¿°æ“ä½œå‘½ä»¤ï¼Œå› ä¸ºgitåŸºäºä»“åº“è¿›è¡Œæ“ä½œ# åˆ é™¤æ–‡ä»¶å¤¹æ—¶ï¼Œæ–‡ä»¶å¤¹ä¸èƒ½ä¸ºç©ºï¼Œå¦åˆ™ä¸èƒ½æ‰¾åˆ°æ–‡ä»¶å¤¹ä»è€Œæ— æ³•åˆ é™¤<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å·¥ä½œè¿‡ç¨‹ä¸­è‹¥è¯¯æäº¤äº†æ–‡ä»¶åˆ°ä»“åº“ä¸Šï¼Œæ¯”å¦‚<code>node_modules</code>,æ­¤æ—¶æƒ³åªåˆ é™¤è¿œç¨‹ä»“åº“æ–‡ä»¶ï¼Œä¸åˆ é™¤æœ¬åœ°æ–‡ä»¶ï¼Œå¯ä½¿ç”¨ä¸‹é¢å‘½ä»¤</p><pre class="line-numbers language-zsh" data-language="zsh"><code class="language-zsh"># åªåˆ é™¤äº†ä»“åº“ä¸­çš„ç¼“å­˜ï¼Œå®é™…æ–‡ä»¶ä¸ä¼šåˆ é™¤git rm --cached æ–‡ä»¶(å¤¹)git commit -m 'å¤‡æ³¨'git push origin åˆ†æ”¯<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Permission-denied-æ‰‹åŠ¨-add-RSA-å¯†é’¥"><a href="#Permission-denied-æ‰‹åŠ¨-add-RSA-å¯†é’¥" class="headerlink" title="Permission denied (æ‰‹åŠ¨ add RSA å¯†é’¥)"></a>Permission denied (æ‰‹åŠ¨ add RSA å¯†é’¥)</h3><p>å¦‚æœè¾“å…¥ <code>$ ssh -T git@github.com</code> å‡ºç°é”™è¯¯æç¤ºï¼šPermission denied (publickey). å› ä¸ºæ–°ç”Ÿæˆçš„ key ä¸èƒ½åŠ å…¥ ssh å°±ä¼šå¯¼è‡´è¿æ¥ä¸ä¸Š githubã€‚<br>è§£å†³åŠæ³•ï¼šè¾“å…¥<code>$ ssh-add ~/.ssh/id_rsa</code>ï¼Œå†è¾“å…¥å¯¹åº” SSH å¯†ç å³å¯</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">ls</span> <span class="token parameter variable">-ah</span><span class="token builtin class-name">.</span>      WeicoolsGitHub  config WeicoolsGitHub.pub  known_hosts$ ssh-add ~/.ssh/WeicoolsGitHub$ <span class="token function">ssh</span> <span class="token parameter variable">-T</span> git@github.comHi weimiku<span class="token operator">!</span> You've successfully authenticated, but GitHub does not provide shell access.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ¢å¤åˆ é™¤åˆ†æ”¯"><a href="#æ¢å¤åˆ é™¤åˆ†æ”¯" class="headerlink" title="æ¢å¤åˆ é™¤åˆ†æ”¯"></a>æ¢å¤åˆ é™¤åˆ†æ”¯</h3><p>å½“æˆ‘ä»¬ä½¿ç”¨ git branch -D åˆ é™¤ä¸€ä¸ªæœ¬åœ°åˆ†æ”¯åï¼Œæ€æ ·æ‰èƒ½æ¢å¤å‘¢ï¼Ÿ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ æ˜¾ç¤ºå†å²æäº¤ï¼Œæ‰¾åˆ°åˆ†æ”¯å¯¹åº”çš„æœ€åä¸€ç¬”æäº¤çš„commit-id<span class="token function">git</span> log <span class="token parameter variable">-g</span><span class="token comment"># ä»¥æŒ‡å®šcommitä¸ºåŸºç¡€åˆ›å»ºåˆ†æ”¯</span>$ <span class="token function">git</span> checkout <span class="token parameter variable">-b</span> <span class="token punctuation">{</span>branch-name<span class="token punctuation">}</span> <span class="token punctuation">{</span>commit-id<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ssh-add-ç›¸å…³é—®é¢˜"><a href="#ssh-add-ç›¸å…³é—®é¢˜" class="headerlink" title="ssh-add ç›¸å…³é—®é¢˜"></a>ssh-add ç›¸å…³é—®é¢˜</h3><p><a href="https://help.github.com/cn/github/authenticating-to-github/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent">ç”Ÿæˆæ–° SSH å¯†é’¥å¹¶æ·»åŠ åˆ° ssh-agent</a><br><a href="https://help.github.com/cn/github/authenticating-to-github/error-permission-denied-publickey">é”™è¯¯ï¼šæƒé™è¢«æ‹’ç»ï¼ˆå…¬é’¥ï¼‰</a><br><a href="https://segmentfault.com/q/1010000000835302">Git æ˜¯å¦å¿…é¡»æ¯æ¬¡æ·»åŠ  ssh-add</a><br><a href="https://www.yangyanxing.com/article/config-local-ssh.html">é…ç½®å¤šä¸ª ssh å¯†é’¥å¯¹å¹¶ä¸”æ°¸ä¹…å¤š ssh ç®¡ç†</a></p><h2 id="Fork-é¡¹ç›®"><a href="#Fork-é¡¹ç›®" class="headerlink" title="Fork é¡¹ç›®"></a>Fork é¡¹ç›®</h2><h3 id="åœ¨-GitHub-ä¸Š-Fork"><a href="#åœ¨-GitHub-ä¸Š-Fork" class="headerlink" title="åœ¨ GitHub ä¸Š Fork"></a>åœ¨ GitHub ä¸Š Fork</h3><p>å‚è€ƒ <a href="https://github.com/selfteaching/the-craft-of-selfteaching/issues/67">https://github.com/selfteaching/the-craft-of-selfteaching/issues/67</a></p><h3 id="GitHub-Fork-å®è·µ"><a href="#GitHub-Fork-å®è·µ" class="headerlink" title="GitHub Fork å®è·µ"></a>GitHub Fork å®è·µ</h3><p>ä»¥ <a href="https://github.com/material-components/material-components-android">material-components-android</a> é¡¹ç›®ä¸ºä¾‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># Cloneè¿œç¨‹ä»“åº“</span>$ <span class="token function">git</span> clone git@github.com:weikeet/material-components-android.git<span class="token comment"># æŸ¥çœ‹è¿œç¨‹ä»“åº“çš„è·¯å¾„</span>$ <span class="token function">git</span> remote <span class="token parameter variable">-v</span>origingit@github.com:weikeet/material-components-android.git <span class="token punctuation">(</span>fetch<span class="token punctuation">)</span>origingit@github.com:weikeet/material-components-android.git <span class="token punctuation">(</span>push<span class="token punctuation">)</span><span class="token comment"># è®¾ç½®Repository upstream</span>$ <span class="token function">git</span> remote <span class="token function">add</span> upstream git@github.com:material-components/material-components-android.git<span class="token comment"># æŸ¥çœ‹è¿œç¨‹ä»“åº“çš„è·¯å¾„</span>$ <span class="token function">git</span> remote <span class="token parameter variable">-v</span>origingit@github.com:weikeet/material-components-android.git <span class="token punctuation">(</span>fetch<span class="token punctuation">)</span>origingit@github.com:weikeet/material-components-android.git <span class="token punctuation">(</span>push<span class="token punctuation">)</span>upstreamgit@github.com:material-components/material-components-android.git <span class="token punctuation">(</span>fetch<span class="token punctuation">)</span>upstreamgit@github.com:material-components/material-components-android.git <span class="token punctuation">(</span>push<span class="token punctuation">)</span><span class="token comment"># æŠ“å–åŸä»“åº“çš„æ›´æ–°</span><span class="token function">git</span> fetch upstream<span class="token comment"># æ‰§è¡Œå‘½ä»¤ git checkout master åˆ‡æ¢åˆ° master åˆ†æ”¯</span><span class="token function">git</span> checkout master<span class="token comment"># åˆå¹¶è¿œç¨‹çš„masteråˆ†æ”¯</span><span class="token function">git</span> merge upstream/master<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ä½¿ç”¨-SubModule"><a href="#ä½¿ç”¨-SubModule" class="headerlink" title="ä½¿ç”¨ SubModule"></a>ä½¿ç”¨ SubModule</h2><blockquote><p>å‚è€ƒï¼š<br>imtianx: <a href="https://juejin.im/post/5aa11f486fb9a028e0140e34">Git å­æ¨¡å—</a><br>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://git-scm.com/book/zh/v2/Git-%E5%B7%A5%E5%85%B7-%E5%AD%90%E6%A8%A1%E5%9D%97">Git å·¥å…· - å­æ¨¡å—</a></p></blockquote><p>å·¥ä½œä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ°<strong>åœ¨ä¸€ä¸ª Git ä»“åº“ ä¸­æ·»åŠ  å…¶ä»– Git ä»“åº“çš„åœºæ™¯</strong>ã€‚æ¯”å¦‚ï¼Œåœ¨é¡¹ç›®ä¸­å¼•ç”¨ç¬¬ä¸‰æ–¹åº“ã€‚æˆ–è€…åœ¨æ¨¡å—åŒ–å¼€å‘ä¸­ï¼ŒæŸäº›å…¬å…±çš„æ¨¡å—æ˜¯éœ€è¦å•ç‹¬ç»´æŠ¤çš„ï¼Œä½¿ç”¨å•ç‹¬çš„ä»“åº“æ¯”è¾ƒæ–¹ä¾¿ï¼Œä½†æ˜¯åœ¨é¡¹ç›®ä¸­éœ€è¦å¼•ç”¨ï¼Œå°±ä¼šå‡ºç°è¿™æ ·çš„åœºæ™¯ã€‚è¿™é‡Œä½¿ç”¨ Git çš„ <code>git submodule</code> å‘½ä»¤ä¸ºä¸€ä¸ª <code>git é¡¹ç›®</code> æ·»åŠ  <code>å­gité¡¹ç›®</code></p><p>å¯ä»¥ä½¿ç”¨ <code>git submodule --help</code> æŸ¥çœ‹æ‰€æœ‰ç›¸å…³å‘½ä»¤ã€‚ ä¸ºäº†æ–¹ä¾¿è¯´æ˜ï¼Œè¿™é‡Œåœ¨ä¸»é¡¹ç›® <code>MainProject</code> ä¸­åŠ ä¸¤ä¸ªå­æ¨¡å— <code>liba</code> å’Œ <code>libb</code> .</p><h3 id="1-æ·»åŠ å­æ¨¡å—"><a href="#1-æ·»åŠ å­æ¨¡å—" class="headerlink" title="1. æ·»åŠ å­æ¨¡å—"></a>1. æ·»åŠ å­æ¨¡å—</h3><p>è¿›å…¥ <code>MainProject</code> ä½¿ç”¨ <strong>git submodule add</strong> è¿›è¡Œæ·»åŠ ,æ“ä½œå‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">git</span> clone https://github.com/imtianx/MainProject.git<span class="token builtin class-name">cd</span> MainProject/$ <span class="token function">git</span> submodule <span class="token function">add</span> https://github.com/imtianx/liba.git<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¦‚ä¸‹å›¾ï¼š<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/2019-03-14-071321.jpg"></p><p>ä½¿ç”¨ <code>git submodule add https://github.com/imtianx/libb.git</code> æ·»åŠ  <code>libb</code> å­æ¨¡å—ã€‚ å¯¹äºä¸Šå›¾: æ–‡ä»¶å¤¹ <code>liba</code> ä¸ºæ–°å¢åŠ çš„å­æ¨¡å—ç›®å½•, <code>.gitmodules</code> ä¸­å­˜æ”¾çš„ä¸ºå­æ¨¡å—çš„ä¿¡æ¯ï¼Œä½¿ç”¨ <code>cat</code> æˆ– <code>vim</code> æŸ¥çœ‹å†…å®¹ä¸ºï¼š</p><pre class="line-numbers language-none"><code class="language-none">[submodule "liba"]path = libaurl = https://github.com/imtianx/liba.git[submodule "libb"]path = libburl = https://github.com/imtianx/libb.git<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p><strong>.gitmodules æ–‡ä»¶</strong>ï¼šä¿å­˜é¡¹ç›® URL ä¸å·²ç»æ‹‰å–çš„æœ¬åœ°ç›®å½•ä¹‹é—´çš„æ˜ å°„ï¼Œæœ‰å¤šä¸ªå­æ¨¡å—åˆ™å«æœ‰å¤šæ¡è®°å½•ï¼Œä¼šéšç€ç‰ˆæœ¬æ§åˆ¶ä¸€èµ·è¢«æ‹‰å»å’Œæ¨é€çš„ã€‚</p></blockquote><p>æ­¤æ—¶æ–‡ä»¶ç›®å½•æ ‘å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">.â”œâ”€â”€ README.mdâ”œâ”€â”€ libaâ”‚   â”œâ”€â”€ README.mdâ”‚   â”œâ”€â”€ a.txtâ”‚   â””â”€â”€ a2.txtâ”œâ”€â”€ libbâ”‚   â”œâ”€â”€ README.mdâ”‚   â”œâ”€â”€ b.txtâ”‚   â””â”€â”€ b2.txtâ””â”€â”€ test.text<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€åï¼Œ<strong>æäº¤æ·»åŠ çš„å­æ¨¡å—åˆ°ä¸»ç›®å½•</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">"add liba and libb submodules"</span><span class="token punctuation">[</span>master 6b15e30<span class="token punctuation">]</span> <span class="token function">add</span> liba and libb submodules <span class="token number">3</span> files changed, <span class="token number">8</span> insertions<span class="token punctuation">(</span>+<span class="token punctuation">)</span> create mode <span class="token number">100644</span> .gitmodules create mode <span class="token number">160000</span> liba create mode <span class="token number">160000</span> libb<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-æ›´æ–°å­æ¨¡å—"><a href="#2-æ›´æ–°å­æ¨¡å—" class="headerlink" title="2. æ›´æ–°å­æ¨¡å—"></a>2. æ›´æ–°å­æ¨¡å—</h3><p>å¾€å¾€å­æ¨¡å—æ˜¯å•ç‹¬å¼€å‘çš„ï¼Œè¿™é‡Œä»¥æ›´æ–° <code>liba</code> ä¸ºä¾‹ï¼ˆä¸ºäº†æµ‹è¯•ï¼Œè¿™é‡Œå…ˆåœ¨ liba ä»“åº“æ·»åŠ äº†ä¸€ä¸ªæ–‡ä»¶ï¼‰ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token builtin class-name">cd</span> liba$ <span class="token function">git</span> fetch$ <span class="token function">git</span> merge origin/master<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ“ä½œç»“æœå¦‚ä¸‹å›¾ï¼Œ<strong>æ³¨æ„éœ€è¦è¿›å…¥å­æ¨¡å—ç›®å½•</strong>ï¼š<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/2019-03-14-071321.jpg"></p><p>æ­¤å¤–ï¼Œè¿˜å¯ä»¥åœ¨ä¸»ç›®å½•ä¸‹ ç›´æ¥ç”¨ä¸‹é¢çš„å‘½ä»¤æ›´æ–° <code>libb</code>å­æ¨¡å—ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> submodule update <span class="token parameter variable">--remote</span> liba<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼ï¼Œæ›´æ–° libb çš„ dev åˆ†æ”¯ï¼š</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">git</span> config <span class="token parameter variable">-f</span> .gitmodules submodule.libb.branch dev$ <span class="token function">git</span> submodule update <span class="token parameter variable">--remote</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¦‚ä¸‹å›¾ï¼š<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/2019-03-14-071531.jpg"></p><blockquote><p>è¿™é‡Œå¯¹ <code>.gitmodules</code> åŠ äº† <code>-f</code> å‚æ•°ï¼Œä¿®æ”¹æäº¤åå¯¹æ‰€æœ‰ç”¨æˆ·æœ‰æ•ˆã€‚</p></blockquote><h3 id="3-åˆ é™¤å­æ¨¡å—"><a href="#3-åˆ é™¤å­æ¨¡å—" class="headerlink" title="3. åˆ é™¤å­æ¨¡å—"></a>3. åˆ é™¤å­æ¨¡å—</h3><p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæœ‰æ·»åŠ ï¼Œå½“ç„¶ä¹Ÿä¼šæœ‰åˆ é™¤ å­æ¨¡å—çš„éœ€æ±‚ã€‚ è¿™é‡Œä¸»é¡¹ç›®åŒ…å«ä¸¤ä¸ªå­æ¨¡å—ï¼š<code>liba</code>ã€<code>libb</code>ï¼Œä»¥åˆ é™¤ <code>liba</code> ä¸ºä¾‹è¯´æ˜ï¼š</p><ul><li>ä½¿ç”¨ <code>git rm --cached liba</code> å°† liba ä»ç‰ˆæœ¬æ§åˆ¶ä¸­åˆ é™¤ï¼ˆæœ¬åœ°ä»ä¿ç•™æœ‰ï¼‰ï¼Œè‹¥ä¸éœ€è¦å¯ä¸å¸¦ <code>--cached</code>è¿›è¡Œå®Œå…¨åˆ é™¤ã€‚</li><li>ä½¿ç”¨ <code>vim .gitmodules</code> å¯æ‰“å¼€ vim ç¼–è¾‘,åˆ é™¤å¯¹åº”çš„å†…å®¹</li></ul><pre class="line-numbers language-none"><code class="language-none">[submodule "liba"]   path = liba   url = https://github.com/imtianx/liba.git   branch = dev<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ul><li>ä½¿ç”¨ <code>vim .git/config</code> å¯æ‰“å¼€ vim ç¼–è¾‘,åˆ é™¤å¯¹åº”çš„å†…å®¹</li></ul><pre class="line-numbers language-none"><code class="language-none">[submodule "liba"]    url = https://github.com/imtianx/liba.git    active = true<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li>ä½¿ç”¨ <code>rm -rf .git/modules/liba</code>, åˆ é™¤.git ä¸‹çš„ç¼“å­˜æ¨¡å—ï¼Œæœ€åæäº¤é¡¹ç›®ã€‚</li></ul><p>ç»è¿‡ä¸Šé¢çš„åˆ é™¤åè¿˜å¯ä»¥è¿›è¡Œæ·»åŠ å­æ¨¡å—ã€‚</p><h3 id="4-å…‹éš†å«å­æ¨¡å—çš„ä»“åº“"><a href="#4-å…‹éš†å«å­æ¨¡å—çš„ä»“åº“" class="headerlink" title="4. å…‹éš†å«å­æ¨¡å—çš„ä»“åº“"></a>4. å…‹éš†å«å­æ¨¡å—çš„ä»“åº“</h3><p>è‹¥éœ€è¦å…‹éš†å«æœ‰å­æ¨¡å—çš„ä»“åº“ï¼Œç›´æ¥ è¿›è¡Œå…‹éš†æ˜¯æ— æ³•æ‹‰å–ä¹‹æ¨¡å—çš„ä»£ç ï¼Œå¯åŠ ä¸Š <strong>â€“recursive</strong> å‚æ•°ï¼Œå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone <span class="token parameter variable">--recursive</span> https://github.com/imtianx/MainProject.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ–è€…ä½¿ç”¨ä¸‹é¢çš„ä¸‰éƒ¨æ“ä½œï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> clone  https://github.com/imtianx/MainProject.git<span class="token function">git</span> submodule init<span class="token function">git</span> submodule update<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="Git-åˆ†æ”¯å¼€å‘è§„èŒƒ"><a href="#Git-åˆ†æ”¯å¼€å‘è§„èŒƒ" class="headerlink" title="Git åˆ†æ”¯å¼€å‘è§„èŒƒ"></a>Git åˆ†æ”¯å¼€å‘è§„èŒƒ</h2><blockquote><p>å‚è€ƒå†…å®¹<br><a href="http://www.ruanyifeng.com/blog/2012/07/git.html">Git åˆ†æ”¯ç®¡ç†ç­–ç•¥</a> &gt; <a href="https://juejin.im/post/5b4328bbf265da0fa21a6820">æ‚¨å¿…é¡»çŸ¥é“çš„ Git åˆ†æ”¯å¼€å‘è§„èŒƒ</a> &gt; <a href="https://www.zhihu.com/question/21209619">å¦‚ä½•å†™å¥½ Git commit messages</a> &gt; <a href="https://segmentfault.com/a/1190000009048911">git commit è§„èŒƒæŒ‡å—</a> &gt; <a href="https://stackoverflow.com/questions/3651860/which-characters-are-illegal-within-a-branch-name">Which characters are illegal within a branch name?</a></p></blockquote><p>Git æ˜¯ç›®å‰æœ€æµè¡Œçš„æºä»£ç ç®¡ç†å·¥å…·ã€‚ ä¸ºè§„èŒƒå¼€å‘ï¼Œä¿æŒä»£ç æäº¤è®°å½•ä»¥åŠ git åˆ†æ”¯ç»“æ„æ¸…æ™°ï¼Œæ–¹ä¾¿åç»­ç»´æŠ¤ï¼Œç°è§„èŒƒ git çš„ç›¸å…³æ“ä½œã€‚</p><p><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/PWAUoF.jpg"></p><h3 id="åˆ†æ”¯ç®¡ç†"><a href="#åˆ†æ”¯ç®¡ç†" class="headerlink" title="åˆ†æ”¯ç®¡ç†"></a>åˆ†æ”¯ç®¡ç†</h3><h4 id="åˆ†æ”¯å‘½å"><a href="#åˆ†æ”¯å‘½å" class="headerlink" title="åˆ†æ”¯å‘½å"></a>åˆ†æ”¯å‘½å</h4><p><strong>master åˆ†æ”¯</strong></p><ul><li>master ä¸ºä¸»åˆ†æ”¯ï¼Œä¹Ÿæ˜¯ç”¨äºéƒ¨ç½²ç”Ÿäº§ç¯å¢ƒçš„åˆ†æ”¯ï¼Œç¡®ä¿ master åˆ†æ”¯ç¨³å®šæ€§</li><li>master åˆ†æ”¯ä¸€èˆ¬ç”± develop ä»¥åŠ hotfix åˆ†æ”¯åˆå¹¶ï¼Œä»»ä½•æ—¶é—´éƒ½ä¸èƒ½ç›´æ¥ä¿®æ”¹ä»£ç </li></ul><p><strong>develop åˆ†æ”¯</strong></p><ul><li>develop ä¸ºå¼€å‘åˆ†æ”¯ï¼Œå§‹ç»ˆä¿æŒæœ€æ–°å®Œæˆä»¥åŠ bug ä¿®å¤åçš„ä»£ç </li><li>ä¸€èˆ¬å¼€å‘çš„æ–°åŠŸèƒ½æ—¶ï¼Œfeature åˆ†æ”¯éƒ½æ˜¯åŸºäº develop åˆ†æ”¯ä¸‹åˆ›å»ºçš„</li></ul><p><strong>feature åˆ†æ”¯</strong></p><ul><li>å¼€å‘æ–°åŠŸèƒ½æ—¶ï¼Œä»¥ develop ä¸ºåŸºç¡€åˆ›å»º feature åˆ†æ”¯</li><li>åˆ†æ”¯å‘½å: feature/ å¼€å¤´çš„ä¸ºç‰¹æ€§åˆ†æ”¯ï¼Œ å‘½åè§„åˆ™: feature/user_moduleã€ feature/cart_module</li></ul><p><strong>release åˆ†æ”¯</strong></p><ul><li>release ä¸ºé¢„ä¸Šçº¿åˆ†æ”¯ï¼Œå‘å¸ƒææµ‹é˜¶æ®µï¼Œä¼š release åˆ†æ”¯ä»£ç ä¸ºåŸºå‡†ææµ‹</li></ul><pre class="line-numbers language-none"><code class="language-none">å½“æœ‰ä¸€ç»„featureå¼€å‘å®Œæˆï¼Œé¦–å…ˆä¼šåˆå¹¶åˆ°developåˆ†æ”¯ï¼Œè¿›å…¥ææµ‹æ—¶ï¼Œä¼šåˆ›å»ºreleaseåˆ†æ”¯ã€‚å¦‚æœæµ‹è¯•è¿‡ç¨‹ä¸­è‹¥å­˜åœ¨bugéœ€è¦ä¿®å¤ï¼Œåˆ™ç›´æ¥ç”±å¼€å‘è€…åœ¨releaseåˆ†æ”¯ä¿®å¤å¹¶æäº¤ã€‚å½“æµ‹è¯•å®Œæˆä¹‹åï¼Œåˆå¹¶releaseåˆ†æ”¯åˆ°masterå’Œdevelopåˆ†æ”¯ï¼Œæ­¤æ—¶masterä¸ºæœ€æ–°ä»£ç ï¼Œç”¨ä½œä¸Šçº¿ã€‚å¤åˆ¶ä»£ç <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>hotfix åˆ†æ”¯</strong></p><ul><li>åˆ†æ”¯å‘½å: hotfix/ å¼€å¤´çš„ä¸ºä¿®å¤åˆ†æ”¯ï¼Œå®ƒçš„å‘½åè§„åˆ™ä¸ feature åˆ†æ”¯ç±»ä¼¼</li><li>çº¿ä¸Šå‡ºç°ç´§æ€¥é—®é¢˜æ—¶ï¼Œéœ€è¦åŠæ—¶ä¿®å¤ï¼Œä»¥ master åˆ†æ”¯ä¸ºåŸºçº¿ï¼Œåˆ›å»º hotfix åˆ†æ”¯ï¼Œä¿®å¤å®Œæˆåï¼Œéœ€è¦åˆå¹¶åˆ° master åˆ†æ”¯å’Œ develop åˆ†æ”¯</li></ul><h4 id="å¸¸è§ä»»åŠ¡"><a href="#å¸¸è§ä»»åŠ¡" class="headerlink" title="å¸¸è§ä»»åŠ¡"></a>å¸¸è§ä»»åŠ¡</h4><p><strong>å¢åŠ æ–°åŠŸèƒ½</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>dev<span class="token punctuation">)</span>$: <span class="token function">git</span> checkout <span class="token parameter variable">-b</span> feature/xxx            <span class="token comment"># ä»devå»ºç«‹ç‰¹æ€§åˆ†æ”¯</span><span class="token punctuation">(</span>feature/xxx<span class="token punctuation">)</span>$: blabla                         <span class="token comment"># å¼€å‘</span><span class="token punctuation">(</span>feature/xxx<span class="token punctuation">)</span>$: <span class="token function">git</span> <span class="token function">add</span> xxx<span class="token punctuation">(</span>feature/xxx<span class="token punctuation">)</span>$: <span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">'commit comment'</span><span class="token punctuation">(</span>dev<span class="token punctuation">)</span>$: <span class="token function">git</span> merge feature/xxx --no-ff          <span class="token comment"># æŠŠç‰¹æ€§åˆ†æ”¯åˆå¹¶åˆ°dev</span>å¤åˆ¶ä»£ç <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ä¿®å¤ç´§æ€¥ bug</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>master<span class="token punctuation">)</span>$: <span class="token function">git</span> checkout <span class="token parameter variable">-b</span> hotfix/xxx         <span class="token comment"># ä»masterå»ºç«‹hotfixåˆ†æ”¯</span><span class="token punctuation">(</span>hotfix/xxx<span class="token punctuation">)</span>$: blabla                         <span class="token comment"># å¼€å‘</span><span class="token punctuation">(</span>hotfix/xxx<span class="token punctuation">)</span>$: <span class="token function">git</span> <span class="token function">add</span> xxx<span class="token punctuation">(</span>hotfix/xxx<span class="token punctuation">)</span>$: <span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">'commit comment'</span><span class="token punctuation">(</span>master<span class="token punctuation">)</span>$: <span class="token function">git</span> merge hotfix/xxx --no-ff       <span class="token comment"># æŠŠhotfixåˆ†æ”¯åˆå¹¶åˆ°masterï¼Œå¹¶ä¸Šçº¿åˆ°ç”Ÿäº§ç¯å¢ƒ</span><span class="token punctuation">(</span>dev<span class="token punctuation">)</span>$: <span class="token function">git</span> merge hotfix/xxx --no-ff          <span class="token comment"># æŠŠhotfixåˆ†æ”¯åˆå¹¶åˆ°devï¼ŒåŒæ­¥ä»£ç </span>å¤åˆ¶ä»£ç <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æµ‹è¯•ç¯å¢ƒä»£ç </strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>release<span class="token punctuation">)</span>$: <span class="token function">git</span> merge dev --no-ff             <span class="token comment"># æŠŠdevåˆ†æ”¯åˆå¹¶åˆ°releaseï¼Œç„¶ååœ¨æµ‹è¯•ç¯å¢ƒæ‹‰å–å¹¶æµ‹è¯•</span>å¤åˆ¶ä»£ç <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>ç”Ÿäº§ç¯å¢ƒä¸Šçº¿</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>master<span class="token punctuation">)</span>$: <span class="token function">git</span> merge release --no-ff          <span class="token comment"># æŠŠreleaseæµ‹è¯•å¥½çš„ä»£ç åˆå¹¶åˆ°masterï¼Œè¿ç»´äººå‘˜æ“ä½œ</span><span class="token punctuation">(</span>master<span class="token punctuation">)</span>$: <span class="token function">git</span> tag <span class="token parameter variable">-a</span> v0.1 <span class="token parameter variable">-m</span> <span class="token string">'éƒ¨ç½²åŒ…ç‰ˆæœ¬å'</span>  <span class="token comment">#ç»™ç‰ˆæœ¬å‘½åï¼Œæ‰“Tag</span>å¤åˆ¶ä»£ç <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/9czDAj.jpg"></p><h3 id="æ—¥å¿—è§„èŒƒ"><a href="#æ—¥å¿—è§„èŒƒ" class="headerlink" title="æ—¥å¿—è§„èŒƒ"></a>æ—¥å¿—è§„èŒƒ</h3><blockquote><p>åœ¨ä¸€ä¸ªå›¢é˜Ÿåä½œçš„é¡¹ç›®ä¸­ï¼Œå¼€å‘äººå‘˜éœ€è¦ç»å¸¸æäº¤ä¸€äº›ä»£ç å»ä¿®å¤ bug æˆ–è€…å®ç°æ–°çš„ featureã€‚è€Œé¡¹ç›®ä¸­çš„æ–‡ä»¶å’Œå®ç°ä»€ä¹ˆåŠŸèƒ½ã€è§£å†³ä»€ä¹ˆé—®é¢˜éƒ½ä¼šæ¸æ¸æ·¡å¿˜ï¼Œæœ€åéœ€è¦æµªè´¹æ—¶é—´å»é˜…è¯»ä»£ç ã€‚ä½†æ˜¯å¥½çš„æ—¥å¿—è§„èŒƒ commit messages ç¼–å†™æœ‰å¸®åŠ©åˆ°æˆ‘ä»¬ï¼Œå®ƒä¹Ÿåæ˜ äº†ä¸€ä¸ªå¼€å‘äººå‘˜æ˜¯å¦æ˜¯è‰¯å¥½çš„åä½œè€…ã€‚</p></blockquote><p><strong>ç¼–å†™è‰¯å¥½çš„ Commit messages å¯ä»¥è¾¾åˆ° 3 ä¸ªé‡è¦çš„ç›®çš„ï¼š</strong></p><ul><li>åŠ å¿« review çš„æµç¨‹</li><li>å¸®åŠ©æˆ‘ä»¬ç¼–å†™è‰¯å¥½çš„ç‰ˆæœ¬å‘å¸ƒæ—¥å¿—</li><li>è®©ä¹‹åçš„ç»´æŠ¤è€…äº†è§£ä»£ç é‡Œå‡ºç°ç‰¹å®šå˜åŒ–å’Œ feature è¢«æ·»åŠ çš„åŸå› </li></ul><p><strong>ç›®å‰ï¼Œç¤¾åŒºæœ‰å¤šç§ Commit message çš„å†™æ³•è§„èŒƒã€‚æ¥è‡ª Angular è§„èŒƒæ˜¯ç›®å‰ä½¿ç”¨æœ€å¹¿çš„å†™æ³•ï¼Œæ¯”è¾ƒåˆç†å’Œç³»ç»ŸåŒ–ã€‚å¦‚ä¸‹å›¾ï¼š</strong></p><p><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/UlbImQ.jpg"></p><h4 id="Commit-messages-çš„åŸºæœ¬è¯­æ³•"><a href="#Commit-messages-çš„åŸºæœ¬è¯­æ³•" class="headerlink" title="Commit messages çš„åŸºæœ¬è¯­æ³•"></a>Commit messages çš„åŸºæœ¬è¯­æ³•</h4><p>å½“å‰ä¸šç•Œåº”ç”¨çš„æ¯”è¾ƒå¹¿æ³›çš„æ˜¯ <a href="https://docs.google.com/document/d/1QrDFcIiPjSLDn3EL15IJygNPiHORgU1_OOAqWjiDU5Y/edit#heading=h.greljkmo14y0">Angular Git Commit Guidelines</a></p><p>å…·ä½“æ ¼å¼ä¸º:</p><pre class="line-numbers language-none"><code class="language-none">&lt;type&gt;: &lt;subject&gt;&lt;BLANK LINE&gt;&lt;body&gt;&lt;BLANK LINE&gt;&lt;footer&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>type: æœ¬æ¬¡ commit çš„ç±»å‹ï¼Œè¯¸å¦‚ bugfix docs style ç­‰</li><li>scope: æœ¬æ¬¡ commit æ³¢åŠçš„èŒƒå›´</li><li>subject: ç®€æ˜æ‰¼è¦çš„é˜è¿°ä¸‹æœ¬æ¬¡ commit çš„ä¸»æ—¨ï¼Œåœ¨åŸæ–‡ä¸­ç‰¹æ„å¼ºè°ƒäº†å‡ ç‚¹ 1. ä½¿ç”¨ç¥ˆä½¿å¥ï¼Œæ˜¯ä¸æ˜¯å¾ˆç†Ÿæ‚‰åˆé™Œç”Ÿçš„ä¸€ä¸ªè¯ï¼Œæ¥ä¼ é€é—¨åœ¨æ­¤ ç¥ˆä½¿å¥ 2. é¦–å­—æ¯ä¸è¦å¤§å†™ 3. ç»“å°¾æ— éœ€æ·»åŠ æ ‡ç‚¹</li><li>body: åŒæ ·ä½¿ç”¨ç¥ˆä½¿å¥ï¼Œåœ¨ä¸»ä½“å†…å®¹ä¸­æˆ‘ä»¬éœ€è¦æŠŠæœ¬æ¬¡ commit è¯¦ç»†çš„æè¿°ä¸€ä¸‹ï¼Œæ¯”å¦‚æ­¤æ¬¡å˜æ›´çš„åŠ¨æœºï¼Œå¦‚éœ€æ¢è¡Œï¼Œåˆ™ä½¿ç”¨ |</li><li>footer: æè¿°ä¸‹ä¸ä¹‹å…³è”çš„ issue æˆ– break changeï¼Œè¯¦è§æ¡ˆä¾‹</li></ul><p><strong>Type çš„ç±»åˆ«è¯´æ˜ï¼š</strong></p><ul><li>feature: æ·»åŠ æ–°ç‰¹æ€§/æ–°åŠŸèƒ½</li><li>upgrade: åŠŸèƒ½å‡çº§æˆ–ä»£ç å˜æ›´</li><li>fix: ä¿®å¤ bug</li><li>docs: ä»…ä»…ä¿®æ”¹äº†æ–‡æ¡£æˆ– README</li><li>style: ä»…ä»…ä¿®æ”¹äº†ç©ºæ ¼ã€æ ¼å¼ç¼©è¿›ã€æˆ–è€…ä¸»é¢˜ UI å˜æ›´ ç­‰ç­‰ï¼Œä¸æ”¹å˜ä»£ç é€»è¾‘</li><li>refactor: ä»£ç é‡æ„ï¼Œæ²¡æœ‰åŠ æ–°åŠŸèƒ½æˆ–è€…ä¿®å¤ bug</li><li>perf: å¢åŠ ä»£ç è¿›è¡Œæ€§èƒ½æµ‹è¯•</li><li>test: å¢åŠ æµ‹è¯•ç”¨ä¾‹</li><li>chore: æ”¹å˜æ„å»ºæµç¨‹ã€æˆ–è€…å¢åŠ ä¾èµ–åº“ã€å·¥å…·ç­‰</li></ul><h4 id="Commit-messages-æ ¼å¼è¦æ±‚"><a href="#Commit-messages-æ ¼å¼è¦æ±‚" class="headerlink" title="Commit messages æ ¼å¼è¦æ±‚"></a>Commit messages æ ¼å¼è¦æ±‚</h4><p>å¯¹äº Git Commit Message å¹¶æ˜ç¡®çš„æ ‡å‡†ï¼Œä½†ä¹Ÿæœ‰ä¸€äº›å¥½çš„åŸåˆ™ï¼š</p><ul><li>ä½¿æäº¤ä¿¡æ¯ä¸šåŠ¡ç›¸å…³</li><li>æäº¤ä¿¡æ¯ä¸­å†™æ˜ç±»å‹</li><li>å¿…è¦æ—¶è¦å†™æè¿°(Decription)</li><li>æäº¤ä¸»é¢˜å°½é‡ç®€çŸ­</li><li>å°½é‡ä½¿ç”¨è‹±æ–‡</li></ul><pre class="line-numbers language-none"><code class="language-none"># æ ‡é¢˜è¡Œï¼š50ä¸ªå­—ç¬¦ä»¥å†…ï¼Œæè¿°ä¸»è¦å˜æ›´å†…å®¹## ä¸»ä½“å†…å®¹ï¼šæ›´è¯¦ç»†çš„è¯´æ˜æ–‡æœ¬ï¼Œå»ºè®®72ä¸ªå­—ç¬¦ä»¥å†…ã€‚ éœ€è¦æè¿°çš„ä¿¡æ¯åŒ…æ‹¬:## * ä¸ºä»€ä¹ˆè¿™ä¸ªå˜æ›´æ˜¯å¿…é¡»çš„? å®ƒå¯èƒ½æ˜¯ç”¨æ¥ä¿®å¤ä¸€ä¸ªbugï¼Œå¢åŠ ä¸€ä¸ªfeatureï¼Œæå‡æ€§èƒ½ã€å¯é æ€§ã€ç¨³å®šæ€§ç­‰ç­‰# * ä»–å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜? å…·ä½“æè¿°è§£å†³é—®é¢˜çš„æ­¥éª¤# * æ˜¯å¦å­˜åœ¨å‰¯ä½œç”¨ã€é£é™©?## å¦‚æœéœ€è¦çš„åŒ–å¯ä»¥æ·»åŠ ä¸€ä¸ªé“¾æ¥åˆ°issueåœ°å€æˆ–è€…å…¶å®ƒæ–‡æ¡£<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h4><p><a href="https://juejin.im/post/6847902225029660680">Git å¦‚ä½•å†™å‡ºä¼˜é›…çš„ Commit Message</a><br><a href="https://juejin.im/post/6844903721244033038">åˆ©ç”¨ emoji è®©çš„ git commit ç”ŸåŠ¨æ¸…æ™°èµ·æ¥</a><br><a href="https://juejin.im/post/6844903606815064077">ä¼˜é›…çš„æäº¤ä½ çš„ Git Commit Message</a></p><h3 id="åˆ©ç”¨-emoji-è®©çš„-git-commit-ç”ŸåŠ¨æ¸…æ™°èµ·æ¥"><a href="#åˆ©ç”¨-emoji-è®©çš„-git-commit-ç”ŸåŠ¨æ¸…æ™°èµ·æ¥" class="headerlink" title="åˆ©ç”¨ emoji è®©çš„ git commit ç”ŸåŠ¨æ¸…æ™°èµ·æ¥"></a>åˆ©ç”¨ emoji è®©çš„ git commit ç”ŸåŠ¨æ¸…æ™°èµ·æ¥</h3><p>æœ‰ä¸€äº›å¤šäººåˆä½œçš„é¡¹ç›®åŒäº‹æäº† commitï¼Œä½ è¿˜éœ€è¦èŠ±æ—¶é—´å»çœ‹ä»€ä¹ˆæäº¤äº†ä»€ä¹ˆï¼Œå› ä¸ºä»€ä¹ˆæäº¤ã€‚<br>æœ‰äº† emoji ä¹‹åï¼Œä¾‹å¦‚çœ‹åˆ°æœ‰æ¡è™« ğŸ› å°±çŸ¥é“ä»–è¿™æ¬¡ç‰ˆæœ¬å°±æ˜¯æ”¹äº† bug äº†ã€‚<br>éå¸¸æ–¹ä¾¿å¿«æ·ï¼Œè¯ä¸å¤šè¯´ï¼Œå¼€å§‹å§ã€‚</p><p>å¦‚ä½•é£Ÿç”¨ï¼šcommit æ—¶å¡«å†™ä»¥ä¸‹å›¾æ ‡å¯¹åº”ä»£ç å³å¯ï¼Œä¾‹å¦‚ï¼š <code>:bug:</code> è§£å†³ä¸‹å•é—®é¢˜ã€‚</p><p>ğŸ¨ <span class="github-emoji"><span>ğŸ¨</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f3a8.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p><pre class="line-numbers language-none"><code class="language-none">æ”¹è¿›ä»£ç ç»“æ„æˆ–è€…æ ¼å¼ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>âš¡ <span class="github-emoji"><span>âš¡</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/26a1.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p><pre class="line-numbers language-none"><code class="language-none">æé«˜æ•ˆç‡ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ğŸ”¥ <span class="github-emoji"><span>ğŸ”¥</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f525.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p><pre class="line-numbers language-none"><code class="language-none">åˆ é™¤ä»£ç æˆ–æ–‡ä»¶ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ğŸ› <span class="github-emoji"><span>ğŸ›</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f41b.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p><pre class="line-numbers language-none"><code class="language-none">ä¿®å¤bugã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ğŸš‘ <span class="github-emoji"><span>ğŸš‘</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f691.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p><pre class="line-numbers language-none"><code class="language-none">åˆ é™¤ä»£ç æˆ–æ–‡ä»¶ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ğŸ”¥ <span class="github-emoji"><span>ğŸ¨</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f3a8.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p><pre class="line-numbers language-none"><code class="language-none">åˆ é™¤ä»£ç æˆ–æ–‡ä»¶ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>âœ¨ <span class="github-emoji"><span>âœ¨</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/2728.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p><pre class="line-numbers language-none"><code class="language-none">å¢åŠ æ–°åŠŸèƒ½ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ğŸ“ <span class="github-emoji"><span>ğŸ“</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f4dd.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p><pre class="line-numbers language-none"><code class="language-none">ä¹¦å†™æ–‡æ¡£ï¼Œä¾‹å¦‚ä¿®æ”¹readme.mdã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ğŸš€ <span class="github-emoji"><span>ğŸš€</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f680.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p><pre class="line-numbers language-none"><code class="language-none">éƒ¨ç½²é¡¹ç›®ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ğŸ’„ <span class="github-emoji"><span>ğŸ’„</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f484.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p><pre class="line-numbers language-none"><code class="language-none">æ›´æ–°UIå’Œæ ·å¼æ–‡ä»¶ï¼Œä¾‹å¦‚æ›´æ–°cssï¼ˆå‰ç«¯åº”è¯¥ç»å¸¸éƒ½è¦è¿™ä¸ªæ¶‚å”‡è†çš„ï¼‰ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ğŸ‰ <span class="github-emoji"><span>ğŸ‰</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f389.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p><pre class="line-numbers language-none"><code class="language-none">é¦–æ¬¡æäº¤ first commitã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>âœ… <span class="github-emoji"><span>âœ…</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p><pre class="line-numbers language-none"><code class="language-none">æ·»åŠ æµ‹è¯•ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ğŸ”’ <span class="github-emoji"><span>ğŸ”’</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f512.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p><pre class="line-numbers language-none"><code class="language-none">è§£å†³å®‰å…¨é—®é¢˜ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>â™» <span class="github-emoji"><span>â™»</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/267b.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p><pre class="line-numbers language-none"><code class="language-none">é‡æ„ä»£ç ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>â• <span class="github-emoji"><span>â•</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/2795.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p><pre class="line-numbers language-none"><code class="language-none">æ·»åŠ ä¾èµ–ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>â– <span class="github-emoji"><span>â–</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/2796.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p><pre class="line-numbers language-none"><code class="language-none">åˆ é™¤ä¾èµ–ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ğŸ”§ <span class="github-emoji"><span>ğŸ”§</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f527.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p><pre class="line-numbers language-none"><code class="language-none">æ›´æ”¹é…ç½®æ–‡ä»¶ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ğŸ’© <span class="github-emoji"><span>ğŸ’©</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f4a9.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p><pre class="line-numbers language-none"><code class="language-none">ç¼–å†™éœ€è¦æ”¹è¿›çš„é”™è¯¯ä»£ç ï¼ˆè¿™ä¸ªemojiä¹Ÿå¤ªçœŸå®äº†å§ï¼‰ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>â– <span class="github-emoji"><span>â–</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/2796.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p><pre class="line-numbers language-none"><code class="language-none">åˆ é™¤ä¾èµ–ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><a href="http://emojihomepage.com/">http://emojihomepage.com/</a><br><a href="https://gitmoji.carloscuesta.me/">https://gitmoji.carloscuesta.me/</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Git </tag>
            
            <tag> GitHub </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - é€‚é…å™¨æ¨¡å¼</title>
      <link href="/20171210/designpattern-structure-adapter/"/>
      <url>/20171210/designpattern-structure-adapter/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-é€‚é…å™¨æ¨¡å¼"><a href="#ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-é€‚é…å™¨æ¨¡å¼" class="headerlink" title="ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - é€‚é…å™¨æ¨¡å¼"></a>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - é€‚é…å™¨æ¨¡å¼</h1><blockquote><p>é€‚é…å™¨æ¨¡å¼æŠŠä¸€ä¸ªç±»çš„æ¥å£å˜æ¢æˆå®¢æˆ·ç«¯æ‰€æœŸå¾…çš„å¦å¤–ä¸€ä¸ªæ¥å£ï¼Œä»è€Œä½¿åŸæœ¬å› æ¥å£ä¸åŒ¹é…è€Œæ— æ³•ä¸€èµ·å·¥ä½œçš„ä¸¤ä¸ªç±»èƒ½å¤Ÿåœ¨ä¸€èµ·å·¥ä½œ<br>é€‚é…å™¨åˆ†ä¸ºç±»é€‚é…å™¨å’Œå¯¹è±¡é€‚é…å™¨ä¸¤å¼ </p></blockquote><span id="more"></span><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><ol><li>ç³»ç»Ÿéœ€è¦ä½¿ç”¨ç°æœ‰çš„ç±»ï¼Œè€Œæ­¤ç±»çš„æ¥å£ä¸ç¬¦åˆç³»ç»Ÿçš„éœ€è¦ï¼Œå³æ¥å£ä¸å…¼å®¹</li><li>æƒ³è¦å»ºç«‹ä¸€ä¸ªå¯é‡å¤åˆ©ç”¨çš„ç±»ï¼Œç”¨äºä¸ä¸€äº›å½¼æ­¤ä¹‹é—´æ²¡æœ‰å¤ªå¤§å…³è”çš„ç±»ä¸€èµ·å·¥ä½œ</li><li>éœ€è¦ä¸€ä¸ªç»Ÿä¸€çš„è¾“å‡ºæ¥å£ï¼Œè€Œè¾“å…¥ç«¯çš„ç±»å‹ä¸å¯é¢„çŸ¥</li></ol><h2 id="ç±»é€‚é…å™¨"><a href="#ç±»é€‚é…å™¨" class="headerlink" title="ç±»é€‚é…å™¨"></a>ç±»é€‚é…å™¨</h2><h2 id="UML-ç±»å›¾"><a href="#UML-ç±»å›¾" class="headerlink" title="UML ç±»å›¾"></a>UML ç±»å›¾</h2><p><img src="http://blog-1251678165.coscd.myqcloud.com/2018-03-14-Adapter-of-class.uml.png" alt="ç±»é€‚é…å™¨"><br>ç±»é€‚é…å™¨æ˜¯é€šè¿‡å®ç° Target æ¥å£ä»¥åŠç»§æ‰¿ Adaptee ç±»æ¥å®ç°æ¥å£è½¬æ¢ï¼Œå¦‚ç›®æ ‡æ¥å£éœ€è¦ operator2(), ä½†æ˜¯ Adaptee å¯¹è±¡åªæœ‰ operator3()ï¼Œå› æ­¤å°±å‡ºç°äº†ä¸å…¼å®¹æƒ…å†µã€‚æ­¤æ—¶å¯ä»¥é€šè¿‡ Adapter å®ç°ä¸€ä¸ª operator2()å°† Adaptee çš„ operator3()è½¬æ¢ä¸º Target éœ€è¦çš„ operator2()</p><p>è§’è‰²ä»‹ç»:</p><ul><li>Target: ç›®æ ‡è§’è‰²ï¼Œä¹Ÿå°±æ˜¯æ¥å£æ‰€æœŸå¾…å¾—åˆ°çš„æ¥å£ã€‚ï¼ˆç±»é€‚é…å™¨æ¨¡å¼ï¼Œæ­¤ç›®æ ‡ä¸å¯ä»¥æ˜¯ç±»ï¼‰</li><li>Adaptee: ç°åœ¨éœ€è¦é€‚é…çš„æ¥å£</li><li>Adapter: é€‚é…å™¨è§’è‰²ï¼Œæ ¸å¿ƒç±»ï¼ŒæŠŠä¸å…¼å®¹çš„æ¥å£è½¬æ¢æˆç›®æ ‡æ‰€éœ€æ¥å£ï¼Œè¿™ä¸€è§’è‰²å¿…é¡»æ˜¯å…·ä½“ç±»</li></ul><h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/12/10. * &lt;p&gt; * desc: ç¬”è®°æœ¬ç”µè„‘ä¸€éƒ½æ˜¯éœ€è¦5Vç”µå‹ï¼Œè€Œç”Ÿæ´»ç”µå‹ä¸€èˆ¬éƒ½æ˜¯220Vï¼Œè¿™ä¸ªæ—¶å€™å°±äº§ç”Ÿäº†ä¸å…¼å®¹æƒ…å†µ * éœ€è¦ä¸€ä¸ªé€‚é…å™¨æ¥æŠŠ220Vç”µå‹è½¬æ¢æˆ5Vç”µå‹ * å¯¹åº”å°±æ˜¯Targetéœ€è¦å¾—åˆ°5Vç”µå‹ï¼Œè€ŒAdapteeæ­£å¸¸è¾“å‡º220Vï¼ŒAdapterç±»åˆ™æ˜¯ç»§æ‰¿Adapteeå®ç°Target * å°†220Vè½¬ä¸º5Vï¼Œè§£å†³æ¥å£ä¸å…¼å®¹é—®é¢˜ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">VoltAdapter</span> adapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VoltAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è¾“å‡ºç”µå‹: "</span> <span class="token operator">+</span> adapter<span class="token punctuation">.</span><span class="token function">getVolt5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/12/10. * &lt;p&gt; * desc: Target è§’è‰² */</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">FiveVolt</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> <span class="token function">getVolt5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/12/10. * &lt;p&gt; * desc: Adaptee è§’è‰² */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Volt220</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getVolt220</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token number">220</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/12/10. * &lt;p&gt; * desc: Adapter è§’è‰² */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">VoltAdapter</span> <span class="token keyword">extends</span> <span class="token class-name">Volt220</span> <span class="token keyword">implements</span> <span class="token class-name">FiveVolt</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getVolt5</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token number">5</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å¯¹è±¡é€‚é…å™¨"><a href="#å¯¹è±¡é€‚é…å™¨" class="headerlink" title="å¯¹è±¡é€‚é…å™¨"></a>å¯¹è±¡é€‚é…å™¨</h2><h3 id="UML-ç±»å›¾-1"><a href="#UML-ç±»å›¾-1" class="headerlink" title="UML ç±»å›¾"></a>UML ç±»å›¾</h3><p><img src="http://blog-1251678165.coscd.myqcloud.com/2018-03-14-Adapter-of-object.uml.png"><br>ä¸ç±»é€‚é…å™¨ä¸€æ ·ï¼Œå¯¹è±¡é€‚é…å™¨æ¨¡å¼æŠŠè¢«é€‚é…ç±»çš„ API è½¬ä¸ºç›®æ ‡ç±»çš„ APIï¼Œä¸ç±»é€‚é…å™¨æ¨¡å¼ä¸åŒçš„æ˜¯ï¼šå¯¹è±¡é€‚é…å™¨æ¨¡å¼ä¸æ˜¯ä½¿ç”¨ç»§æ‰¿å…³ç³»è¿æ¥åˆ° Adapteeï¼Œè€Œæ˜¯ä½¿ç”¨ä»£ç†å…³ç³»ï¼ŒUML ç±»å›¾å¦‚ä¸‹:</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// åŸºäºç±»é€‚é…å™¨çš„ç¤ºä¾‹ä¿®æ”¹Adapter</span><span class="token comment">/** * Created by Weicools on 2017/12/10. * &lt;p&gt; * desc: Adapter è§’è‰² */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">VoltAdapter</span> <span class="token keyword">implements</span> <span class="token class-name">FiveVolt</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token class-name">Volt220</span> mVolt220<span class="token punctuation">;</span>    <span class="token class-name">VoltAdapter</span><span class="token punctuation">(</span><span class="token class-name">Volt220</span> volt220<span class="token punctuation">)</span> <span class="token punctuation">{</span>        mVolt220 <span class="token operator">=</span> volt220<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getVOlt220</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> mVolt220<span class="token punctuation">.</span><span class="token function">getVolt220</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getVolt5</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token number">5</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/12/10. * &lt;p&gt; * desc: ç¬”è®°æœ¬ç”µè„‘ä¸€éƒ½æ˜¯éœ€è¦5Vç”µå‹ï¼Œè€Œç”Ÿæ´»ç”µå‹ä¸€èˆ¬éƒ½æ˜¯220Vï¼Œè¿™ä¸ªæ—¶å€™å°±äº§ç”Ÿäº†ä¸å…¼å®¹æƒ…å†µ * éœ€è¦ä¸€ä¸ªé€‚é…å™¨æ¥æŠŠ220Vç”µå‹è½¬æ¢æˆ5Vç”µå‹ * ç›´æ¥å°†è¢«é€‚é…çš„å¯¹è±¡ä¼ åˆ°Adapterä¸­ï¼Œä½¿ç”¨ç»„åˆå½¢å¼å®ç°æ¥å£å…¼å®¹æ•ˆæœ * æ¯”ç±»é€‚é…å™¨æ›´åŠ çµæ´»ï¼Œé€‚é…å¯¹è±¡çš„æ–¹æ³•ä¹Ÿä¸ä¼šæš´éœ²å‡ºæ¥ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">VoltAdapter</span> adapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VoltAdapter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Volt220</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è¾“å‡ºç”µå‹: "</span> <span class="token operator">+</span> adapter<span class="token punctuation">.</span><span class="token function">getVolt5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><ol><li>å¯¹è±¡é€‚é…å™¨ç›´æ¥å°†è¦é€‚é…çš„å¯¹è±¡ä¼ åˆ° Adapter ä¸­ï¼Œä½¿ç”¨ç»„åˆçš„å½¢å¼å®ç°æ¥å£å…¼å®¹çš„æ•ˆæœï¼Œæ¯”ç±»é€‚é…å™¨æ›´åŠ çµæ´»</li><li>å¯¹è±¡é€‚é…å™¨è¿˜ä¸ä¼šå°†è¢«é€‚é…å¯¹è±¡çš„æ–¹æ³•æš´éœ²å‡ºæ¥ï¼Œè€Œç±»é€‚é…å™¨æ˜¯ç»§æ‰¿è¢«é€‚é…çš„ç±»ï¼Œä¸å¤Ÿçµæ´»ã€‚</li><li>å®é™…å¼€å‘ä¸­ Adapter å¸¸ç”¨é¢„è¿›è¡Œä¸å…¼å®¹ç±»å‹çš„è½¬æ¢åœºæ™¯ï¼Œè¿˜æœ‰ä¸€ç§å°±æ˜¯è¾“å…¥æœ‰å¤šç§æƒ…å†µï¼Œè€Œè¾“å‡ºåªæœ‰ä¸€ç§çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡ Adapter ç»Ÿä¸€è¿›è¡Œè¾“å‡ºã€‚</li><li>å°½å¯èƒ½ä½¿ç”¨å¯¹è±¡é€‚é…å™¨ï¼Œå¤šä½¿ç”¨ç»„åˆå°‘ä½¿ç”¨ç»§æ‰¿ã€‚</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Java </tag>
            
            <tag> DesignPattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ¶ä½œå¤šåŠŸèƒ½å¯åŠ¨Uç›˜, è½»æ¾å®Œæˆç³»ç»Ÿå®‰è£…å’Œç»´æŠ¤</title>
      <link href="/20171202/make-multiboot-udisk/"/>
      <url>/20171202/make-multiboot-udisk/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="åˆ¶ä½œå¤šåŠŸèƒ½å¯åŠ¨-U-ç›˜-è½»æ¾å®Œæˆç³»ç»Ÿå®‰è£…å’Œç»´æŠ¤"><a href="#åˆ¶ä½œå¤šåŠŸèƒ½å¯åŠ¨-U-ç›˜-è½»æ¾å®Œæˆç³»ç»Ÿå®‰è£…å’Œç»´æŠ¤" class="headerlink" title="åˆ¶ä½œå¤šåŠŸèƒ½å¯åŠ¨ U ç›˜, è½»æ¾å®Œæˆç³»ç»Ÿå®‰è£…å’Œç»´æŠ¤"></a>åˆ¶ä½œå¤šåŠŸèƒ½å¯åŠ¨ U ç›˜, è½»æ¾å®Œæˆç³»ç»Ÿå®‰è£…å’Œç»´æŠ¤</h1><blockquote><p>æœ¬æ•™ç¨‹ä»…é€‚ç”¨äº EFI å¼•å¯¼çš„ç”µè„‘ï¼Œå®‰è£…çš„ç³»ç»Ÿä¹Ÿéœ€è¦æ”¯æŒ EFI å¼•å¯¼ã€‚</p></blockquote><p>å¹³æ—¶ç»™è‡ªå·±æˆ–è€…åˆ«äººé‡è£…ç³»ç»Ÿçš„é¢‘ç‡è¿˜ç®—æŒºé«˜çš„ï¼Œå› ä¸ºæœ‰æ—¶å€™è¦è£… macOS æœ‰æ—¶å€™è¦è£… Windowsï¼Œæ¯æ¬¡éƒ½è¦é‡æ–°æŠŠå®‰è£…åŒ…åˆ·åˆ°æˆ‘çš„ U ç›˜é‡Œï¼Œä¸ä½†éå¸¸æŠ˜è…¾ï¼Œè€Œä¸”å¯¹å¯¿å‘½ä¹Ÿä¸å¥½ã€‚äºæ˜¯æ•´ç†äº†ä¸€ä¸‹æŠŠå®‰è£…ç›˜éƒ½å¡åˆ°ä¸€ä¸ª U ç›˜é‡Œï¼Œè¿™ä¸ª U ç›˜ä¸ä»…å¯ä»¥é€‰æ‹©å¯åŠ¨å¤šä¸ªç³»ç»Ÿï¼Œè€Œä¸”å½“æŸä¸€ä¸ªç³»ç»Ÿçš„å®‰è£…ç›˜éœ€è¦æ›´æ–°çš„æ—¶å€™ï¼Œå¹¶ä¸éœ€è¦æŠ¹æ‰æ•´ä¸ªç›˜ï¼Œåªè¦å•ç‹¬å¤„ç†å¯¹åº”çš„åˆ†åŒºå°±å¥½ï¼Œéå¸¸æ–¹ä¾¿ã€‚å¯åŠ¨çš„æ—¶å€™æ•ˆæœæ˜¯è¿™æ ·çš„ï¼š</p><span id="more"></span><p><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-03-MiPro%20Boot.jpg" alt="å¼•å¯¼ç”»é¢"> å¯åŠ¨ç®±é€‰æ‹©ç•Œé¢</p><pre><code>* Linpus lite (sanDisk) -- å¼•å¯¼è¯•ç”¨/å®‰è£…/å¯åŠ¨ Ubuntu 16.04.3* EFI USB Device (SanDisk) -- å¼•å¯¼`macOSå®‰è£…å’Œå¯åŠ¨` ä»¥åŠ `Windows/Linuxç­‰æ”¯æŒEFIå¼•å¯¼çš„ç³»ç»Ÿå¯åŠ¨`* EFI USB Device 1 (SanDisk) -- å¼•å¯¼Windowsç³»ç»Ÿå®‰è£…* EFI USB Device 2 (SanDisk) -- å¼•å¯¼è¿›å…¥WeiPE</code></pre><p>è¿™ä¸ª U ç›˜åŒ…æ‹¬äº†ä¸€ä¸ª macOS å®‰è£…å™¨ã€ä¸€ä¸ª Ubuntu 16.04.3 ã€ä¸€ä¸ª Windows10 å®‰è£…å™¨ å’Œä¸€ä¸ª WinPEã€‚æ¥ä¸‹æ¥çš„æ•™ç¨‹å°±æ˜¯æ•™å¤§å®¶æ€æ ·åˆ¶ä½œä¸€ä¸ªè¿™æ ·çš„å¯åŠ¨ U ç›˜å¹¶åº”å¯¹ä¸€äº›å¯åŠ¨é—®é¢˜ã€‚</p><h2 id="ææ–™å‡†å¤‡"><a href="#ææ–™å‡†å¤‡" class="headerlink" title="ææ–™å‡†å¤‡"></a>ææ–™å‡†å¤‡</h2><ol><li><p>è‡³å°‘ 16GB çš„ U ç›˜, 32GB æœ€ä½³</p></li><li><p><a href="https://itunes.apple.com/cn/app/macos-high-sierra/id1246284741?mt=12">macOS å®‰è£…ç¨‹åº</a> (7GB++, æ ¹æ®å®‰è£…ç¨‹åºå¤§å°å†³å®š)</p></li><li><p><a href="http://releases.ubuntu.com/16.04/">Linux å®‰è£…é•œåƒ</a> (2GB++, æ ¹æ®å®‰è£…é•œåƒå¤§å°å†³å®š)</p></li><li><p><a href="https://msdn.itellyou.cn/">Windows å®‰è£…é•œåƒ</a> (5GB++, æ ¹æ®å®‰è£…é•œåƒå¤§å°å†³å®š)</p></li><li><p><a href="http://www.wepe.com.cn/download.html">WeiPE ç”Ÿæˆçš„é•œåƒ</a> (300MB++, æ ¹æ®å®‰è£…é•œåƒå¤§å°å†³å®š)</p></li><li><p>å…¶ä»–è½¯ä»¶å·¥å…·: ç£ç›˜å·¥å…·, <a href="http://www.zdfans.com/6959.html">DiskGenius</a>, <a href="http://unetbootin.github.io/">Unetbootin</a>, <a href="https://sourceforge.net/projects/cloverefiboot/?source=typ_redirect">CloverBootLoader</a></p><ul><li>U ç›˜å»ºè®®ä½¿ç”¨ USB 3.0 çš„</li><li>macOS å¯ä»¥ç›´æ¥ä» AppStore ä¸‹è½½åŸç‰ˆå®‰è£…æ–‡ä»¶</li><li>Linux å¯ä»¥å» Ubuntu å®˜ç½‘ä¸‹è½½, ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–å‘è¡Œç‰ˆ Linux(éœ€è¦æ”¯æŒ EFI)</li><li>Windows åŸç‰ˆé•œåƒå¯ä»¥ä» I tell you ä¸Šè·å–</li><li>PE å¯ä»¥ä½¿ç”¨ WeiPE æˆ–è€… AOMEI PE, æœ¬æ•™ç¨‹ä½¿ç”¨ WeiPE(PE éœ€è¦çš„å·¥å…·åŸºæœ¬è‡ªå¸¦)</li></ul><p><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-02-162348.png"></p></li></ol><h2 id="åˆ¶ä½œ-macOS-å®‰è£…ç›˜"><a href="#åˆ¶ä½œ-macOS-å®‰è£…ç›˜" class="headerlink" title="åˆ¶ä½œ macOS å®‰è£…ç›˜"></a>åˆ¶ä½œ macOS å®‰è£…ç›˜</h2><ol><li><p>æ‰“å¼€ç£ç›˜å·¥å…·ï¼Œé¦–å…ˆåœ¨å·¦è¾¹é€‰ä¸­ä½ çš„ U ç›˜ï¼Œ<strong>æ³¨æ„æ˜¯é€‰ä¸­ U ç›˜è€Œä¸æ˜¯å…¶ä¸­çš„åˆ†åŒº</strong>ï¼Œä¹‹åç‚¹å‡»æŠ¹æ‰æŒ‰é’®ï¼Œè¿™ä¼šæŠŠæ•´ä¸ªç£ç›˜æŠ¹æˆ GPTã€‚âš ï¸<strong>è¯¥æ“ä½œä¼šæ¸…ç©º U ç›˜çš„å…¨éƒ¨å†…å®¹ï¼Œæ³¨æ„å¤‡ä»½ã€‚</strong>âš ï¸ï¼ˆè™½ç„¶ä¸€äº›è½¯ä»¶å¯ä»¥ç›´æ¥è½¬æ¢ MBR å’Œ GPTï¼Œä¸è¿‡æˆ‘è¿˜æ˜¯è§‰å¾—ç›´æ¥éƒ½æŠ¹æ‰æ¯”è¾ƒå¹²å‡€ï¼‰</p><p>æŒ‰ç…§ä¸‹é¢çš„åšæ³•ï¼Œå°†åˆ†åŒºæ ¼å¼é€‰ä¸º Mac OS æ‰©å±•ï¼ˆæ—¥å¿—å¼ï¼‰ï¼Œæ–¹æ¡ˆé€‰æ‹© GUID åˆ†åŒºå›¾ã€‚ç‚¹å‡»æŠ¹æ‰ã€‚æœ‰ä¸€å®šæ¦‚ç‡å‡ºç°ç¬¬ä¸€æ¬¡æŠ¹æ‰ä¸æˆåŠŸçš„æƒ…å†µï¼Œæ˜¯ç”±äºç³»ç»Ÿæ²¡æœ‰æ­£ç¡®å¸è½½ç£ç›˜å¯¼è‡´çš„ï¼Œè¿™ä¸ª Bug å¾ˆå¸¸è§ã€‚å¦‚æœç¬¬ä¸€æ¬¡å¤±è´¥äº†ï¼Œå°±å†è¯•ä¸€æ¬¡åŸºæœ¬ä¸Šå°±æ²¡é—®é¢˜äº†ã€‚</p><p><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-02-162915.png"><br><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-02-162943.png"></p></li><li><p>ä¹‹åè¿˜æ˜¯é€‰ä¸­ U ç›˜ï¼Œç‚¹å‡»åˆ†åŒºã€‚ä½ ç°åœ¨åº”è¯¥çœ‹åˆ°æ•´ä¸ªç¡¬ç›˜ä½¿ç”¨ä¸€ä¸ªåˆ†åŒºã€‚ç‚¹å‡»ä¸‹é¢çš„åŠ å·æ–°å»ºä¸€ä¸ªåˆ†åŒºï¼Œä¸Šé¢çš„ç¡¬ç›˜ä¼šè¢«å¹³å‡åˆ†ä¸ºä¸¤ä¸ªã€‚é€‰æ‹©å³è¾¹çš„ä¸€ä¸ªï¼ˆç¬¬ä¸€ä¸ªåˆ†åŒºï¼‰ï¼Œåœ¨å³ä¾§çš„è¯¦ç»†ä¿¡æ¯ä¸­å°†åˆ†åŒºçš„åç§°æ”¹ä¸ºã€ŒmacOSã€ï¼ˆåœ¨ä¹‹åçš„å†™å…¥å‘½ä»¤ä¸­æˆ‘ä»¬ä¼šç”¨åˆ°è¿™ä¸ªåç§°ï¼‰ï¼Œå°†å¤§å°æ”¹ä¸º 7.5GBï¼ˆå…¶å®å¯ä»¥å†å°ä¸€ç‚¹ï¼Œä½†æ˜¯ä¸ºäº†èƒ½å¤Ÿå…¼å®¹ä¹‹åçš„ macOS æ›´æ–°ä»¥åŠèƒ½å¤Ÿæ”¾ä¸€äº›å¸¸ç”¨ç¨‹åºï¼Œè¿™é‡Œ 7.5 æ˜¯ä¸€ä¸ªæ¯”è¾ƒåˆç†çš„å¤§å°ï¼‰</p><p><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-02-163036.png"></p><p><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-02-163210.png"></p><p><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-02-163239.png"></p></li><li><p>ç”¨å‘½ä»¤åˆ¶ä½œå®‰è£…ç›˜<br>å‘½ä»¤(å…·ä½“å¯å‚ç…§ä¸‹å›¾)ï¼š<code>sudo /Applications/Install\ macOS\ High\ Sierra.app/Contents/Resources/createinstallmedia --volume /Volumes/macOS --applicationpath /Applications/Install\ macOS\ High\ Sierra.app --nointeraction</code><br><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-02-QQ20171203-003628.png"><br><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-02-163919.png"><br><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-02-164734.png"></p></li><li><p>å®‰è£… Clover å¼•å¯¼<br><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-02-165039.png"></p><p>å®‰è£…å®Œæˆåæ”¾ Kextsï¼Œä¸»é¢˜ï¼ŒAPFS é©±åŠ¨ï¼Œé…ç½® config.plistâ€¦â€¦</p></li><li><p>æ‹·è´å¸¸ç”¨è½¯ä»¶<br>å¯ä»¥å¾€ Install macOS High Sierra å®‰è£…ç›˜æ”¾äº›é©±åŠ¨/å¸¸ç”¨ App/å·¥å…·ä¹‹ç±»çš„ï¼Œå®‰è£…å®Œç³»ç»Ÿå¯ä»¥ä» U ç›˜é‡Œé¢æ‹·è´ä½¿ç”¨.</p></li></ol><h2 id="å†™å…¥-Linux-Windows-PE-é•œåƒ"><a href="#å†™å…¥-Linux-Windows-PE-é•œåƒ" class="headerlink" title="å†™å…¥ Linux/Windows/PE é•œåƒ"></a>å†™å…¥ Linux/Windows/PE é•œåƒ</h2><ol><li><p>è¿›å…¥ Windows ç³»ç»Ÿ(ä¹Ÿå¯ä»¥ä½¿ç”¨è™šæ‹Ÿæœºï¼Œç³»ç»Ÿå¯èƒ½ä¼šæç¤ºåˆ†åŒºæŸåï¼Œå–æ¶ˆæ‰ä¸è¦æ ¼å¼åŒ–ï¼Œè¿™æ˜¯å› ä¸º Windows è¯»ä¸äº† HFS+ çš„åˆ†åŒº), å‡†å¤‡å¥½å·¥å…·: <a href="http://www.zdfans.com/6959.html">DiskGenius</a>, <a href="http://unetbootin.github.io/">Unetbootin</a>, é•œåƒï¼š<a href="http://releases.ubuntu.com/16.04/">Linux å®‰è£…é•œåƒ</a>, <a href="https://msdn.itellyou.cn/">Windows å®‰è£…é•œåƒ</a>, <a href="http://www.wepe.com.cn/download.html">WeiPE ç”Ÿæˆçš„é•œåƒ</a></p></li><li><p>æ‰“å¼€ DiskGenius, åˆ é™¤åœ¨ macOS ä¸Šåˆ†å‡ºæ¥çš„åŒº<code>Others</code>, ç„¶åæœªåˆ†åŒºçš„ä½ç½®æ–°å»ºåˆ†åŒºå¦‚ä¸‹å›¾ï¼šæŒ‰ç…§é•œåƒå¤§å° new å‡ºä¸‰ä¸ª FAT32 åˆ†åŒºï¼Œåˆ†åˆ«æ˜¯ LINUX, WIN10, WEIPEã€‚(å·æ ‡è‡ªå·±å‘½åï¼Œæ–°å»ºåˆ†åŒºæ—¶ä»¥ GB ä¸ºå•ä½åªèƒ½æ–°å»ºå‡ºæ•´æ•°å¤§å°ï¼Œå¯ä»¥åœ¨æ–°å»ºå®Œè¿™ä¸ªåˆ†åŒºåå¯¹å…¶è°ƒæ•´)<br><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-03-u-disk-1-delete.png"><br><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-03-u-disk-2-newLinuxPart.png"><br><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-03-u-disk-3-chang-size.png"><br><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-03-u-disk-4-newWinPart.png"></p></li><li><p>æ–°å»ºå®Œåˆ†åŒºåã€‚ä½¿ç”¨ Unetbootin æŠŠå¯¹åº”çš„ç³»ç»Ÿé•œåƒå†™å…¥åˆ°å¯¹åº”åˆ†åŒºä¸­ï¼šâš ï¸<strong>åƒä¸‡ä¸è¦é€‰é”™ï¼ŒæŠŠåˆ«çš„åˆ†åŒºæŠ¹æ‰å°±è¦é‡æ¥äº†ã€‚</strong>âš ï¸<br><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-03-u-disk-5-copyUbuntu.png"><br><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-03-u-disk-6-copyWin10.png"><br><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-03-Windows10%20make.png"></p><p>å¯¹äº WEIPEï¼Œå®˜ç½‘ä¸‹è½½å¾—åˆ°çš„æ˜¯ WeiPE.exe æ–‡ä»¶ï¼Œæ‰“å¼€å¹¶é€‰æ‹©<code>ç”ŸæˆISOæ–‡ä»¶</code>ï¼Œå¾—åˆ° ISO æ–‡ä»¶åï¼Œç›´æ¥<code>åŒå‡»æ‰“å¼€</code>ï¼Œ<code>å…¨é€‰é‡Œé¢çš„æ–‡ä»¶æ‹·è´åˆ°PEåˆ†åŒº</code> æˆ–è€… ç”¨<code>Unetbootinå†™å…¥</code>ä¹Ÿä¸€æ ·ã€‚<br><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-03-u-disk-WEIPE-1.png"><br><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-03-u-disk-WEIPE-2.png"><br><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-03-u-disk-WEIPE-3.png"></p></li><li><p>æœ€ç»ˆå¾—åˆ°çš„æ•ˆæœå¦‚ä¸‹(ä¸è¦åœ¨æ„ U ç›˜å’Œç›˜ç¬¦ï¼Œæˆ‘ç”¨ä¸¤ä¸ª U ç›˜åˆ†åˆ«åšäº†ä¸€æ¬¡ï¼Œæˆªå›¾ä¹±äº†ç‚¹ â•®(ï¿£ â–½ ï¿£)â•­)ï¼Œé‡å¯æŒ‰ F12(é€šå¸¸æ˜¯ F12)è¿›å…¥å¯åŠ¨é¡¹é€‰æ‹©ç•Œé¢å³å¯é€‰æ‹©å¯¹åº”çš„å¯åŠ¨é¡¹ã€‚<br><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-03-u-disk-newThreePart.png"><br><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-03-u-disk-final.png"><br><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-03-MiPro%20Boot.jpg" alt="å¼•å¯¼ç”»é¢"></p></li></ol><h2 id="Q-amp-A"><a href="#Q-amp-A" class="headerlink" title="Q &amp; A"></a>Q &amp; A</h2><ol><li>å®‰è£…ç›˜æœ‰äº†æ–°ç‰ˆæœ¬æ€ä¹ˆåŠï¼Ÿ<ul><li>åªè¦æŠ¹æ‰è¯¥åˆ†åŒºï¼Œé‡æ–°æŒ‰ç…§ä¹‹å‰çš„æ­¥éª¤åˆ·å…¥å³å¯ã€‚Windows ä¹Ÿæ˜¯åŒç†ï¼Œä¸è¿‡è¦åœ¨ Windows ä¸­å°±æ ¼å¼åŒ–å¯¹åº”åˆ†åŒºé‡æ–°å†™å…¥ã€‚</li></ul></li><li>æœ‰å®‰è£…ç›˜çš„é‚£äº›åˆ†åŒºå¯ä»¥è‡ªå·±å­˜æ–‡ä»¶ä¹ˆï¼Ÿ<ul><li>å½“ç„¶å¯ä»¥ï¼Œå¯ç”¨ç©ºé—´é‡Œé¢éšä¾¿å­˜ï¼Œä¸ä¼šæµªè´¹ã€‚æ¯”å¦‚ Install macOS High Sierra çš„ç›˜å¯ä»¥æ”¾äº›é©±åŠ¨/å¸¸ç”¨ App ä¹‹ç±»çš„ï¼Œå®‰è£…å®Œç³»ç»Ÿå¯ä»¥ä» U ç›˜é‡Œé¢æ‹·è´ä½¿ç”¨ï¼ŒWIN10 åˆ†åŒºå¯ä»¥æ”¾äº› PE æ²¡æœ‰çš„ä¸€äº›å·¥å…·ï¼Œä¹Ÿå¯ä»¥å­˜è‡ªå·±æ—¥å¸¸çš„ä¸€äº›æ–‡ä»¶ï¼Œä¸è¿‡æœ€å¥½æ–°å»ºæ–‡ä»¶å¤¹æ¥å­˜å‚¨ã€‚<br><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-03-032556.png"><br><img src="http://blog-1251678165.coscd.myqcloud.com/2017-12-03-032634.png"></li></ul></li><li>æ¨å‡º U ç›˜çš„æ—¶å€™æ€»æ˜¯æ— æ³•æ¨å‡ºæ€ä¹ˆåŠï¼Ÿ<ul><li>å› ä¸ºå››ä¸ªåŒºçš„å…³ç³»ï¼Œåœ¨è¾ƒæ…¢çš„ U ç›˜ä¸Šæ¨å‡ºçš„æ—¶å€™ä¼šéå¸¸çš„å¡ï¼Œè¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œå¤šç­‰ä¸€ä¼šå°±å¥½äº†ã€‚</li></ul></li></ol><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><blockquote><ul><li><a href="https://sspai.com/post/41960">åˆ¶ä½œä¸€ä¸ªå››åˆä¸€ç»´æŠ¤ U ç›˜ï¼Œé‡è£…ç³»ç»Ÿè¿˜èƒ½æœ‰å¤šæ–¹ä¾¿ï¼Ÿ</a></li><li><a href="http://www.ruanyifeng.com/blog/2013/02/booting.html">è®¡ç®—æœºæ˜¯å¦‚ä½•å¯åŠ¨çš„ - é˜®ä¸€å³°</a></li><li><a href="https://www.zhihu.com/question/21672895">UEFI å’Œ BIOS å¼•å¯¼æœ‰ä»€ä¹ˆä¸åŒ - çŸ¥ä¹</a></li><li><a href="https://decio.eu/2014/01/16/correct-name-and-icons-in-startup-manager/">Correct name and icons in Startup Manager </a></li></ul></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> macOS </tag>
            
            <tag> Linux </tag>
            
            <tag> Windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æš—å½±ç²¾çµ2Plus GTX1060ç‹¬æ˜¾äº®åº¦è°ƒèŠ‚å®ç°</title>
      <link href="/20170826/hp2plus-gtx1060-brightness/"/>
      <url>/20170826/hp2plus-gtx1060-brightness/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="æš—å½±ç²¾çµ-2Plus-GTX1060-ç‹¬æ˜¾äº®åº¦è°ƒèŠ‚å®ç°"><a href="#æš—å½±ç²¾çµ-2Plus-GTX1060-ç‹¬æ˜¾äº®åº¦è°ƒèŠ‚å®ç°" class="headerlink" title="æš—å½±ç²¾çµ 2Plus GTX1060 ç‹¬æ˜¾äº®åº¦è°ƒèŠ‚å®ç°"></a>æš—å½±ç²¾çµ 2Plus GTX1060 ç‹¬æ˜¾äº®åº¦è°ƒèŠ‚å®ç°</h1><blockquote><p>Forewordï¼šæœ¬æ¥æ‰“ç®—æ¯•ä¸šå·¥ä½œäº†å†æ¢æœ¬çš„ï¼Œä½†æ˜¯å®åœ¨å—ä¸äº†ä¹‹å‰é‚£ä¸ªä½å‹ U æœ¬ Yoga13 äº†ï¼Œå¼€ä¸ª IDE å’Œæ¨¡æ‹Ÿå™¨å°±å¿«ç‚¸äº†ï¼Œç©ä¸ª LOL ä¸€æ‰“å›¢å°±å˜ PPT ç©ä¸ªè›‡çš®ï¼›ç„¶åç„¶åçœ‹åˆ°**<code>æš—å½±ç²¾çµ2Plus</code><strong>ä¸ƒä»£ U ç‰ˆæœ¬æ¯”é¦–å‘ä»·è¿˜ä½ 1000 å°±å¿ä¸ä½å‰æ‰‹äº† ğŸ¤£ï¼Œæ€»ä½“ä½“éªŒï¼šæ€§èƒ½ä¸ç”¨è¯´ï¼Œi7+GTX1060 ç”œå“æ˜¾å¡åŸºæœ¬éƒ½å¯ä»¥ç©ï¼Œ72ï¼…è‰²åŸŸ IPS å±å¹•ä¹Ÿæ˜¯å¾ˆæ£’ï¼Œç¼ºç‚¹ 17.3 å¯¸æ¯”è¾ƒé‡ã€å°è¾¾ç”µæº 230W å¥½å¤§ä¸€å—ç –ã€é”®ç›˜æ–¹å‘é”®åäººç±» ğŸ™ƒ<br><img src="https://blog-bak-1251678165.cos.ap-beijing.myqcloud.com/2017-08-27-023638.jpg" alt="Order"><br>å›åˆ°ä¸»é¢˜ï¼šè¿™æœ¬æƒ æ™®è‡ªå·±æŠŠ</strong><code>æ ¸æ˜¾HD630å±è”½</code><strong>äº†ï¼ŒWindows è®¾å¤‡ç®¡ç†å™¨éƒ½çœ‹ä¸åˆ°ï¼ˆWindows ä¸Šä¸æ’ç”µæºæ²¡æ³•ç©æ¸¸æˆï¼‰ï¼ŒHackintosh å²‚ä¸æ˜¯å¯ä»¥ç›´æ¥ç”¨ GTX1060 äº† ğŸ˜‰ ç¾æ»‹æ»‹ï¼Œè™½ç„¶æ˜¯ç”¨ä¸Šäº†ä½†æ˜¯</strong><code>äº®åº¦è°ƒèŠ‚</code>**ä¸€ç›´ä¸è¡Œï¼Œç›´åˆ°æ˜¨å¤©æ‰æå®šã€‚</p></blockquote><span id="more"></span><ol><li>æœ¬æ¬¡å‚è€ƒçš„æ•™ç¨‹ï¼š<ul><li><a href="http://bbs.pcbeta.com/viewthread-1742873-9-1.html">ã€ç¬”è®°æœ¬ GTX1060ã€‘ç°åœ¨å¼„å¥½äº†è°ƒèŠ‚äº®åº¦å•¦-è¿œæ™¯è®ºå›-å¾®è½¯æå®¢ç¤¾åŒº</a></li><li><a href="http://bbs.pcbeta.com/viewthread-1714158-1-1.html">è“å¤© p6xxrx å‡†ç³»ç»Ÿ EFI 10.12 ï¼ˆç¥èˆŸæˆ˜ç¥ z7s3ï¼‰-è¿œæ™¯è®ºå›-å¾®è½¯æå®¢ç¤¾åŒº</a></li><li><a href="http://bbs.pcbeta.com/viewthread-1663916-1-1.html">GTX970M-åŸç”Ÿäº®åº¦è°ƒèŠ‚-è¿œæ™¯è®ºå›-å¾®è½¯æå®¢ç¤¾åŒº</a></li><li><a href="http://bbs.pcbeta.com/viewthread-1473634-1-1.html">è½»æ¾æ³¨å…¥ EDID å‚æ•°-è¿œæ™¯è®ºå›-å¾®è½¯æå®¢ç¤¾åŒº</a></li></ul></li><li>ä½¿ç”¨åˆ°çš„å·¥å…·ï¼š<ul><li><a href="https://bitbucket.org/blackosx/darwindumper/downloads/">DarwinDumper_v3.0.3</a></li><li><a href="http://bbs.pcbeta.com/forum.php?mod=viewthread&amp;tid=1525657">æ³¨å…¥ EDID çš„åˆ©å™¨ï¼šFixEDID 2.3.2(12 æ¥¼å·²æœ‰çƒ­å¿ƒä¼šå‘˜åšçš„æ±‰åŒ–ç‰ˆ)</a></li><li><a href="https://bitbucket.org/RehabMan/os-x-maciasl-patchmatic/downloads/">MaciASL DSDT å’Œ SSDT å·¥å…·</a></li><li><a href="https://bitbucket.org/RehabMan/acpica/downloads/">Acpica iasl åç¼–è¯‘è„šæ­¥å·¥å…·</a></li><li><a href="http://www.insanelymac.com/forum/files/file/397-easykext-pro-a-minimal-and-super-fast-kext-installer/">EasyKext Pro é©±åŠ¨å®‰è£…å’Œæƒé™ä¿®å¤</a></li></ul></li></ol><h2 id="ä¸€-æ³¨å…¥-EDID"><a href="#ä¸€-æ³¨å…¥-EDID" class="headerlink" title="ä¸€.æ³¨å…¥ EDID"></a>ä¸€.æ³¨å…¥ EDID</h2><ol><li><p>æ‰“å¼€ DarwinDumper_v3.0.3 ç›´æ¥ç‚¹å‡» Runï¼ˆä¹Ÿå¯åªé€‰ EDIDï¼‰<br><img src="https://blog-bak-1251678165.cos.ap-beijing.myqcloud.com/2017-08-27-031521.jpg" alt="DarwinDumper_v3.0.3"><br><img src="https://blog-bak-1251678165.cos.ap-beijing.myqcloud.com/2017-08-27-031613.jpg" alt="Report"></p><blockquote><p>ä¹‹å‰æˆ‘ç”¨æ•™ç¨‹å¸¦çš„ DarwinDumper2.8.8 ç”Ÿæˆçš„ bin æ–‡ä»¶åœ¨ FixEDID2.3 å¯¼å…¥æŠ¥é”™ï¼Œ2.3 ç‰ˆæœ¬ç›®æµ‹é€‰ hex æ–‡ä»¶ä¼šæœ‰é—®é¢˜ï¼Œå‘å•Š ğŸ™ƒï¼Œè¿˜å¥½å»æ‰¾åˆ°äº†æœ€æ–°çš„ç‰ˆæœ¬ 3.0.3 ç”¨èµ·æ¥æ²¡å•¥é—®é¢˜</p></blockquote></li><li><p>æ‰“å¼€ FixEDID 2.3.2ï¼Œæ‰“å¼€ EDID æ–‡ä»¶é€‰æ‹©åˆšæ‰ç”Ÿæˆçš„ EDID.binï¼Œå…¶ä»–éœ€è¦å‹¾é€‰çš„å›¾ä¸Šå·²åšæ ‡æ³¨ï¼šé€‰æ‹©æ˜¾ç¤ºå™¨å‹å·ï¼Œä¸‹é¢ä¸¤ä¸ªéƒ½é€‰ AppleBlacklightDisplayï¼Œç„¶åç‚¹å‡» make å¾—åˆ°ä¸‰ä¸ªä¸œè¥¿ï¼šDisplayVendorID-xxx æ–‡ä»¶å¤¹ã€DisplayMergeNub.kextã€EDID-xxx.binã€‚ç„¶åéœ€è¦åšçš„æ˜¯<code>æŠŠé©±åŠ¨å®‰è£…åˆ°S/L/Eå¹¶ä¿®å¤ç¼“å­˜</code> æˆ–è€… <code>æŠŠDisplayVendorID-xxxæ–‡ä»¶å¤¹æ”¾åˆ°/System/Library/Displays/Contents/Resources/Overridesç›®å½•ä¸‹</code> æ¨èä½¿ç”¨é©±åŠ¨æ³¨å…¥ï¼Œé‡æ–°å¯åŠ¨çœ‹çœ‹æ˜¾ç¤ºå™¨æƒ…å†µã€‚<br><img src="https://blog-bak-1251678165.cos.ap-beijing.myqcloud.com/2017-08-26-155155.jpg" alt="FixEDID"></p><blockquote><p>å‘ç‚¹ï¼šæŠŠ FixEDID ä¸­æ˜¾ç¤ºå™¨å‹å·éƒ½è¯•äº†ä¸€éï¼Œç”Ÿæˆçš„é©±åŠ¨å®‰è£…åˆ° S/L/E å‡æ— æ•ˆï¼ŒåŠŸèƒ½æ‰©å±•æ˜¾ç¤º<code>ç­¾åéªŒè¯é”™è¯¯</code><br><img src="https://blog-bak-1251678165.cos.ap-beijing.myqcloud.com/2017-08-26-134239.jpg" alt="Kextsign"><br>æ— å¥ˆåªèƒ½é€‰æ‹©æŠŠ <strong>æ˜¾ç¤ºå™¨çš„ Overrides æ–‡ä»¶</strong> æ‰”åˆ° <code>/System/Library/Displays/Contents/Resources/Overrides</code> ï¼Œè¿™ç§æ–¹å¼ä¹Ÿå­˜åœ¨ä¸å°‘é—®é¢˜ï¼Œå¤šæ•°å‹å·å¼€æœºå¡ä½ï¼ˆå¼ºåˆ¶å…³æœºç„¶å-V æ¨¡å¼å¯è¿›å…¥ï¼‰ï¼Œéƒ¨åˆ†æ˜¯æ²¡æœ‰ä»»ä½•æ•ˆæœï¼Œåªæœ‰ MacBook Pro 16:10 å¯è¡Œï¼Œå½“æ—¶æ•ˆæœå¦‚ä¸‹ï¼š<br><img src="https://blog-bak-1251678165.cos.ap-beijing.myqcloud.com/2017-08-26-154719.jpg" alt="MBP"><br>17.3 å¯¸æ˜¾ç¤ºå™¨æ˜¾ç¤ºæˆäº† 13.3 å¯¸ ğŸ™ƒ</p></blockquote></li></ol><h2 id="äºŒ-DSDT-éƒ¨åˆ†"><a href="#äºŒ-DSDT-éƒ¨åˆ†" class="headerlink" title="äºŒ.DSDT éƒ¨åˆ†"></a>äºŒ.DSDT éƒ¨åˆ†</h2><ol><li><p>æ‰“è¡¥ä¸ï¼šBrightness fixï¼ˆåŠ å…¥ PLNF ä»£ç ï¼Œè®°å¾—å…ˆæŠŠå·²å­˜åœ¨çš„ PLNF é‡å‘½åï¼‰<br><img src="https://blog-bak-1251678165.cos.ap-beijing.myqcloud.com/2017-08-26-103057.jpg" alt="Brightness"></p></li><li><p>æœ€å…³é”®åœ°æ–¹ï¼šæ‰“å¼€ IORegistryExplorer æœç´¢ displayï¼ŒæŸ¥çœ‹ AppleDisplay æ‰€åœ¨ä½ç½®<br><img src="https://blog-bak-1251678165.cos.ap-beijing.myqcloud.com/2017-08-23-040403.jpg" alt="AppleDisplay"><br>æ‰“å¼€ MaciASLï¼Œé€‰æ‹©ç›¸åº” DSDT æ–‡ä»¶ï¼Œåœ¨ DSDT ä¸‹çš„ PEG0 ä¸‹ PEGP æ€»åŠ å…¥_DSM æ–¹æ³•ï¼Œæ³¨å…¥ä»£ç å¦‚ä¸‹:</p><pre class="line-numbers language-none"><code class="language-none">Method (_DSM, 4, NotSerialized)  // _DSM: Device-Specific Method{   If (LEqual (Arg2, Zero))   {       Return (Buffer (One)       {            0x03       })   }   Return (Package (0x16)   {       "@1,AAPL,boot-display",       Buffer (One)       {            0x01       },       "@1,backlight-control",       Buffer (0x04)       {            0x01, 0x00, 0x00, 0x00       },       "@1,built-in",       Buffer (One)       {            0x01       },       "@0,connector-type",       Buffer (0x04)       {            0x00, 0x08, 0x00, 0x00       },       "@1,connector-type",       Buffer (0x04)       {            0x00, 0x04, 0x00, 0x00       },       "@2,connector-type",       Buffer (0x04)       {            0x00, 0x04, 0x00, 0x00       },       "@3,connector-type",       Buffer (0x04)       {            0x00, 0x04, 0x00, 0x00       },       "@4,connector-type",       Buffer (0x04)       {            0x00, 0x04, 0x00, 0x00       },       "@5,connector-type",       Buffer (0x04)       {            0x00, 0x04, 0x00, 0x00       },       "@1,pwm-info",       Buffer (0x14)       {           /* 0000 */  0x01, 0x14, 0x00, 0x64, 0xA8, 0x61, 0x00, 0x00,           /* 0008 */  0x1E, 0x02, 0x00, 0x00, 0x2C, 0x00, 0x00, 0x00,           /* 0010 */  0x00, 0x04, 0x00, 0x00       },       "hda-gfx",       Buffer (0x0A)       {           "onboard-1"       }   })}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ³¨æ„ï¼šâ€@1,AAPL,boot-displayâ€, â€œ@1,backlight-controlâ€,â€@1,built-inâ€,â€@1,pwm-infoâ€è¿™å‡ ä¸ªåœ°æ–¹ï¼Œ@1 æ˜¯æ˜¾ç¤ºå™¨æ‰€åœ¨ä½ç½®ï¼Œæ ¹æ® IORegistryExplorer æ˜¾ç¤ºï¼šæˆ‘çš„æ˜¯åœ¨ NVDA,Display-B@1ã€‚<br><img src="https://blog-bak-1251678165.cos.ap-beijing.myqcloud.com/2017-08-27-DSDT%20AppleDisplay.png" alt="DSDT AppleDisplay"><br>æ’å…¥å®Œä»£ç ä¿å­˜ DSDTï¼ŒæŠŠå®ƒæ”¾åˆ°<code>/EFI/CLOVER/ACPI/patched</code>ï¼ŒClover ä¸­å‹¾é€‰æ³¨å…¥å³å¯ï¼Œé‡å¯å³å¯çœ‹åˆ°åŠ è½½çš„æ˜¯ AppleBlacklightDisplay<br><img src="https://blog-bak-1251678165.cos.ap-beijing.myqcloud.com/2017-08-27-043716.jpg" alt="AppleBlacklightDisplay"></p></blockquote></li></ol><h2 id="ä¸‰-æ›¿æ¢é©±åŠ¨"><a href="#ä¸‰-æ›¿æ¢é©±åŠ¨" class="headerlink" title="ä¸‰.æ›¿æ¢é©±åŠ¨"></a>ä¸‰.æ›¿æ¢é©±åŠ¨</h2><ol><li>10.12.4 ä¸‹å¯ä¸ç”¨æ›¿æ¢ AppleBacklight.kextï¼Œä½†æ˜¯ 10.12.5/10.12.6 éœ€è¦æ›¿æ¢ï¼Œ10.13 æœªçŸ¥ï¼Œé©±åŠ¨åˆ†äº«é“¾æ¥: <a href="https://pan.baidu.com/s/1mhPjxqS">https://pan.baidu.com/s/1mhPjxqS</a> å¯†ç : 6666</li><li>ä½¿ç”¨ EasyKext å®‰è£…ä¿®å¤ç¼“å­˜å³å¯ã€‚</li></ol><h2 id="å››-æ•ˆæœå±•ç¤º"><a href="#å››-æ•ˆæœå±•ç¤º" class="headerlink" title="å››.æ•ˆæœå±•ç¤º"></a>å››.æ•ˆæœå±•ç¤º</h2><p>å®Œæˆä¸Šé¢ä¸‰æ­¥ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯ OK äº†~é‡å¯ç”µè„‘è¯•è¯•å§ ğŸ˜‰ğŸ˜‰ğŸ˜‰ï¼ï¼ï¼ï¼ˆæˆ‘çš„äº®åº¦ç›´æ¥æ˜¯å¯ä¿å­˜çš„ï¼Œè‹¥ä¸å¯ä»¥è¯·å‚è€ƒï¼š<a href="http://bbs.pcbeta.com/viewthread-1538926-1-1.html">[åˆ†äº«] è§£å†³å¼€æœºç¬¬äºŒé˜¶æ®µèŠ±å±å’Œ Clover è„šæœ¬ä¸ç”Ÿæˆ nvram.plist å¯¼è‡´ä¸èƒ½ä¿å­˜äº®åº¦çš„é—®é¢˜</a>ï¼‰</p><p><img src="https://blog-bak-1251678165.cos.ap-beijing.myqcloud.com/2017-08-27-043359.jpg" alt="æ¦‚è§ˆ"><br><img src="https://blog-bak-1251678165.cos.ap-beijing.myqcloud.com/2017-08-27-043512.jpg" alt="æ˜¾ç¤ºå™¨å›¾å½¢å¡"><br><img src="https://blog-bak-1251678165.cos.ap-beijing.myqcloud.com/2017-08-27-043606.jpg" alt="äº®åº¦è°ƒèŠ‚1"><br><img src="https://blog-bak-1251678165.cos.ap-beijing.myqcloud.com/2017-08-27-044609.jpg" alt="äº®åº¦è°ƒèŠ‚2"><br><img src="https://blog-bak-1251678165.cos.ap-beijing.myqcloud.com/2017-08-27-044641.jpg" alt="äº®åº¦è°ƒèŠ‚3"></p><blockquote><p><strong>å·®ä¸å¤šå°±ç»“æŸäº†å§ï¼Œè¸©å¾—å‘è¿˜æ˜¯ä¸å°‘ï¼Œå°¤å…¶æ˜¯æ³¨å…¥ EDIDï¼Œä¹‹å‰ä¸€ç›´ä¸è¡Œæ‰€æœ‰æ”¾å¼ƒæ”¾å¼ƒâ€¦â€¦ï¼Œä½†æ˜¯çœ‹åˆ°è®ºå›æœ‰ä¸å°‘äººéƒ½å¯ä»¥å®ç°ç‹¬æ˜¾äº®åº¦è°ƒèŠ‚ï¼Œå¿ä¸ä½åˆå›æ¥é‡è¯•äº†å¥½å‡ éï¼ŒæŠ˜è…¾å•Šâ€¦â€¦</strong>ğŸ™ƒğŸ™ƒğŸ™ƒ</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> macOS </tag>
            
            <tag> Hackintosh </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - è´£ä»»é“¾æ¨¡å¼</title>
      <link href="/20170318/designpattern-behavior-chain-of-responsibility/"/>
      <url>/20170318/designpattern-behavior-chain-of-responsibility/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-è´£ä»»é“¾æ¨¡å¼"><a href="#ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-è´£ä»»é“¾æ¨¡å¼" class="headerlink" title="ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - è´£ä»»é“¾æ¨¡å¼"></a>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - è´£ä»»é“¾æ¨¡å¼</h1><blockquote><p>é”é“¾è¿™ç§é“¾å¼ç»“æ„ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥è¢«æ‹†å¼€å†è¿æ¥ï¼Œå› æ­¤é“¾å¼ç»“æ„ä¹Ÿå…·æœ‰å¾ˆå¥½çš„çµæ´»æ€§ï¼Œåœ¨ç¼–ç¨‹é¢†åŸŸï¼Œå°†æ¯ä¸€ä¸ªèŠ‚ç‚¹çœ‹ä½œä¸€ä¸ªå¯¹è±¡ï¼Œæ¯ä¸ªå¯¹è±¡æœ‰ä¸åŒçš„å¤„ç†é€»è¾‘ï¼Œå°†ä¸€ä¸ªè¯·æ±‚ä»é“¾å¼çš„é¦–ç«¯å‡ºå‘ï¼Œæ²¿ç€è·¯å¾„ä¾æ¬¡ä¼ é€’åˆ°æ¯ä¸ªèŠ‚ç‚¹å¯¹è±¡ï¼Œç›´åˆ°æœ‰å¯¹è±¡å¤„ç†è¿™ä¸ªè¯·æ±‚ä¸ºæ­¢ã€‚<br>å®šä¹‰: è´£ä»»é“¾æ¨¡å¼æ˜¯è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼ä¹‹ä¸€ï¼Œå®ƒä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…äº†è¯·æ±‚çš„å‘é€è€…å’Œæ¥å—è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚å°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰å¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚</p></blockquote><span id="more"></span><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><ol><li>å¤šä¸ªå¯¹è±¡å¯ä»¥å¤„ç†åŒä¸€è¯·æ±‚ï¼Œä½†å…·ä½“ç”±å“ªä¸ªå¯¹è±¡å¤„ç†åˆ™åœ¨è¿è¡Œæ—¶åŠ¨æ€å†³å®šã€‚</li><li>åœ¨è¯·æ±‚å¤„ç†è€…ä¸æ˜ç¡®çš„æƒ…å†µä¸‹å‘å¤šä¸ªå¯¹è±¡ä¸­çš„ä¸€ä¸ªæäº¤è¯·æ±‚ã€‚</li><li>éœ€è¦åŠ¨æ€æŒ‡å®šä¸€ç»„å¯¹è±¡å¤„ç†è¯·æ±‚ã€‚</li></ol><h2 id="UML-ç±»å›¾"><a href="#UML-ç±»å›¾" class="headerlink" title="UML ç±»å›¾"></a>UML ç±»å›¾</h2><p><img src="http://blog-1251678165.coscd.myqcloud.com/2018-03-18-Chain.png"></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: æŠ½è±¡å¤„ç†è§’è‰²ï¼Œç”³æ˜ä¸€ä¸ªè¯·æ±‚å¤„ç†æ–¹æ³• * å¹¶åœ¨å…¶ä¸­ä¿æŒä¸€ä¸ªå¯¹ä¸‹ä¸€ä¸ªå¤„ç†èŠ‚ç‚¹Handlerçš„å¼•ç”¨ */</span><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Handler</span> <span class="token punctuation">{</span>    <span class="token comment">//ä¸‹ä¸€ä¸ªèŠ‚ç‚¹å¤„ç†è€…</span>    <span class="token keyword">protected</span> <span class="token class-name">Handler</span> successor<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">handleRequest</span><span class="token punctuation">(</span><span class="token class-name">String</span> condition<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: å…·ä½“å¤„ç†è€…è§’è‰²ï¼Œå¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œå¦‚æœä¸èƒ½å¤„ç†å°±è½¬å‘ç»™ä¸‹ä¸€ä¸ªå¤„ç† */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConcreteHandlerA</span> <span class="token keyword">extends</span> <span class="token class-name">Handler</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleRequest</span><span class="token punctuation">(</span><span class="token class-name">String</span> condition<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>condition<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"ConcreteHandlerA"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ConcreteHandlerA handled"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            successor<span class="token punctuation">.</span><span class="token function">handleRequest</span><span class="token punctuation">(</span>condition<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: å…·ä½“å¤„ç†è€…è§’è‰²ï¼Œå¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œå¦‚æœä¸èƒ½å¤„ç†å°±è½¬å‘ç»™ä¸‹ä¸€ä¸ªå¤„ç† */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConcreteHandlerB</span> <span class="token keyword">extends</span> <span class="token class-name">Handler</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleRequest</span><span class="token punctuation">(</span><span class="token class-name">String</span> condition<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>condition<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"ConcreteHandlerB"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ConcreteHandlerB handled"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            successor<span class="token punctuation">.</span><span class="token function">handleRequest</span><span class="token punctuation">(</span>condition<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">ConcreteHandlerA</span> handlerA <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcreteHandlerA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ConcreteHandlerB</span> handlerB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcreteHandlerB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        handlerA<span class="token punctuation">.</span>successor <span class="token operator">=</span> handlerB<span class="token punctuation">;</span>        handlerB<span class="token punctuation">.</span>successor <span class="token operator">=</span> handlerA<span class="token punctuation">;</span>        handlerA<span class="token punctuation">.</span><span class="token function">handleRequest</span><span class="token punctuation">(</span><span class="token string">"ConcreteHandleB"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç®€å•å®ç°"><a href="#ç®€å•å®ç°" class="headerlink" title="ç®€å•å®ç°"></a>ç®€å•å®ç°</h2><blockquote><p>è¿™ä¸ªä¾‹å­æˆ‘è§‰å¾—å¾ˆè´´åˆ‡ã€‚æˆ‘ä»¬åœ¨å…¬å¸æœ‰å„ç§åŸå› éœ€è¦æŠ¥é”€è´¹ç”¨ï¼Œé¦–å…ˆæˆ‘ä»¬è¦æ‰¾æˆ‘ä»¬çš„ä¸Šçº§é¢†å¯¼å»å®¡æ‰¹ï¼ŒæŠ¥é”€é¢åº¦å¦‚æœåœ¨é¢†å¯¼çš„æƒé™èŒƒå›´å†…ï¼Œé‚£å°±å®¡æ‰¹é€šè¿‡ï¼Œå¦åˆ™é¢†å¯¼åœ¨æ‰¾è‡ªå·±çš„ä¸Šçº§å»å®¡æ‰¹ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p></blockquote><h3 id="æŠ½è±¡é¢†å¯¼ç±»"><a href="#æŠ½è±¡é¢†å¯¼ç±»" class="headerlink" title="æŠ½è±¡é¢†å¯¼ç±»"></a>æŠ½è±¡é¢†å¯¼ç±»</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Leader</span> <span class="token punctuation">{</span>    <span class="token comment">/**     * ä¸Šçº§é¢†å¯¼å¤„ç†è€…     */</span>    <span class="token keyword">protected</span> <span class="token class-name">Leader</span> nextHandler<span class="token punctuation">;</span>    <span class="token comment">/**     * å¤„ç†æŠ¥è´¦è¯·æ±‚     *     * @param money èƒ½æ‰¹å¤çš„æŠ¥è´¦é¢åº¦     *     */</span>    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">handleRequest</span><span class="token punctuation">(</span><span class="token keyword">int</span> money<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">getLeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>money <span class="token operator">&lt;=</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token function">handle</span><span class="token punctuation">(</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æŠ¥è´¦é¢åº¦ä¸è¶³ï¼Œæäº¤é¢†å¯¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> nextHandler<span class="token punctuation">)</span><span class="token punctuation">{</span>                nextHandler<span class="token punctuation">.</span><span class="token function">handleRequest</span><span class="token punctuation">(</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * è‡ªèº«èƒ½æ‰¹å¤çš„é¢åº¦æƒé™     *     * @return é¢åº¦     */</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">int</span> <span class="token function">limit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * å¤„ç†æŠ¥è´¦è¡Œä¸º     *     * @param money å…·ä½“é‡‘é¢     */</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token keyword">int</span> money<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * è·å–å¤„ç†è€…     *     * @return å¤„ç†è€…     */</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token class-name">String</span> <span class="token function">getLeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç»„é•¿ï¼ˆé¢åº¦-1000ï¼‰ï¼š"><a href="#ç»„é•¿ï¼ˆé¢åº¦-1000ï¼‰ï¼š" class="headerlink" title="ç»„é•¿ï¼ˆé¢åº¦ 1000ï¼‰ï¼š"></a>ç»„é•¿ï¼ˆé¢åº¦ 1000ï¼‰ï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GroupLeader</span> <span class="token keyword">extends</span> <span class="token class-name">Leader</span><span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">limit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token number">1000</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token keyword">int</span> money<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç»„é•¿æ‰¹å¤æŠ¥é”€"</span><span class="token operator">+</span> money <span class="token operator">+</span><span class="token string">"å…ƒ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getLeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token string">"å½“å‰æ˜¯ç»„é•¿"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¸»ç®¡ï¼ˆé¢åº¦-5000ï¼‰ï¼š"><a href="#ä¸»ç®¡ï¼ˆé¢åº¦-5000ï¼‰ï¼š" class="headerlink" title="ä¸»ç®¡ï¼ˆé¢åº¦ 5000ï¼‰ï¼š"></a>ä¸»ç®¡ï¼ˆé¢åº¦ 5000ï¼‰ï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Director</span> <span class="token keyword">extends</span> <span class="token class-name">Leader</span><span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">limit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token number">5000</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token keyword">int</span> money<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ä¸»ç®¡æ‰¹å¤æŠ¥é”€"</span><span class="token operator">+</span> money <span class="token operator">+</span><span class="token string">"å…ƒ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getLeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token string">"å½“å‰æ˜¯ä¸»ç®¡"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç»ç†ï¼ˆé¢åº¦-10000ï¼‰ï¼š"><a href="#ç»ç†ï¼ˆé¢åº¦-10000ï¼‰ï¼š" class="headerlink" title="ç»ç†ï¼ˆé¢åº¦ 10000ï¼‰ï¼š"></a>ç»ç†ï¼ˆé¢åº¦ 10000ï¼‰ï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Manager</span> <span class="token keyword">extends</span> <span class="token class-name">Leader</span><span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">limit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token number">10000</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token keyword">int</span> money<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç»ç†æ‰¹å¤æŠ¥é”€"</span><span class="token operator">+</span> money <span class="token operator">+</span><span class="token string">"å…ƒ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getLeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token string">"å½“å‰æ˜¯ç»ç†"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è€æ¿ï¼ˆé¢åº¦æ— ä¸Šé™ï¼‰"><a href="#è€æ¿ï¼ˆé¢åº¦æ— ä¸Šé™ï¼‰" class="headerlink" title="è€æ¿ï¼ˆé¢åº¦æ— ä¸Šé™ï¼‰:"></a>è€æ¿ï¼ˆé¢åº¦æ— ä¸Šé™ï¼‰:</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Boss</span> <span class="token keyword">extends</span> <span class="token class-name">Leader</span><span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">limit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token keyword">int</span> money<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è€æ¿æ‰¹å¤æŠ¥é”€"</span><span class="token operator">+</span> money <span class="token operator">+</span><span class="token string">"å…ƒ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getLeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token string">"å½“å‰æ˜¯è€æ¿"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å‘èµ·ç”³è¯·ï¼š"><a href="#å‘èµ·ç”³è¯·ï¼š" class="headerlink" title="å‘èµ·ç”³è¯·ï¼š"></a>å‘èµ·ç”³è¯·ï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//æ„é€ å„ä¸ªé¢†å¯¼å¯¹è±¡</span>        <span class="token class-name">GroupLeader</span> groupLeader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GroupLeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Director</span> director <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Director</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Manager</span> manager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Manager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Boss</span> boss <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Boss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//è®¾ç½®ä¸Šçº§é¢†å¯¼å¤„ç†è€…å¯¹è±¡</span>        groupLeader<span class="token punctuation">.</span>nextHandler <span class="token operator">=</span> director<span class="token punctuation">;</span>        director<span class="token punctuation">.</span>nextHandler <span class="token operator">=</span> manager<span class="token punctuation">;</span>        manager<span class="token punctuation">.</span>nextHandler <span class="token operator">=</span> boss<span class="token punctuation">;</span>        <span class="token comment">//å‘èµ·æŠ¥è´¦ç”³è¯·</span>        groupLeader<span class="token punctuation">.</span><span class="token function">handleRequest</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç»“æœï¼š"><a href="#ç»“æœï¼š" class="headerlink" title="ç»“æœï¼š"></a>ç»“æœï¼š</h3><pre class="line-numbers language-none"><code class="language-none">å½“å‰æ˜¯ç»„é•¿æŠ¥è´¦é¢åº¦ä¸è¶³ï¼Œæäº¤é¢†å¯¼å½“å‰æ˜¯ä¸»ç®¡æŠ¥è´¦é¢åº¦ä¸è¶³ï¼Œæäº¤é¢†å¯¼å½“å‰æ˜¯ç»ç†ç»ç†æ‰¹å¤æŠ¥é”€8000å…ƒ123456<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è´£ä»»é“¾æ¨¡å¼éå¸¸çµæ´»ï¼Œè¯·æ±‚çš„å‘èµ·å¯ä»¥ä»è´£ä»»é“¾çš„ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹å¼€å§‹ï¼Œä¹Ÿå¯ä»¥æ”¹å˜å†…éƒ¨çš„ä¼ é€’è§„åˆ™ã€‚æ¯”å¦‚ä¸»ç®¡ä¸åœ¨ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥è·¨è¿‡ä¸»ç®¡ç›´æ¥ä»ç»„é•¿é‚£é‡Œè½¬åˆ°ç»ç†ã€‚</p><blockquote><p>å¯¹äºè´£ä»»é“¾ä¸­çš„ä¸€ä¸ªå¤„ç†è€…å¯¹è±¡ï¼Œæœ‰ä¸¤ä¸ªè¡Œä¸ºã€‚ä¸€æ˜¯å¤„ç†è¯·æ±‚ï¼ŒäºŒæ˜¯å°†è¯·æ±‚ä¼ é€’åˆ°ä¸‹ä¸€èŠ‚ç‚¹ï¼Œä¸å…è®¸æŸä¸ªå¤„ç†è€…å¯¹è±¡åœ¨å¤„ç†äº†è¯·æ±‚ååˆå°†è¯·æ±‚ä¼ é€ç»™ä¸Šä¸€ä¸ªèŠ‚ç‚¹çš„æƒ…å†µã€‚<br>å¯¹äºä¸€æ¡è´£ä»»é“¾æ¥è¯´ï¼Œä¸€ä¸ªè¯·æ±‚æœ€ç»ˆåªæœ‰ä¸¤ç§æƒ…å†µã€‚ä¸€æ˜¯è¢«æŸä¸ªå¤„ç†å¯¹è±¡æ‰€å¤„ç†ï¼Œå¦ä¸€ä¸ªæ˜¯æ‰€æœ‰å¯¹è±¡å‡æœªå¯¹å…¶å¤„ç†ï¼Œå¯¹äºå‰ä¸€ç§æƒ…å†µæˆ‘ä»¬ç§°ä¸º<strong>çº¯çš„è´£ä»»é“¾æ¨¡å¼</strong>ï¼Œåä¸€ç§ä¸º<strong>ä¸çº¯çš„è´£ä»»é“¾</strong>ã€‚å®é™…ä¸­å¤§å¤šä¸ºä¸çº¯çš„è´£ä»»é“¾ã€‚</p></blockquote><h2 id="Android-æºç ä¸­çš„è´£ä»»é“¾æ¨¡å¼"><a href="#Android-æºç ä¸­çš„è´£ä»»é“¾æ¨¡å¼" class="headerlink" title="Android æºç ä¸­çš„è´£ä»»é“¾æ¨¡å¼"></a>Android æºç ä¸­çš„è´£ä»»é“¾æ¨¡å¼</h2><ul><li>View äº‹ä»¶çš„åˆ†å‘å¤„ç†</li></ul><p>ViewGroup äº‹ä»¶æŠ•é€’çš„é€’å½’è°ƒç”¨å°±ç±»ä¼¼äºä¸€æ¡è´£ä»»é“¾ï¼Œä¸€æ—¦å…¶å¯»æ‰¾åˆ°è´£ä»»è€…ï¼Œé‚£ä¹ˆå°†ç”±è´£ä»»è€…æŒæœ‰å¹¶æ¶ˆè´¹æ‰è¯¥æ¬¡äº‹ä»¶ï¼Œå…·ä½“ä½“ç°åœ¨ View çš„ onTouchEvent æ–¹æ³•ä¸­è¿”å›å€¼çš„è®¾ç½®ï¼Œå¦‚æœè¿”å› falseï¼Œé‚£ä¹ˆæ„å‘³ç€å½“å‰çš„ View ä¸ä¼šæ˜¯è¯¥æ¬¡çš„è´£ä»»äººï¼Œå°†ä¸ä¼šå¯¹å…¶æŒæœ‰ï¼›å¦‚æœè¿”å› trueï¼Œæ­¤æ—¶ View ä¼šæŒæœ‰è¯¥äº‹ä»¶å¹¶ä¸å†å‘å¤–ä¼ é€’ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol><li>ä¼˜ç‚¹<ul><li>å¯ä»¥å¯¹è¯·æ±‚è€…å’Œå¤„ç†è€…çš„å…³ç³»è§£è€¦ï¼Œæé«˜ä»£ç çš„çµæ´»æ€§ã€‚</li></ul></li><li>ç¼ºç‚¹<ul><li>æ¯æ¬¡éƒ½éœ€è¦å¯¹é“¾ä¸­è¯·æ±‚å¤„ç†è€…éå†ï¼Œå¦‚æœå¤„ç†è€…å¤ªå¤šé‚£ä¹ˆéå†å¿…å®šä¼šå½±å“æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯åœ¨ä¸€äº›é€’å½’è°ƒç”¨è€…ä¸­ï¼Œè¦æ…ç”¨ã€‚</li></ul></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Java </tag>
            
            <tag> DesignPattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - å‘½ä»¤æ¨¡å¼</title>
      <link href="/20170318/designpattern-behavior-command/"/>
      <url>/20170318/designpattern-behavior-command/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-å‘½ä»¤æ¨¡å¼"><a href="#ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-å‘½ä»¤æ¨¡å¼" class="headerlink" title="ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - å‘½ä»¤æ¨¡å¼"></a>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - å‘½ä»¤æ¨¡å¼</h1><blockquote><p>å‘½ä»¤æ¨¡å¼æ˜¯è¡Œä¸ºå‹æ¨¡å¼ä¹‹ä¸€ã€‚æ€»ä½“æ¥è¯´å¹¶ä¸éš¾ç†è§£ï¼Œåªæ˜¯æ¯”è¾ƒç¹çï¼Œä»–ä¼šå°†ç®€å•çš„è°ƒç”¨å…³ç³»è§£è€¦æˆå¤šä¸ªéƒ¨åˆ†ï¼Œå¢åŠ ç±»çš„å¤æ‚åº¦ï¼Œä½†æ˜¯å³ä¾¿å¦‚æ­¤ï¼Œå‘½ä»¤æ¨¡å¼çš„ç»“æ„ä¾ç„¶æ¸…æ™°ã€‚<br>å®šä¹‰: å°†ä¸€ä¸ªè¯·æ±‚å°è£…æˆä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œè®©ç”¨æˆ·ä½¿ç”¨ä¸åŒçš„è¯·æ±‚æŠŠå®¢æˆ·ç«¯å‚æ•°åŒ–ï¼›å¯¹è¯·æ±‚æ’é˜Ÿæˆ–è€…è®°å½•è¯·æ±‚æ—¥å¿—ï¼Œä»¥åŠæ”¯æŒå¯æ’¤é”€çš„æ“ä½œã€‚</p></blockquote><span id="more"></span><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><ul><li>ï¼ˆ1ï¼‰éœ€è¦æŠ½å‡ºå¾…æ‰§è¡Œçš„åŠ¨ä½œï¼Œç„¶åä»¥å‚æ•°çš„å½¢å¼æä¾›å‡ºæ¥ã€‚</li><li>ï¼ˆ2ï¼‰åœ¨ä¸åŒçš„æ—¶åˆ»æŒ‡å®šã€æ’åˆ—å’Œæ‰§è¡Œè¯·æ±‚ã€‚ä¸€ä¸ªå‘½ä»¤å¯¹è±¡å¯ä»¥æœ‰ä¸åˆå§‹è¯·æ±‚æ— å…³çš„ç”Ÿå­˜æœŸã€‚</li><li>ï¼ˆ3ï¼‰éœ€è¦æ”¯æŒæ“ä½œå–æ¶ˆã€‚</li><li>ï¼ˆ4ï¼‰æ”¯æŒä¿®æ”¹æ—¥å¿—åŠŸèƒ½ï¼Œè¿™æ ·å½“ç³»ç»Ÿå´©æºƒæ—¶ï¼Œè¿™äº›ä¿®æ”¹å¯ä»¥è¢«é‡åšä¸€éã€‚</li><li>ï¼ˆ5ï¼‰éœ€è¦æ”¯æŒäº‹åŠ¡æ“ä½œã€‚</li></ul><h2 id="UML-ç±»å›¾"><a href="#UML-ç±»å›¾" class="headerlink" title="UML ç±»å›¾"></a>UML ç±»å›¾</h2><p><img src="http://blog-1251678165.coscd.myqcloud.com/2018-03-18-Command.png"></p><h2 id="ç®€å•å®ç°"><a href="#ç®€å•å®ç°" class="headerlink" title="ç®€å•å®ç°"></a>ç®€å•å®ç°</h2><blockquote><p>ä»¥æ¨ç®±å­æ¸¸æˆä¸ºä¾‹ï¼Œä¸€èˆ¬æ¸¸æˆä¸­ä¼šæœ‰äº”ä¸ªæŒ‰é’®ï¼Œåˆ†åˆ«æ˜¯å·¦ç§»ã€å³ç§»ã€ä¸‹ç§»ã€ä¸Šç§»å’Œæ’¤é”€ã€‚é‚£ä¹ˆç©æ¸¸æˆçš„äººå°±æ˜¯å®¢æˆ·ç«¯ï¼Œäº”ä¸ªæŒ‰é’®å°±æ˜¯è°ƒç”¨è€…ï¼Œæ‰§è¡Œå…·ä½“æŒ‰é’®å‘½ä»¤çš„æ–¹æ³•æ˜¯å‘½ä»¤è§’è‰²ã€‚</p></blockquote><h3 id="æ¥æ”¶è€…è§’è‰²ï¼šæ¨ç®±å­æ¸¸æˆ"><a href="#æ¥æ”¶è€…è§’è‰²ï¼šæ¨ç®±å­æ¸¸æˆ" class="headerlink" title="æ¥æ”¶è€…è§’è‰²ï¼šæ¨ç®±å­æ¸¸æˆ"></a>æ¥æ”¶è€…è§’è‰²ï¼šæ¨ç®±å­æ¸¸æˆ</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PushBox</span> <span class="token punctuation">{</span>    <span class="token comment">/**     * æ‰§è¡Œå‘å·¦å‘½ä»¤     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">toLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å‘å·¦"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * æ‰§è¡Œå‘å³å‘½ä»¤     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">toRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å‘å³"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * æ‰§è¡Œå‘ä¸‹å‘½ä»¤     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">toDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å‘ä¸‹"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * æ‰§è¡Œå‘ä¸Šå‘½ä»¤     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">toUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å‘ä¸Š"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * æ‰§è¡Œæ’¤é”€å‘½ä»¤     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">revoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ’¤é”€"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å‘½ä»¤è€…æŠ½è±¡"><a href="#å‘½ä»¤è€…æŠ½è±¡" class="headerlink" title="å‘½ä»¤è€…æŠ½è±¡"></a>å‘½ä»¤è€…æŠ½è±¡</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Command</span> <span class="token punctuation">{</span>    <span class="token comment">/**     * å‘½ä»¤æ‰§è¡Œæ–¹æ³•     */</span>    <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * è·å–å‘½ä»¤ç±»å‹     */</span>    <span class="token keyword">void</span> <span class="token function">getCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å…·ä½“å‘½ä»¤è€…ï¼Œå·¦ç§»å‘½ä»¤ç±»"><a href="#å…·ä½“å‘½ä»¤è€…ï¼Œå·¦ç§»å‘½ä»¤ç±»" class="headerlink" title="å…·ä½“å‘½ä»¤è€…ï¼Œå·¦ç§»å‘½ä»¤ç±»"></a>å…·ä½“å‘½ä»¤è€…ï¼Œå·¦ç§»å‘½ä»¤ç±»</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LeftCommand</span> <span class="token keyword">implements</span> <span class="token class-name">Command</span><span class="token punctuation">{</span>    <span class="token comment">//æŒæœ‰ä¸€ä¸ªæ¥å—æ¨ç®±å­æ¸¸æˆå¯¹è±¡çš„å¼•ç”¨</span>    <span class="token keyword">private</span> <span class="token class-name">PushBox</span> pushBox<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">LeftCommand</span><span class="token punctuation">(</span><span class="token class-name">PushBox</span> pushBox<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>pushBox <span class="token operator">=</span> pushBox<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//è°ƒç”¨å…·ä½“å‘½ä»¤</span>        pushBox<span class="token punctuation">.</span><span class="token function">toLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"å‘å·¦--&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å…·ä½“å‘½ä»¤è€…ï¼Œå³ç§»å‘½ä»¤ç±»"><a href="#å…·ä½“å‘½ä»¤è€…ï¼Œå³ç§»å‘½ä»¤ç±»" class="headerlink" title="å…·ä½“å‘½ä»¤è€…ï¼Œå³ç§»å‘½ä»¤ç±»"></a>å…·ä½“å‘½ä»¤è€…ï¼Œå³ç§»å‘½ä»¤ç±»</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RightCommand</span> <span class="token keyword">implements</span> <span class="token class-name">Command</span><span class="token punctuation">{</span>    <span class="token comment">//æŒæœ‰ä¸€ä¸ªæ¥å—æ¨ç®±å­æ¸¸æˆå¯¹è±¡çš„å¼•ç”¨</span>    <span class="token keyword">private</span> <span class="token class-name">PushBox</span> pushBox<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">RightCommand</span><span class="token punctuation">(</span><span class="token class-name">PushBox</span> pushBox<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>pushBox <span class="token operator">=</span> pushBox<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//è°ƒç”¨å…·ä½“å‘½ä»¤</span>        pushBox<span class="token punctuation">.</span><span class="token function">toRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"å‘å³--&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å…·ä½“å‘½ä»¤è€…ï¼Œä¸Šç§»å‘½ä»¤ç±»"><a href="#å…·ä½“å‘½ä»¤è€…ï¼Œä¸Šç§»å‘½ä»¤ç±»" class="headerlink" title="å…·ä½“å‘½ä»¤è€…ï¼Œä¸Šç§»å‘½ä»¤ç±»"></a>å…·ä½“å‘½ä»¤è€…ï¼Œä¸Šç§»å‘½ä»¤ç±»</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UpCommand</span> <span class="token keyword">implements</span> <span class="token class-name">Command</span><span class="token punctuation">{</span>    <span class="token comment">//æŒæœ‰ä¸€ä¸ªæ¥å—æ¨ç®±å­æ¸¸æˆå¯¹è±¡çš„å¼•ç”¨</span>    <span class="token keyword">private</span> <span class="token class-name">PushBox</span> pushBox<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">UpCommand</span><span class="token punctuation">(</span><span class="token class-name">PushBox</span> pushBox<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>pushBox <span class="token operator">=</span> pushBox<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//è°ƒç”¨å…·ä½“å‘½ä»¤</span>        pushBox<span class="token punctuation">.</span><span class="token function">toUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"å‘ä¸Š--&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å…·ä½“å‘½ä»¤è€…ï¼Œä¸‹ç§»å‘½ä»¤ç±»"><a href="#å…·ä½“å‘½ä»¤è€…ï¼Œä¸‹ç§»å‘½ä»¤ç±»" class="headerlink" title="å…·ä½“å‘½ä»¤è€…ï¼Œä¸‹ç§»å‘½ä»¤ç±»"></a>å…·ä½“å‘½ä»¤è€…ï¼Œä¸‹ç§»å‘½ä»¤ç±»</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DownCommand</span> <span class="token keyword">implements</span> <span class="token class-name">Command</span><span class="token punctuation">{</span>    <span class="token comment">//æŒæœ‰ä¸€ä¸ªæ¥å—æ¨ç®±å­æ¸¸æˆå¯¹è±¡çš„å¼•ç”¨</span>    <span class="token keyword">private</span> <span class="token class-name">PushBox</span> pushBox<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">DownCommand</span><span class="token punctuation">(</span><span class="token class-name">PushBox</span> pushBox<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>pushBox <span class="token operator">=</span> pushBox<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//è°ƒç”¨å…·ä½“å‘½ä»¤</span>        pushBox<span class="token punctuation">.</span><span class="token function">toDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"å‘ä¸‹--&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å…·ä½“å‘½ä»¤è€…ï¼Œæ’¤é”€å‘½ä»¤ç±»"><a href="#å…·ä½“å‘½ä»¤è€…ï¼Œæ’¤é”€å‘½ä»¤ç±»" class="headerlink" title="å…·ä½“å‘½ä»¤è€…ï¼Œæ’¤é”€å‘½ä»¤ç±»"></a>å…·ä½“å‘½ä»¤è€…ï¼Œæ’¤é”€å‘½ä»¤ç±»</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RevokeCommand</span> <span class="token keyword">implements</span> <span class="token class-name">Command</span><span class="token punctuation">{</span>    <span class="token comment">//æŒæœ‰ä¸€ä¸ªæ¥å—æ¨ç®±å­æ¸¸æˆå¯¹è±¡çš„å¼•ç”¨</span>    <span class="token keyword">private</span> <span class="token class-name">PushBox</span> pushBox<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">RevokeCommand</span><span class="token punctuation">(</span><span class="token class-name">PushBox</span> pushBox<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>pushBox <span class="token operator">=</span> pushBox<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//è°ƒç”¨å…·ä½“å‘½ä»¤</span>        pushBox<span class="token punctuation">.</span><span class="token function">revoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è¯·æ±‚è€…ç±»ï¼Œå‘½ä»¤ç”±æŒ‰é’®å‘èµ·"><a href="#è¯·æ±‚è€…ç±»ï¼Œå‘½ä»¤ç”±æŒ‰é’®å‘èµ·" class="headerlink" title="è¯·æ±‚è€…ç±»ï¼Œå‘½ä»¤ç”±æŒ‰é’®å‘èµ·"></a>è¯·æ±‚è€…ç±»ï¼Œå‘½ä»¤ç”±æŒ‰é’®å‘èµ·</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Buttons</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token class-name">LeftCommand</span> leftCommand<span class="token punctuation">;</span> <span class="token comment">//å‘å·¦ç§»åŠ¨çš„å‘½ä»¤å¯¹è±¡å¼•ç”¨</span>    <span class="token keyword">private</span> <span class="token class-name">RightCommand</span> rightCommand<span class="token punctuation">;</span> <span class="token comment">//å‘å³ç§»åŠ¨çš„å‘½ä»¤å¯¹è±¡å¼•ç”¨</span>    <span class="token keyword">private</span> <span class="token class-name">UpCommand</span> upCommand<span class="token punctuation">;</span> <span class="token comment">//å‘ä¸Šç§»åŠ¨çš„å‘½ä»¤å¯¹è±¡å¼•ç”¨</span>    <span class="token keyword">private</span> <span class="token class-name">DownCommand</span> downCommand<span class="token punctuation">;</span> <span class="token comment">//å‘ä¸‹ç§»åŠ¨çš„å‘½ä»¤å¯¹è±¡å¼•ç”¨</span>    <span class="token keyword">private</span> <span class="token class-name">RevokeCommand</span> revokeCommand<span class="token punctuation">;</span> <span class="token comment">//æ’¤é”€å‘½ä»¤å¯¹è±¡å¼•ç”¨</span>    <span class="token keyword">private</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Command</span><span class="token punctuation">&gt;</span></span> commandList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Command</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç”¨äºè®°å½•å‘½ä»¤åŠ¨ä½œ</span>    <span class="token comment">/**     * è·å–æ‰§è¡Œå‘½ä»¤     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getCommandList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Command</span> c <span class="token operator">:</span> commandList<span class="token punctuation">)</span><span class="token punctuation">{</span>            c<span class="token punctuation">.</span><span class="token function">getCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * è®¾ç½®å‘å·¦ç§»åŠ¨çš„å‘½ä»¤å¯¹è±¡     *     * @param leftCommand å‘å·¦ç§»åŠ¨çš„å‘½ä»¤å¯¹è±¡     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setLeftCommand</span><span class="token punctuation">(</span><span class="token class-name">LeftCommand</span> leftCommand<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>leftCommand <span class="token operator">=</span> leftCommand<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * è®¾ç½®å‘å³ç§»åŠ¨çš„å‘½ä»¤å¯¹è±¡     *     * @param rightCommand å‘å³ç§»åŠ¨çš„å‘½ä»¤å¯¹è±¡     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setRightCommand</span><span class="token punctuation">(</span><span class="token class-name">RightCommand</span> rightCommand<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>rightCommand <span class="token operator">=</span> rightCommand<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * è®¾ç½®å‘ä¸Šç§»åŠ¨çš„å‘½ä»¤å¯¹è±¡     *     * @param upCommand å‘ä¸Šç§»åŠ¨çš„å‘½ä»¤å¯¹è±¡     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUpCommand</span><span class="token punctuation">(</span><span class="token class-name">UpCommand</span> upCommand<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>upCommand <span class="token operator">=</span> upCommand<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * è®¾ç½®å‘ä¸‹ç§»åŠ¨çš„å‘½ä»¤å¯¹è±¡     *     * @param downCommand å‘ä¸‹ç§»åŠ¨çš„å‘½ä»¤å¯¹è±¡     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDownCommand</span><span class="token punctuation">(</span><span class="token class-name">DownCommand</span> downCommand<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>downCommand <span class="token operator">=</span> downCommand<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * è®¾ç½®æ’¤é”€å‘½ä»¤å¯¹è±¡     *     * @param revokeCommand æ’¤é”€å‘½ä»¤å¯¹è±¡     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setRevokeCommand</span><span class="token punctuation">(</span><span class="token class-name">RevokeCommand</span> revokeCommand<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>revokeCommand <span class="token operator">=</span> revokeCommand<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * æŒ‰ä¸‹å‘å·¦æŒ‰é’®     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">toLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        leftCommand<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        commandList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>leftCommand<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * æŒ‰ä¸‹å‘å³æŒ‰é’®     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">toRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        rightCommand<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        commandList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>rightCommand<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * æŒ‰ä¸‹å‘ä¸ŠæŒ‰é’®     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">toUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        upCommand<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        commandList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>upCommand<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * æŒ‰ä¸‹å‘ä¸‹æŒ‰é’®     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">toDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        downCommand<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        commandList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>downCommand<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * æŒ‰ä¸‹æ’¤é”€æŒ‰é’®     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">toRevoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        revokeCommand<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        commandList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>commandList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å®¢æˆ·ç«¯è°ƒç”¨"><a href="#å®¢æˆ·ç«¯è°ƒç”¨" class="headerlink" title="å®¢æˆ·ç«¯è°ƒç”¨"></a>å®¢æˆ·ç«¯è°ƒç”¨</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//é¦–å…ˆåˆ›å»ºæ¸¸æˆ</span>        <span class="token class-name">PushBox</span> pushBox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PushBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//æ ¹æ®æ¸¸æˆæ„é€ 5ç§å‘½ä»¤</span>        <span class="token class-name">LeftCommand</span> leftCommand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LeftCommand</span><span class="token punctuation">(</span>pushBox<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">RightCommand</span> rightCommand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RightCommand</span><span class="token punctuation">(</span>pushBox<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">UpCommand</span> upCommand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UpCommand</span><span class="token punctuation">(</span>pushBox<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">DownCommand</span> downCommand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DownCommand</span><span class="token punctuation">(</span>pushBox<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">RevokeCommand</span> revokeCommand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RevokeCommand</span><span class="token punctuation">(</span>pushBox<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//æŒ‰é’®å¯ä»¥æ‰§è¡Œä¸åŒå‘½ä»¤</span>        <span class="token class-name">Buttons</span> buttons <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Buttons</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        buttons<span class="token punctuation">.</span><span class="token function">setLeftCommand</span><span class="token punctuation">(</span>leftCommand<span class="token punctuation">)</span><span class="token punctuation">;</span>        buttons<span class="token punctuation">.</span><span class="token function">setRightCommand</span><span class="token punctuation">(</span>rightCommand<span class="token punctuation">)</span><span class="token punctuation">;</span>        buttons<span class="token punctuation">.</span><span class="token function">setUpCommand</span><span class="token punctuation">(</span>upCommand<span class="token punctuation">)</span><span class="token punctuation">;</span>        buttons<span class="token punctuation">.</span><span class="token function">setDownCommand</span><span class="token punctuation">(</span>downCommand<span class="token punctuation">)</span><span class="token punctuation">;</span>        buttons<span class="token punctuation">.</span><span class="token function">setRevokeCommand</span><span class="token punctuation">(</span>revokeCommand<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//æ‰§è¡Œæ“ä½œ</span>        buttons<span class="token punctuation">.</span><span class="token function">toLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        buttons<span class="token punctuation">.</span><span class="token function">toDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        buttons<span class="token punctuation">.</span><span class="token function">toDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        buttons<span class="token punctuation">.</span><span class="token function">toRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        buttons<span class="token punctuation">.</span><span class="token function">getCommandList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        buttons<span class="token punctuation">.</span><span class="token function">toRevoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        buttons<span class="token punctuation">.</span><span class="token function">toUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        buttons<span class="token punctuation">.</span><span class="token function">toLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        buttons<span class="token punctuation">.</span><span class="token function">toDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        buttons<span class="token punctuation">.</span><span class="token function">toUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        buttons<span class="token punctuation">.</span><span class="token function">getCommandList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ‰§è¡Œç»“æœ"><a href="#æ‰§è¡Œç»“æœ" class="headerlink" title="æ‰§è¡Œç»“æœ"></a>æ‰§è¡Œç»“æœ</h3><pre class="line-numbers language-none"><code class="language-none">å‘å·¦å‘ä¸‹å‘ä¸‹å‘å³å‘å·¦--&gt;å‘ä¸‹--&gt;å‘ä¸‹--&gt;å‘å³--&gt;æ’¤é”€å‘ä¸Šå‘å·¦å‘ä¸‹å‘ä¸Šå‘å·¦--&gt;å‘ä¸‹--&gt;å‘ä¸‹--&gt;å‘ä¸Š--&gt;å‘å·¦--&gt;å‘ä¸‹--&gt;å‘ä¸Š--&gt;1234567891011<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨è¿™ä¹ˆé•¿çš„ä»£ç ä¹‹åæ˜¯ä¸æ˜¯è§‰å¾—å¾ˆçƒ¦çï¼Œæ˜æ˜å¯ä»¥å¾ˆç®€å•çš„å®ç°ï¼Œå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//é¦–å…ˆåˆ›å»ºæ¸¸æˆ</span>        <span class="token class-name">PushBox</span> pushBox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PushBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        pushBox<span class="token punctuation">.</span><span class="token function">toDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        pushBox<span class="token punctuation">.</span><span class="token function">toRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        pushBox<span class="token punctuation">.</span><span class="token function">toUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶å®è®¾è®¡æ¨¡å¼æœ‰ä¸€ä¸ªé‡è¦çš„åŸåˆ™ï¼šå¯¹ä¿®æ”¹å…³é—­å¯¹æ‰©å±•å¼€æ”¾ã€‚å¦‚æœä½¿ç”¨å¦‚ä¸Šçš„ç®€å•æ–¹å¼ï¼Œé‚£ä¹ˆä»¥åçš„ä¿®æ”¹åªèƒ½å»ä¿®æ”¹ PushBox ç±»ï¼Œç„¶åä¿®æ”¹ Client ç±»ï¼Œè¿™æ˜¾ç„¶è¿åäº†è¿™ä¸€åŸåˆ™ã€‚å¦‚æœä½¿ç”¨å‘½ä»¤æ¨¡å¼ï¼Œé‚£ä¹ˆ Client ç±»æ— éœ€ä¿®æ”¹ï¼Œåªéœ€è¦ä¿®æ”¹ PushBox ç±»çš„å†…éƒ¨æ“ä½œï¼ŒClient ç±»æ— éœ€çŸ¥é“å…·ä½“çš„å†…éƒ¨å®ç°ã€‚</p><blockquote><p>è®¾è®¡æ¨¡å¼çš„ä½¿ç”¨ä¹‹å‰ä¹Ÿæœ‰æåˆ°ï¼Œä¸»è¦æ˜¯è¦çœ‹å½“å‰åœºæ™¯çš„å¤æ‚åº¦å’Œä»¥åçš„éœ€æ±‚è¿›è¡Œæ‰©å±•ã€ç»´æŠ¤ç­‰æ–¹é¢ï¼Œå®Œå…¨ä½¿ç”¨è®¾è®¡æ¨¡å¼ä¹Ÿæ˜¯ä¸æå€¡çš„ï¼Œè¿™å°±éœ€è¦è®¾è®¡è€…æƒè¡¡åˆ©å¼Šäº†ã€‚</p></blockquote><h2 id="Android-æºç ä¸­çš„å‘½ä»¤æ¨¡å¼å®ç°"><a href="#Android-æºç ä¸­çš„å‘½ä»¤æ¨¡å¼å®ç°" class="headerlink" title="Android æºç ä¸­çš„å‘½ä»¤æ¨¡å¼å®ç°"></a>Android æºç ä¸­çš„å‘½ä»¤æ¨¡å¼å®ç°</h2><ol><li>PackageHandler</li></ol><p>PackageManagerService ä¸­ï¼Œå…¶å¯¹åŒ…çš„ç›¸å…³æ¶ˆæ¯å¤„ç†å³å…¶å†…éƒ¨ç±» PackageHandler æ‰¿æ‹…ï¼Œå…¶å°†éœ€è¦å¤„ç†çš„è¯·æ±‚ä½œä¸ºå¯¹è±¡é€šè¿‡æ¶ˆæ¯ä¼ é€’ç»™ç›¸å…³çš„æ–¹æ³•ï¼Œè€Œå¯¹äºåŒ…çš„å®‰è£…ã€ç§»åŠ¨ä»¥åŠåŒ…å¤§å°çš„æµ‹é‡åˆ™åˆ†åˆ«å°è£…ä¸º<strong>HandlerParams</strong>çš„å…·ä½“å­ç±»<strong>InstallParams</strong>ã€<strong>MoveParams</strong>å’Œ<strong>MeasureParams</strong>ã€‚æºç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">HandlerParams</span> <span class="token punctuation">{</span>        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">MAX_RETRIES</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>        <span class="token comment">/**         * Number of times startCopy() has been attempted and had a non-fatal         * error.         */</span>        <span class="token keyword">private</span> <span class="token keyword">int</span> mRetries <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">startCopy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">boolean</span> res<span class="token punctuation">;</span>            <span class="token keyword">try</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">DEBUG_INSTALL</span><span class="token punctuation">)</span> <span class="token class-name">Slog</span><span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> <span class="token string">"startCopy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">++</span>mRetries <span class="token operator">&gt;</span> <span class="token constant">MAX_RETRIES</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token class-name">Slog</span><span class="token punctuation">.</span><span class="token function">w</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> <span class="token string">"Failed to invoke remote methods on default container service. Giving up"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    mHandler<span class="token punctuation">.</span><span class="token function">sendEmptyMessage</span><span class="token punctuation">(</span><span class="token constant">MCS_GIVE_UP</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token function">handleServiceError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                    <span class="token function">handleStartCopy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    res <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RemoteException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">DEBUG_INSTALL</span><span class="token punctuation">)</span> <span class="token class-name">Slog</span><span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> <span class="token string">"Posting install MCS_RECONNECT"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                mHandler<span class="token punctuation">.</span><span class="token function">sendEmptyMessage</span><span class="token punctuation">(</span><span class="token constant">MCS_RECONNECT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                res <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token function">handleReturnCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> res<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">serviceError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">DEBUG_INSTALL</span><span class="token punctuation">)</span> <span class="token class-name">Slog</span><span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> <span class="token string">"serviceError"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">handleServiceError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">handleReturnCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">handleStartCopy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">RemoteException</span><span class="token punctuation">;</span>        <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">handleServiceError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">handleReturnCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹å‡º<strong>HandlerParams</strong>ä¹Ÿæ˜¯ä¸€ä¸ªæŠ½è±¡å‘½ä»¤è€…ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol><li>ä¼˜ç‚¹<ul><li>å‘½ä»¤æ¨¡å¼çš„å°è£…æ€§å¾ˆå¥½ï¼Œæ›´å¼±çš„è€¦åˆæ€§ï¼Œæ›´çµæ´»çš„æ§åˆ¶æ€§ä»¥åŠæ›´å¥½çš„æ‰©å±•æ€§ã€‚</li></ul></li><li>ç¼ºç‚¹<ul><li>ç±»çš„è†¨èƒ€ï¼Œå¤§é‡è¡ç”Ÿç±»çš„åˆ›å»ºã€‚</li></ul></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Java </tag>
            
            <tag> DesignPattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - è¿­ä»£å™¨æ¨¡å¼</title>
      <link href="/20170318/designpattern-behavior-iterator/"/>
      <url>/20170318/designpattern-behavior-iterator/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Ã</p><h1 id="ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-è¿­ä»£å™¨æ¨¡å¼"><a href="#ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-è¿­ä»£å™¨æ¨¡å¼" class="headerlink" title="ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - è¿­ä»£å™¨æ¨¡å¼"></a>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - è¿­ä»£å™¨æ¨¡å¼</h1><blockquote><p>è¿­ä»£å™¨æ¨¡å¼ï¼Œåˆå«åšæ¸¸æ ‡æ¨¡å¼ï¼Œæ˜¯è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼ä¹‹ä¸€ã€‚æˆ‘ä»¬çŸ¥é“å¯¹å®¹å™¨å¯¹è±¡çš„è®¿é—®å¿…ç„¶ä¼šæ¶‰åŠéå†ç®—æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å°†éå†çš„æ–¹æ³•å°è£…åœ¨å®¹å™¨ä¸­ï¼Œæˆ–è€…ä¸æä¾›éå†æ–¹æ³•ï¼Œè®©ä½¿ç”¨å®¹å™¨çš„äººè‡ªå·±å»å®ç°å»å§ã€‚è¿™ä¸¤ç§æƒ…å†µå¥½åƒéƒ½èƒ½å¤Ÿè§£å†³é—®é¢˜ã€‚<br>ç„¶è€Œåœ¨å‰ä¸€ç§æƒ…å†µï¼Œå®¹å™¨æ‰¿å—äº†è¿‡å¤šçš„åŠŸèƒ½ï¼Œå®ƒä¸ä»…è¦è´Ÿè´£è‡ªå·±â€œå®¹å™¨â€å†…çš„å…ƒç´ ç»´æŠ¤ï¼ˆæ·»åŠ ã€åˆ é™¤ç­‰ç­‰ï¼‰ï¼Œè€Œä¸”è¿˜è¦æä¾›éå†è‡ªèº«çš„æ¥å£ï¼›è€Œä¸”ç”±äºéå†çŠ¶æ€ä¿å­˜çš„é—®é¢˜ï¼Œä¸èƒ½å¯¹åŒä¸€ä¸ªå®¹å™¨å¯¹è±¡åŒæ—¶è¿›è¡Œå¤šä¸ªéå†ã€‚ç¬¬äºŒç§æ–¹å¼å€’æ˜¯çœäº‹ï¼Œå´åˆå°†å®¹å™¨çš„å†…éƒ¨ç»†èŠ‚æš´éœ²æ— é—ã€‚<br>æ­£å› äºæ­¤ï¼Œè¿­ä»£å™¨æ¨¡å¼åº”è¿è€Œç”Ÿï¼Œåœ¨å®¢æˆ·è®¿é—®ç±»ä¸å®¹å™¨ä½“ä¹‹é—´æ’å…¥ä¸€ä¸ªç¬¬ä¸‰è€…â€“è¿­ä»£å™¨ï¼Œå¾ˆå¥½çš„è§£å†³äº†ä¸Šè¿°å¼Šç«¯ã€‚<br>å®šä¹‰ï¼šæä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªå®¹å™¨å¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸éœ€è¦æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚</p></blockquote><span id="more"></span><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><p>éå†ä¸€ä¸ªå®¹å™¨å¯¹è±¡æ—¶ã€‚</p><h2 id="UMLç±»å›¾"><a href="#UMLç±»å›¾" class="headerlink" title="UMLç±»å›¾"></a>UMLç±»å›¾</h2><p><img src="http://blog-1251678165.coscd.myqcloud.com/2018-03-18-Iterator.png"></p><h2 id="ç®€å•å®ç°"><a href="#ç®€å•å®ç°" class="headerlink" title="ç®€å•å®ç°"></a>ç®€å•å®ç°</h2><blockquote><p>ç”¨ä¹¦ä¸­çš„ä¾‹å­ï¼šå°æ°‘å’Œå°è¾‰åˆ†åˆ«åœ¨å…¬å¸ä¸¤ä¸ªäº‹ä¸šéƒ¨ï¼ŒæŸå¤©è€æ¿å®‰æ’ä»»åŠ¡è®©ä»–ä»¬ä¿©ç»Ÿè®¡ä¸€ä¸‹å„è‡ªéƒ¨é—¨çš„å‘˜å·¥æ•°æ®ã€‚</p></blockquote><h3 id="å‘˜å·¥å®ä½“ç±»ï¼š"><a href="#å‘˜å·¥å®ä½“ç±»ï¼š" class="headerlink" title="å‘˜å·¥å®ä½“ç±»ï¼š"></a>å‘˜å·¥å®ä½“ç±»ï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span><span class="token comment">// å§“å</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span><span class="token comment">// å¹´é¾„</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> sex<span class="token punctuation">;</span><span class="token comment">// æ€§åˆ«</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> position<span class="token punctuation">;</span><span class="token comment">// èŒä½</span>    <span class="token keyword">public</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">,</span> <span class="token class-name">String</span> sex<span class="token punctuation">,</span> <span class="token class-name">String</span> position<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> sex<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>position <span class="token operator">=</span> position<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">// ç®€åŒ–ä»£ç ï¼Œçœç•¥setterå’Œgetteræ–¹æ³•</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token string">"Employee{"</span> <span class="token operator">+</span> <span class="token string">"name='"</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span> <span class="token string">", age="</span> <span class="token operator">+</span> age <span class="token operator">+</span> <span class="token string">", sex="</span>                <span class="token operator">+</span> sex <span class="token operator">+</span> <span class="token string">", position='"</span> <span class="token operator">+</span> position <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span> <span class="token string">"}"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å°è¾‰éƒ¨é—¨ï¼š"><a href="#å°è¾‰éƒ¨é—¨ï¼š" class="headerlink" title="å°è¾‰éƒ¨é—¨ï¼š"></a>å°è¾‰éƒ¨é—¨ï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CompanyHui</span> <span class="token punctuation">{</span><span class="token keyword">private</span> <span class="token class-name">Employee</span><span class="token punctuation">[</span><span class="token punctuation">]</span> array <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">CompanyHui</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"è¾‰å“¥"</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token string">"ç”·"</span><span class="token punctuation">,</span> <span class="token string">"ç¨‹åºçŒ¿"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"å°çº¢"</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">"ç”·"</span><span class="token punctuation">,</span> <span class="token string">"ç¨‹åºçŒ¿"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"å°è¾‰"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">"ç”·"</span><span class="token punctuation">,</span> <span class="token string">"ç¨‹åºçŒ¿"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token class-name">Employee</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getEmployees</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> array<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å°æ°‘éƒ¨é—¨ï¼š"><a href="#å°æ°‘éƒ¨é—¨ï¼š" class="headerlink" title="å°æ°‘éƒ¨é—¨ï¼š"></a>å°æ°‘éƒ¨é—¨ï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CompanyMin</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">CompanyMin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"å°æ°‘"</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token string">"ç”·"</span><span class="token punctuation">,</span> <span class="token string">"ç¨‹åºçŒ¿"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"å°èŠ¸"</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token string">"å¥³"</span><span class="token punctuation">,</span> <span class="token string">"æµ‹è¯•"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"å°æ–¹"</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">"å¥³"</span><span class="token punctuation">,</span> <span class="token string">"æµ‹è¯•"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"å¯å„¿"</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token string">"å¥³"</span><span class="token punctuation">,</span> <span class="token string">"è®¾è®¡"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"æœ—æƒ…"</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">"å¥³"</span><span class="token punctuation">,</span> <span class="token string">"è®¾è®¡"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//åæ§½ä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆå°±å°æ°‘ä¸€ä¸ªç”·çš„ï¼Œå°è¾‰éƒ¨é—¨å…¨ç”·çš„ã€‚</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> <span class="token function">getEmployees</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> list<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="BossæŸ¥çœ‹ï¼š"><a href="#BossæŸ¥çœ‹ï¼š" class="headerlink" title="BossæŸ¥çœ‹ï¼š"></a>BossæŸ¥çœ‹ï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Boss</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">CompanyHui</span> hui <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CompanyHui</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Employee</span><span class="token punctuation">[</span><span class="token punctuation">]</span> huiList <span class="token operator">=</span> hui<span class="token punctuation">.</span><span class="token function">getEmployees</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> huiList<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>huiList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token class-name">CompanyMin</span> min <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CompanyMin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">List</span> minList <span class="token operator">=</span> min<span class="token punctuation">.</span><span class="token function">getEmployees</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> minList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>minList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç»“æœï¼š"><a href="#ç»“æœï¼š" class="headerlink" title="ç»“æœï¼š"></a>ç»“æœï¼š</h3><pre class="line-numbers language-none"><code class="language-none">Employee{name='è¾‰å“¥', age=28, sex=ç”·, position='ç¨‹åºçŒ¿'}Employee{name='å°çº¢', age=23, sex=ç”·, position='ç¨‹åºçŒ¿'}Employee{name='å°è¾‰', age=25, sex=ç”·, position='ç¨‹åºçŒ¿'}Employee{name='å°æ°‘', age=26, sex=ç”·, position='ç¨‹åºçŒ¿'}Employee{name='å°èŠ¸', age=22, sex=å¥³, position='æµ‹è¯•'}Employee{name='å°æ–¹', age=18, sex=å¥³, position='æµ‹è¯•'}Employee{name='å¯å„¿', age=21, sex=å¥³, position='è®¾è®¡'}Employee{name='æœ—æƒ…', age=19, sex=å¥³, position='è®¾è®¡'}12345678<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·çœ‹ä¼¼ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœæœ‰å¤šä¸ªéƒ¨é—¨ï¼Œæ¯ä¸ªéƒ¨é—¨æœ‰å„è‡ªçš„å®ç°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦åœ¨Bossç±»ä¸­å¢åŠ ä¸€ééå†é€»è¾‘ï¼Œè¿™æ ·Bossç±»çš„åŠŸèƒ½ä¼šè¶Šæ¥è¶Šå¤šï¼ŒåŒæ—¶æš´éœ²äº†å†…éƒ¨ç»†èŠ‚ã€‚é‚£ä¹ˆæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªè¿­ä»£å™¨æ¥å£ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Iterator</span> <span class="token punctuation">{</span>    <span class="token comment">/**     * æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€ä¸ªå…ƒç´       *      * @return trueè¡¨ç¤ºæœ‰ï¼Œfalseè¡¨ç¤ºæ²¡æœ‰     */</span>    <span class="token keyword">boolean</span> <span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * è¿”å›å½“å‰å…ƒç´ ï¼Œå¹¶å°†ä½ç½®ç§»è‡³ä¸‹ä¸€ä½     */</span>    <span class="token class-name">Object</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°æ°‘çš„è¿­ä»£å™¨ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MinIterator</span> <span class="token keyword">implements</span> <span class="token class-name">Iterator</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> position<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">MinIterator</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>list <span class="token operator">=</span> list<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span>position <span class="token operator">&gt;</span> list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">||</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">Employee</span> e <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>        position<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> e<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°è¾‰çš„è¿­ä»£å™¨ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HuiIterator</span> <span class="token keyword">implements</span> <span class="token class-name">Iterator</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token class-name">Employee</span><span class="token punctuation">[</span><span class="token punctuation">]</span> array<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> position<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">HuiIterator</span><span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token punctuation">[</span><span class="token punctuation">]</span> array<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>array <span class="token operator">=</span> array<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span>position <span class="token operator">&gt;</span> array<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">||</span> array<span class="token punctuation">[</span>position<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">Employee</span> e <span class="token operator">=</span> array<span class="token punctuation">[</span>position<span class="token punctuation">]</span><span class="token punctuation">;</span>        position<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> e<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®šä¹‰å®¹å™¨ç±»çš„æ¥å£</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Company</span> <span class="token punctuation">{</span>    <span class="token comment">/**     * è¿”å›ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡     *      * @return è¿­ä»£å™¨å¯¹è±¡     */</span>    <span class="token class-name">Iterator</span> <span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¿®æ”¹ä¸€ä¸‹ä¹‹å‰çš„ä¸¤ä¸ªå®¹å™¨ç±»ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CompanyHui</span> <span class="token keyword">implements</span> <span class="token class-name">Company</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token class-name">Employee</span><span class="token punctuation">[</span><span class="token punctuation">]</span> array <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">CompanyHui</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"è¾‰å“¥"</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token string">"ç”·"</span><span class="token punctuation">,</span> <span class="token string">"ç¨‹åºçŒ¿"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"å°çº¢"</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">"ç”·"</span><span class="token punctuation">,</span> <span class="token string">"ç¨‹åºçŒ¿"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"å°è¾‰"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">"ç”·"</span><span class="token punctuation">,</span> <span class="token string">"ç¨‹åºçŒ¿"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token class-name">Employee</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getEmployees</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> array<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">Iterator</span> <span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">HuiIterator</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CompanyMin</span> <span class="token keyword">implements</span> <span class="token class-name">Company</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">CompanyMin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"å°æ°‘"</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token string">"ç”·"</span><span class="token punctuation">,</span> <span class="token string">"ç¨‹åºçŒ¿"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"å°èŠ¸"</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token string">"å¥³"</span><span class="token punctuation">,</span> <span class="token string">"æµ‹è¯•"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"å°æ–¹"</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">"å¥³"</span><span class="token punctuation">,</span> <span class="token string">"æµ‹è¯•"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"å¯å„¿"</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token string">"å¥³"</span><span class="token punctuation">,</span> <span class="token string">"è®¾è®¡"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"æœ—æƒ…"</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">"å¥³"</span><span class="token punctuation">,</span> <span class="token string">"è®¾è®¡"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> <span class="token function">getEmployees</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> list<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">Iterator</span> <span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MinIterator</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>BossæŸ¥çœ‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Boss</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">CompanyHui</span> hui <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CompanyHui</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">check</span><span class="token punctuation">(</span>hui<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">CompanyMin</span> min <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CompanyMin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">check</span><span class="token punctuation">(</span>min<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token class-name">Iterator</span> iterator<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“æœä¸å˜ï¼Œå°±ä¸é‡å¤å†™äº†ã€‚</p><h2 id="Androidæºç ä¸­çš„æ¨¡å¼å®ç°"><a href="#Androidæºç ä¸­çš„æ¨¡å¼å®ç°" class="headerlink" title="Androidæºç ä¸­çš„æ¨¡å¼å®ç°"></a>Androidæºç ä¸­çš„æ¨¡å¼å®ç°</h2><h3 id="Cursor"><a href="#Cursor" class="headerlink" title="Cursor"></a>Cursor</h3><p>å½“æˆ‘ä»¬ä½¿ç”¨SQLiteDatabaseçš„queryæ–¹æ³•æŸ¥è¯¢æ•°æ®åº“æ—¶ï¼Œä¼šè¿”å›ä¸€ä¸ªCursoræ¸¸æ ‡å¯¹è±¡ï¼Œè¯¥æ¸¸æ ‡çš„å®è´¨å°±æ˜¯ä¸€ä¸ªå…·ä½“çš„è¿­ä»£å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥éå†æ•°æ®åº“æŸ¥è¯¢æ‰€å¾—çš„ç»“æœé›†ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><blockquote><p>è¿­ä»£å™¨æ¨¡å¼å‘å±•è‡³ä»Šï¼Œå‡ ä¹æ‰€æœ‰çš„é«˜çº§è¯­è¨€éƒ½æœ‰ç›¸åº”çš„å†…ç½®å®ç°ï¼Œå¯¹äºå¼€å‘è€…è€Œè¨€ï¼Œå·²ç»æå°‘ä¼šè‡ªå·±å»å®ç°è¿­ä»£å™¨äº†ï¼Œæ‰€ä»¥æœ¬ç« å†…å®¹æ›´å¤šçš„æ˜¯äº†è§£è€Œéåº”ç”¨ã€‚</p></blockquote><ol><li><p>ä¼˜ç‚¹</p><ul><li>ç¬¦åˆé¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™ä¸­çš„å•ä¸€èŒè´£åŸåˆ™ã€‚</li><li>æ”¯æŒå¯¹å®¹å™¨å¯¹è±¡çš„å¤šç§éå†ã€‚å¼±åŒ–äº†å®¹å™¨ç±»ä¸éå†ç®—æ³•ä¹‹é—´çš„å…³ç³»ã€‚</li></ul></li><li><p>ç¼ºç‚¹</p><ul><li>ç±»æ–‡ä»¶çš„å¢åŠ ã€‚</li><li>ä¼šå‡ºç°ConcurrentModificationExceptionå¼‚å¸¸ã€‚</li><li>éå†è¿‡ç¨‹æ˜¯ä¸€ä¸ªå•å‘ä¸”ä¸å¯é€†çš„éå†ã€‚</li></ul></li></ol><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="http://dev.yesky.com/474/2168474.shtml">æ·±å…¥æµ…å‡ºJavaè®¾è®¡æ¨¡å¼ä¹‹è¿­ä»£å™¨æ¨¡å¼</a></li><li><a href="http://blog.csdn.net/lirunfa/article/details/7353857">ConcurrentModificationExceptionå¼‚å¸¸</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Java </tag>
            
            <tag> DesignPattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - çŠ¶æ€æ¨¡å¼</title>
      <link href="/20170318/designpattern-behavior-state/"/>
      <url>/20170318/designpattern-behavior-state/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-çŠ¶æ€æ¨¡å¼"><a href="#ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-çŠ¶æ€æ¨¡å¼" class="headerlink" title="ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - çŠ¶æ€æ¨¡å¼"></a>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - çŠ¶æ€æ¨¡å¼</h1><blockquote><p>å®šä¹‰ï¼šçŠ¶æ€æ¨¡å¼ä¸­çš„è¡Œä¸ºæ˜¯ç”±çŠ¶æ€æ¥å†³å®šï¼Œä¸åŒçš„çŠ¶æ€ä¸‹æœ‰ä¸åŒçš„è¡Œä¸ºã€‚å½“ä¸€ä¸ªå¯¹è±¡çš„å†…åœ¨çŠ¶æ€æ”¹å˜æ—¶å…è®¸æ”¹å˜å…¶è¡Œä¸ºï¼Œè¿™ä¸ªå¯¹è±¡çœ‹èµ·æ¥åƒæ˜¯æ”¹å˜äº†å…¶ç±»ã€‚</p></blockquote><span id="more"></span><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><ol><li>ä¸€ä¸ªå¯¹è±¡çš„è¡Œä¸ºå–å†³äºå®ƒçš„çŠ¶æ€ï¼Œå¹¶ä¸”å®ƒå¿…é¡»åœ¨è¿è¡Œæ—¶æ ¹æ®çŠ¶æ€æ”¹å˜å®ƒçš„è¡Œä¸ºã€‚</li><li>ä»£ç ä¸­åŒ…å«å¤§é‡ä¸å¯¹è±¡çŠ¶æ€æœ‰å…³çš„æ¡ä»¶è¯­å¥ï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªæ“ä½œä¸­å«æœ‰å¤§é‡çš„å¤šåˆ†æ”¯è¯­å¥ï¼Œä¸”è¿™äº›åˆ†æ”¯ä¾èµ–äºè¯¥å¯¹è±¡çš„çŠ¶æ€ã€‚<br><img src="http://blog-1251678165.coscd.myqcloud.com/2018-03-18-State.png"></li></ol><h2 id="ç®€å•å®ç°"><a href="#ç®€å•å®ç°" class="headerlink" title="ç®€å•å®ç°"></a>ç®€å•å®ç°</h2><blockquote><p>å®ç°æ•ˆæœï¼šé¦–å…ˆå°†ç”µè§†çš„çŠ¶æ€åˆ†ä¸ºå¼€æœºä¸å…³æœºçŠ¶æ€ï¼Œå¼€æœºæ—¶å¯ä»¥é€šè¿‡é¥æ§å™¨å®ç°é¢‘é“åˆ‡æ¢å’Œè°ƒèŠ‚éŸ³é‡ï¼Œä½†æ˜¯å…³æœºæ—¶ï¼Œè¿™äº›æ“ä½œéƒ½ä¼šå¤±æ•ˆã€‚</p></blockquote><h3 id="æ™®é€šçš„å®ç°æ–¹æ³•ï¼š"><a href="#æ™®é€šçš„å®ç°æ–¹æ³•ï¼š" class="headerlink" title="æ™®é€šçš„å®ç°æ–¹æ³•ï¼š"></a>æ™®é€šçš„å®ç°æ–¹æ³•ï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TVController</span> <span class="token punctuation">{</span>    <span class="token comment">//å¼€æœºçŠ¶æ€</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token constant">POWER_ON</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token comment">//å…³æœºçŠ¶æ€</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token constant">POWER_OFF</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token comment">//é»˜è®¤çŠ¶æ€</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> mState <span class="token operator">=</span> <span class="token constant">POWER_OFF</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">powerOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>mState <span class="token operator">==</span><span class="token constant">POWER_OFF</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç”µè§†å¼€æœºäº†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        mState <span class="token operator">=</span> <span class="token constant">POWER_ON</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">powerOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>mState <span class="token operator">==</span><span class="token constant">POWER_ON</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç”µè§†å…³æœºäº†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        mState <span class="token operator">=</span> <span class="token constant">POWER_OFF</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">nextChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>mState <span class="token operator">==</span><span class="token constant">POWER_ON</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ä¸‹ä¸€é¢‘é“"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ²¡æœ‰å¼€æœº"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">prevChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>mState <span class="token operator">==</span><span class="token constant">POWER_ON</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ä¸Šä¸€é¢‘é“"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ²¡æœ‰å¼€æœº"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">turnUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>mState <span class="token operator">==</span><span class="token constant">POWER_ON</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è°ƒé«˜éŸ³é‡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ²¡æœ‰å¼€æœº"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">turnDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>mState <span class="token operator">==</span><span class="token constant">POWER_ON</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è°ƒä½éŸ³é‡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ²¡æœ‰å¼€æœº"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œæ¯æ¬¡æ‰§è¡Œé€šè¿‡åˆ¤æ–­å½“å‰çŠ¶æ€æ¥è¿›è¡Œæ“ä½œï¼Œéƒ¨åˆ†çš„ä»£ç é‡å¤ï¼Œå‡è®¾çŠ¶æ€å’ŒåŠŸèƒ½å¢åŠ ï¼Œå°±ä¼šè¶Šæ¥è¶Šéš¾ä»¥ç»´æŠ¤ã€‚è¿™æ—¶å¯ä»¥ä½¿ç”¨çŠ¶æ€æ¨¡å¼ï¼Œå¦‚ä¸‹ï¼š</p><h3 id="ç”µè§†çš„æ“ä½œ"><a href="#ç”µè§†çš„æ“ä½œ" class="headerlink" title="ç”µè§†çš„æ“ä½œ"></a>ç”µè§†çš„æ“ä½œ</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * ç”µè§†çŠ¶æ€æ¥å£ï¼Œå®šä¹‰äº†ç”µè§†çš„æ“ä½œå‡½æ•° * * */</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">TVState</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">nextChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">prevChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">turnUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">turnDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token number">12345678910111213</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å…³æœºçŠ¶æ€"><a href="#å…³æœºçŠ¶æ€" class="headerlink" title="å…³æœºçŠ¶æ€"></a>å…³æœºçŠ¶æ€</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * * å…³æœºçŠ¶æ€ï¼Œæ“ä½œæ— ç»“æœ * * */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PowerOffState</span> <span class="token keyword">implements</span> <span class="token class-name">TVState</span><span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">nextChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">prevChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">turnUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">turnDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å¼€æœºçŠ¶æ€"><a href="#å¼€æœºçŠ¶æ€" class="headerlink" title="å¼€æœºçŠ¶æ€"></a>å¼€æœºçŠ¶æ€</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * * å¼€æœºçŠ¶æ€ï¼Œæ“ä½œæœ‰æ•ˆ * * */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PowerOnState</span> <span class="token keyword">implements</span> <span class="token class-name">TVState</span><span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">nextChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ä¸‹ä¸€é¢‘é“"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">prevChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ä¸Šä¸€é¢‘é“"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">turnUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è°ƒé«˜éŸ³é‡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">turnDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è°ƒä½éŸ³é‡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç”µæºæ“ä½œæ¥å£"><a href="#ç”µæºæ“ä½œæ¥å£" class="headerlink" title="ç”µæºæ“ä½œæ¥å£"></a>ç”µæºæ“ä½œæ¥å£</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * ç”µæºæ“ä½œæ¥å£ * * */</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">PowerController</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">powerOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">powerOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç”µè§†é¥æ§å™¨"><a href="#ç”µè§†é¥æ§å™¨" class="headerlink" title="ç”µè§†é¥æ§å™¨"></a>ç”µè§†é¥æ§å™¨</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * ç”µè§†é¥æ§å™¨ * * */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TVController</span> <span class="token keyword">implements</span> <span class="token class-name">PowerController</span><span class="token punctuation">{</span>    <span class="token class-name">TVState</span> mTVState<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTVState</span><span class="token punctuation">(</span><span class="token class-name">TVState</span> mTVState<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>mTVState <span class="token operator">=</span> mTVState<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">powerOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">setTVState</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PowerOnState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å¼€æœºäº†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">powerOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">setTVState</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PowerOffState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å…³æœºäº†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">nextChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        mTVState<span class="token punctuation">.</span><span class="token function">nextChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">prevChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        mTVState<span class="token punctuation">.</span><span class="token function">prevChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">turnUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        mTVState<span class="token punctuation">.</span><span class="token function">turnUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">turnDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        mTVState<span class="token punctuation">.</span><span class="token function">turnDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è°ƒç”¨ï¼š"><a href="#è°ƒç”¨ï¼š" class="headerlink" title="è°ƒç”¨ï¼š"></a>è°ƒç”¨ï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">TVController</span> tvController <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TVController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//è®¾ç½®å¼€æœºçŠ¶æ€</span>        tvController<span class="token punctuation">.</span><span class="token function">powerOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//ä¸‹ä¸€é¢‘é“</span>        tvController<span class="token punctuation">.</span><span class="token function">nextChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//è°ƒé«˜éŸ³é‡</span>        tvController<span class="token punctuation">.</span><span class="token function">turnUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å…³æœº</span>        tvController<span class="token punctuation">.</span><span class="token function">powerOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//è°ƒä½éŸ³é‡ï¼Œæ­¤æ—¶ä¸ä¼šç”Ÿæ•ˆ</span>        tvController<span class="token punctuation">.</span><span class="token function">turnDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h3><pre class="line-numbers language-none"><code class="language-none">å¼€æœºäº†ä¸‹ä¸€é¢‘é“è°ƒé«˜éŸ³é‡å…³æœºäº†1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹å‡ºï¼ŒçŠ¶æ€æ¨¡å¼å°†è¿™äº›è¡Œä¸ºå°è£…åˆ°çŠ¶æ€ç±»ä¸­ï¼Œåœ¨è¿›è¡Œæ“ä½œæ—¶å°†è¿™äº›åŠŸèƒ½è½¬å‘ç»™çŠ¶æ€å¯¹è±¡ï¼Œä¸åŒçš„çŠ¶æ€æœ‰ä¸åŒçš„å®ç°ï¼Œå»é™¤äº†é‡å¤äº† if-else è¯­å¥ï¼Œè¿™æ­£æ˜¯çŠ¶æ€æ¨¡å¼çš„ç²¾é«“æ‰€åœ¨ã€‚</p><h2 id="ä¸ç­–ç•¥æ¨¡å¼çš„åŒºåˆ«"><a href="#ä¸ç­–ç•¥æ¨¡å¼çš„åŒºåˆ«" class="headerlink" title="ä¸ç­–ç•¥æ¨¡å¼çš„åŒºåˆ«"></a>ä¸ç­–ç•¥æ¨¡å¼çš„åŒºåˆ«</h2><p>çŠ¶æ€æ¨¡å¼ä¸ç­–ç•¥æ¨¡å¼çš„ç»“æ„å‡ ä¹æ˜¯ä¸€æ ·çš„ï¼Œå°±åƒæ˜¯å­ªç”Ÿå…„å¼Ÿã€‚ä½†æ˜¯ä»–ä»¬çš„ç›®åœ°ã€æœ¬è´¨ä¸ä¸€æ ·ã€‚çŠ¶æ€æ¨¡å¼çš„è¡Œä¸ºæ˜¯å¹³è¡Œçš„ã€ä¸å¯æ›¿æ¢çš„ï¼Œç­–ç•¥æ¨¡å¼çš„è¡Œä¸ºæ˜¯å½¼æ­¤ç‹¬ç«‹çš„ã€å¯ç›¸äº’æ›¿æ¢çš„ã€‚çŠ¶æ€æ¨¡å¼ï¼Œé€šå¸¸æ˜¯è‡ªæˆ‘æ§åˆ¶çŠ¶æ€çš„æ”¹å˜ã€‚è€Œç­–ç•¥æ¨¡å¼ï¼Œæ˜¯ç”±å¤–éƒ¨æŒ‡å®šä½¿ç”¨ä»€ä¹ˆæ ·çš„ç­–ç•¥ã€‚</p><h2 id="Android-å®æˆ˜ä¸­çš„ä½¿ç”¨"><a href="#Android-å®æˆ˜ä¸­çš„ä½¿ç”¨" class="headerlink" title="Android å®æˆ˜ä¸­çš„ä½¿ç”¨"></a>Android å®æˆ˜ä¸­çš„ä½¿ç”¨</h2><ol><li>ç™»å½•ç³»ç»Ÿï¼Œæ ¹æ®ç”¨æˆ·æ˜¯å¦ç™»å½•ï¼Œåˆ¤æ–­äº‹ä»¶çš„å¤„ç†æ–¹å¼ã€‚</li><li>Wi-Fi ç®¡ç†ï¼Œåœ¨ä¸åŒçš„çŠ¶æ€ä¸‹ï¼ŒWiFi çš„æ‰«æè¯·æ±‚å¤„ç†ä¸ä¸€ã€‚</li></ol><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol><li>ä¼˜ç‚¹<ul><li>å°†æ‰€æœ‰ä¸ä¸€ä¸ªç‰¹å®šçš„çŠ¶æ€ç›¸å…³çš„è¡Œä¸ºéƒ½æ”¾å…¥ä¸€ä¸ªçŠ¶æ€å¯¹è±¡ä¸­ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ›´å¥½çš„æ–¹æ³•æ¥ç»„ç»‡ä¸ç‰¹å®šçŠ¶æ€ç›¸å…³çš„ä»£ç ï¼Œå°†ç¹ççš„çŠ¶æ€åˆ¤æ–­è½¬æ¢æˆç»“æ„æ¸…æ™°çš„çŠ¶æ€ç±»æ—ï¼Œåœ¨é¿å…ä»£ç è†¨èƒ€çš„åŒæ—¶ä¹Ÿä¿è¯äº†å¯æ‰©å±•æ€§ä¸å¯ç»´æŠ¤æ€§ã€‚</li></ul></li><li>ç¼ºç‚¹<ul><li>çŠ¶æ€æ¨¡å¼çš„ä½¿ç”¨å¿…ç„¶ä¼šå¢åŠ ç³»ç»Ÿç±»å’Œå¯¹è±¡çš„ä¸ªæ•°ã€‚</li></ul></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Java </tag>
            
            <tag> DesignPattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - ç­–ç•¥æ¨¡å¼</title>
      <link href="/20170318/designpattern-behavior-stragety/"/>
      <url>/20170318/designpattern-behavior-stragety/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-ç­–ç•¥æ¨¡å¼"><a href="#ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-ç­–ç•¥æ¨¡å¼" class="headerlink" title="ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - ç­–ç•¥æ¨¡å¼"></a>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - ç­–ç•¥æ¨¡å¼</h1><blockquote><p>é€šå¸¸å¦‚æœä¸€ä¸ªé—®é¢˜æœ‰å¤šä¸ªè§£å†³æ–¹æ¡ˆæ—¶ï¼Œæœ€ç®€å•çš„å°±æ˜¯åˆ©ç”¨ if-else æˆ–è€… switch-case æ–¹å¼æ ¹æ®ä¸åŒçš„æƒ…æ™¯é€‰æ‹©ä¸åŒçš„è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯è¿™æ ·è€¦åˆæ€§å¤ªé«˜ ã€ä»£ç è‡ƒè‚¿ã€éš¾ä»¥ç»´æŠ¤ç­‰ã€‚è¿™æ—¶å°±å¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¥è§£å†³ã€‚<br>å®šä¹‰ï¼šç­–ç•¥æ¨¡å¼å®šä¹‰äº†ä¸€ç³»åˆ—çš„ç®—æ³•ï¼Œå¹¶å°†æ¯ä¸€ä¸ªç®—æ³•å°è£…èµ·æ¥ï¼Œè€Œä¸”ä½¿ä»–ä»¬è¿˜å¯ä»¥ç›¸äº’æ›¿æ¢ã€‚ç­–ç•¥æ¨¡å¼è®©ç®—æ³•ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„å®¢æˆ·è€Œç‹¬ç«‹å˜åŒ–ã€‚</p></blockquote><span id="more"></span><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><ol><li>é’ˆå¯¹åŒä¸€ç±»å‹é—®é¢˜çš„å¤šç§å¤„ç†æ–¹å¼ï¼Œä»…ä»…æ˜¯å…·ä½“è¡Œä¸ºæœ‰å·®åˆ«æ—¶ã€‚</li><li>éœ€è¦å®‰å…¨åœ°å°è£…å¤šç§åŒä¸€ç±»å‹çš„æ“ä½œæ—¶ã€‚</li><li>å‡ºç°åŒä¸€æŠ½è±¡ç±»æœ‰å¤šä¸ªå­ç±»ï¼Œè€Œåˆéœ€è¦ä½¿ç”¨ if-else æˆ–è€… switch-case æ¥é€‰æ‹©å…·ä½“å­ç±»æ—¶ã€‚</li></ol><h2 id="UML-ç±»å›¾"><a href="#UML-ç±»å›¾" class="headerlink" title="UML ç±»å›¾"></a>UML ç±»å›¾</h2><p><img src="http://blog-1251678165.coscd.myqcloud.com/2018-03-18-Stragety-2.png"></p><h2 id="ç®€å•å®ç°"><a href="#ç®€å•å®ç°" class="headerlink" title="ç®€å•å®ç°"></a>ç®€å•å®ç°</h2><blockquote><p>éœ€æ±‚ï¼šè®¡ç®—å›¾ä¹¦ä»·æ ¼ï¼Œåˆçº§ä¼šå‘˜æ²¡æœ‰æŠ˜æ‰£ï¼Œä¸­çº§ä¼šå‘˜æ‰“ 9 æŠ˜ï¼Œé«˜çº§ä¼šå‘˜æ‰“ 8 æŠ˜ã€‚å¦‚æœä¸€èˆ¬å†™æ³•ï¼Œåº”è¯¥æ˜¯ if-else åˆ¤æ–­ä»–æ˜¯ä»€ä¹ˆçº§åˆ«çš„ä¼šå‘˜ï¼Œåœ¨è®¡ç®—ç›¸åº”çš„æŠ˜æ‰£ã€‚ä¸‹é¢ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¥è¿›è¡Œå®ç°ã€‚</p></blockquote><h3 id="æŠ½è±¡æŠ˜æ‰£ç±»"><a href="#æŠ½è±¡æŠ˜æ‰£ç±»" class="headerlink" title="æŠ½è±¡æŠ˜æ‰£ç±»"></a>æŠ½è±¡æŠ˜æ‰£ç±»</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">MemberStrategy</span> <span class="token punctuation">{</span>    <span class="token comment">/**     * è®¡ç®—å›¾ä¹¦çš„ä»·æ ¼     * @param booksPrice    å›¾ä¹¦çš„åŸä»·     * @return    è®¡ç®—å‡ºæ‰“æŠ˜åçš„ä»·æ ¼     */</span>    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">calcPrice</span><span class="token punctuation">(</span><span class="token keyword">double</span> booksPrice<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="åˆçº§ä¼šå‘˜æŠ˜æ‰£ç±»"><a href="#åˆçº§ä¼šå‘˜æŠ˜æ‰£ç±»" class="headerlink" title="åˆçº§ä¼šå‘˜æŠ˜æ‰£ç±»"></a>åˆçº§ä¼šå‘˜æŠ˜æ‰£ç±»</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PrimaryMemberStrategy</span> <span class="token keyword">implements</span> <span class="token class-name">MemberStrategy</span><span class="token punctuation">{</span>    <span class="token comment">/**     * åˆçº§ä¼šå‘˜æŠ˜æ‰£     */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">calcPrice</span><span class="token punctuation">(</span><span class="token keyword">double</span> booksPrice<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å¯¹äºåˆçº§ä¼šå‘˜çš„æ²¡æœ‰æŠ˜æ‰£"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> booksPrice<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¸­çº§ä¼šå‘˜æŠ˜æ‰£ç±»"><a href="#ä¸­çº§ä¼šå‘˜æŠ˜æ‰£ç±»" class="headerlink" title="ä¸­çº§ä¼šå‘˜æŠ˜æ‰£ç±»"></a>ä¸­çº§ä¼šå‘˜æŠ˜æ‰£ç±»</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IntermediateMemberStrategy</span> <span class="token keyword">implements</span> <span class="token class-name">MemberStrategy</span><span class="token punctuation">{</span>    <span class="token comment">/**     * ä¸­çº§ä¼šå‘˜æŠ˜æ‰£     */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">calcPrice</span><span class="token punctuation">(</span><span class="token keyword">double</span> booksPrice<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å¯¹äºä¸­çº§ä¼šå‘˜çš„æŠ˜æ‰£ä¸º10%"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> booksPrice <span class="token operator">*</span> <span class="token number">0.9</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token number">12345678910</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="é«˜çº§ä¼šå‘˜æŠ˜æ‰£ç±»"><a href="#é«˜çº§ä¼šå‘˜æŠ˜æ‰£ç±»" class="headerlink" title="é«˜çº§ä¼šå‘˜æŠ˜æ‰£ç±»"></a>é«˜çº§ä¼šå‘˜æŠ˜æ‰£ç±»</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AdvancedMemberStrategy</span> <span class="token keyword">implements</span> <span class="token class-name">MemberStrategy</span><span class="token punctuation">{</span>    <span class="token comment">/**     * é«˜çº§ä¼šå‘˜æŠ˜æ‰£     */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">calcPrice</span><span class="token punctuation">(</span><span class="token keyword">double</span> booksPrice<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å¯¹äºé«˜çº§ä¼šå‘˜çš„æŠ˜æ‰£ä¸º20%"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> booksPrice <span class="token operator">*</span> <span class="token number">0.8</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä»·æ ¼ç±»"><a href="#ä»·æ ¼ç±»" class="headerlink" title="ä»·æ ¼ç±»"></a>ä»·æ ¼ç±»</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Price</span> <span class="token punctuation">{</span>    <span class="token comment">//æŒæœ‰ä¸€ä¸ªå…·ä½“çš„ç­–ç•¥å¯¹è±¡</span>    <span class="token keyword">private</span> <span class="token class-name">MemberStrategy</span> strategy<span class="token punctuation">;</span>    <span class="token comment">/**     * æ„é€ å‡½æ•°ï¼Œä¼ å…¥ä¸€ä¸ªå…·ä½“çš„ç­–ç•¥å¯¹è±¡     * @param strategy    å…·ä½“çš„ç­–ç•¥å¯¹è±¡     */</span>    <span class="token keyword">public</span> <span class="token class-name">Price</span><span class="token punctuation">(</span><span class="token class-name">MemberStrategy</span> strategy<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>strategy <span class="token operator">=</span> strategy<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * è®¡ç®—å›¾ä¹¦çš„ä»·æ ¼     * @param booksPrice    å›¾ä¹¦çš„åŸä»·     * @return    è®¡ç®—å‡ºæ‰“æŠ˜åçš„ä»·æ ¼     */</span>    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">quote</span><span class="token punctuation">(</span><span class="token keyword">double</span> booksPrice<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>strategy<span class="token punctuation">.</span><span class="token function">calcPrice</span><span class="token punctuation">(</span>booksPrice<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å®¢æˆ·ç«¯"><a href="#å®¢æˆ·ç«¯" class="headerlink" title="å®¢æˆ·ç«¯"></a>å®¢æˆ·ç«¯</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//é€‰æ‹©å¹¶åˆ›å»ºéœ€è¦ä½¿ç”¨çš„ç­–ç•¥å¯¹è±¡</span>        <span class="token class-name">MemberStrategy</span> strategy1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AdvancedMemberStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//åˆ›å»ºç¯å¢ƒ</span>        <span class="token class-name">Price</span> price <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Price</span><span class="token punctuation">(</span>strategy1<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//è®¡ç®—ä»·æ ¼</span>        <span class="token keyword">double</span> quote <span class="token operator">=</span> price<span class="token punctuation">.</span><span class="token function">quote</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å›¾ä¹¦çš„æœ€ç»ˆä»·æ ¼ä¸ºï¼š"</span> <span class="token operator">+</span> quote<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h3><pre class="line-numbers language-none"><code class="language-none">å¯¹äºé«˜çº§ä¼šå‘˜çš„æŠ˜æ‰£ä¸º20%å›¾ä¹¦çš„æœ€ç»ˆä»·æ ¼ä¸ºï¼š240.012<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç­–ç•¥æ¨¡å¼å’Œå·¥å‚æ¨¡å¼çš„åŒºåˆ«"><a href="#ç­–ç•¥æ¨¡å¼å’Œå·¥å‚æ¨¡å¼çš„åŒºåˆ«" class="headerlink" title="ç­–ç•¥æ¨¡å¼å’Œå·¥å‚æ¨¡å¼çš„åŒºåˆ«"></a>ç­–ç•¥æ¨¡å¼å’Œå·¥å‚æ¨¡å¼çš„åŒºåˆ«</h2><table><thead><tr><th>å·¥å‚æ¨¡å¼</th><th>ç­–ç•¥æ¨¡å¼</th></tr></thead><tbody><tr><td>åˆ›å»ºå‹çš„è®¾è®¡æ¨¡å¼</td><td>è¡Œä¸ºå‹çš„è®¾è®¡æ¨¡å¼</td></tr><tr><td>å…³æ³¨å¯¹è±¡åˆ›å»º</td><td>å…³æ³¨è¡Œä¸ºçš„é€‰æ‹©</td></tr><tr><td>é»‘ç›’å­ï¼ˆæ— éœ€çŸ¥é“å…·ä½“çš„å®ç°è¿‡ç¨‹ï¼‰</td><td>ç™½ç›’å­ï¼ˆçŸ¥é“å…·ä½“çš„å®ç°è¿‡ç¨‹ï¼‰</td></tr></tbody></table><h2 id="Android-æºç ä¸­çš„ç­–ç•¥æ¨¡å¼å®ç°"><a href="#Android-æºç ä¸­çš„ç­–ç•¥æ¨¡å¼å®ç°" class="headerlink" title="Android æºç ä¸­çš„ç­–ç•¥æ¨¡å¼å®ç°"></a>Android æºç ä¸­çš„ç­–ç•¥æ¨¡å¼å®ç°</h2><p>æ—¶é—´æ’å€¼å™¨ï¼ˆTimeInterpolatorï¼‰</p><p>LinearInterpolatorã€AccelerateInterpolatorã€CycleInterpolator ç­‰å®ç° Interpolatorï¼Œé€šè¿‡ getInterpolatorï¼ˆfloat inputï¼‰è·å–å½“å‰çš„æ—¶é—´ç™¾åˆ†æ¯”ï¼Œä»¥æ­¤æ¥è®¡ç®—åŠ¨ç”»çš„å±æ€§å€¼ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ç­–ç•¥æ¨¡å¼ä¸»è¦ç”¨æ¥åˆ†ç¦»ç®—æ³•ï¼Œåœ¨ç›¸åŒçš„è¡Œä¸ºæŠ½è±¡ä¸‹æœ‰ä¸åŒçš„å…·ä½“å®ç°ç­–ç•¥ã€‚è¿™ä¸ªæ¨¡å¼å¾ˆå¥½åœ°æ¼”ç¤ºäº†å¼€é—­åŸåˆ™ï¼Œä¹Ÿå°±æ˜¯å®šä¹‰æŠ½è±¡ï¼Œæ³¨å…¥ä¸åŒçš„å®ç°ï¼Œä»è€Œè¾¾åˆ°å¾ˆå¥½çš„å¯æ‰©å±•æ€§ã€‚</p><ol><li>ä¼˜ç‚¹ï¼š<ul><li>ç»“æ„æ¸…æ™°æ˜äº†ã€ä½¿ç”¨ç®€å•ç›´è§‚ã€‚</li><li>è€¦åˆåº¦ç›¸å¯¹è€Œè¨€è¾ƒä½ï¼Œæ‰©å±•æ–¹ä¾¿ã€‚</li><li>æ“ä½œå°è£…ä¹Ÿæ›´ä¸ºå½»åº•ï¼Œæ•°æ®æ›´ä¸ºå®‰å…¨ã€‚</li></ul></li><li>ç¼ºç‚¹ï¼š<ul><li>éšç€ç­–ç•¥çš„å¢åŠ ï¼Œå­ç±»ä¹Ÿä¼šå˜å¾—ç¹å¤šã€‚</li></ul></li></ol><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="http://www.cnblogs.com/java-my-life/archive/2012/05/10/2491891.html">ã€ŠJAVA ä¸æ¨¡å¼ã€‹ä¹‹ç­–ç•¥æ¨¡å¼</a></li><li><a href="http://www.cnblogs.com/me115/p/3790615.html">ç­–ç•¥æ¨¡å¼å’Œå·¥å‚æ¨¡å¼çš„åŒºåˆ«</a></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Java </tag>
            
            <tag> DesignPattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - æ¨¡æ¿æ–¹æ³•æ¨¡å¼</title>
      <link href="/20170318/designpattern-behavior-template-method/"/>
      <url>/20170318/designpattern-behavior-template-method/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-æ¨¡æ¿æ–¹æ³•æ¨¡å¼"><a href="#ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-æ¨¡æ¿æ–¹æ³•æ¨¡å¼" class="headerlink" title="ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - æ¨¡æ¿æ–¹æ³•æ¨¡å¼"></a>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - æ¨¡æ¿æ–¹æ³•æ¨¡å¼</h1><blockquote><p>æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ˜¯ç»“æ„æœ€ç®€å•çš„è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼ï¼Œä¹Ÿæ˜¯æ‰€æœ‰æ¨¡å¼ä¸­æœ€ä¸ºå¸¸è§çš„å‡ ä¸ªæ¨¡å¼ä¹‹ä¸€ï¼Œæ˜¯åŸºäºç»§æ‰¿çš„ä»£ç å¤ç”¨çš„åŸºæœ¬æŠ€æœ¯ã€‚åœ¨å…¶ç»“æ„ä¸­åªå­˜åœ¨çˆ¶ç±»ä¸å­ç±»ä¹‹é—´çš„ç»§æ‰¿å…³ç³»ã€‚<br>å®šä¹‰ï¼šå®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„æ¡†æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ï¼Œä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚</p></blockquote><span id="more"></span><h2 id="æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸­çš„æ–¹æ³•"><a href="#æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸­çš„æ–¹æ³•" class="headerlink" title="æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸­çš„æ–¹æ³•"></a>æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸­çš„æ–¹æ³•</h2><p><img src="http://blog-1251678165.coscd.myqcloud.com/2018-03-18-Template.png"></p><h3 id="æ¨¡æ¿æ–¹æ³•"><a href="#æ¨¡æ¿æ–¹æ³•" class="headerlink" title="æ¨¡æ¿æ–¹æ³•"></a>æ¨¡æ¿æ–¹æ³•</h3><p>ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•æ˜¯å®šä¹‰åœ¨æŠ½è±¡ç±»ä¸­çš„ï¼ŒæŠŠåŸºæœ¬æ“ä½œæ–¹æ³•ç»„åˆåœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªæ€»ç®—æ³•æˆ–ä¸€ä¸ªæ€»è¡Œä¸ºçš„æ–¹æ³•ã€‚è¿™ä¸ªæ¨¡æ¿æ–¹æ³•å®šä¹‰åœ¨æŠ½è±¡ç±»ä¸­ï¼Œå¹¶ç”±å­ç±»ä¸åŠ ä»¥ä¿®æ”¹åœ°å®Œå…¨ç»§æ‰¿ä¸‹æ¥ã€‚æ‰€ä»¥æ¨¡æ¿æ–¹æ³•å¤§å¤šä¼šå®šä¹‰ä¸º<strong>final ç±»å‹</strong>ï¼ŒæŒ‡æ˜ä¸»è¦çš„é€»è¾‘åŠŸèƒ½åœ¨å­ç±»ä¸­ä¸èƒ½è¢«é‡å†™ã€‚æ¨¡æ¿æ–¹æ³•æ˜¯ä¸€ä¸ªå…·ä½“æ–¹æ³•ï¼Œå®ƒç»™å‡ºäº†ä¸€ä¸ªé¡¶å±‚é€»è¾‘æ¡†æ¶ï¼Œè€Œé€»è¾‘çš„ç»„æˆæ­¥éª¤åœ¨æŠ½è±¡ç±»ä¸­å¯ä»¥æ˜¯å…·ä½“æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æ˜¯æŠ½è±¡æ–¹æ³•ã€‚ç”±äºæ¨¡æ¿æ–¹æ³•æ˜¯å…·ä½“æ–¹æ³•ï¼Œå› æ­¤æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸­çš„æŠ½è±¡å±‚åªèƒ½æ˜¯æŠ½è±¡ç±»ï¼Œè€Œä¸æ˜¯æ¥å£ã€‚</p><h3 id="åŸºæœ¬æ–¹æ³•"><a href="#åŸºæœ¬æ–¹æ³•" class="headerlink" title="åŸºæœ¬æ–¹æ³•"></a>åŸºæœ¬æ–¹æ³•</h3><p>ï¼ˆ1ï¼‰æŠ½è±¡æ–¹æ³•ï¼šä¸€ä¸ªæŠ½è±¡æ–¹æ³•ç”±<strong>æŠ½è±¡ç±»å£°æ˜ï¼Œç”±å…·ä½“å­ç±»å®ç°</strong>ã€‚åœ¨ Java è¯­è¨€é‡ŒæŠ½è±¡æ–¹æ³•ä»¥ abstract å…³é”®å­—æ ‡ç¤ºã€‚<br>ï¼ˆ2ï¼‰é’©å­æ–¹æ³•ï¼šä¸€ä¸ªé’©å­æ–¹æ³•ç”±æŠ½è±¡ç±»<strong>å£°æ˜å¹¶å®ç°</strong>ï¼Œè€Œå­ç±»ä¼šåŠ ä»¥æ‰©å±•ã€‚å­ç±»å¯ä»¥é€šè¿‡æ‰©å±•é’©å­æ–¹æ³•æ¥å½±å“æ¨¡æ¿æ–¹æ³•çš„é€»è¾‘ã€‚</p><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><p>ï¼ˆ1ï¼‰å¤šä¸ªå­ç±»æœ‰å…¬æœ‰çš„æ–¹æ³•ï¼Œå¹¶ä¸”é€»è¾‘åŸºæœ¬ç›¸åŒã€‚=<br>ï¼ˆ2ï¼‰é‡è¦ã€å¤æ‚çš„ç®—æ³•ï¼Œå¯ä»¥æŠŠæ ¸å¿ƒç®—æ³•è®¾è®¡ä¸ºæ¨¡æ¿æ–¹æ³•ï¼Œå‘¨è¾¹çš„ç›¸å…³ç»†èŠ‚åŠŸèƒ½ç”±å„ä¸ªå­ç±»å®ç°ã€‚<br>ï¼ˆ3ï¼‰é‡æ„æ—¶ï¼Œæ¨¡æ¿æ–¹æ³•æ˜¯ä¸€ä¸ªç»å¸¸ä½¿ç”¨çš„æ¨¡å¼ï¼ŒæŠŠç›¸åŒçš„ä»£ç æŠ½å–åˆ°çˆ¶ç±»ä¸­ï¼Œç„¶åé€šè¿‡é’©å­æ–¹æ³•çº¦æŸå…¶è¡Œä¸ºã€‚</p><h2 id="ç®€å•å®ç°"><a href="#ç®€å•å®ç°" class="headerlink" title="ç®€å•å®ç°"></a>ç®€å•å®ç°</h2><blockquote><p>ä»¥ç”µè„‘å¼€æœºä¸ºä¾‹ï¼Œå‡è®¾ç°åœ¨æœ‰ä¸¤å°ç”µè„‘ï¼Œä¸€å° Windows ç³»ç»Ÿç”µè„‘ï¼Œä¸€å° Mac ç³»ç»Ÿç”µè„‘ã€‚ä½†æ˜¯å¼€æœºæµç¨‹åŸºæœ¬ä¸€è‡´ï¼šæ­¥éª¤ä¸ºå¼€å¯ç”µæºã€ç³»ç»Ÿæ£€æŸ¥ã€åŠ è½½ç³»ç»Ÿã€æ£€æŸ¥æ˜¯å¦éœ€è¦ç™»å½•ã€‚</p></blockquote><h3 id="æŠ½è±¡çš„-Computer"><a href="#æŠ½è±¡çš„-Computer" class="headerlink" title="æŠ½è±¡çš„ Computer"></a>æŠ½è±¡çš„ Computer</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * æŠ½è±¡çš„ Computer */</span><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">AbstractComputer</span> <span class="token punctuation">{</span>    <span class="token comment">//ä¸‹é¢æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œå­ç±»å¯ä»¥è¦†ç›–,ä¸å…è®¸å¤–éƒ¨ç›´æ¥è°ƒç”¨è¿™äº›æ–¹æ³•ï¼Œæ‰€ä»¥ç”¨protected</span>    <span class="token comment">/**     * å¼€å¯ç”µæº     */</span>    <span class="token keyword">protected</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">powerOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * æ£€æŸ¥ç¡¬ä»¶     */</span>    <span class="token keyword">protected</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">checkHardware</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * è½½å…¥æ“ä½œç³»ç»Ÿ     */</span>    <span class="token keyword">protected</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">loadOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * ç™»å½•     */</span>    <span class="token keyword">protected</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//ä¸‹é¢æ˜¯é’©å­æ–¹æ³•ï¼Œå£°æ˜å¹¶å®ç°</span>    <span class="token comment">/**     * æ˜¯å¦éœ€è¦ç™»å½•     *     * @return trueä¸ºéœ€è¦ç™»å½•     */</span>    <span class="token keyword">protected</span> <span class="token keyword">boolean</span> <span class="token function">isLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">//ä¸‹é¢æ˜¯æ¨¡æ¿æ–¹æ³•ï¼Œå®šä¹‰ä¸ºfinalï¼Œå­ç±»ä¸èƒ½è¦†ç›–æ­¤æ–¹æ³•</span>    <span class="token comment">/**     * å¯åŠ¨è®¡ç®—æœºæ–¹æ³•ï¼Œæ­¥éª¤ä¸ºå¼€å¯ç”µæºã€ç³»ç»Ÿæ£€æŸ¥ã€åŠ è½½ç³»ç»Ÿã€æ£€æŸ¥æ˜¯å¦ç™»å½•ã€‚     */</span>    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">startUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"--------å¼€æœº START--------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">powerOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">checkHardware</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">loadOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-------- å¼€æœº END --------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Windows-ç³»ç»Ÿç”µè„‘ï¼ˆä¸éœ€ç™»å½•ï¼‰ï¼š"><a href="#Windows-ç³»ç»Ÿç”µè„‘ï¼ˆä¸éœ€ç™»å½•ï¼‰ï¼š" class="headerlink" title="Windows ç³»ç»Ÿç”µè„‘ï¼ˆä¸éœ€ç™»å½•ï¼‰ï¼š"></a>Windows ç³»ç»Ÿç”µè„‘ï¼ˆä¸éœ€ç™»å½•ï¼‰ï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Windowsç³»ç»Ÿç”µè„‘ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WindowsComputer</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractComputer</span><span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">powerOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Windowsç”µè„‘å¼€å¯ç”µæº"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">checkHardware</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Windowsç”µè„‘æ£€æŸ¥ç¡¬ä»¶"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">loadOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Windowsç”µè„‘è½½å…¥æ“ä½œç³»ç»Ÿ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">boolean</span> <span class="token function">isLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//è¿”å›falseï¼Œä¸éœ€ç™»å½•</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Mac-ç³»ç»Ÿç”µè„‘ï¼ˆéœ€ç™»å½•ï¼‰ï¼š"><a href="#Mac-ç³»ç»Ÿç”µè„‘ï¼ˆéœ€ç™»å½•ï¼‰ï¼š" class="headerlink" title="Mac ç³»ç»Ÿç”µè„‘ï¼ˆéœ€ç™»å½•ï¼‰ï¼š"></a>Mac ç³»ç»Ÿç”µè„‘ï¼ˆéœ€ç™»å½•ï¼‰ï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Macç³»ç»Ÿç”µè„‘ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MacComputer</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractComputer</span><span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">powerOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Macç”µè„‘å¼€å¯ç”µæº"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">checkHardware</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Macç”µè„‘æ£€æŸ¥ç¡¬ä»¶"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">loadOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Macç”µè„‘è½½å…¥æ“ä½œç³»ç»Ÿ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Macç”µè„‘ç™»å½•"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è°ƒç”¨ï¼š"><a href="#è°ƒç”¨ï¼š" class="headerlink" title="è°ƒç”¨ï¼š"></a>è°ƒç”¨ï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">AbstractComputer</span> comp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WindowsComputer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        comp<span class="token punctuation">.</span><span class="token function">startUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        comp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MacComputer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        comp<span class="token punctuation">.</span><span class="token function">startUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç»“æœï¼š"><a href="#ç»“æœï¼š" class="headerlink" title="ç»“æœï¼š"></a>ç»“æœï¼š</h3><pre class="line-numbers language-none"><code class="language-none">--------å¼€æœº START--------Windowsç”µè„‘å¼€å¯ç”µæºWindowsç”µè„‘æ£€æŸ¥ç¡¬ä»¶Windowsç”µè„‘è½½å…¥æ“ä½œç³»ç»Ÿ-------- å¼€æœº END ----------------å¼€æœº START--------Macç”µè„‘å¼€å¯ç”µæºMacç”µè„‘æ£€æŸ¥ç¡¬ä»¶Macç”µè„‘è½½å…¥æ“ä½œç³»ç»ŸMacç”µè„‘ç™»å½•-------- å¼€æœº END --------1234567891011<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Android-æºç ä¸­çš„æ¨¡æ¿æ–¹æ³•æ¨¡å¼"><a href="#Android-æºç ä¸­çš„æ¨¡æ¿æ–¹æ³•æ¨¡å¼" class="headerlink" title="Android æºç ä¸­çš„æ¨¡æ¿æ–¹æ³•æ¨¡å¼"></a>Android æºç ä¸­çš„æ¨¡æ¿æ–¹æ³•æ¨¡å¼</h2><h3 id="AsyncTask"><a href="#AsyncTask" class="headerlink" title="AsyncTask"></a>AsyncTask</h3><p>åœ¨ä½¿ç”¨ AsyncTask æ—¶ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“æŠŠè€—æ—¶æ“ä½œæ”¾åˆ° doInBackground(Paramsâ€¦ params)ä¸­ï¼Œåœ¨ doInBackground ä¹‹å‰ï¼Œå¦‚æœæƒ³åšä¸€äº›åˆå§‹åŒ–æ“ä½œï¼Œå¯ä»¥æŠŠå®ç°å†™åœ¨ onPreExecute ä¸­ï¼Œå½“ doInBackground æ‰§è¡Œå®Œåä¼šæ‰§è¡Œ onPostExecute æ–¹æ³•ï¼Œè€Œæˆ‘ä»¬åªéœ€è¦æ„å»º AsyncTask å¯¹è±¡ï¼Œç„¶åæ‰§è¡Œ execute æ–¹æ³•ã€‚</p><h3 id="Activity-çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#Activity-çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Activity çš„ç”Ÿå‘½å‘¨æœŸ"></a>Activity çš„ç”Ÿå‘½å‘¨æœŸ</h3><p>ActivityThread çš„ main å‡½æ•°è¢«è°ƒç”¨åï¼Œä¾æ¬¡æ‰§è¡Œ Activity çš„ onCreateã€onStartã€onResume å‡½æ•°ï¼Œç”¨æˆ·é€šå¸¸åœ¨ Activity çš„å­ç±»ä¸­è¦†å†™ onCreate æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨è¯¥æ–¹æ³•ä¸­è°ƒç”¨ setContentView æ¥è®¾ç½®å¸ƒå±€ã€‚</p><h2 id="ä¸å…¶ä»–æ¨¡å¼åŒºåˆ«"><a href="#ä¸å…¶ä»–æ¨¡å¼åŒºåˆ«" class="headerlink" title="ä¸å…¶ä»–æ¨¡å¼åŒºåˆ«"></a>ä¸å…¶ä»–æ¨¡å¼åŒºåˆ«</h2><ul><li>ï¼ˆ1ï¼‰å·¥å‚æ–¹æ³•æ˜¯æ¨¡æ¿æ–¹æ³•çš„ä¸€ç§ç‰¹æ®Šç‰ˆæœ¬ã€‚</li><li>ï¼ˆ2ï¼‰ç­–ç•¥æ¨¡å¼å’Œæ¨¡æ¿æ–¹æ³•æ¨¡å¼éƒ½æ˜¯å°è£…ç®—æ³•ï¼Œä¸€ä¸ªç”¨ç»„åˆï¼Œä¸€ä¸ªç”¨ç»§æ‰¿ã€‚</li><li>ï¼ˆ3ï¼‰ç­–ç•¥æ¨¡å¼å’Œæ¨¡æ¿æ¨¡å¼é€šå¸¸å¯ä»¥äº’ç›¸æ›¿æ¢ã€‚å®ƒä»¬éƒ½åƒè¯•å·ï¼Œç­–ç•¥æ¨¡å¼æ˜¯é€‰æ‹©é¢˜ï¼Œæ¨¡æ¿æ¨¡å¼æ˜¯å¡«ç©ºé¢˜ã€‚</li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><blockquote><p>æ¨¡æ¿æ–¹æ³•æ¨¡å¼ç”¨ 4 ä¸ªå­—æ¦‚æ‹¬å°±æ˜¯ï¼šæµç¨‹å°è£…ã€‚ä¹Ÿå°±æ˜¯æŠŠæŸä¸ªå›ºå®šçš„æµç¨‹å°è£…åˆ°ä¸€ä¸ª final æ–¹æ³•ä¸­ï¼Œå¹¶ä¸”è®©å­ç±»èƒ½å¤Ÿå®šåˆ¶è¿™ä¸ªæµç¨‹ä¸­çš„æŸäº›æˆ–è€…æ‰€æœ‰æ­¥éª¤ï¼Œè¿™å°±è¦æ±‚çˆ¶ç±»æå–å…¬ç”¨çš„ä»£ç ï¼Œæå‡ä»£ç çš„å¤ç”¨ç‡ï¼ŒåŒæ—¶å¸¦æ¥äº†æ›´å¥½çš„å¯æ‰©å±•æ€§ã€‚</p></blockquote><ol><li><p>ä¼˜ç‚¹</p><ul><li>ï¼ˆ1ï¼‰å°è£…ä¸å˜éƒ¨åˆ†ï¼Œæ‰©å±•å¯å˜éƒ¨åˆ†ã€‚</li><li>ï¼ˆ2ï¼‰æå–å…¬å…±éƒ¨åˆ†ä»£ç ï¼Œä¾¿äºç»´æŠ¤ã€‚</li></ul></li><li><p>ç¼ºç‚¹</p><ul><li>éœ€è¦ä¸ºæ¯ä¸€ä¸ªåŸºæœ¬æ–¹æ³•çš„ä¸åŒå®ç°æä¾›ä¸€ä¸ªå­ç±»ï¼Œå¦‚æœçˆ¶ç±»ä¸­å¯å˜çš„åŸºæœ¬æ–¹æ³•å¤ªå¤šï¼Œå°†ä¼šå¯¼è‡´ç±»çš„ä¸ªæ•°å¢åŠ ï¼Œç³»ç»Ÿæ›´åŠ åºå¤§ï¼Œè®¾è®¡ä¹Ÿæ›´åŠ æŠ½è±¡ï¼Œæ­¤æ—¶ï¼Œå¯ç»“åˆæ¡¥æ¥æ¨¡å¼æ¥è¿›è¡Œè®¾è®¡ã€‚</li></ul></li></ol><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="http://www.cnblogs.com/lzhp/p/3404514.html"> æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼ˆHead first è®¾è®¡æ¨¡å¼â€”â€”7ï¼‰</a></li><li><a href="http://blog.csdn.net/zhengzhb/article/details/7405608"> æ¨¡æ¿æ–¹æ³•æ¨¡å¼</a></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Java </tag>
            
            <tag> DesignPattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - ç»„åˆæ¨¡å¼</title>
      <link href="/20170318/designpattern-structure-composite/"/>
      <url>/20170318/designpattern-structure-composite/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-ç»„åˆæ¨¡å¼"><a href="#ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-ç»„åˆæ¨¡å¼" class="headerlink" title="ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - ç»„åˆæ¨¡å¼"></a>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - ç»„åˆæ¨¡å¼</h1><blockquote><p>ç»„åˆæ¨¡å¼ä¹Ÿç§°ä¸ºéƒ¨åˆ†-æ•´ä½“æ¨¡å¼ï¼Œç»“æ„å‹è®¾è®¡æ¨¡å¼ä¹‹ä¸€ã€‚ç»„åˆæ¨¡å¼æ¯”è¾ƒç®€å•ï¼Œå®ƒå°†ä¸€ç»„ç›¸ä¼¼çš„å¯¹è±¡å½“ä½œä¸€ä¸ªå¯¹è±¡å¤„ç†ï¼Œå¹¶æ ¹æ®æ ‘çŠ¶ç»“æ„æ¥ç»„åˆå¯¹è±¡<br>å®šä¹‰ï¼šå°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤ºâ€œéƒ¨åˆ†-æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„ï¼Œä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ã€‚</p></blockquote><span id="more"></span><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><ol><li>è¡¨ç¤ºå¯¹è±¡çš„éƒ¨åˆ†-æ•´ä½“å±‚æ¬¡ç»“æ„æ—¶ã€‚</li><li>ä»ä¸€ä¸ªæ•´ä½“ä¸­èƒ½å¤Ÿç‹¬ç«‹å‡ºéƒ¨åˆ†æ¨¡å—æˆ–åŠŸèƒ½çš„åœºæ™¯ã€‚</li></ol><h2 id="UML-ç±»å›¾"><a href="#UML-ç±»å›¾" class="headerlink" title="UML ç±»å›¾"></a>UML ç±»å›¾</h2><h3 id="å®‰å…¨ç»„åˆæ¨¡å¼"><a href="#å®‰å…¨ç»„åˆæ¨¡å¼" class="headerlink" title="å®‰å…¨ç»„åˆæ¨¡å¼"></a>å®‰å…¨ç»„åˆæ¨¡å¼</h3><p><img src="http://blog-1251678165.coscd.myqcloud.com/2018-03-18-composite.png" alt="Composite"></p><ul><li>ï¼ˆ1ï¼‰<code>Component</code>ï¼šæŠ½è±¡æ ¹èŠ‚ç‚¹ï¼Œä¸ºç»„åˆä¸­çš„å¯¹è±¡å£°æ˜æ¥å£ã€‚åœ¨é€‚å½“çš„æƒ…å†µä¸‹ï¼Œå®ç°æ‰€æœ‰ç±»å…±æœ‰æ¥å£çš„ç¼ºçœè¡Œä¸ºã€‚å£°æ˜ä¸€ä¸ªæ¥å£ç”¨äºè®¿é—®å’Œç®¡ç† Component çš„å­èŠ‚ç‚¹ã€‚å¯åœ¨é€’å½’ç»“æ„ä¸­å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œç”¨äºè®¿é—®ä¸€ä¸ªçˆ¶èŠ‚ç‚¹ï¼Œå¹¶åœ¨åˆé€‚çš„æƒ…å†µä¸‹å®ç°å®ƒã€‚</li><li>ï¼ˆ2ï¼‰<code>Composite</code>ï¼šå®šä¹‰æœ‰å­èŠ‚ç‚¹çš„é‚£äº›æå¹²èŠ‚ç‚¹è¡Œä¸ºï¼Œå­˜å‚¨å­èŠ‚ç‚¹ï¼Œåœ¨ Component æ¥å£ä¸­å®ç°ä¸å­èŠ‚ç‚¹æœ‰å…³çš„æ“ä½œã€‚</li><li>ï¼ˆ3ï¼‰<code>Leaf</code>ï¼šåœ¨ç»„åˆä¸­è¡¨ç¤ºå¶å­èŠ‚ç‚¹å¯¹è±¡ï¼Œå¶å­èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹ï¼Œåœ¨ç»„åˆä¸­å®šä¹‰èŠ‚ç‚¹å¯¹è±¡çš„è¡Œä¸ºã€‚</li><li>ï¼ˆ4ï¼‰<code>Client</code>ï¼šé€šè¿‡ Component æ¥å£æ“çºµç»„åˆèŠ‚ç‚¹çš„å¯¹è±¡ã€‚</li></ul><blockquote><p>å¦‚å›¾è¿™ç§å°†ç»„åˆæ‰€ä½¿ç”¨çš„æ–¹æ³•å…¨éƒ¨å®šä¹‰åœ¨æŠ½è±¡ç±»çš„æ–¹å¼ç§°ä¸º<strong>é€æ˜çš„ç»„åˆæ¨¡å¼</strong>ï¼Œå¦‚æœå°† Component ä¸­çš„ Addã€Removeã€GetChild å»é™¤ï¼Œåªåœ¨ Composite ä¸­å•ç‹¬æ·»åŠ ï¼Œè¿™ç§æ–¹å¼ç§°ä¸º<strong>å®‰å…¨çš„ç»„åˆæ¨¡å¼</strong>ã€‚ç„¶è€Œåè€…è¿èƒŒäº†ä¾èµ–å€’ç½®åŸåˆ™ã€‚</p></blockquote><p>é€šç”¨ç»„åˆæ‘¸åº•ä»£ç </p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/17. * &lt;p&gt; * desc: æŠ½è±¡æ ¹èŠ‚ç‚¹ï¼Œä¸ºç»„åˆä¸­çš„å¯¹è±¡å£°æ˜æ¥å£ã€‚åœ¨é€‚å½“çš„æƒ…å†µä¸‹ï¼Œå®ç°æ‰€æœ‰ç±»å…±æœ‰æ¥å£çš„ç¼ºçœè¡Œä¸º */</span><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>    <span class="token keyword">protected</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Component</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * éœ€è¦å­ç±»å®ç°     */</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/3/17. * &lt;p&gt; * desc: å…·ä½“åˆ†æ”¯èŠ‚ç‚¹ï¼Œå®šä¹‰æœ‰å­èŠ‚ç‚¹è¡Œä¸º */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Composite</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>    <span class="token comment">/**     * å­˜å‚¨èŠ‚ç‚¹å®¹å™¨     */</span>    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Component</span><span class="token punctuation">&gt;</span></span> mComponentList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Composite</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>mComponentList <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Component</span> component <span class="token operator">:</span> mComponentList<span class="token punctuation">)</span> <span class="token punctuation">{</span>                component<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * æ·»åŠ å­èŠ‚ç‚¹     * @param component å­èŠ‚ç‚¹     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addChild</span><span class="token punctuation">(</span><span class="token class-name">Component</span> component<span class="token punctuation">)</span> <span class="token punctuation">{</span>        mComponentList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * ç§»é™¤å­èŠ‚ç‚¹     * @param component å­èŠ‚ç‚¹     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeChild</span><span class="token punctuation">(</span><span class="token class-name">Component</span> component<span class="token punctuation">)</span> <span class="token punctuation">{</span>        mComponentList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * è·å–å­èŠ‚ç‚¹     * @param index å­èŠ‚ç‚¹ä¸‹æ ‡     * @return å­èŠ‚ç‚¹     */</span>    <span class="token keyword">public</span> <span class="token class-name">Component</span> <span class="token function">getChildren</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> mComponentList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: å…·ä½“å¶å­èŠ‚ç‚¹ï¼Œå¶å­èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹ï¼Œåœ¨ç»„åˆä¸­å®šä¹‰èŠ‚ç‚¹å¯¹è±¡çš„è¡Œä¸º */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Leaf</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token class-name">Leaf</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: é€šè¿‡Componentæ¥å£æ“çºµç»„åˆèŠ‚ç‚¹çš„å¯¹è±¡ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//æ„é€ ä¸€ä¸ªæ ¹èŠ‚ç‚¹</span>        <span class="token class-name">Composite</span> root <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Composite</span><span class="token punctuation">(</span><span class="token string">"Root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//æ„é€ ä¸¤ä¸ªåˆ†æ”¯å­èŠ‚ç‚¹</span>        <span class="token class-name">Composite</span> branch1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Composite</span><span class="token punctuation">(</span><span class="token string">"Branch1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Composite</span> branch2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Composite</span><span class="token punctuation">(</span><span class="token string">"Branch2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//æ„é€ ä¸¤ä¸ªå¶å­èŠ‚ç‚¹</span>        <span class="token class-name">Leaf</span> leaf1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Leaf</span><span class="token punctuation">(</span><span class="token string">"Leaf1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Leaf</span> leaf2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Leaf</span><span class="token punctuation">(</span><span class="token string">"Leaf2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å°†å¶å­èŠ‚ç‚¹æ·»åŠ åˆ°åˆ†æ”¯å­èŠ‚ç‚¹</span>        branch1<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>leaf1<span class="token punctuation">)</span><span class="token punctuation">;</span>        branch2<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>leaf2<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å°†åˆ†æ”¯å­èŠ‚ç‚¹æ·»åŠ åˆ°æ ¹èŠ‚ç‚¹</span>        root<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>branch1<span class="token punctuation">)</span><span class="token punctuation">;</span>        root<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>branch2<span class="token punctuation">)</span><span class="token punctuation">;</span>        root<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="é€æ˜ç»„åˆæ¨¡å¼"><a href="#é€æ˜ç»„åˆæ¨¡å¼" class="headerlink" title="é€æ˜ç»„åˆæ¨¡å¼"></a>é€æ˜ç»„åˆæ¨¡å¼</h3><p>ä¸Šé¢å®‰å…¨ç»„åˆæ¨¡å¼ä¸ä¾èµ–å€’ç½®åŸåˆ™ç›¸è¿èƒŒï¼Œæ‰€å®šä¹‰çš„æŠ½è±¡ Component åœ¨è¿™é‡Œçš„ä½œç”¨ä¸å¤§ï¼Œæ—¢ç„¶æ˜¯é¢å‘æ¥å£ç¼–ç¨‹ï¼Œé‚£ä¹ˆæ›´å¤šçš„åº”è¯¥æ˜¯å®Œå–„æ¥å£è®¾è®¡ï¼Œå¯¹ä¸Šé¢çš„æ¥å£åšä¸€äº›ä¿®æ”¹ï¼š<br><img src="http://blog-1251678165.coscd.myqcloud.com/2018-03-18-composite-transparent.png"></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/17. * &lt;p&gt; * desc: æŠ½è±¡æ ¹èŠ‚ç‚¹ï¼Œä¸ºç»„åˆä¸­çš„å¯¹è±¡å£°æ˜æ¥å£ã€‚åœ¨é€‚å½“çš„æƒ…å†µä¸‹ï¼Œå®ç°æ‰€æœ‰ç±»å…±æœ‰æ¥å£çš„ç¼ºçœè¡Œä¸º */</span><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>    <span class="token keyword">protected</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Component</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * å…·ä½“ç”±å­ç±»å®ç°     */</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * æ·»åŠ å­èŠ‚ç‚¹     *     * @param child å­èŠ‚ç‚¹     */</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">addChild</span><span class="token punctuation">(</span><span class="token class-name">Component</span> child<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * ç§»é™¤å­èŠ‚ç‚¹     *     * @param child å­èŠ‚ç‚¹     */</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">removeChild</span><span class="token punctuation">(</span><span class="token class-name">Component</span> child<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * è·å–å­èŠ‚ç‚¹     *     * @param index å­èŠ‚ç‚¹ä¸‹æ ‡     * @return å­èŠ‚ç‚¹     */</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token class-name">Component</span> <span class="token function">getChildren</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/3/17. * &lt;p&gt; * desc: å…·ä½“åˆ†æ”¯èŠ‚ç‚¹ï¼Œå®šä¹‰æœ‰å­èŠ‚ç‚¹è¡Œä¸º */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Composite</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>    <span class="token comment">/**     * å­˜å‚¨èŠ‚ç‚¹å®¹å™¨     */</span>    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Component</span><span class="token punctuation">&gt;</span></span> mComponentList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Composite</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>mComponentList <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Component</span> component <span class="token operator">:</span> mComponentList<span class="token punctuation">)</span> <span class="token punctuation">{</span>                component<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addChild</span><span class="token punctuation">(</span><span class="token class-name">Component</span> component<span class="token punctuation">)</span> <span class="token punctuation">{</span>        mComponentList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeChild</span><span class="token punctuation">(</span><span class="token class-name">Component</span> component<span class="token punctuation">)</span> <span class="token punctuation">{</span>        mComponentList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">Component</span> <span class="token function">getChildren</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> mComponentList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: å…·ä½“å¶å­èŠ‚ç‚¹ï¼Œå¶å­èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹ï¼ŒæŸäº›æ“ä½œæŠ›å‡ºå¼‚å¸¸ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Leaf</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token class-name">Leaf</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addChild</span><span class="token punctuation">(</span><span class="token class-name">Component</span> child<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnsupportedOperationException</span><span class="token punctuation">(</span><span class="token string">"å¶å­èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeChild</span><span class="token punctuation">(</span><span class="token class-name">Component</span> child<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnsupportedOperationException</span><span class="token punctuation">(</span><span class="token string">"å¶å­èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">Component</span> <span class="token function">getChildren</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnsupportedOperationException</span><span class="token punctuation">(</span><span class="token string">"å¶å­èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: é€šè¿‡Componentæ¥å£æ“çºµç»„åˆèŠ‚ç‚¹çš„å¯¹è±¡ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//æ„é€ ä¸€ä¸ªæ ¹èŠ‚ç‚¹</span>        <span class="token class-name">Composite</span> root <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Composite</span><span class="token punctuation">(</span><span class="token string">"Root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//æ„é€ ä¸¤ä¸ªåˆ†æ”¯å­èŠ‚ç‚¹</span>        <span class="token class-name">Composite</span> branch1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Composite</span><span class="token punctuation">(</span><span class="token string">"Branch1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Composite</span> branch2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Composite</span><span class="token punctuation">(</span><span class="token string">"Branch2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//æ„é€ ä¸¤ä¸ªå¶å­èŠ‚ç‚¹</span>        <span class="token class-name">Leaf</span> leaf1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Leaf</span><span class="token punctuation">(</span><span class="token string">"Leaf1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Leaf</span> leaf2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Leaf</span><span class="token punctuation">(</span><span class="token string">"Leaf2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å°†å¶å­èŠ‚ç‚¹æ·»åŠ åˆ°åˆ†æ”¯å­èŠ‚ç‚¹</span>        branch1<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>leaf1<span class="token punctuation">)</span><span class="token punctuation">;</span>        branch2<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>leaf2<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å°†åˆ†æ”¯å­èŠ‚ç‚¹æ·»åŠ åˆ°æ ¹èŠ‚ç‚¹</span>        root<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>branch1<span class="token punctuation">)</span><span class="token punctuation">;</span>        root<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>branch2<span class="token punctuation">)</span><span class="token punctuation">;</span>        root<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç®€å•å®ç°"><a href="#ç®€å•å®ç°" class="headerlink" title="ç®€å•å®ç°"></a>ç®€å•å®ç°</h2><blockquote><p>ä»¥æ–‡ä»¶ç³»ç»Ÿä¸ºä¾‹ï¼Œæ–‡ä»¶ç³»ç»ŸåŒ…å«æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼Œè€Œæ–‡ä»¶å¤¹ä¹Ÿå¯ä»¥åŒ…å«æ–‡ä»¶ã€‚</p></blockquote><h3 id="æ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„æŠ½è±¡ç±»ï¼šï¼ˆComponentï¼‰"><a href="#æ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„æŠ½è±¡ç±»ï¼šï¼ˆComponentï¼‰" class="headerlink" title="æ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„æŠ½è±¡ç±»ï¼šï¼ˆComponentï¼‰"></a>æ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„æŠ½è±¡ç±»ï¼šï¼ˆComponentï¼‰</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: è¡¨ç¤ºæ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„æŠ½è±¡ç±»(Componentè§’è‰²) */</span><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Dir</span> <span class="token punctuation">{</span>    <span class="token comment">//ç”³æ˜Listæˆå‘˜å˜é‡å­˜å‚¨æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰å…ƒç´ </span>    <span class="token keyword">protected</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dir</span><span class="token punctuation">&gt;</span></span> mDirList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//æ–‡ä»¶åæˆ–è€…æ–‡ä»¶å¤¹åç§°</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Dir</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * æ·»åŠ ä¸€ä¸ªæ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹     *     * @param dir æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹     */</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">addDir</span><span class="token punctuation">(</span><span class="token class-name">Dir</span> dir<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * åˆ é™¤æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹     *     * @param dir æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹     */</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">removeDir</span><span class="token punctuation">(</span><span class="token class-name">Dir</span> dir<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * æƒ…å†µæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰å…ƒç´      */</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * è¾“å‡ºæ–‡ä»¶å¤¹ç›®å½•ç»“æ„     */</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * è·å–æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰çš„æ–‡ä»¶å’Œå­æ–‡ä»¶å¤¹     *     * @return æ–‡ä»¶å’Œå­æ–‡ä»¶å¤¹     */</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dir</span><span class="token punctuation">&gt;</span></span> <span class="token function">getFiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> name<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è¡¨ç¤ºæ–‡ä»¶å¤¹çš„ç±»ï¼šï¼ˆCompositeï¼‰"><a href="#è¡¨ç¤ºæ–‡ä»¶å¤¹çš„ç±»ï¼šï¼ˆCompositeï¼‰" class="headerlink" title="è¡¨ç¤ºæ–‡ä»¶å¤¹çš„ç±»ï¼šï¼ˆCompositeï¼‰"></a>è¡¨ç¤ºæ–‡ä»¶å¤¹çš„ç±»ï¼šï¼ˆCompositeï¼‰</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: æ–‡ä»¶å¤¹ç±»(Compositeè§’è‰²) */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Folder</span> <span class="token keyword">extends</span> <span class="token class-name">Dir</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token class-name">Folder</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addDir</span><span class="token punctuation">(</span><span class="token class-name">Dir</span> dir<span class="token punctuation">)</span> <span class="token punctuation">{</span>        mDirList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>dir<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeDir</span><span class="token punctuation">(</span><span class="token class-name">Dir</span> dir<span class="token punctuation">)</span> <span class="token punctuation">{</span>        mDirList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>dir<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        mDirList<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"("</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dir</span><span class="token punctuation">&gt;</span></span> iterator <span class="token operator">=</span> mDirList<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token class-name">Dir</span> dir <span class="token operator">=</span> iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            dir<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dir</span><span class="token punctuation">&gt;</span></span> <span class="token function">getFiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> mDirList<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è¡¨ç¤ºæ–‡ä»¶å¤¹çš„ç±»ï¼šï¼ˆLeafï¼‰"><a href="#è¡¨ç¤ºæ–‡ä»¶å¤¹çš„ç±»ï¼šï¼ˆLeafï¼‰" class="headerlink" title="è¡¨ç¤ºæ–‡ä»¶å¤¹çš„ç±»ï¼šï¼ˆLeafï¼‰"></a>è¡¨ç¤ºæ–‡ä»¶å¤¹çš„ç±»ï¼šï¼ˆLeafï¼‰</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: æ–‡ä»¶ç±»(Leafè§’è‰²) */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">File</span> <span class="token keyword">extends</span> <span class="token class-name">Dir</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addDir</span><span class="token punctuation">(</span><span class="token class-name">Dir</span> dir<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnsupportedOperationException</span><span class="token punctuation">(</span><span class="token string">"æ–‡ä»¶ä¸æ”¯æŒè¯¥æ“ä½œ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeDir</span><span class="token punctuation">(</span><span class="token class-name">Dir</span> dir<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnsupportedOperationException</span><span class="token punctuation">(</span><span class="token string">"æ–‡ä»¶ä¸æ”¯æŒè¯¥æ“ä½œ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnsupportedOperationException</span><span class="token punctuation">(</span><span class="token string">"æ–‡ä»¶ä¸æ”¯æŒè¯¥æ“ä½œ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dir</span><span class="token punctuation">&gt;</span></span> <span class="token function">getFiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnsupportedOperationException</span><span class="token punctuation">(</span><span class="token string">"æ–‡ä»¶ä¸æ”¯æŒè¯¥æ“ä½œ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å®¢æˆ·æµ‹è¯•ç±»ï¼š"><a href="#å®¢æˆ·æµ‹è¯•ç±»ï¼š" class="headerlink" title="å®¢æˆ·æµ‹è¯•ç±»ï¼š"></a>å®¢æˆ·æµ‹è¯•ç±»ï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: æµ‹è¯• */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//æ„é€ ä¸€ä¸ªç›®å½•è¡¨ç¤ºSDå¡æ ¹ç›®å½•</span>        <span class="token class-name">Dir</span> sdCard <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Folder</span><span class="token punctuation">(</span><span class="token string">"Storage"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//SDå¡ä¸‹æœ‰ä¸€ä¸ªæ–‡ä»¶"è®¾è®¡æ¨¡å¼.pdf"</span>        sdCard<span class="token punctuation">.</span><span class="token function">addDir</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"è®¾è®¡æ¨¡å¼.pdf"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//SDå¡ä¸‹æœ‰3ä¸ªå­æ–‡ä»¶å¤¹"ADM", "Android", "Books"</span>        <span class="token class-name">Dir</span> adm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Folder</span><span class="token punctuation">(</span><span class="token string">"ADM"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        adm<span class="token punctuation">.</span><span class="token function">addDir</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"google.html"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        sdCard<span class="token punctuation">.</span><span class="token function">addDir</span><span class="token punctuation">(</span>adm<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Dir</span> an <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Folder</span><span class="token punctuation">(</span><span class="token string">"Android"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        an<span class="token punctuation">.</span><span class="token function">addDir</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"cache.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        sdCard<span class="token punctuation">.</span><span class="token function">addDir</span><span class="token punctuation">(</span>an<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Dir</span> books <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Folder</span><span class="token punctuation">(</span><span class="token string">"Books"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        books<span class="token punctuation">.</span><span class="token function">addDir</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"è·³æ§½æŒ‡å—.md"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        sdCard<span class="token punctuation">.</span><span class="token function">addDir</span><span class="token punctuation">(</span>books<span class="token punctuation">)</span><span class="token punctuation">;</span>        sdCard<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è¾“å‡ºç»“æœï¼š"><a href="#è¾“å‡ºç»“æœï¼š" class="headerlink" title="è¾“å‡ºç»“æœï¼š"></a>è¾“å‡ºç»“æœï¼š</h3><pre class="line-numbers language-none"><code class="language-none">Storage(è®¾è®¡æ¨¡å¼.pdf, ADM(google.html), Android(cache.txt), Books(è·³æ§½æŒ‡å—.md))<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Android-æºç ä¸­çš„æ¨¡å¼å®ç°"><a href="#Android-æºç ä¸­çš„æ¨¡å¼å®ç°" class="headerlink" title="Android æºç ä¸­çš„æ¨¡å¼å®ç°"></a>Android æºç ä¸­çš„æ¨¡å¼å®ç°</h2><ul><li>View å’Œ ViewGroup çš„åµŒå¥—ç»„åˆ</li></ul><p>View å’Œ ViewGroup çš„ç»“æ„å¾ˆåƒä¸Šé¢çš„ UML ç±»å›¾ï¼Œä¸è¿‡ View çš„è§†å›¾å±‚çº§ä½¿ç”¨çš„æ˜¯å®‰å…¨çš„ç»„åˆæ¨¡å¼ã€‚ViewGroup æœ‰å¯¹ View çš„ addViewã€removeViewã€getChildAt ç­‰æ–¹æ³•ï¼Œæƒ³å¿…å¤§å®¶ä¹Ÿå¾ˆç†Ÿæ‚‰ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol><li><p>ä¼˜ç‚¹</p><ul><li>ï¼ˆ1ï¼‰ç»„åˆæ¨¡å¼å¯ä»¥æ¸…æ¥šåœ°å®šä¹‰åˆ†å±‚æ¬¡çš„å¤æ‚å¯¹è±¡ï¼Œè¡¨ç¤ºå¯¹è±¡çš„å…¨éƒ¨æˆ–éƒ¨åˆ†å±‚æ¬¡ï¼Œä»–è®©é«˜å±‚æ¨¡å—å¿½ç•¥äº†å±‚æ¬¡çš„å·®å¼‚ï¼Œæ–¹ä¾¿å¯¹æ•´ä¸ªå±‚æ¬¡ç»“æ„è¿›è¡Œæ§åˆ¶ã€‚</li><li>ï¼ˆ2ï¼‰ç®€åŒ–äº†é«˜å±‚æ¨¡å—çš„ä»£ç ã€‚</li><li>ï¼ˆ3ï¼‰åœ¨ç»„åˆæ¨¡å¼ä¸­å¢åŠ æ–°çš„æå¹²æ„ä»¶å’Œå¶å­æ„ä»¶éƒ½å¾ˆæ–¹ä¾¿ï¼Œæ— é¡»å¯¹ç°æœ‰ç±»åº“è¿›è¡Œä¿®æ”¹ï¼Œç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚</li><li>ï¼ˆ4ï¼‰å¯¹æ ‘å½¢ç»“æ„çš„æ§åˆ¶å˜å¾—ç®€å•ã€‚</li></ul></li><li><p>ç¼ºç‚¹</p><ul><li>ç»„åˆæ¨¡å¼ä¸å®¹æ˜“é™åˆ¶ç»„åˆä¸­çš„æ„ä»¶ã€‚å› ä¸ºå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå®ƒä»¬éƒ½æ¥è‡ªäºç›¸åŒçš„æŠ½è±¡å±‚ï¼Œæ­¤æ—¶ï¼Œå¿…é¡»è¿›è¡Œç±»å‹æ£€æŸ¥æ¥å®ç°ï¼Œè¿™ä¸ªå®ç°è¿‡ç¨‹è¾ƒä¸ºå¤æ‚ã€‚</li></ul></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Java </tag>
            
            <tag> DesignPattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - æ¡¥æ¥æ¨¡å¼</title>
      <link href="/20170318/designpattern-structure-bridge/"/>
      <url>/20170318/designpattern-structure-bridge/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-æ¡¥æ¥æ¨¡å¼"><a href="#ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-æ¡¥æ¥æ¨¡å¼" class="headerlink" title="ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - æ¡¥æ¥æ¨¡å¼"></a>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - æ¡¥æ¥æ¨¡å¼</h1><blockquote><p>æ¡¥æ¥æ¨¡å¼ä¹Ÿç§°ä¸ºæ¡¥æ¢æ¨¡å¼ï¼Œæ˜¯ç»“æ„å‹è®¾è®¡æ¨¡å¼ä¹‹ä¸€ã€‚æ¡¥æ¥æ¨¡å¼ä¸­ä½“ç°äº†â€œå•ä¸€èŒè´£åŸåˆ™â€ã€â€œå¼€é—­åŸåˆ™â€ã€â€œé‡Œæ°æ›¿æ¢åŸåˆ™â€ã€â€œä¾èµ–å€’ç½®åŸåˆ™â€ç­‰ï¼ŒåŒæ—¶å®ƒä¹Ÿæ˜¯å¾ˆå®ç”¨çš„ä¸€ç§æ¨¡å¼ã€‚<br><strong>å®šä¹‰</strong>ï¼šå°†æŠ½è±¡éƒ¨åˆ† ä¸ å®ç°éƒ¨åˆ† åˆ†ç¦»ï¼Œä½¿å®ƒä»¬éƒ½å¯ä»¥ç‹¬ç«‹åœ°è¿›è¡Œå˜åŒ–ã€‚</p></blockquote><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><ul><li>ï¼ˆ1ï¼‰å¦‚æœä¸€ä¸ªç³»ç»Ÿéœ€è¦åœ¨æ„å»ºçš„æŠ½è±¡åŒ–è§’è‰²å’Œå…·ä½“è§’è‰²ä¹‹é—´å¢åŠ æ›´å¤šçš„çµæ´»æ€§ï¼Œé¿å…åœ¨ä¸¤ä¸ªå±‚æ¬¡ä¹‹é—´å»ºç«‹é™æ€çš„ç»§æ‰¿è”ç³»ã€‚</li><li>ï¼ˆ2ï¼‰å¯¹äºé‚£äº›ä¸å¸Œæœ›ä½¿ç”¨ç»§æ‰¿æˆ–å› ä¸ºå¤šå±‚æ¬¡ç»§æ‰¿å¯¼è‡´ç³»ç»Ÿç±»çš„ä¸ªæ•°æ€¥å‰§å¢åŠ çš„ç³»ç»Ÿï¼Œä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨æ¡¥æ¥æ¨¡å¼ã€‚</li><li>ï¼ˆ3ï¼‰ä¸€ä¸ªç±»å­˜åœ¨ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦ï¼Œä¸”è¿™ä¸¤ä¸ªç»´åº¦éƒ½éœ€è¦æ‰©å±•ã€‚</li></ul><h2 id="UML-ç±»å›¾"><a href="#UML-ç±»å›¾" class="headerlink" title="UML ç±»å›¾"></a>UML ç±»å›¾</h2><p><img src="http://blog-1251678165.coscd.myqcloud.com/2018-03-18-Bridge.png" alt="Bridge"></p><ul><li>ï¼ˆ1ï¼‰<code>Abstraction</code>ï¼šæŠ½è±¡éƒ¨åˆ†ï¼Œè¯¥ç±»ä¿æŒä¸€ä¸ªå¯¹å®ç°éƒ¨åˆ†å¯¹è±¡çš„å¼•ç”¨ï¼ŒæŠ½è±¡éƒ¨åˆ†ä¸­çš„æ–¹æ³•éœ€è¦è°ƒç”¨å®ç°éƒ¨åˆ†çš„å¯¹è±¡æ¥å®ç°ï¼Œè¯¥ç±»ä¸€èˆ¬ä¸ºæŠ½è±¡ç±»ã€‚</li><li>ï¼ˆ2ï¼‰<code>RefinedAbstraction</code>ï¼šä¼˜åŒ–æŠ½è±¡éƒ¨åˆ†ï¼ŒæŠ½è±¡éƒ¨åˆ†çš„å…·ä½“å®ç°ï¼Œè¯¥ç±»ä¸€èˆ¬æ˜¯å¯¹æŠ½è±¡éƒ¨åˆ†çš„æ–¹æ³•è¿›è¡Œå®Œå–„å’Œæ‰©å±•ã€‚</li><li>ï¼ˆ3ï¼‰<code>Implementor</code>ï¼šå®ç°éƒ¨åˆ†ã€‚å¯ä»¥ä¸ºæ¥å£æˆ–æŠ½è±¡ç±»ï¼Œå…¶æ–¹æ³•ä¸ä¸€å®šè¦ä¸æŠ½è±¡éƒ¨åˆ†ä¸­çš„ä¸€è‡´ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ˜¯ç”±ç°å®éƒ¨åˆ†æä¾›åŸºæœ¬æ“ä½œï¼Œè€ŒæŠ½è±¡éƒ¨åˆ†å®šä¹‰çš„åˆ™æ˜¯åŸºäºå®ç°éƒ¨åˆ†è¿™äº›åŸºæœ¬æ“ä½œçš„ä¸šåŠ¡æ–¹æ³•ã€‚</li><li>ï¼ˆ4ï¼‰<code>ConcreteImplementorA</code>ã€<code>ConcreteImplementorB</code>ï¼šå®ç°éƒ¨åˆ†çš„å…·ä½“å®ç°ã€‚å®Œå–„å®ç°éƒ¨åˆ†ä¸­çš„æ–¹æ³•å®šä¹‰çš„å…·ä½“é€»è¾‘ã€‚</li></ul><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: å®ç°éƒ¨åˆ†çš„æŠ½è±¡æ¥å£ */public interface Implementor {    /**     * å®ç°éƒ¨åˆ†çš„æ¥å£æ–¹æ³•     */    void operationImpl();}/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: å®ç°éƒ¨åˆ†çš„å…·ä½“å®ç° */public class ConcreteImplementorA implements Implementor {    @Override    public void operationImpl() {        // å®ç°éƒ¨åˆ†çš„å…·ä½“å®ç°    }}/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: æŠ½è±¡éƒ¨åˆ†çš„æŠ½è±¡ç±» */public abstract class Abstraction {    //å®ç°éƒ¨åˆ†çš„å¼•ç”¨    private Implementor mImplementor;    /**     * é€šè¿‡å®ç°éƒ¨åˆ†çš„å¯¹è±¡å¼•ç”¨æ„é€ æŠ½è±¡éƒ¨åˆ†çš„å¯¹è±¡     * @param implementor å®ç°éƒ¨åˆ†å¯¹è±¡å¼•ç”¨     */    public Abstraction(Implementor implementor) {        mImplementor = implementor;    }    /**     * è°ƒç”¨å®ç°éƒ¨åˆ†çš„å…·ä½“æ–¹æ³•å®ç°     */    public void operation() {        mImplementor.operationImpl();    }}/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: æŠ½è±¡éƒ¨åˆ†çš„å­ç±» */public class RefineAbstraction extends Abstraction {    /**     * é€šè¿‡å®ç°éƒ¨åˆ†çš„å¯¹è±¡å¼•ç”¨æ„é€ æŠ½è±¡éƒ¨åˆ†çš„å¯¹è±¡     *     * @param implementor å®ç°éƒ¨åˆ†å¯¹è±¡å¼•ç”¨     */    public RefineAbstraction(Implementor implementor) {        super(implementor);    }    public void refineOperation() {        //å¯¹Abstractionæ–¹æ³•è¿›è¡Œæ‰©å±•    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç®€å•å®ç°"><a href="#ç®€å•å®ç°" class="headerlink" title="ç®€å•å®ç°"></a>ç®€å•å®ç°</h2><blockquote><p>ä»¥å»å’–å•¡åº—å–å’–å•¡ä¸ºä¾‹ï¼Œæˆ‘ä»¬å‡å®šå’–å•¡æœ‰å¤§æ¯åŠ ç³–ã€å¤§æ¯ä¸åŠ ç³–ã€å°æ¯åŠ ç³–å’Œå°æ¯ä¸åŠ ç³–å››ç§<br>è¿™å››ç§å®è´¨ä¸Šå°±æ˜¯ä¸¤ç§å˜åŒ–ï¼šä¸€æ˜¯å¤§æ¯å°æ¯ï¼ŒäºŒæ˜¯åŠ ç³–ä¸åŠ ç³–</p></blockquote><h3 id="ç»™å’–å•¡æ·»åŠ ä¸œè¥¿çš„æŠ½è±¡ç±»ï¼šï¼ˆImplementorï¼‰"><a href="#ç»™å’–å•¡æ·»åŠ ä¸œè¥¿çš„æŠ½è±¡ç±»ï¼šï¼ˆImplementorï¼‰" class="headerlink" title="ç»™å’–å•¡æ·»åŠ ä¸œè¥¿çš„æŠ½è±¡ç±»ï¼šï¼ˆImplementorï¼‰"></a>ç»™å’–å•¡æ·»åŠ ä¸œè¥¿çš„æŠ½è±¡ç±»ï¼šï¼ˆImplementorï¼‰</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: */</span><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">CoffeeAdditives</span> <span class="token punctuation">{</span>    <span class="token comment">/**     * éœ€è¦å¾€å’–å•¡ä¸­åŠ ä»€ä¹ˆ     * @return å…·ä½“æ·»åŠ çš„ä¸œè¥¿     */</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token class-name">String</span> <span class="token function">addSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="åŠ ç³–ç±»å®ç°ï¼šï¼ˆConcreteImplementorAï¼‰"><a href="#åŠ ç³–ç±»å®ç°ï¼šï¼ˆConcreteImplementorAï¼‰" class="headerlink" title="åŠ ç³–ç±»å®ç°ï¼šï¼ˆConcreteImplementorAï¼‰"></a>åŠ ç³–ç±»å®ç°ï¼šï¼ˆConcreteImplementorAï¼‰</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AddSugar</span> <span class="token keyword">extends</span> <span class="token class-name">CoffeeAdditives</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">addSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token string">"åŠ ç³–"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="åŸå‘³ç±»å®ç°ï¼šï¼ˆConcreteImplementorBï¼‰"><a href="#åŸå‘³ç±»å®ç°ï¼šï¼ˆConcreteImplementorBï¼‰" class="headerlink" title="åŸå‘³ç±»å®ç°ï¼šï¼ˆConcreteImplementorBï¼‰"></a>åŸå‘³ç±»å®ç°ï¼šï¼ˆConcreteImplementorBï¼‰</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Ordinary</span> <span class="token keyword">extends</span> <span class="token class-name">CoffeeAdditives</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">addSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token string">"åŸå‘³"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å’–å•¡ç±»ï¼šï¼ˆAbstractionï¼‰"><a href="#å’–å•¡ç±»ï¼šï¼ˆAbstractionï¼‰" class="headerlink" title="å’–å•¡ç±»ï¼šï¼ˆAbstractionï¼‰"></a>å’–å•¡ç±»ï¼šï¼ˆAbstractionï¼‰</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: */</span><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Coffee</span> <span class="token punctuation">{</span>    <span class="token keyword">protected</span> <span class="token class-name">CoffeeAdditives</span> mAdditives<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Coffee</span><span class="token punctuation">(</span><span class="token class-name">CoffeeAdditives</span> additives<span class="token punctuation">)</span> <span class="token punctuation">{</span>        mAdditives <span class="token operator">=</span> additives<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/**     * å’–å•¡æ¯å¤§å°ç”±å­ç±»å†³å®š     */</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">makeCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å¤§æ¯å’–å•¡ï¼šï¼ˆRefinedAbstractionï¼‰"><a href="#å¤§æ¯å’–å•¡ï¼šï¼ˆRefinedAbstractionï¼‰" class="headerlink" title="å¤§æ¯å’–å•¡ï¼šï¼ˆRefinedAbstractionï¼‰"></a>å¤§æ¯å’–å•¡ï¼šï¼ˆRefinedAbstractionï¼‰</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LargeCoffee</span> <span class="token keyword">extends</span> <span class="token class-name">Coffee</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token class-name">LargeCoffee</span><span class="token punctuation">(</span><span class="token class-name">CoffeeAdditives</span> additives<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>additives<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">makeCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å¤§æ¯çš„"</span> <span class="token operator">+</span> mAdditives<span class="token punctuation">.</span><span class="token function">addSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"å’–å•¡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å°æ¯å’–å•¡ï¼šï¼ˆRefinedAbstractionï¼‰"><a href="#å°æ¯å’–å•¡ï¼šï¼ˆRefinedAbstractionï¼‰" class="headerlink" title="å°æ¯å’–å•¡ï¼šï¼ˆRefinedAbstractionï¼‰"></a>å°æ¯å’–å•¡ï¼šï¼ˆRefinedAbstractionï¼‰</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SmallCoffee</span> <span class="token keyword">extends</span> <span class="token class-name">Coffee</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token class-name">SmallCoffee</span><span class="token punctuation">(</span><span class="token class-name">CoffeeAdditives</span> additives<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>additives<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">makeCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å°æ¯çš„"</span> <span class="token operator">+</span> mAdditives<span class="token punctuation">.</span><span class="token function">addSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"å’–å•¡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æµ‹è¯•ï¼š"><a href="#æµ‹è¯•ï¼š" class="headerlink" title="æµ‹è¯•ï¼š"></a>æµ‹è¯•ï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">AddSugar</span> sugar <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AddSugar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Ordinary</span> ordinary <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Ordinary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å¤§æ¯åŠ ç³–</span>        <span class="token class-name">LargeCoffee</span> largeSugarCoffee <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LargeCoffee</span><span class="token punctuation">(</span>sugar<span class="token punctuation">)</span><span class="token punctuation">;</span>        largeSugarCoffee<span class="token punctuation">.</span><span class="token function">makeCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å¤§æ¯åŸå‘³</span>        <span class="token class-name">LargeCoffee</span> largeOrdinaryCoffee <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LargeCoffee</span><span class="token punctuation">(</span>ordinary<span class="token punctuation">)</span><span class="token punctuation">;</span>        largeOrdinaryCoffee<span class="token punctuation">.</span><span class="token function">makeCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å°æ¯åŠ ç³–</span>        <span class="token class-name">SmallCoffee</span> smallSugarCoffee <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SmallCoffee</span><span class="token punctuation">(</span>sugar<span class="token punctuation">)</span><span class="token punctuation">;</span>        smallSugarCoffee<span class="token punctuation">.</span><span class="token function">makeCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å°æ¯åŸå‘³</span>        <span class="token class-name">SmallCoffee</span> smallOrdinaryCoffee <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SmallCoffee</span><span class="token punctuation">(</span>ordinary<span class="token punctuation">)</span><span class="token punctuation">;</span>        smallOrdinaryCoffee<span class="token punctuation">.</span><span class="token function">makeCoffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç»“æœï¼š"><a href="#ç»“æœï¼š" class="headerlink" title="ç»“æœï¼š"></a>ç»“æœï¼š</h3><pre class="line-numbers language-none"><code class="language-none">å¤§æ¯çš„åŠ ç³–å’–å•¡å¤§æ¯çš„åŸå‘³å’–å•¡å°æ¯çš„åŠ ç³–å’–å•¡å°æ¯çš„åŸå‘³å’–å•¡<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Android-æºç ä¸­çš„æ¡¥æ¥æ¨¡å¼"><a href="#Android-æºç ä¸­çš„æ¡¥æ¥æ¨¡å¼" class="headerlink" title="Android æºç ä¸­çš„æ¡¥æ¥æ¨¡å¼"></a>Android æºç ä¸­çš„æ¡¥æ¥æ¨¡å¼</h3><ul><li>æ¡¥æ¥æ¨¡å¼åœ¨ Android ä¸­åº”ç”¨å¹¿æ³›ï¼Œæ¯”å¦‚ï¼šåœ¨ View çš„è§†å›¾é¡¶å±‚ä¸­ï¼ŒCheckBoxã€CompoundButtonã€Buttonã€TextView å’Œ View ä¹‹é—´æ„æˆä¸€ä¸ªç»§æ‰¿å…³ç³»çš„è§†å›¾å±‚çº§ï¼Œæ¯ä¸€å±‚çº§éƒ½ä»…ä»…æ˜¯å¯¹ä¸€ç§ç±»å‹æ§ä»¶çš„å®ç°ï¼Œå®ƒä»¬å®šä¹‰äº†è¯¥ç±»æ§ä»¶æ‰€æ‹¥æœ‰çš„åŸºæœ¬å±æ€§å’Œè¡Œä¸ºï¼Œä½†æ˜¯çœŸæ­£å°†ä»–ä»¬ç»˜åˆ¶åˆ°å±å¹•çš„éƒ¨åˆ†æ˜¯ç”±ä¸ View ç›¸å…³çš„åŠŸèƒ½å®ç°ç±» DisplayListã€HardwareLayerã€Canvas è´Ÿè´£ã€‚</li><li>å¦å¤–è¿˜æœ‰æ¯”è¾ƒå…¸å‹çš„ Window ä¸ WindowManager<br><img src="http://blog-1251678165.coscd.myqcloud.com/2018-03-18-Window%26WindowManager.png"></li></ul><p>ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">public abstract class Window {   //éƒ¨åˆ†çœç•¥   /**     * Set the window manager for use by this Window to, for example,     * display panels.  This is &lt;em&gt;not&lt;/em&gt; used for displaying the     * Window itself -- that must be done by the client.     *     * @param wm The window manager for adding new windows.     */    public void setWindowManager(WindowManager wm, IBinder appToken, String appName) {        setWindowManager(wm, appToken, appName, false);    }    /**     * Set the window manager for use by this Window to, for example,     * display panels.  This is &lt;em&gt;not&lt;/em&gt; used for displaying the     * Window itself -- that must be done by the client.     *     * @param wm The window manager for adding new windows.     */    public void setWindowManager(WindowManager wm, IBinder appToken, String appName,            boolean hardwareAccelerated) {        mAppToken = appToken;        mAppName = appName;        mHardwareAccelerated = hardwareAccelerated                || SystemProperties.getBoolean(PROPERTY_HARDWARE_UI, false);        if (wm == null) {            wm = (WindowManager)mContext.getSystemService(Context.WINDOW_SERVICE);        }        //*å°†Windowä¸WindowManagerç»‘å®š        mWindowManager = ((WindowManagerImpl)wm).createLocalWindowManager(this);    }    //éƒ¨åˆ†çœç•¥ }<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>Windowï¼š<a href="https://developer.android.com/reference/android/view/Window.html">https://developer.android.com/reference/android/view/Window.html</a><br>WindowManagerï¼š<a href="https://developer.android.com/reference/android/view/WindowManager.html">https://developer.android.com/reference/android/view/WindowManager.html</a></p></blockquote><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol><li>ä¼˜ç‚¹<ul><li>ï¼ˆ1ï¼‰åˆ†ç¦»æŠ½è±¡ä¸ç°å®ã€çµæ´»çš„æ‰©å±•ä»¥åŠå¯¹å®¢æˆ·æ¥è¯´é€æ˜çš„å®ç°ã€‚</li><li>ï¼ˆ2ï¼‰æ¡¥æ¥æ¨¡å¼å¯ä»¥å–ä»£å¤šå±‚ç»§æ‰¿ï¼Œå¤§å¤§å‡å°‘äº†å­ç±»çš„ä¸ªæ•°ã€‚</li></ul></li><li>ç¼ºç‚¹<ul><li>ä¸å®¹æ˜“è®¾è®¡ï¼Œå¯¹å¼€å‘è€…æ¥è¯´è¦æœ‰ä¸€å®šçš„ç»éªŒè¦æ±‚ã€‚ç†è§£å¾ˆå®¹æ˜“ï¼Œè®¾è®¡å´ä¸å®¹æ˜“ã€‚</li></ul></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Java </tag>
            
            <tag> DesignPattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - å¤–è§‚æ¨¡å¼</title>
      <link href="/20170318/designpattern-structure-facade/"/>
      <url>/20170318/designpattern-structure-facade/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-å¤–è§‚æ¨¡å¼"><a href="#ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-å¤–è§‚æ¨¡å¼" class="headerlink" title="ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - å¤–è§‚æ¨¡å¼"></a>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - å¤–è§‚æ¨¡å¼</h1><blockquote><p>å¤–è§‚æ¨¡å¼(Facade)æ˜¯ç»“æ„å‹è®¾è®¡æ¨¡å¼ä¹‹ä¸€ï¼Œå®ƒåœ¨å¼€å‘ä¸­çš„è¿ç”¨é¢‘ç‡éå¸¸é«˜ï¼Œå°¤å…¶æ˜¯åœ¨ SDK æ¨¡å—ä¸Šï¼Œæ˜¯æˆ‘ä»¬å°è£… API çš„å¸¸ç”¨æ‰‹æ®µã€‚æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„ä¸‰æ–¹ SDK åŸºæœ¬éƒ½ä½¿ç”¨çš„å¤–è§‚æ¨¡å¼ï¼Œè¿™æ ·å¯ä»¥å¯¹ç”¨æˆ·å±è”½å¾ˆå¤šå®ç°ç»†èŠ‚ï¼Œé™ä½ç”¨æˆ·ä½¿ç”¨æˆæœ¬ã€‚</p></blockquote><span id="more"></span><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1.å®šä¹‰"></a>1.å®šä¹‰</h2><p>è¦æ±‚ä¸€ä¸ªå­ç³»ç»Ÿçš„å¤–éƒ¨ä¸å…¶å†…éƒ¨çš„é€šä¿¡å¿…é¡»é€šè¿‡ä¸€ä¸ªç»Ÿä¸€çš„å¯¹è±¡è¿›è¡Œã€‚å¤–è§‚æ¨¡å¼æä¾›ä¸€ä¸ªé«˜å±‚æ¬¡çš„æ¥å£ï¼Œä½¿å¾—å­ç³»ç»Ÿæ›´æ˜“äºä½¿ç”¨ã€‚</p><h2 id="2-ä½¿ç”¨åœºæ™¯"><a href="#2-ä½¿ç”¨åœºæ™¯" class="headerlink" title="2.ä½¿ç”¨åœºæ™¯"></a>2.ä½¿ç”¨åœºæ™¯</h2><ul><li>ä¸ºå¤æ‚å­ç³»ç»Ÿæä¾›ä¸€ä¸ªç®€å•æ¥å£ï¼Œå¯¹å¤–éšè—å­ç³»ç»Ÿçš„å…·ä½“å®ç°ã€éš”ç¦»å˜åŒ–ã€‚</li><li>å½“ä½ éœ€è¦æ„å»ºä¸€ä¸ªå±‚æ¬¡ç»“æ„çš„å­ç³»ç»Ÿæ—¶ï¼Œä½¿ç”¨å¤–è§‚æ¨¡å¼å®šä¹‰å­ç³»ç»Ÿä¸­æ¯å±‚çš„å…¥å£ç‚¹ã€‚å¦‚æœå­ç³»ç»Ÿä¹‹é—´æ˜¯ç›¸äº’ä¾èµ–çš„ï¼Œä½ å¯ä»¥è®©å®ƒä»¬ä»…é€šè¿‡å¤–è§‚æ¥å£è¿›è¡Œé€šä¿¡ï¼Œä»è€Œç®€åŒ–äº†å®ƒä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</li></ul><h2 id="3-UML-ç±»å›¾"><a href="#3-UML-ç±»å›¾" class="headerlink" title="3.UML ç±»å›¾"></a>3.UML ç±»å›¾</h2><p><img src="http://blog-1251678165.coscd.myqcloud.com/2018-03-17-Facade-Pattern-1.png"></p><ul><li><code>Facade</code>ï¼šç³»ç»Ÿå¯¹å¤–çš„ç»Ÿä¸€æ¥å£ï¼Œç³»ç»Ÿå†…éƒ¨ç³»ç»Ÿåœ°å·¥ä½œã€‚</li><li><code>å…¶ä»–åˆ†æ”¯</code>ï¼šå­ç³»ç»Ÿæ¥å£ã€‚</li></ul><p>å¯ä»¥çœ‹å‡ºå¤–è§‚æ¨¡å¼ç»“æ„å¾ˆç®€å•ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰å°è£…ï¼Œé‚£ä¹ˆç”¨æˆ·å°±è¦æ“ä½œå‡ ä¸ªå­ç³»ç»Ÿçš„äº¤äº’é€»è¾‘ï¼Œå®¹æ˜“å‡ºç°é”™è¯¯ã€‚</p><h2 id="4-ç®€å•å®ä¾‹"><a href="#4-ç®€å•å®ä¾‹" class="headerlink" title="4.ç®€å•å®ä¾‹"></a>4.ç®€å•å®ä¾‹</h2><blockquote><p>æ‰‹æœºé›†åˆäº†ç”µè¯åŠŸèƒ½ã€çŸ­ä¿¡åŠŸèƒ½ã€æ‹ç…§å’Œ GPS ç­‰åŠŸèƒ½ã€‚é‚£ä¹ˆä»¥æ‰‹æœºä¸ºä¾‹ï¼Œç®€å•çš„ç”¨å¤–è§‚æ¨¡å¼å®ç°ä¸€ä¸‹ã€‚</p></blockquote><h3 id="Phone-æ¥å£ä¸-PhoneImplï¼š"><a href="#Phone-æ¥å£ä¸-PhoneImplï¼š" class="headerlink" title="Phone æ¥å£ä¸ PhoneImplï¼š"></a>Phone æ¥å£ä¸ PhoneImplï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/17. * &lt;p&gt; * desc: */</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Phone</span> <span class="token punctuation">{</span>    <span class="token comment">/**     * æ‰“ç”µè¯     */</span>    <span class="token keyword">void</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * æŒ‚æ–­     */</span>    <span class="token keyword">void</span> <span class="token function">hangUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/17. * &lt;p&gt; * desc: ç”µè¯æ¨¡å—å®ç° */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PhoneImpl</span> <span class="token keyword">implements</span> <span class="token class-name">Phone</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ‰“ç”µè¯"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">hangUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æŒ‚æ–­ç”µè¯"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Camera-æ¥å£ä¸-Camera-çš„å®ç°ç±»ï¼š"><a href="#Camera-æ¥å£ä¸-Camera-çš„å®ç°ç±»ï¼š" class="headerlink" title="Camera æ¥å£ä¸ Camera çš„å®ç°ç±»ï¼š"></a>Camera æ¥å£ä¸ Camera çš„å®ç°ç±»ï¼š</h3><pre class="line-numbers language-none"><code class="language-none">/** * Created by Weicools on 2017/3/17. * &lt;p&gt; * desc: */public interface Camera {    /**     * æ‰“å¼€ç›¸æœº     */    void open();    /**     * æ‹ç…§     */    void takePicture();    /**     * å…³é—­ç›¸æœº     */    void close();}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/17. * &lt;p&gt; * desc: ç›¸æœºæ¨¡å—å®ç° */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SonyCamera</span> <span class="token keyword">implements</span> <span class="token class-name">Camera</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token keyword">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ‰“å¼€ç›¸æœº"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">takePicture</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ‹ä¸ªç…§ç‰‡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å…³é—­ç›¸æœº"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å¤–è§‚ç±»-MobileFacadeï¼š"><a href="#å¤–è§‚ç±»-MobileFacadeï¼š" class="headerlink" title="å¤–è§‚ç±» MobileFacadeï¼š"></a>å¤–è§‚ç±» MobileFacadeï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/17. * &lt;p&gt; * desc: å¤–è§‚ç±» */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MobileFacade</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token class-name">Phone</span> mPhone <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PhoneImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">Camera</span> mCamera <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SonyCamera</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        mPhone<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">videoChat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è§†é¢‘æ­£åœ¨è¿æ¥â€¦â€¦"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        mCamera<span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        mPhone<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">hangUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        mPhone<span class="token punctuation">.</span><span class="token function">hangUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">takePicture</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        mCamera<span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        mCamera<span class="token punctuation">.</span><span class="token function">takePicture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">closeCamera</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        mCamera<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æµ‹è¯•ï¼š"><a href="#æµ‹è¯•ï¼š" class="headerlink" title="æµ‹è¯•ï¼š"></a>æµ‹è¯•ï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2018/3/17. * &lt;p&gt; * desc: */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">MobileFacade</span> mobileFacade <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MobileFacade</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        mobileFacade<span class="token punctuation">.</span><span class="token function">videoChat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        mobileFacade<span class="token punctuation">.</span><span class="token function">takePicture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        mobileFacade<span class="token punctuation">.</span><span class="token function">closeCamera</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“æœï¼š</p><pre class="line-numbers language-none"><code class="language-none">æ‰“å¼€ç›¸æœºæ‹ç…§--&gt; è§†é¢‘èŠå¤©æ¥é€šä¸­æ‰“å¼€ç›¸æœºæ‰“ç”µè¯12345<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="5-Android-æºç ä¸­çš„å¤–è§‚æ¨¡å¼"><a href="#5-Android-æºç ä¸­çš„å¤–è§‚æ¨¡å¼" class="headerlink" title="5.Android æºç ä¸­çš„å¤–è§‚æ¨¡å¼"></a>5.Android æºç ä¸­çš„å¤–è§‚æ¨¡å¼</h2><p><code>Context</code> æ˜¯ Android å¼€å‘ä¸­çš„æœ€é‡è¦ä¸€ä¸ªï¼Œæ˜¯ç¨‹åºçš„è¿è¡Œç¯å¢ƒï¼Œå®ƒå°è£…äº†å¾ˆå¤šé‡è¦æ“ä½œï¼Œä¾‹å¦‚: startActivity(), startService(), sendBroadcast(), bindService().</p><p><code>Context</code> æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒçš„çœŸæ­£å®ç°æ˜¯<code>ContextImpl</code> ç±»ï¼Œé€šè¿‡æŸ¥çœ‹<code>ContextImpl</code> æºç æˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>ContextImpl</code>å†…éƒ¨å°è£…äº†å¾ˆå¤šä¸åŒå­ç³»ç»Ÿçš„æ“ä½œã€‚ä¾‹å¦‚ï¼šActivity çš„è·³è½¬ã€å‘é€å¹¿æ’­ã€å¯åŠ¨æœåŠ¡å’Œè®¾ç½®å£çº¸ç­‰ï¼Œè¿™äº›å·¥ä½œä¸æ˜¯åœ¨<code>ContextImpl</code> ä¸­å®ç°ï¼Œè€Œæ˜¯äº¤ç»™äº†å…·ä½“çš„å­ç³»ç»Ÿè¿›è¡Œå¤„ç†ã€‚é€šè¿‡<code>Context</code> è¿™ä¸ªæŠ½è±¡ç±»å®šä¹‰äº†ä¸€ç»„æ¥å£ï¼Œ<code>ContextImpl</code>å®ç°ã€‚è¿™æ ·ç”¨æˆ·é€šå¸¸æƒ…å†µä¸‹å°±ä¸éœ€è¦å¯¹æ¯ä¸ªå­ç³»ç»Ÿè¿›è¡Œäº†è§£ã€‚è¿™æ ·å¯¹ç”¨æˆ·å±è”½äº†å…·ä½“çš„å®ç°ç»†èŠ‚ï¼Œé™ä½äº†ä½¿ç”¨æˆæœ¬ã€‚</p><h2 id="6-Summary"><a href="#6-Summary" class="headerlink" title="6.Summary"></a>6.Summary</h2><ol><li><p>ä¼˜ç‚¹</p><ul><li>å¯¹å®¢æˆ·ç¨‹åºéšè—å­ç³»ç»Ÿçš„ç»†èŠ‚ï¼Œå› è€Œå‡å°‘äº†å®¢æˆ·å¯¹äºå­ç³»ç»Ÿçš„è€¦åˆï¼Œèƒ½å¤Ÿæ‹¥æŠ±å˜åŒ–ã€‚</li><li>å¤–è§‚ç±»å¯¹å­ç³»ç»Ÿçš„æ¥å£å°è£…ï¼Œä½¿å¾—ç³»ç»Ÿæ›´æ˜“äºä½¿ç”¨ã€‚</li></ul></li><li><p>ç¼ºç‚¹</p><ul><li>å¤–è§‚ç±»æ¥å£è†¨èƒ€ã€‚ç”±äºå­ç³»ç»Ÿçš„æ¥å£éƒ½æœ‰å¤–è§‚ç±»ç»Ÿä¸€å¯¹å¤–æš´éœ²ï¼Œä½¿å¾—å¤–è§‚ç±»çš„ API æ¥å£è¾ƒå¤šï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†ç”¨æˆ·ä½¿ç”¨æˆæœ¬ã€‚</li><li>å¤–è§‚ç±»æ²¡æœ‰éµå¾ªå¼€é—­åŸåˆ™ï¼Œå½“ä¸šåŠ¡å‡ºç°å˜æ›´æ—¶ï¼Œå¯èƒ½éœ€è¦ç›´æ¥ä¿®æ”¹å¤–è§‚ç±»ã€‚</li></ul></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Java </tag>
            
            <tag> DesignPattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - è£…é¥°ç€æ¨¡å¼</title>
      <link href="/20170318/designpattern-structure-decorator/"/>
      <url>/20170318/designpattern-structure-decorator/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-è£…é¥°ç€æ¨¡å¼"><a href="#ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-è£…é¥°ç€æ¨¡å¼" class="headerlink" title="ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - è£…é¥°ç€æ¨¡å¼"></a>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - è£…é¥°ç€æ¨¡å¼</h1><blockquote><p>è£…é¥°æ¨¡å¼ä¹Ÿç§°ä¸ºåŒ…è£…æ¨¡å¼ï¼Œæ˜¯ç»“æ„å‹è®¾è®¡æ¨¡å¼ä¹‹ä¸€ã€‚å®ƒä½¿ç”¨ä¸€ç§å¯¹å®¢æˆ·ç«¯é€æ˜çš„æ–¹å¼æ¥åŠ¨æ€æ‰©å±•å¯¹è±¡çš„åŠŸèƒ½ï¼Œæ˜¯ä¸€ç§ç”¨äºæ›¿ä»£ç»§æ‰¿æŠ€æœ¯çš„ä¸€ç§æ–¹æ¡ˆã€‚<br>å®šä¹‰ï¼šåŠ¨æ€çš„ç»™å¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ï¼Œå°±å¢åŠ åŠŸèƒ½æ¥è¯´ï¼Œå®ƒæ¯”ç”Ÿæˆå­ç±»æ›´åŠ çµæ´»ã€‚</p></blockquote><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><ul><li>éœ€è¦é€æ˜ä¸”åŠ¨æ€åœ°æ‰©å±•ç±»çš„åŠŸèƒ½æ—¶ã€‚ä¸”åœ¨ä¸å½±å“å…¶ä»–å¯¹è±¡çš„æƒ…å†µä¸‹ã€‚</li><li>å½“ä¸èƒ½é‡‡ç”¨ç»§æ‰¿å¯¹ç³»ç»Ÿè¿›è¡Œæ‰©å±•æ—¶å¯ä»¥ä½¿ç”¨è£…é¥°æ¨¡å¼ã€‚æ¯”å¦‚ final ç±»ã€‚</li></ul><h2 id="UML-ç±»å›¾"><a href="#UML-ç±»å›¾" class="headerlink" title="UML ç±»å›¾"></a>UML ç±»å›¾</h2><p><img src="http://blog-1251678165.coscd.myqcloud.com/2018-03-18-decorator.png" alt="decorator"></p><ul><li><code>Component</code>ï¼šæŠ½è±¡ç»„ä»¶ã€‚å¯ä»¥æ˜¯ä¸€ä¸ªæ¥å£æˆ–æŠ½è±¡ç±»ï¼Œå…¶å……å½“çš„å°±æ˜¯è¢«è£…é¥°çš„åŸå§‹å¯¹è±¡ã€‚</li><li><code>ConcreteComponent</code>ï¼šç»„ä»¶å…·ä½“å®ç°ç±»ï¼Œè¯¥ç±»æ˜¯ Component ç±»çš„åŸºæœ¬å®ç°ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬è£…é¥°çš„å…·ä½“å¯¹è±¡ã€‚</li><li><code>Decorator</code>ï¼šæŠ½è±¡è£…é¥°è€…ï¼Œå…¶èŒè´£å°±æ˜¯è£…é¥°æˆ‘ä»¬çš„ç»„ä»¶å¯¹è±¡ï¼Œé€šè¿‡å…¶å­ç±»æ‰©å±•è¯¥æ–¹æ³•ä»¥è¾¾åˆ°è£…é¥°çš„ç›®çš„ã€‚å…¶å†…éƒ¨ä¸€å®šè¦æœ‰ä¸€ä¸ªæŒ‡å‘ç»„ä»¶å¯¹è±¡çš„å¼•ç”¨ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¯¥ç±»ä¸ºæŠ½è±¡ç±»ï¼Œéœ€è¦æ ¹æ®ä¸åŒçš„è£…é¥°é€»è¾‘å®ç°ä¸åŒçš„å…·ä½“å­ç±»ã€‚</li><li><code>ConcreteDecoratorA</code>ã€<code>ConcreteDecoratorB</code>ï¼šè£…é¥°ç€å…·ä½“å®ç°ç±»ã€‚è´Ÿè´£å‘æ„ä»¶æ·»åŠ æ–°çš„èŒè´£ã€‚</li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: æŠ½è±¡ç»„ä»¶ç±»ï¼Œå¯ä»¥æ˜¯æŠ½è±¡ç±»ä¹Ÿå¯ä»¥æ˜¯æ¥å£ */</span><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>    <span class="token comment">/**     * æŠ½è±¡ç»„ä»¶çš„æŠ½è±¡æ–¹æ³•     */</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: å…·ä½“ç»„ä»¶å®ç°ç±» */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConcreteComponent</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">// å…·ä½“é€»è¾‘</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: æŠ½è±¡è£…é¥°è€… */</span><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Decorator</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token class-name">Component</span> mComponent<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Decorator</span><span class="token punctuation">(</span><span class="token class-name">Component</span> component<span class="token punctuation">)</span> <span class="token punctuation">{</span>        mComponent <span class="token operator">=</span> component<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        mComponent<span class="token punctuation">.</span><span class="token function">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: è£…é¥°è€…å…·ä½“å®ç°ç±» */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConcreteDecoratorA</span> <span class="token keyword">extends</span> <span class="token class-name">Decorator</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token class-name">ConcreteDecoratorA</span><span class="token punctuation">(</span><span class="token class-name">Component</span> component<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">operatorA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">operatorB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operatorA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operatorB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: è£…é¥°è€…å…·ä½“å®ç°ç±» */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConcreteDecoratorB</span> <span class="token keyword">extends</span> <span class="token class-name">Decorator</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token class-name">ConcreteDecoratorB</span><span class="token punctuation">(</span><span class="token class-name">Component</span> component<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">operatorA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">operatorB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operatorA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operatorB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: å®¢æˆ·è°ƒç”¨ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//è¢«è£…é¥°çš„ç»„ä»¶å¯¹è±¡</span>        <span class="token class-name">Component</span> component <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcreteComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//æ ¹æ®ç»„ä»¶å¯¹è±¡æ„é€ è£…é¥°è€…Aå¹¶è°ƒç”¨ï¼Œç›¸å½“äºç»™ç»„ä»¶å¯¹è±¡å¢åŠ è£…é¥°ç€Açš„åŠŸèƒ½</span>        <span class="token class-name">Decorator</span> decoratorA <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcreteDecoratorA</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span><span class="token punctuation">;</span>        decoratorA<span class="token punctuation">.</span><span class="token function">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//æ ¹æ®ç»„ä»¶å¯¹è±¡æ„é€ è£…é¥°è€…Bå¹¶è°ƒç”¨ï¼Œç›¸å½“äºç»™ç»„ä»¶å¯¹è±¡å¢åŠ è£…é¥°ç€Bçš„åŠŸèƒ½</span>        <span class="token class-name">Decorator</span> decoratorB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcreteDecoratorA</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span><span class="token punctuation">;</span>        decoratorB<span class="token punctuation">.</span><span class="token function">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç®€å•å®ç°"><a href="#ç®€å•å®ç°" class="headerlink" title="ç®€å•å®ç°"></a>ç®€å•å®ç°</h2><blockquote><p>ä»¥ä¸€ä¸ªç”·å­©ç©¿è¡£è£…æ‰®ä¸ºä¾‹ã€‚å®ç°ç»™ç”·å­©åœ¨å®¶ä¸å‡ºé—¨çš„ç©¿è¡£è£…æ‰®ã€‚</p></blockquote><h3 id="æŠ½è±¡ç»„ä»¶ç±»ï¼ˆComponentï¼‰ï¼š"><a href="#æŠ½è±¡ç»„ä»¶ç±»ï¼ˆComponentï¼‰ï¼š" class="headerlink" title="æŠ½è±¡ç»„ä»¶ç±»ï¼ˆComponentï¼‰ï¼š"></a>æŠ½è±¡ç»„ä»¶ç±»ï¼ˆComponentï¼‰ï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: */</span><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>    <span class="token comment">/**     * ç©¿ç€     */</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">dressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å…·ä½“å®ç°ç±»ï¼ˆConcreteComponentï¼‰ï¼šè¡¨ç¤ºè¦è£…æ‰®çš„-Boy"><a href="#å…·ä½“å®ç°ç±»ï¼ˆConcreteComponentï¼‰ï¼šè¡¨ç¤ºè¦è£…æ‰®çš„-Boy" class="headerlink" title="å…·ä½“å®ç°ç±»ï¼ˆConcreteComponentï¼‰ï¼šè¡¨ç¤ºè¦è£…æ‰®çš„ Boy"></a>å…·ä½“å®ç°ç±»ï¼ˆConcreteComponentï¼‰ï¼šè¡¨ç¤ºè¦è£…æ‰®çš„ Boy</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Boy</span> <span class="token keyword">extends</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Boyç©¿äº†å†…è¡£å†…è£¤"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æŠ½è±¡è£…é¥°ç±»ï¼ˆDecoratorï¼‰ï¼šPersonCloth-è¡¨ç¤ºäººæ‰€ç©¿ç€çš„è¡£æœ"><a href="#æŠ½è±¡è£…é¥°ç±»ï¼ˆDecoratorï¼‰ï¼šPersonCloth-è¡¨ç¤ºäººæ‰€ç©¿ç€çš„è¡£æœ" class="headerlink" title="æŠ½è±¡è£…é¥°ç±»ï¼ˆDecoratorï¼‰ï¼šPersonCloth è¡¨ç¤ºäººæ‰€ç©¿ç€çš„è¡£æœ"></a>æŠ½è±¡è£…é¥°ç±»ï¼ˆDecoratorï¼‰ï¼šPersonCloth è¡¨ç¤ºäººæ‰€ç©¿ç€çš„è¡£æœ</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: */</span><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">PersonCloth</span> <span class="token keyword">extends</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>    <span class="token keyword">protected</span> <span class="token class-name">Person</span> mPerson<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">PersonCloth</span><span class="token punctuation">(</span><span class="token class-name">Person</span> person<span class="token punctuation">)</span> <span class="token punctuation">{</span>        mPerson <span class="token operator">=</span> person<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//è°ƒç”¨Personçš„dressed()æ–¹æ³•</span>        mPerson<span class="token punctuation">.</span><span class="token function">dressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç©¿è´µçš„è¡£æœï¼š"><a href="#ç©¿è´µçš„è¡£æœï¼š" class="headerlink" title="ç©¿è´µçš„è¡£æœï¼š"></a>ç©¿è´µçš„è¡£æœï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExpensiveCloth</span> <span class="token keyword">extends</span> <span class="token class-name">PersonCloth</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token class-name">ExpensiveCloth</span><span class="token punctuation">(</span><span class="token class-name">Person</span> person<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">dressJean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç©¿æ¡ç‰›ä»”è£¤"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">dressLeather</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç©¿ä»¶çš®è¡£"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">dressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dressJean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dressLeather</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç©¿ä¾¿å®œçš„è¡£æœï¼š"><a href="#ç©¿ä¾¿å®œçš„è¡£æœï¼š" class="headerlink" title="ç©¿ä¾¿å®œçš„è¡£æœï¼š"></a>ç©¿ä¾¿å®œçš„è¡£æœï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CheapCloth</span> <span class="token keyword">extends</span> <span class="token class-name">PersonCloth</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token class-name">CheapCloth</span><span class="token punctuation">(</span><span class="token class-name">Person</span> person<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">dressShirt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç©¿ä»¶çŸ­è¢–"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">dressShort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç©¿æ¡çŸ­è£¤"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">dressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dressShirt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dressShort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è£…æ‰®ï¼š"><a href="#è£…æ‰®ï¼š" class="headerlink" title="è£…æ‰®ï¼š"></a>è£…æ‰®ï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/18. * &lt;p&gt; * desc: */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">Person</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Boy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">PersonCloth</span> cheapCloth <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CheapCloth</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>        cheapCloth<span class="token punctuation">.</span><span class="token function">dressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"*************"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">PersonCloth</span> expensiveCloth <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExpensiveCloth</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>        expensiveCloth<span class="token punctuation">.</span><span class="token function">dressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç»“æœï¼š"><a href="#ç»“æœï¼š" class="headerlink" title="ç»“æœï¼š"></a>ç»“æœï¼š</h3><pre class="line-numbers language-none"><code class="language-none">Boyç©¿äº†å†…è¡£å†…è£¤ç©¿ä»¶çŸ­è¢–ç©¿æ¡çŸ­è£¤*************Boyç©¿äº†å†…è¡£å†…è£¤ç©¿æ¡ç‰›ä»”è£¤ç©¿ä»¶çš®è¡£<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Android-æºç ä¸­çš„å®ç°"><a href="#Android-æºç ä¸­çš„å®ç°" class="headerlink" title="Android æºç ä¸­çš„å®ç°"></a>Android æºç ä¸­çš„å®ç°</h2><ul><li><p>Context</p></li><li><p><code>Context</code>ç±»åœ¨ Android ä¸­è¢«ç§°ä¸ºâ€œä¸Šå¸å¯¹è±¡â€ï¼Œå®ƒçš„æœ¬è´¨å°±æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œåœ¨è£…é¥°æ¨¡å¼ä¸­ç›¸å½“äºæŠ½è±¡ç»„ä»¶ï¼Œè€Œåœ¨å†…éƒ¨å®šä¹‰äº†å¤§é‡çš„æŠ½è±¡æ–¹æ³•ï¼Œæ¯”å¦‚æˆ‘ä»¬ç»å¸¸ç”¨åˆ°çš„<code>startActivity</code>æ–¹æ³•ã€‚</p></li><li><p>è€ŒçœŸæ­£å®ç°æ˜¯åœ¨<code>ContextImpl</code>ä¸­å®Œæˆï¼Œé‚£ä¹ˆ<code>ContextImpl</code> å°±æ˜¯æŠ½è±¡ç»„ä»¶çš„å…·ä½“å®ç°ç±»ã€‚</p></li><li><p><code>Activity</code>ä»ç±»çš„å±‚æ¬¡æ¥çœ‹æœ¬è´¨æ˜¯å›¾ä¸ª Contextï¼Œä½†æ˜¯<code>Activity</code>å¹¶éç›´æ¥ç»§æ‰¿<code>Context</code>ï¼Œè€Œæ˜¯ç»§æ‰¿<code>ContextThemeWrapper</code>, <code>ContextThemeWrapper</code>æœ‰æ˜¯ç»§æ‰¿<code>ContextWrapper</code>ï¼Œå› ä¸º<code>ContextWrapper</code> ç»§æ‰¿äº<code>Context</code>ï¼Œæ‰€ä»¥<code>ContextWrapper</code> å°±æ˜¯è£…é¥°è€…ï¼Œ<code>ContextWrapper</code>ä¸­æŒæœ‰<code>Context</code>çš„å¼•ç”¨ã€‚</p></li></ul><blockquote><p>Contextï¼š<a href="https://developer.android.com/reference/android/content/Context.html">https://developer.android.com/reference/android/content/Context.html</a><br>ContextWrapperï¼š<a href="https://developer.android.com/reference/android/content/ContextWrapper.html">https://developer.android.com/reference/android/content/ContextWrapper.html</a><br>ContextThemeWrapperï¼š<a href="https://developer.android.com/reference/android/view/ContextThemeWrapper.html">https://developer.android.com/reference/android/view/ContextThemeWrapper.html</a><br>Activityï¼š<a href="https://developer.android.com/reference/android/app/Activity.html">https://developer.android.com/reference/android/app/Activity.html</a></p></blockquote><h2 id="ä¸å…¶ä»–æ¨¡å¼åŒºåˆ«"><a href="#ä¸å…¶ä»–æ¨¡å¼åŒºåˆ«" class="headerlink" title="ä¸å…¶ä»–æ¨¡å¼åŒºåˆ«"></a>ä¸å…¶ä»–æ¨¡å¼åŒºåˆ«</h2><ol><li>ä¸<a href="http://blog.csdn.net/qq_17766199/article/details/50492805">ä»£ç†æ¨¡å¼</a>çš„åŒºåˆ«<ul><li>ï¼ˆ1ï¼‰è£…é¥°æ¨¡å¼æ˜¯ä»¥å¯¹å®¢æˆ·ç«¯é€æ˜çš„æ–¹å¼æ‰©å±•å¯¹è±¡çš„åŠŸèƒ½ï¼Œæ˜¯ç»§æ‰¿æ–¹æ¡ˆçš„ä¸€ä¸ªæ›¿ä»£ï¼›è€Œä»£ç†æ¨¡å¼åˆ™æ˜¯ç»™ä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œå¹¶æœ‰ä»£ç†å¯¹è±¡æ¥æ§åˆ¶å¯¹åŸæœ‰å¯¹è±¡çš„å¼•ç”¨ã€‚</li><li>ï¼ˆ2ï¼‰è£…é¥°æ¨¡å¼åº”è¯¥ä¸ºæ‰€è£…é¥°çš„å¯¹è±¡å¢å¼ºåŠŸèƒ½ï¼›ä»£ç†æ¨¡å¼æ˜¯å¯¹ä»£ç†å¯¹è±¡æ–½åŠ æ§åˆ¶ï¼Œä¸å¯¹å¯¹è±¡æœ¬èº«åŠŸèƒ½è¿›è¡Œå¢å¼ºã€‚</li></ul></li><li>ä¸<a href="http://blog.csdn.net/qq_17766199/article/details/50514877">é€‚é…å™¨æ¨¡å¼</a>çš„åŒºåˆ«<ul><li>é€‚é…å™¨æ¨¡å¼æ˜¯ç”¨æ–°æ¥å£æ¥è°ƒç”¨åŸæ¥å£ï¼ŒåŸæ¥å£å¯¹æ–°ç³»ç»Ÿæ˜¯ä¸å¯è§çš„ï¼›è£…é¥°æ¨¡å¼å¢å¼ºäº†å…¶ä»–å¯¹è±¡çš„åŠŸèƒ½è€ŒåŒæ—¶åˆä¸æ”¹å˜å®ƒçš„æ¥å£ã€‚</li></ul></li></ol><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><blockquote><p>åœ¨å®é™…å¼€å‘ä¸­æˆ‘ä»¬åº”è¯¥å†™è¿‡å¦‚ä¸‹ä»£ç ï¼šå…¶å®è¿™äº›æ–°å¢æ–¹æ³•çš„è°ƒç”¨å°±ç±»ä¼¼è£…é¥°æ¨¡å¼ä¸­çš„è£…é¥°è€…çš„èŒè´£ï¼Œåªä¸è¿‡è¿™é‡Œæˆ‘ä»¬æ²¡æœ‰ä¿æŒå¯¹ç»„ä»¶ç±»çš„å¼•ç”¨ã€‚</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//åˆå§‹åŒ–æ•°æ®</span>    <span class="token function">initData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//åˆå§‹åŒ–æ§ä»¶</span>    <span class="token function">initViews</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//åˆå§‹åŒ–äº‹ä»¶</span>    <span class="token function">initEvent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol><li>ä¼˜ç‚¹<ul><li>ï¼ˆ1ï¼‰å¯¹äºæ‰©å±•ä¸€ä¸ªå¯¹è±¡çš„åŠŸèƒ½ï¼Œè£…é¥°æ¨¡å¼æ¯”ç»§æ‰¿æ›´åŠ çµæ´»æ€§ï¼Œä¸ä¼šå¯¼è‡´ç±»çš„ä¸ªæ•°æ€¥å‰§å¢åŠ ã€‚</li><li>ï¼ˆ2ï¼‰å¯ä»¥é€šè¿‡ä¸€ç§åŠ¨æ€çš„æ–¹å¼åœ¨è¿è¡Œæ—¶é€‰æ‹©ä¸åŒçš„å…·ä½“è£…é¥°ç±»ï¼Œä»è€Œå®ç°ä¸åŒçš„è¡Œä¸ºã€‚</li><li>ï¼ˆ3ï¼‰å¯ä»¥å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œå¤šæ¬¡è£…é¥°ï¼Œé€šè¿‡ä½¿ç”¨ä¸åŒçš„å…·ä½“è£…é¥°ç±»ä»¥åŠè¿™äº›è£…é¥°ç±»çš„æ’åˆ—ç»„åˆï¼Œå¯ä»¥åˆ›é€ å‡ºå¾ˆå¤šä¸åŒè¡Œä¸ºçš„ç»„åˆï¼Œå¾—åˆ°åŠŸèƒ½æ›´ä¸ºå¼ºå¤§çš„å¯¹è±¡ã€‚</li><li>ï¼ˆ4ï¼‰å…·ä½“æ„ä»¶ç±»ä¸å…·ä½“è£…é¥°ç±»å¯ä»¥ç‹¬ç«‹å˜åŒ–ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦å¢åŠ æ–°çš„å…·ä½“æ„ä»¶ç±»å’Œå…·ä½“è£…é¥°ç±»ï¼ŒåŸæœ‰ç±»åº“ä»£ç æ— é¡»æ”¹å˜ï¼Œç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚</li></ul></li><li>ç¼ºç‚¹<ul><li>ï¼ˆ1ï¼‰ä½¿ç”¨è£…é¥°æ¨¡å¼è¿›è¡Œç³»ç»Ÿè®¾è®¡æ—¶å°†äº§ç”Ÿå¾ˆå¤šå°å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡çš„åŒºåˆ«åœ¨äºå®ƒä»¬ä¹‹é—´ç›¸äº’è¿æ¥çš„æ–¹å¼æœ‰æ‰€ä¸åŒï¼Œè€Œä¸æ˜¯å®ƒä»¬çš„ç±»æˆ–è€…å±æ€§å€¼æœ‰æ‰€ä¸åŒï¼Œå¤§é‡å°å¯¹è±¡çš„äº§ç”ŸåŠ¿å¿…ä¼šå ç”¨æ›´å¤šçš„ç³»ç»Ÿèµ„æºï¼Œåœ¨ä¸€å®šç¨‹åºä¸Šå½±å“ç¨‹åºçš„æ€§èƒ½ã€‚</li><li>ï¼ˆ2ï¼‰å¯¹äºå¤šæ¬¡è£…é¥°çš„å¯¹è±¡ï¼Œè°ƒè¯•æ—¶å¯»æ‰¾é”™è¯¯å¯èƒ½éœ€è¦é€çº§æ’æŸ¥ï¼Œè¾ƒä¸ºç¹çã€‚</li></ul></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Java </tag>
            
            <tag> DesignPattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - ä»£ç†æ¨¡å¼</title>
      <link href="/20170317/designpattern-structure-proxy/"/>
      <url>/20170317/designpattern-structure-proxy/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-ä»£ç†æ¨¡å¼"><a href="#ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-ä»£ç†æ¨¡å¼" class="headerlink" title="ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - ä»£ç†æ¨¡å¼"></a>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - ä»£ç†æ¨¡å¼</h1><blockquote><p>ä»£ç†æ¨¡å¼ä¹Ÿç§°å§”æ‰˜æ¨¡å¼ï¼Œæ˜¯ç»“æ„å‹è®¾è®¡æ¨¡å¼ä¹‹ä¸€ã€‚æ˜¯åº”ç”¨å¹¿æ³›çš„æ¨¡å¼ä¹‹ä¸€ã€‚<br>å®šä¹‰ï¼šä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚</p></blockquote><h2 id="1-ä½¿ç”¨åœºæ™¯"><a href="#1-ä½¿ç”¨åœºæ™¯" class="headerlink" title="1.ä½¿ç”¨åœºæ™¯"></a>1.ä½¿ç”¨åœºæ™¯</h2><p>å½“æ— æ³•æˆ–ä¸æƒ³ç›´æ¥è®¿é—®æŸä¸ªå¯¹è±¡æˆ–è®¿é—®æŸä¸ªå¯¹è±¡å­˜åœ¨å›°éš¾æ—¶å¯ä»¥é€šè¿‡ä¸€ä¸ªä»£ç†å¯¹è±¡æ¥é—´æ¥è®¿é—®ï¼Œä¸ºäº†ä¿è¯å®¢æˆ·ç«¯ä½¿ç”¨çš„é€æ˜æ€§ï¼Œå§”æ‰˜å¯¹è±¡ä¸ä»£ç†å¯¹è±¡éœ€è¦å®ç°ç›¸åŒçš„æ¥å£ã€‚</p><h2 id="2-UML-ç±»å›¾"><a href="#2-UML-ç±»å›¾" class="headerlink" title="2.UML ç±»å›¾"></a>2.UML ç±»å›¾</h2><p><img src="http://blog-1251678165.coscd.myqcloud.com/2018-03-17-Proxy-Pattern-1.png" alt="Proxy"><br>å„ä¸ªè§’è‰²ä»‹ç»ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/17. * &lt;p&gt; * desc: æŠ½è±¡ä¸»é¢˜ç±»ï¼Œä¸»è¦èŒè´£æ˜¯ç”³æ˜çœŸå®ä¸ä»£ç†ä¸»é¢˜çš„å…±åŒæ¥å£æ–¹æ³• * å¯ä»¥æ˜¯æŠ½è±¡ç±»ä¹Ÿå¯ä»¥æ˜¯æ¥å£ */</span><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Subject</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">visit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/3/17. * &lt;p&gt; * desc: çœŸå®ä¸»é¢˜ç±»ï¼Œä¹Ÿç§°è¢«ä»£ç†ç±» */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RealSubject</span> <span class="token keyword">extends</span> <span class="token class-name">Subject</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">visit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Real subject"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/3/17. * &lt;p&gt; * desc: ä»£ç†ç±»ï¼ŒæŒæœ‰çœŸå®ä¸»é¢˜çš„å¼•ç”¨ï¼Œå®ƒå®ç°çš„æ¥å£æ–¹æ³•ä¸­è°ƒç”¨çœŸå®ä¸»é¢˜çš„æ–¹æ³• */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProxySubject</span> <span class="token keyword">extends</span> <span class="token class-name">Subject</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token class-name">Subject</span> mRealSubject<span class="token punctuation">;</span>    <span class="token class-name">ProxySubject</span><span class="token punctuation">(</span><span class="token class-name">Subject</span> subject<span class="token punctuation">)</span> <span class="token punctuation">{</span>        mRealSubject <span class="token operator">=</span> subject<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">visit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Proxy subject"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è°ƒç”¨çœŸå®ä¸»é¢˜æ–¹æ³•</span>        mRealSubject<span class="token punctuation">.</span><span class="token function">visit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/3/17. * &lt;p&gt; * desc: */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">Subject</span> subject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProxySubject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RealSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        subject<span class="token punctuation">.</span><span class="token function">visit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-ç®€å•ç¤ºä¾‹"><a href="#3-ç®€å•ç¤ºä¾‹" class="headerlink" title="3.ç®€å•ç¤ºä¾‹"></a>3.ç®€å•ç¤ºä¾‹</h2><blockquote><p>ä¹¦ä¸­ä¾‹å­ï¼šä»¥å°æ°‘è¯‰è®¼çš„æµç¨‹ä¸¾ä¾‹ã€‚é‚£ä¹ˆéœ€è¦ä»£ç†å¾‹å¸ˆä»£ç†ï¼Œè¯‰è®¼ç®€å•æµç¨‹ï¼šæäº¤ç”³è¯·â€“&gt;è¿›è¡Œä¸¾è¯â€“&gt;å¼€å§‹è¾©æŠ¤â€“&gt;è¯‰è®¼å®Œæˆã€‚</p></blockquote><h3 id="è¯‰è®¼æ¥å£ç±»ï¼š"><a href="#è¯‰è®¼æ¥å£ç±»ï¼š" class="headerlink" title="è¯‰è®¼æ¥å£ç±»ï¼š"></a>è¯‰è®¼æ¥å£ç±»ï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2018/3/17. * &lt;p&gt; * desc: è¯‰è®¼æ¥å£ç±» */</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ILawsuit</span> <span class="token punctuation">{</span>    <span class="token comment">/**     * æäº¤ç”³è¯·     */</span>    <span class="token keyword">void</span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * ç¦è¡Œä¸¾è¯     */</span>    <span class="token keyword">void</span> <span class="token function">burden</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * å¼€å§‹è¾©æŠ¤     */</span>    <span class="token keyword">void</span> <span class="token function">defend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * è¯‰è®¼å®Œæˆ     */</span>    <span class="token keyword">void</span> <span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å…·ä½“è¯‰è®¼äºº-Weicoolsï¼š"><a href="#å…·ä½“è¯‰è®¼äºº-Weicoolsï¼š" class="headerlink" title="å…·ä½“è¯‰è®¼äºº Weicoolsï¼š"></a>å…·ä½“è¯‰è®¼äºº Weicoolsï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/17. * &lt;p&gt; * desc: å…·ä½“è¯‰è®¼äºº */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Weicools</span> <span class="token keyword">implements</span> <span class="token class-name">ILawsuit</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è€æ¿æ‹–æ¬ å·¥èµ„ï¼Œç‰¹æ­¤ç”³è¯·ä»²è£ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">burden</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è¿™æ˜¯åˆåŒä¹¦å’Œè¿‡å»ä¸€å¹´çš„é“¶è¡Œå·¥èµ„æµæ°´ã€‚"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">defend</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è¯æ®ç¡®å‡¿ï¼Œä¸éœ€è¦åšä»»ä½•è¾©æŠ¤ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è¯‰è®¼æˆåŠŸï¼Œåˆ¤å†³è€æ¿ä¸ƒå¤©å†…ç»“ç®—å·¥èµ„ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä»£ç†å¾‹å¸ˆï¼š"><a href="#ä»£ç†å¾‹å¸ˆï¼š" class="headerlink" title="ä»£ç†å¾‹å¸ˆï¼š"></a>ä»£ç†å¾‹å¸ˆï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/17. * &lt;p&gt; * desc: ä»£ç†å¾‹å¸ˆ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProxyLayer</span> <span class="token keyword">implements</span> <span class="token class-name">ILawsuit</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token class-name">ILawsuit</span> mLawsuit<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">ProxyLayer</span><span class="token punctuation">(</span><span class="token class-name">ILawsuit</span> lawsuit<span class="token punctuation">)</span> <span class="token punctuation">{</span>        mLawsuit <span class="token operator">=</span> lawsuit<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        mLawsuit<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">burden</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        mLawsuit<span class="token punctuation">.</span><span class="token function">burden</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">defend</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        mLawsuit<span class="token punctuation">.</span><span class="token function">defend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        mLawsuit<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å¼€å§‹ä»²è£ï¼š"><a href="#å¼€å§‹ä»²è£ï¼š" class="headerlink" title="å¼€å§‹ä»²è£ï¼š"></a>å¼€å§‹ä»²è£ï¼š</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/17. * &lt;p&gt; * desc: */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">ILawsuit</span> weico <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Weicools</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ILawsuit</span> layer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProxyLayer</span><span class="token punctuation">(</span>weico<span class="token punctuation">)</span><span class="token punctuation">;</span>        layer<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        layer<span class="token punctuation">.</span><span class="token function">burden</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        layer<span class="token punctuation">.</span><span class="token function">defend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        layer<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç»“æœï¼š"><a href="#ç»“æœï¼š" class="headerlink" title="ç»“æœï¼š"></a>ç»“æœï¼š</h3><pre class="line-numbers language-none"><code class="language-none">è€æ¿æ‹–æ¬ å·¥èµ„ï¼Œç‰¹æ­¤ç”³è¯·ä»²è£ï¼è¿™æ˜¯åˆåŒä¹¦å’Œè¿‡å»ä¸€å¹´çš„é“¶è¡Œå·¥èµ„æµæ°´ã€‚è¯æ®ç¡®å‡¿ï¼Œä¸éœ€è¦åšä»»ä½•è¾©æŠ¤ï¼è¯‰è®¼æˆåŠŸï¼Œåˆ¤å†³è€æ¿ä¸ƒå¤©å†…ç»“ç®—å·¥èµ„ï¼<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>åŒæ ·æˆ‘ä»¬ä¹Ÿå¯ä»¥ä»£ç†å…¶ä»–äººï¼Œåªéœ€è¦å®ç° ILawsuit å³å¯ã€‚ä¸Šé¢çš„ä»£ç†æ¨¡å¼ä¹Ÿå«é™æ€ä»£ç†ï¼Œä¹Ÿå°±æ˜¯åœ¨ä»£ç è¿è¡Œå‰ä»£ç†ç±»çš„ class æ–‡ä»¶å°±å·²ç»å­˜åœ¨ã€‚é‚£ä¹ˆç›¸åï¼Œå½“ç„¶ä¹Ÿä¼šæœ‰åŠ¨æ€ä»£ç†ï¼Œé€šè¿‡åå°„æœºåˆ¶åŠ¨æ€ç”Ÿæˆä»£ç†ç±»ï¼Œä¹Ÿå°±æ˜¯åœ¨ç¼–ç é˜¶æ®µä¸éœ€è¦çŸ¥é“ä»£ç†è°ã€‚</p><h2 id="4-åŠ¨æ€ä»£ç†å®ç°"><a href="#4-åŠ¨æ€ä»£ç†å®ç°" class="headerlink" title="4.åŠ¨æ€ä»£ç†å®ç°"></a>4.åŠ¨æ€ä»£ç†å®ç°</h2><p>Java æä¾›äº†ä¸€ä¸ªä¾¿æ·çš„åŠ¨æ€ä»£ç†æ¥å£ InvocationHandlerï¼Œæˆ‘ä»¬æ¥å®ç°å®ƒï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/17. * &lt;p&gt; * desc: åŠ¨æ€ä»£ç†ç±» */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DynamicPorxy</span> <span class="token keyword">implements</span> <span class="token class-name">InvocationHandler</span> <span class="token punctuation">{</span>    <span class="token comment">// è¢«ä»£ç†ç±»çš„å¼•ç”¨</span>    <span class="token keyword">private</span> <span class="token class-name">Object</span> mObject<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">DynamicPorxy</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>        mObject <span class="token operator">=</span> o<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>mObject<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæˆ‘ä»¬é€šè¿‡ invoke æ–¹æ³•æ¥è°ƒç”¨å…·ä½“çš„è¢«ä»£ç†æ–¹æ³•ï¼Œå¢åŠ  DynamicTest ç±»æµ‹è¯•ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/17. * &lt;p&gt; * desc: åŠ¨æ€ä»£ç†æµ‹è¯• */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DynamicTest</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">//æ„é€ å‡ºè¯‰è®¼äººå°æ°‘</span>        <span class="token class-name">ILawsuit</span> weicools <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Weicools</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//1.é™æ€ä»£ç†</span>        <span class="token comment">//æ„é€ ä¸€ä¸ªä»£ç†å¾‹å¸ˆï¼Œå¹¶å°†å°æ°‘ä¼ é€’è¿›å»</span>        <span class="token comment">//ILawsuit lawyer = new Lawyer(xiaomin);</span>        <span class="token comment">//2.åŠ¨æ€ä»£ç†</span>        <span class="token comment">//æ„é€ ä¸€ä¸ªåŠ¨æ€ä»£ç†</span>        <span class="token class-name">DynamicProxy</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DynamicProxy</span><span class="token punctuation">(</span>weicools<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//è·å–è¢«ä»£ç†ç±»å°æ°‘çš„ClassLoader</span>        <span class="token class-name">ClassLoader</span> loader <span class="token operator">=</span> weicools<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//åŠ¨æ€æ„é€ ä¸€ä¸ªä»£ç†è€…å¾‹å¸ˆ</span>        <span class="token class-name">ILawsuit</span> lawyer <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ILawsuit</span><span class="token punctuation">)</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>loader<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span> <span class="token class-name">ILawsuit</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> proxy<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å¾‹å¸ˆæäº¤ç”³è¯·</span>        lawyer<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å¾‹å¸ˆè¿›è¡Œä¸¾è¯</span>        lawyer<span class="token punctuation">.</span><span class="token function">burden</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å¾‹å¸ˆä»£æ›¿weicoolsè¾©æŠ¤</span>        lawyer<span class="token punctuation">.</span><span class="token function">defend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å®Œæˆè¯‰è®¼</span>        lawyer<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“æœä¸å˜ï¼Œç”±æ­¤å¯ä»¥çœ‹å‡ºåŠ¨æ€ä»£ç†é€šè¿‡ä¸€ä¸ªä»£ç†ç±»æ¥å¤„ç† N å¤šä¸ªè¢«ä»£ç†ç±»ï¼Œå…¶å®è´¨æ˜¯å¯¹ä»£ç†è€…ä¸è¢«ä»£ç†è€…è§£è€¦ã€‚ç›¸å¯¹è€Œè¨€é™æ€ä»£ç†åˆ™åªèƒ½ä¸ºç»™å®šæ¥å£ä¸‹çš„å®ç°ç±»åšä»£ç†ï¼Œå¦‚æœæ¥å£ä¸åŒé‚£ä¹ˆå°±éœ€è¦é‡æ–°å®šä¹‰ä¸åŒçš„ä»£ç†ç±»ï¼Œè¾ƒä¸ºå¤æ‚ï¼Œä½†æ˜¯é™æ€ä»£ç†æ›´ç¬¦åˆé¢å‘å¯¹è±¡åŸåˆ™ã€‚å…·ä½“ä½¿ç”¨å“ªç§æ–¹å¼ï¼Œæ ¹æ®ä¸ªäººå–œå¥½ã€‚</p><h2 id="5-Android-æºç ä¸­çš„ä»£ç†æ¨¡å¼å®ç°"><a href="#5-Android-æºç ä¸­çš„ä»£ç†æ¨¡å¼å®ç°" class="headerlink" title="5.Android æºç ä¸­çš„ä»£ç†æ¨¡å¼å®ç°"></a>5.Android æºç ä¸­çš„ä»£ç†æ¨¡å¼å®ç°</h2><h3 id="ActivityManagerProxy-ä»£ç†ç±»"><a href="#ActivityManagerProxy-ä»£ç†ç±»" class="headerlink" title="ActivityManagerProxy ä»£ç†ç±»"></a>ActivityManagerProxy ä»£ç†ç±»</h3><p>ActivityManager æ˜¯ Android ä¸­ç®¡ç†å’Œç»´æŠ¤ Activity çš„ç›¸å…³ä¿¡æ¯çš„ç±»ï¼Œä¸ºäº†éš”ç¦»å®ƒä¸ ActivityManagerServiceï¼Œæœ‰æ•ˆé™ä½äºŒè€…çš„è€¦åˆï¼Œåœ¨è¿™ä¸­é—´ä½¿ç”¨äº† ActivityManagerProxy ä»£ç†ç±»ï¼Œå…¶æŠ½è±¡ä¸»é¢˜ç±»æ˜¯ IActivityManager æ¥å£ï¼Œæ‰€æœ‰å¯¹ ActivityManagerService çš„è®¿é—®éƒ½è½¬æ¢æˆå¯¹ä»£ç†ç±»çš„è®¿é—®ï¼Œè¿™æ · ActivityManager å°±ä¸ ActivityManagerService è§£è€¦äº†ã€‚<br><img src="http://blog-1251678165.coscd.myqcloud.com/2018-03-17-Activity-Manaher.png"></p><h2 id="6-æ€»ç»“"><a href="#6-æ€»ç»“" class="headerlink" title="6.æ€»ç»“"></a>6.æ€»ç»“</h2><ol><li><p>ä¼˜ç‚¹</p><ul><li>ï¼ˆ1ï¼‰å¯¹ä»£ç†è€…ä¸è¢«ä»£ç†è€…è¿›è¡Œè§£è€¦ã€‚</li><li>ï¼ˆ2ï¼‰ä»£ç†å¯¹è±¡åœ¨å®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸€ä¸ªä¸­ä»‹çš„ä½œç”¨ï¼Œè¿™æ ·å¯ä»¥èµ·åˆ°å¯¹ç›®æ ‡å¯¹è±¡çš„ä¿æŠ¤ã€‚</li></ul></li><li><p>ç¼ºç‚¹</p><ul><li>åŸºæœ¬æ²¡æœ‰ç¼ºç‚¹ï¼ŒçœŸè¦è¯´ç¼ºç‚¹å°±æ˜¯è®¾è®¡æ¨¡å¼çš„é€šç—…ï¼šå¯¹ç±»çš„å¢åŠ ã€‚</li></ul></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Java </tag>
            
            <tag> DesignPattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - è§‚å¯Ÿè€…æ¨¡å¼</title>
      <link href="/20170312/designpattern-behavior-observer/"/>
      <url>/20170312/designpattern-behavior-observer/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-è§‚å¯Ÿè€…æ¨¡å¼"><a href="#ã€ŠAndroid-æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®°-è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - è§‚å¯Ÿè€…æ¨¡å¼"></a>ã€ŠAndroid æºç è®¾è®¡æ¨¡å¼è§£æä¸å®æˆ˜ã€‹è¯»ä¹¦ç¬”è®° - è§‚å¯Ÿè€…æ¨¡å¼</h1><blockquote><p>è§‚å¯Ÿè€…æ¨¡å¼æ˜¯ä¸€ä¸ªä½¿ç”¨ç‡éå¸¸é«˜çš„æ¨¡å¼ï¼Œå®ƒæœ€å¸¸ç”¨åœ¨ GUI ç³»ç»Ÿã€è®¢é˜…â€“å‘å¸ƒç³»ç»Ÿã€‚å› ä¸ºè¿™ä¸ªæ¨¡å¼çš„ä¸€ä¸ªé‡è¦ä½œç”¨å°±æ˜¯è§£è€¦ï¼Œå°†è¢«è§‚å¯Ÿè€…å’Œè§‚å¯Ÿè€…è§£è€¦ï¼Œä½¿å¾—å®ƒä»¬ä¹‹é—´çš„ä¾èµ–æ€§æ›´å°ï¼Œç”šè‡³åšåˆ°æ¯«æ— ä¾èµ–ã€‚æ¯”å¦‚å®‰å“çš„å¼€æºé¡¹ç›® EventBusã€Ottoã€AndroidEventBus ç­‰äº‹ä»¶æ€»çº¿ç±»çš„å’Œ RxJava å“åº”å¼ç¼–ç¨‹å…¶æ ¸å¿ƒéƒ½æ˜¯ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼ã€‚<br>è§‚å¯Ÿè€…æ¨¡å¼æ˜¯å®šä¹‰å¯¹è±¡é—´ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œä½¿å¾—æ¯å½“ä¸€ä¸ªå¯¹è±¡çŠ¶æ€æ”¹å˜æ—¶å¯ä»¥é€šçŸ¥ ä¾èµ–äºå®ƒçš„æ‰€æœ‰å¯¹è±¡è¿›è¡Œæ›´æ–°ã€‚</p></blockquote><span id="more"></span><h2 id="1-ä½¿ç”¨åœºæ™¯"><a href="#1-ä½¿ç”¨åœºæ™¯" class="headerlink" title="1.ä½¿ç”¨åœºæ™¯"></a>1.ä½¿ç”¨åœºæ™¯</h2><ol><li>å…³è”è¡Œä¸ºåœºæ™¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå…³è”è¡Œä¸ºæ˜¯å¯æ‹†åˆ†çš„ï¼Œè€Œä¸æ˜¯â€œç»„åˆâ€å…³ç³»ã€‚</li><li>äº‹ä»¶å¤šçº§è§¦å‘åœºæ™¯ã€‚</li><li>è·¨ç³»ç»Ÿçš„æ¶ˆæ¯äº¤æ¢åœºæ™¯ï¼Œå¦‚æ¶ˆæ¯é˜Ÿåˆ—ã€äº‹ä»¶æ€»çº¿çš„å¤„ç†æœºåˆ¶ã€‚</li></ol><h2 id="2-UML-ç±»å›¾"><a href="#2-UML-ç±»å›¾" class="headerlink" title="2.UML ç±»å›¾"></a>2.UML ç±»å›¾</h2><p><img src="http://blog-1251678165.coscd.myqcloud.com/2018-03-16-Observer.jpg"><br>UML ç±»å›¾ä»‹ç»ï¼š</p><ol><li>Subjectï¼šæŠ½è±¡ä¸»é¢˜ï¼Œä¹Ÿå°±æ˜¯è¢«è§‚å¯Ÿè€…è§’è‰²(Observable)ï¼ŒæŠ½è±¡ä¸»é¢˜æŠŠæ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡çš„å¼•ç”¨ä¿å­˜åˆ°ä¸€ä¸ªé›†åˆé‡Œï¼Œæ¯ä¸ªä¸»é¢˜éƒ½å¯ä»¥æœ‰ä»»æ„æ•°é‡çš„è§‚å¯Ÿè€…ï¼ŒæŠ½è±¡ä¸»é¢˜æä¾›æ¥å£å¯ä»¥åˆ é™¤å’Œå¢åŠ è§‚å¯Ÿè€…å¯¹è±¡</li><li>ConcreteSubjectï¼šå…·ä½“ä¸»é¢˜ï¼Œå°†æœ‰å…³çŠ¶æ€å­˜å…¥å…·ä½“çš„è§‚å¯Ÿè€…å¯¹è±¡ï¼Œåœ¨å…·ä½“ä¸»é¢˜çš„å†…éƒ¨å‘ç”Ÿæ”¹å˜æ—¶ï¼Œç»™æ‰€æœ‰æ³¨å†Œè¿‡çš„è§‚å¯Ÿè€…å‘é€é€šçŸ¥ã€‚</li><li>Observerï¼šæŠ½è±¡è§‚å¯Ÿè€…ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªæ›´æ–°æ¥å£ï¼Œä½¿å¾—åœ¨å¾—åˆ°è¢«è§‚å¯Ÿè€…çš„æ›´æ”¹é€šçŸ¥æ—¶æ›´æ–°è‡ªèº«çŠ¶æ€ã€‚</li><li>ConcreteObserverï¼šå…·ä½“è§‚å¯Ÿè€…ï¼Œå®ç°æŠ½è±¡è§‚å¯Ÿè€…è§’è‰²æ‰€å®šä¹‰çš„æ›´æ–°æ¥å£ï¼Œåœ¨è¢«è§‚å¯Ÿè€…çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶æ›´æ–°è‡ªèº«çŠ¶æ€ã€‚</li></ol><h2 id="3-å®ç°ç¤ºä¾‹"><a href="#3-å®ç°ç¤ºä¾‹" class="headerlink" title="3.å®ç°ç¤ºä¾‹"></a>3.å®ç°ç¤ºä¾‹</h2><ul><li><strong>å®ç°ç”¨æˆ·è¿½ç•ª</strong></li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by Weicools on 2017/3/16. * &lt;p&gt; * desc: æŠ½è±¡è§‚å¯Ÿè€…ç±»ï¼Œä¸ºæ‰€æœ‰å…·ä½“è§‚å¯Ÿè€…å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œåœ¨å¾—åˆ°é€šçŸ¥æ—¶æ›´æ–°è‡ªå·± */</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Observer</span> <span class="token punctuation">{</span>    <span class="token comment">/**     * æ›´æ–°æ¶ˆæ¯     * @param message æ¶ˆæ¯     */</span>    <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/3/16. * &lt;p&gt; * desc: å…·ä½“çš„è§‚å¯Ÿè€…ç±»ï¼Œä¹Ÿå°±æ˜¯è®¢é˜…è€… */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">implements</span> <span class="token class-name">Observer</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> mName<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>        mName <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>mName <span class="token operator">+</span> <span class="token string">": è®¢é˜…çš„"</span> <span class="token operator">+</span> message <span class="token operator">+</span> <span class="token string">"æ›´æ–°äº†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/3/16. * &lt;p&gt; * desc: æŠ½è±¡è¢«è§‚å¯Ÿè€…ç±» */</span><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Subject</span> <span class="token punctuation">{</span>    <span class="token comment">/**     * æ¨é€æ¶ˆæ¯     * @param message å†…å®¹     */</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">pushMsg</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * è®¢é˜…     * @param observer è®¢é˜…è€…     */</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">addObserver</span><span class="token punctuation">(</span><span class="token class-name">Observer</span> observer<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/3/16. * &lt;p&gt; * desc: å…·ä½“çš„è¢«è§‚å¯Ÿè€…ç±»ï¼Œä¹Ÿå°±æ˜¯è®¢é˜…çš„èŠ‚ç›® */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Animation</span> <span class="token keyword">extends</span> <span class="token class-name">Subject</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Observer</span><span class="token punctuation">&gt;</span></span> mObserverList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å‚¨å­˜è®¢é˜…è€…</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">pushMsg</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Observer</span> observer <span class="token operator">:</span> mObserverList<span class="token punctuation">)</span> <span class="token punctuation">{</span>            observer<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addObserver</span><span class="token punctuation">(</span><span class="token class-name">Observer</span> observer<span class="token punctuation">)</span> <span class="token punctuation">{</span>        mObserverList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">/** * Created by Weicools on 2017/3/16. * &lt;p&gt; * desc: */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">// è§‚å¯Ÿè€…, å³è®¢é˜…ç”¨æˆ·</span>        <span class="token class-name">User</span> user1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token string">"XXX"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">User</span> user2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token string">"YYY"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">User</span> user3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token string">"ZZZ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è¢«è§‚å¯Ÿè€…, ç”¨æˆ·è®¢é˜…çš„â€¦â€¦</span>        <span class="token class-name">Animation</span> animation <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        animation<span class="token punctuation">.</span><span class="token function">addObserver</span><span class="token punctuation">(</span>user1<span class="token punctuation">)</span><span class="token punctuation">;</span>        animation<span class="token punctuation">.</span><span class="token function">addObserver</span><span class="token punctuation">(</span>user2<span class="token punctuation">)</span><span class="token punctuation">;</span>        animation<span class="token punctuation">.</span><span class="token function">addObserver</span><span class="token punctuation">(</span>user3<span class="token punctuation">)</span><span class="token punctuation">;</span>        animation<span class="token punctuation">.</span><span class="token function">pushMsg</span><span class="token punctuation">(</span><span class="token string">"å¢ƒç•Œçš„å½¼æ–¹"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">// è¾“å‡ºXXX: è®¢é˜…çš„å¢ƒç•Œçš„å½¼æ–¹æ›´æ–°äº†YYY: è®¢é˜…çš„å¢ƒç•Œçš„å½¼æ–¹æ›´æ–°äº†ZZZ: è®¢é˜…çš„å¢ƒç•Œçš„å½¼æ–¹æ›´æ–°äº†<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ç”±ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºå®ç°äº†ä¸€å¯¹å¤šçš„æ¶ˆæ¯æ¨é€ï¼Œæ¨é€æ¶ˆæ¯éƒ½æ˜¯ä¾èµ– Observer å’Œ Observable è¿™äº›æŠ½è±¡ç±»ï¼Œè€Œ User å’Œ Teleplay å®Œå…¨æ²¡æœ‰è€¦åˆï¼Œä¿è¯äº†è®¢é˜…ç³»ç»Ÿçš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ã€‚</p><h2 id="4-Android-æºç ä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼"><a href="#4-Android-æºç ä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="4.Android æºç ä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼"></a>4.Android æºç ä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼</h2><h3 id="BaseAdapter"><a href="#BaseAdapter" class="headerlink" title="BaseAdapter"></a>BaseAdapter</h3><p>åœ¨ ListView çš„é€‚é…å™¨ä¸­æˆ‘ä»¬éƒ½æ˜¯ç»§æ‰¿ BaseAdapterã€‚ä¸‹é¢æ¥ç®€å•åˆ†æåˆ†æã€‚BaseAdapter éƒ¨åˆ†ä»£ç ï¼š</p><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">public abstract class BaseAdapter implements ListAdapter, SpinnerAdapter {    //æ•°æ®é›†è§‚å¯Ÿè€…    private final DataSetObservable mDataSetObservable = new DataSetObservable();    public boolean hasStableIds() {        return false;    }    public void registerDataSetObserver(DataSetObserver observer) {        mDataSetObservable.registerObserver(observer);    }    public void unregisterDataSetObserver(DataSetObserver observer) {        mDataSetObservable.unregisterObserver(observer);    }    /**     * å½“æ•°æ®é›†å˜åŒ–æ—¶ï¼Œé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…     */    public void notifyDataSetChanged() {        mDataSetObservable.notifyChanged();    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>çœ‹çœ‹ mDataSetObservable.notifyChanged()æ–¹æ³•ï¼š</p><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">public class DataSetObservable extends Observable&lt;DataSetObserver&gt; {    /**     * Invokes {@link DataSetObserver#onChanged} on each observer.     * Called when the contents of the data set have changed.  The recipient     * will obtain the new contents the next time it queries the data set.     */    public void notifyChanged() {        synchronized(mObservers) {            // since onChanged() is implemented by the app, it could do anything, including            // removing itself from {@link mObservers} - and that could cause problems if            // an iterator is used on the ArrayList {@link mObservers}.            // to avoid such problems, just march thru the list in the reverse order.            for (int i = mObservers.size() - 1; i &gt;= 0; i--) {                mObservers.get(i).onChanged();            }        }    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹å‡ºåœ¨ mDataSetObservable.notifyChanged()ä¸­éå†æ‰€æœ‰è§‚å¯Ÿè€…ï¼Œå¹¶è°ƒç”¨ä»–ä»¬çš„ onChanged()ï¼Œä»è€Œå‘ŠçŸ¥è§‚å¯Ÿè€…éœ€è¦åšä»€ä¹ˆã€‚</p><p>é‚£ä¹ˆè§‚å¯Ÿè€…æ€ä¹ˆæ¥çš„ï¼Œé‚£å°±æ˜¯ setAdapter æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">@Overridepublic void setAdapter(ListAdapter adapter) {    if (mAdapter != null &amp;&amp; mDataSetObserver != null) {        mAdapter.unregisterDataSetObserver(mDataSetObserver);    }    resetList();    mRecycler.clear();    if (mHeaderViewInfos.size() &gt; 0|| mFooterViewInfos.size() &gt; 0) {        mAdapter = new HeaderViewListAdapter(mHeaderViewInfos, mFooterViewInfos, adapter);    } else {        mAdapter = adapter;    }    mOldSelectedPosition = INVALID_POSITION;    mOldSelectedRowId = INVALID_ROW_ID;    // AbsListView#setAdapter will update choice mode states.    super.setAdapter(adapter);    if (mAdapter != null) {        mAreAllItemsSelectable = mAdapter.areAllItemsEnabled();        mOldItemCount = mItemCount;        mItemCount = mAdapter.getCount();        checkFocus();        mDataSetObserver = new AdapterDataSetObserver();        mAdapter.registerDataSetObserver(mDataSetObserver);//æ³¨å†Œè§‚å¯Ÿè€…        ......çœç•¥    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>AdapterDataSetObserver å®šä¹‰åœ¨ ListView çš„çˆ¶ç±» AbsListView ä¸­ï¼Œæ˜¯ä¸€ä¸ªæ•°æ®é›†è§‚å¯Ÿè€…ï¼Œä»£ç ï¼š</p><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">class AdapterDataSetObserver extends AdapterView&lt;ListAdapter&gt;.AdapterDataSetObserver {    @Override    public void onChanged() {        super.onChanged();        if (mFastScroller != null) {            mFastScroller.onSectionsChanged();        }    }    @Override    public void onInvalidated() {        super.onInvalidated();        if (mFastScroller != null) {            mFastScroller.onSectionsChanged();        }    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ƒç”±ç»§æ‰¿è‡ª AbsListView çš„çˆ¶ç±» AdapterView çš„ AdapterDataSetObserver, ä»£ç å¦‚ä¸‹ :</p><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">class AdapterDataSetObserver extends DataSetObserver {    private Parcelable mInstanceState = null;    // ä¸Šæ–‡æœ‰è¯´é“ï¼Œè°ƒç”¨Adapterçš„notifyDataSetChangedçš„æ—¶å€™ä¼šè°ƒç”¨æ‰€æœ‰è§‚å¯Ÿè€…çš„onChangedæ–¹æ³•,æ ¸å¿ƒå®ç°å°±åœ¨è¿™é‡Œ    @Override    public void onChanged() {        mDataChanged = true;        mOldItemCount = mItemCount;        // è·å–Adapterä¸­æ•°æ®çš„æ•°é‡        mItemCount = getAdapter().getCount();        // Detect the case where a cursor that was previously invalidated has        // been repopulated with new data.        if (AdapterView.this.getAdapter().hasStableIds() &amp;&amp; mInstanceState != null                &amp;&amp; mOldItemCount == 0 &amp;&amp; mItemCount &gt; 0) {            AdapterView.this.onRestoreInstanceState(mInstanceState);            mInstanceState = null;        } else {            rememberSyncState();        }        checkFocus();        // é‡æ–°å¸ƒå±€ListViewã€GridViewç­‰AdapterViewç»„ä»¶        requestLayout();    }    // ä»£ç çœç•¥    public void clearSavedState() {        mInstanceState = null;    }}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“ ListView çš„æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè°ƒç”¨ Adapter çš„ notifyDataSetChanged å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°åˆä¼šè°ƒç”¨ DataSetObservable çš„ notifyChanged å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè°ƒç”¨æ‰€æœ‰è§‚å¯Ÿè€… (AdapterDataSetObserver) çš„ onChanged æ–¹æ³•ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªè§‚å¯Ÿè€…æ¨¡å¼ï¼</p><h2 id="5-Summary"><a href="#5-Summary" class="headerlink" title="5.Summary"></a>5.Summary</h2><ol><li>ä¼˜ç‚¹<ul><li>è§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…ä¹‹é—´æ˜¯æŠ½è±¡è€¦åˆï¼Œå°†è§‚å¯Ÿè€…ä¸è¢«è§‚å¯Ÿè€…å®Œå…¨éš”ç¦»ï¼Œåªä¾èµ–äº Observer å’Œ Observable æŠ½è±¡ï¼Œåº”å¯¹ä¸šåŠ¡å˜åŒ–ã€‚</li><li>å¢å¼ºç³»ç»Ÿçš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ã€‚</li></ul></li><li>ç¼ºç‚¹<ul><li>åœ¨åº”ç”¨è§‚å¯Ÿè€…æ¨¡å¼æ—¶éœ€è¦è€ƒè™‘ä¸€ä¸‹å¼€å‘æ•ˆç‡å’Œè¿è¡Œæ•ˆç‡çš„é—®é¢˜ï¼Œç¨‹åºä¸­åŒ…æ‹¬ä¸€ä¸ªè¢«è§‚å¯Ÿè€…ã€å¤šä¸ªè§‚å¯Ÿè€…ï¼Œå¼€å‘ã€è°ƒè¯•ç­‰å†…å®¹ä¼šæ¯”è¾ƒå¤æ‚ï¼Œè€Œä¸”åœ¨ Java ä¸­æ¶ˆæ¯çš„é€šçŸ¥ä¸€èˆ¬æ˜¯é¡ºåºæ‰§è¡Œï¼Œé‚£ä¹ˆä¸€ä¸ªè§‚å¯Ÿè€…å¡é¡¿ï¼Œä¼šå½±å“æ•´ä½“çš„æ‰§è¡Œæ•ˆç‡ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸€èˆ¬ä¼šé‡‡ç”¨å¼‚æ­¥å®ç°ã€‚</li></ul></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Java </tag>
            
            <tag> DesignPattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼</title>
      <link href="/20170218/designpattern/"/>
      <url>/20170218/designpattern/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="è®¾è®¡æ¨¡å¼"><a href="#è®¾è®¡æ¨¡å¼" class="headerlink" title="è®¾è®¡æ¨¡å¼"></a>è®¾è®¡æ¨¡å¼</h1><p><img src="http://blog-1251678165.coscd.myqcloud.com/2018-03-17-Design-Pattern.png"></p><blockquote><p>ğŸ˜ğŸ˜‚ è¡¨ç¤ºé‡è¦ç¨‹åº¦</p></blockquote><h2 id="åˆ›å»ºå‹æ¨¡å¼-Creational-Pattern"><a href="#åˆ›å»ºå‹æ¨¡å¼-Creational-Pattern" class="headerlink" title="åˆ›å»ºå‹æ¨¡å¼(Creational Pattern)"></a>åˆ›å»ºå‹æ¨¡å¼(Creational Pattern)</h2><p>åˆ›å»ºå‹æ¨¡å¼å¯¹ç±»çš„å®ä¾‹åŒ–è¿‡ç¨‹è¿›è¡ŒæŠ½è±¡ï¼Œèƒ½å¤Ÿå°†è½¯ä»¶æ¨¡å—ä¸­çš„å¯¹è±¡åˆ›å»ºå’Œå¯¹è±¡ä½¿ç”¨åˆ†ç¦»ã€‚ä¸ºäº†ä½¿è½¯ä»¶çš„ç»“æ„æ›´åŠ æ¸…æ™°ï¼Œå¤–ç•Œå¯¹äºè¿™äº›å¯¹è±¡åªéœ€è¦çŸ¥é“å®ƒä»¬å…±åŒçš„æ¥å£ï¼Œè€Œä¸æ¸…æ¥šå…¶å…·ä½“çš„å®ç°ç»†èŠ‚ï¼Œä½¿æ•´ä¸ªç³»ç»Ÿçš„è®¾è®¡æ›´åŠ ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ã€‚</p><p>åˆ›å»ºå‹æ¨¡å¼åœ¨åˆ›å»ºä»€ä¹ˆ(What)ï¼Œç”±è°åˆ›å»º(Who)ï¼Œä½•æ—¶åˆ›å»º(When)ç­‰æ–¹é¢éƒ½ä¸ºè½¯ä»¶è®¾è®¡è€…æä¾›äº†å°½å¯èƒ½å¤§çš„çµæ´»æ€§ã€‚åˆ›å»ºå‹æ¨¡å¼éšè—äº†ç±»çš„å®ä¾‹çš„åˆ›å»ºç»†èŠ‚ï¼Œé€šè¿‡éšè—å¯¹è±¡å¦‚ä½•è¢«åˆ›å»ºå’Œç»„åˆåœ¨ä¸€èµ·è¾¾åˆ°ä½¿æ•´ä¸ªç³»ç»Ÿç‹¬ç«‹çš„ç›®çš„ã€‚</p><h3 id="1-å•ä¾‹æ¨¡å¼-Singleton-Pattern"><a href="#1-å•ä¾‹æ¨¡å¼-Singleton-Pattern" class="headerlink" title="1.å•ä¾‹æ¨¡å¼(Singleton Pattern)"></a>1.å•ä¾‹æ¨¡å¼(Singleton Pattern)</h3><h3 id="2-ç®€å•å·¥ç¨‹æ¨¡å¼-Simple-Factory-Pattern"><a href="#2-ç®€å•å·¥ç¨‹æ¨¡å¼-Simple-Factory-Pattern" class="headerlink" title="2.ç®€å•å·¥ç¨‹æ¨¡å¼(Simple Factory Pattern)"></a>2.ç®€å•å·¥ç¨‹æ¨¡å¼(Simple Factory Pattern)</h3><h3 id="3-å·¥å‚æ–¹æ³•æ¨¡å¼-Factory-Method-Pattern"><a href="#3-å·¥å‚æ–¹æ³•æ¨¡å¼-Factory-Method-Pattern" class="headerlink" title="3.å·¥å‚æ–¹æ³•æ¨¡å¼(Factory Method Pattern)"></a>3.å·¥å‚æ–¹æ³•æ¨¡å¼(Factory Method Pattern)</h3><h3 id="4-æŠ½è±¡å·¥å‚æ¨¡å¼-Abstract-Factory-Pattern"><a href="#4-æŠ½è±¡å·¥å‚æ¨¡å¼-Abstract-Factory-Pattern" class="headerlink" title="4.æŠ½è±¡å·¥å‚æ¨¡å¼(Abstract Factory Pattern)"></a>4.æŠ½è±¡å·¥å‚æ¨¡å¼(Abstract Factory Pattern)</h3><h3 id="5-å»ºé€ è€…æ¨¡å¼-Builder-Pattern"><a href="#5-å»ºé€ è€…æ¨¡å¼-Builder-Pattern" class="headerlink" title="5.å»ºé€ è€…æ¨¡å¼(Builder Pattern)"></a>5.å»ºé€ è€…æ¨¡å¼(Builder Pattern)</h3><h3 id="6-åŸå‹æ¨¡å¼-Prototype-Pattern"><a href="#6-åŸå‹æ¨¡å¼-Prototype-Pattern" class="headerlink" title="6.åŸå‹æ¨¡å¼(Prototype Pattern)"></a>6.åŸå‹æ¨¡å¼(Prototype Pattern)</h3><h2 id="ç»“æ„å‹æ¨¡å¼-Structural-Pattern"><a href="#ç»“æ„å‹æ¨¡å¼-Structural-Pattern" class="headerlink" title="ç»“æ„å‹æ¨¡å¼(Structural Pattern)"></a>ç»“æ„å‹æ¨¡å¼(Structural Pattern)</h2><ol><li>ç»“æ„å‹æ¨¡å¼æè¿°å¦‚ä½•å°†ç±»æˆ–è€…å¯¹ è±¡ç»“åˆåœ¨ä¸€èµ·å½¢æˆæ›´å¤§çš„ç»“æ„ï¼Œå°±åƒæ­ç§¯æœ¨ï¼Œå¯ä»¥é€šè¿‡ ç®€å•ç§¯æœ¨çš„ç»„åˆå½¢æˆå¤æ‚çš„ã€åŠŸèƒ½æ›´ä¸ºå¼ºå¤§çš„ç»“æ„ã€‚</li><li>ç»“æ„å‹æ¨¡å¼å¯ä»¥åˆ†ä¸ºç±»ç»“æ„å‹æ¨¡å¼å’Œå¯¹è±¡ç»“æ„å‹æ¨¡å¼ï¼š<ul><li>ç±»ç»“æ„å‹æ¨¡å¼å…³å¿ƒç±»çš„ç»„åˆï¼Œç”±å¤šä¸ªç±»å¯ä»¥ç»„åˆæˆä¸€ä¸ªæ›´å¤§çš„ç³»ç»Ÿï¼Œåœ¨ç±»ç»“æ„å‹æ¨¡å¼ä¸­ä¸€èˆ¬åªå­˜åœ¨ç»§æ‰¿å…³ç³»å’Œå®ç°å…³ç³»ã€‚</li><li>å¯¹è±¡ç»“æ„å‹æ¨¡å¼å…³å¿ƒç±»ä¸å¯¹è±¡çš„ç»„åˆï¼Œé€šè¿‡å…³è”å…³ç³»ä½¿å¾—åœ¨ä¸€ ä¸ªç±»ä¸­å®šä¹‰å¦ä¸€ä¸ªç±»çš„å®ä¾‹å¯¹è±¡ï¼Œç„¶åé€šè¿‡è¯¥å¯¹è±¡è°ƒç”¨å…¶æ–¹æ³•ã€‚ æ ¹æ®â€œåˆæˆå¤ç”¨åŸåˆ™â€ï¼Œåœ¨ç³»ç»Ÿä¸­å°½é‡ä½¿ç”¨å…³è”å…³ç³»æ¥æ›¿ä»£ç»§ æ‰¿å…³ç³»ï¼Œå› æ­¤å¤§éƒ¨åˆ†ç»“æ„å‹æ¨¡å¼éƒ½æ˜¯å¯¹è±¡ç»“æ„å‹æ¨¡å¼ã€‚</li></ul></li></ol><h3 id="1-é€‚é…å™¨æ¨¡å¼-Adapter-Pattern"><a href="#1-é€‚é…å™¨æ¨¡å¼-Adapter-Pattern" class="headerlink" title="1.é€‚é…å™¨æ¨¡å¼(Adapter Pattern)"></a>1.é€‚é…å™¨æ¨¡å¼(Adapter Pattern)</h3><h3 id="2-æ¡¥æ¥æ¨¡å¼-Bridge-Pattern"><a href="#2-æ¡¥æ¥æ¨¡å¼-Bridge-Pattern" class="headerlink" title="2.æ¡¥æ¥æ¨¡å¼(Bridge Pattern)"></a>2.æ¡¥æ¥æ¨¡å¼(Bridge Pattern)</h3><h3 id="3-è£…é¥°æ¨¡å¼-Decorator-Pattern"><a href="#3-è£…é¥°æ¨¡å¼-Decorator-Pattern" class="headerlink" title="3.è£…é¥°æ¨¡å¼(Decorator Pattern)"></a>3.è£…é¥°æ¨¡å¼(Decorator Pattern)</h3><h3 id="4-å¤–è§‚æ¨¡å¼-Facade-Pattern"><a href="#4-å¤–è§‚æ¨¡å¼-Facade-Pattern" class="headerlink" title="4.å¤–è§‚æ¨¡å¼(Facade Pattern)"></a>4.å¤–è§‚æ¨¡å¼(Facade Pattern)</h3><h3 id="5-äº«å…ƒæ¨¡å¼-Flyweight-Pattern"><a href="#5-äº«å…ƒæ¨¡å¼-Flyweight-Pattern" class="headerlink" title="5.äº«å…ƒæ¨¡å¼(Flyweight Pattern)"></a>5.äº«å…ƒæ¨¡å¼(Flyweight Pattern)</h3><h3 id="6-ä»£ç†æ¨¡å¼-Proxy-Pattern"><a href="#6-ä»£ç†æ¨¡å¼-Proxy-Pattern" class="headerlink" title="6.ä»£ç†æ¨¡å¼(Proxy Pattern)"></a>6.ä»£ç†æ¨¡å¼(Proxy Pattern)</h3><h3 id="7-ç»„åˆæ¨¡å¼-Composite-Pattern"><a href="#7-ç»„åˆæ¨¡å¼-Composite-Pattern" class="headerlink" title="7.ç»„åˆæ¨¡å¼(Composite Pattern)"></a>7.ç»„åˆæ¨¡å¼(Composite Pattern)</h3><h2 id="è¡Œä¸ºå‹æ¨¡å¼-Behavioral-Pattern"><a href="#è¡Œä¸ºå‹æ¨¡å¼-Behavioral-Pattern" class="headerlink" title="è¡Œä¸ºå‹æ¨¡å¼(Behavioral Pattern)"></a>è¡Œä¸ºå‹æ¨¡å¼(Behavioral Pattern)</h2><ol><li>è¡Œä¸ºå‹æ¨¡å¼æ˜¯å¯¹åœ¨ä¸åŒçš„å¯¹è±¡ä¹‹é—´åˆ’åˆ†è´£ä»»å’Œç®—æ³•çš„æŠ½è±¡åŒ–ã€‚</li><li>è¡Œä¸ºå‹æ¨¡å¼ä¸ä»…ä»…å…³æ³¨ç±»å’Œå¯¹è±¡çš„ç»“æ„ï¼Œè€Œä¸”é‡ç‚¹å…³æ³¨å®ƒä»¬ä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€‚</li><li>é€šè¿‡è¡Œä¸ºå‹æ¨¡å¼ï¼Œå¯ä»¥æ›´åŠ æ¸…æ™°åœ°åˆ’åˆ†ç±»ä¸å¯¹è±¡çš„èŒè´£ï¼Œå¹¶ç ”ç©¶ç³»ç»Ÿåœ¨è¿è¡Œæ—¶å®ä¾‹å¯¹è±¡ ä¹‹é—´çš„äº¤äº’ã€‚åœ¨ç³»ç»Ÿè¿è¡Œæ—¶ï¼Œå¯¹è±¡å¹¶ä¸æ˜¯å­¤ç«‹çš„ï¼Œå®ƒä»¬å¯ä»¥é€šè¿‡ç›¸äº’é€šä¿¡ä¸åä½œå®ŒæˆæŸäº›å¤æ‚åŠŸèƒ½ï¼Œä¸€ä¸ªå¯¹è±¡åœ¨è¿è¡Œæ—¶ä¹Ÿå°†å½±å“åˆ°å…¶ä»–å¯¹è±¡çš„è¿è¡Œã€‚</li><li>è¡Œä¸ºå‹æ¨¡å¼åˆ†ä¸ºç±»è¡Œä¸ºå‹æ¨¡å¼å’Œå¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ä¸¤ç§ï¼š<ul><li>ç±»è¡Œä¸ºå‹æ¨¡å¼ï¼šç±»çš„è¡Œä¸ºå‹æ¨¡å¼ä½¿ç”¨ç»§æ‰¿å…³ç³»åœ¨å‡ ä¸ªç±»ä¹‹é—´åˆ†é…è¡Œä¸ºï¼Œç±»è¡Œä¸ºå‹æ¨¡å¼ä¸»è¦é€šè¿‡å¤šæ€ç­‰æ–¹å¼æ¥åˆ†é…çˆ¶ç±»ä¸å­ç±»çš„èŒè´£ã€‚</li><li>å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ï¼šå¯¹è±¡çš„è¡Œä¸ºå‹æ¨¡å¼åˆ™ä½¿ç”¨å¯¹è±¡çš„èšåˆå…³è”å…³ç³»æ¥åˆ†é…è¡Œä¸ºï¼Œå¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ä¸»è¦æ˜¯é€šè¿‡å¯¹è±¡å…³è”ç­‰æ–¹å¼æ¥åˆ†é…ä¸¤ä¸ªæˆ–å¤šä¸ªç±»çš„èŒè´£ã€‚æ ¹æ®â€œåˆæˆå¤ç”¨åŸåˆ™â€ï¼Œç³»ç»Ÿä¸­è¦å°½é‡ä½¿ç”¨å…³è”å…³ç³»æ¥å–ä»£ç»§æ‰¿å…³ç³»ï¼Œå› æ­¤å¤§éƒ¨åˆ†è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼éƒ½å±äºå¯¹è±¡è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼</li></ul></li></ol><h3 id="1-è§‚å¯Ÿè€…æ¨¡å¼-Observer-Pattern"><a href="#1-è§‚å¯Ÿè€…æ¨¡å¼-Observer-Pattern" class="headerlink" title="1.è§‚å¯Ÿè€…æ¨¡å¼(Observer Pattern)"></a>1.è§‚å¯Ÿè€…æ¨¡å¼(Observer Pattern)</h3><h3 id="2-ç­–ç•¥æ¨¡å¼-Strategy-Pattern"><a href="#2-ç­–ç•¥æ¨¡å¼-Strategy-Pattern" class="headerlink" title="2.ç­–ç•¥æ¨¡å¼(Strategy Pattern)"></a>2.ç­–ç•¥æ¨¡å¼(Strategy Pattern)</h3><h3 id="3-çŠ¶æ€æ¨¡å¼-State-Pattern"><a href="#3-çŠ¶æ€æ¨¡å¼-State-Pattern" class="headerlink" title="3.çŠ¶æ€æ¨¡å¼(State Pattern)"></a>3.çŠ¶æ€æ¨¡å¼(State Pattern)</h3><h3 id="4-å‘½ä»¤æ¨¡å¼-Command-Pattern"><a href="#4-å‘½ä»¤æ¨¡å¼-Command-Pattern" class="headerlink" title="4.å‘½ä»¤æ¨¡å¼(Command Pattern)"></a>4.å‘½ä»¤æ¨¡å¼(Command Pattern)</h3><h3 id="5-ä¸­ä»‹è€…æ¨¡å¼-Mediator-Pattern"><a href="#5-ä¸­ä»‹è€…æ¨¡å¼-Mediator-Pattern" class="headerlink" title="5.ä¸­ä»‹è€…æ¨¡å¼(Mediator Pattern)"></a>5.ä¸­ä»‹è€…æ¨¡å¼(Mediator Pattern)</h3><h3 id="6-è¿­ä»£å™¨æ¨¡å¼-Iterator-Pattern"><a href="#6-è¿­ä»£å™¨æ¨¡å¼-Iterator-Pattern" class="headerlink" title="6.è¿­ä»£å™¨æ¨¡å¼(Iterator Pattern)"></a>6.è¿­ä»£å™¨æ¨¡å¼(Iterator Pattern)</h3><h3 id="7-å¤‡å¿˜å½•æ¨¡å¼-Memento-Pattern"><a href="#7-å¤‡å¿˜å½•æ¨¡å¼-Memento-Pattern" class="headerlink" title="7.å¤‡å¿˜å½•æ¨¡å¼(Memento Pattern)"></a>7.å¤‡å¿˜å½•æ¨¡å¼(Memento Pattern)</h3><h3 id="8-æ¨¡æ¿æ–¹æ³•æ¨¡å¼-Template-Method-Pattern"><a href="#8-æ¨¡æ¿æ–¹æ³•æ¨¡å¼-Template-Method-Pattern" class="headerlink" title="8.æ¨¡æ¿æ–¹æ³•æ¨¡å¼(Template Method Pattern)"></a>8.æ¨¡æ¿æ–¹æ³•æ¨¡å¼(Template Method Pattern)</h3><h3 id="9-è®¿é—®è€…æ¨¡å¼-Visitor-Pattern"><a href="#9-è®¿é—®è€…æ¨¡å¼-Visitor-Pattern" class="headerlink" title="9.è®¿é—®è€…æ¨¡å¼(Visitor Pattern)"></a>9.è®¿é—®è€…æ¨¡å¼(Visitor Pattern)</h3><h3 id="10-è§£é‡Šå™¨æ¨¡å¼-Interpreter-Pattern"><a href="#10-è§£é‡Šå™¨æ¨¡å¼-Interpreter-Pattern" class="headerlink" title="10.è§£é‡Šå™¨æ¨¡å¼(Interpreter Pattern)"></a>10.è§£é‡Šå™¨æ¨¡å¼(Interpreter Pattern)</h3><h3 id="11-è´£ä»»é“¾æ¨¡å¼-Chain-of-Responsibility"><a href="#11-è´£ä»»é“¾æ¨¡å¼-Chain-of-Responsibility" class="headerlink" title="11.è´£ä»»é“¾æ¨¡å¼(Chain of Responsibility)"></a>11.è´£ä»»é“¾æ¨¡å¼(Chain of Responsibility)</h3>]]></content>
      
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> DesignPattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼ä¹‹ç®€å•å·¥å‚æ¨¡å¼</title>
      <link href="/20161018/designpattern-creator-simple-factory-pattern/"/>
      <url>/20161018/designpattern-creator-simple-factory-pattern/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="è®¾è®¡æ¨¡å¼ä¹‹ç®€å•å·¥å‚æ¨¡å¼"><a href="#è®¾è®¡æ¨¡å¼ä¹‹ç®€å•å·¥å‚æ¨¡å¼" class="headerlink" title="è®¾è®¡æ¨¡å¼ä¹‹ç®€å•å·¥å‚æ¨¡å¼"></a>è®¾è®¡æ¨¡å¼ä¹‹ç®€å•å·¥å‚æ¨¡å¼</h1><h2 id="1-é—®é¢˜"><a href="#1-é—®é¢˜" class="headerlink" title="1.é—®é¢˜"></a>1.é—®é¢˜</h2><p>è€ƒè™‘ä¸€ä¸ªç®€å•çš„è½¯ä»¶åº”ç”¨åœºæ™¯ï¼Œä¸€ä¸ªè½¯ä»¶ç³»ç»Ÿå¯ä»¥æä¾›å¤šä¸ªå¤–è§‚ä¸åŒçš„æŒ‰é’®ï¼ˆå¦‚åœ†å½¢æŒ‰é’®ã€çŸ©å½¢æŒ‰é’®ã€è±å½¢æŒ‰é’®ç­‰ï¼‰ï¼Œ è¿™äº›æŒ‰é’®éƒ½æºè‡ªåŒä¸€ä¸ªåŸºç±»ï¼Œä¸è¿‡åœ¨ç»§æ‰¿åŸºç±»åä¸åŒçš„å­ç±»ä¿®æ”¹äº†éƒ¨åˆ†å±æ€§ä»è€Œä½¿å¾—å®ƒä»¬å¯ä»¥å‘ˆç°ä¸åŒçš„å¤–è§‚ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›åœ¨ä½¿ç”¨è¿™äº›æŒ‰é’®æ—¶ï¼Œä¸éœ€è¦çŸ¥é“è¿™äº›å…·ä½“æŒ‰é’®ç±»çš„åå­—ï¼Œåªéœ€è¦çŸ¥é“è¡¨ç¤ºè¯¥æŒ‰é’®ç±»çš„ä¸€ä¸ªå‚æ•°ï¼Œå¹¶æä¾›ä¸€ä¸ªè°ƒç”¨æ–¹ä¾¿çš„æ–¹æ³•ï¼ŒæŠŠè¯¥å‚æ•°ä¼ å…¥æ–¹æ³•å³å¯è¿”å›ä¸€ä¸ªç›¸åº”çš„æŒ‰é’®å¯¹è±¡ï¼Œæ­¤æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼</p><h2 id="2-æ¨¡å¼å®šä¹‰"><a href="#2-æ¨¡å¼å®šä¹‰" class="headerlink" title="2.æ¨¡å¼å®šä¹‰"></a>2.æ¨¡å¼å®šä¹‰</h2><p>ç®€å•å·¥å‚æ¨¡å¼(Simple Factory Pattern)ï¼šåˆç§°ä¸ºé™æ€å·¥å‚æ–¹æ³•(Static Factory Method)æ¨¡å¼ï¼Œå®ƒå±äºç±»åˆ›å»ºå‹æ¨¡å¼ã€‚åœ¨ç®€å•å·¥å‚æ¨¡å¼ä¸­ï¼Œå¯ä»¥æ ¹æ®å‚æ•°çš„ä¸åŒè¿”å›ä¸åŒç±»çš„å®ä¾‹ã€‚ç®€å•å·¥å‚æ¨¡å¼ä¸“é—¨å®šä¹‰ä¸€ä¸ªç±»æ¥è´Ÿè´£åˆ›å»ºå…¶ä»–ç±»çš„å®ä¾‹ï¼Œè¢«åˆ›å»ºçš„å®ä¾‹é€šå¸¸éƒ½å…·æœ‰å…±åŒçš„çˆ¶ç±»</p><h2 id="3-æ¨¡å¼ç»“æ„-amp-UMLç±»å›¾"><a href="#3-æ¨¡å¼ç»“æ„-amp-UMLç±»å›¾" class="headerlink" title="3.æ¨¡å¼ç»“æ„&amp;UMLç±»å›¾"></a>3.æ¨¡å¼ç»“æ„&amp;UMLç±»å›¾</h2><ol><li><p>ç®€å•å·¥å‚æ¨¡å¼åŒ…å«å¦‚ä¸‹è§’è‰²ï¼š</p><ul><li>Factoryï¼šå·¥å‚è§’è‰² - å·¥å‚è§’è‰²è´Ÿè´£å®ç°åˆ›å»ºæ‰€æœ‰å®ä¾‹çš„å†…éƒ¨é€»è¾‘</li><li>Productï¼šæŠ½è±¡äº§å“è§’è‰² - æŠ½è±¡äº§å“è§’è‰²æ˜¯æ‰€åˆ›å»ºçš„æ‰€æœ‰å¯¹è±¡çš„çˆ¶ç±»ï¼Œè´Ÿè´£æè¿°æ‰€æœ‰å®ä¾‹æ‰€å…±æœ‰çš„å…¬å…±æ¥å£</li><li>ConcreteProductï¼šå…·ä½“äº§å“è§’è‰² - å…·ä½“äº§å“è§’è‰²æ˜¯åˆ›å»ºç›®æ ‡ï¼Œæ‰€æœ‰åˆ›å»ºçš„å¯¹è±¡éƒ½å……å½“è¿™ä¸ªè§’è‰²çš„æŸä¸ªå…·ä½“ç±»çš„å®ä¾‹</li></ul></li><li><p>UMLç±»å›¾<br><img src="https://blog-bak-1251678165.cos.ap-beijing.myqcloud.com/2016-10-18-SimpleFactory.jpg" alt="SimpleFactory"></p></li></ol><h2 id="4-æ—¶åºå›¾"><a href="#4-æ—¶åºå›¾" class="headerlink" title="4.æ—¶åºå›¾"></a>4.æ—¶åºå›¾</h2><p><img src="https://blog-bak-1251678165.cos.ap-beijing.myqcloud.com/2016-10-18-seq_SimpleFactory.jpg" alt="seq_SimpleFactory"></p><h2 id="5-å®ç°æ–¹å¼"><a href="#5-å®ç°æ–¹å¼" class="headerlink" title="5.å®ç°æ–¹å¼"></a>5.å®ç°æ–¹å¼</h2><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token class-name">SimpleFactoryPattern</span><span class="token punctuation">;</span><span class="token comment">/** * Created by weicools on 2016/10/18. */</span><span class="token comment">// Animal.java  æŠ½è±¡äº§å“è§’è‰²</span><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token class-name">SimpleFactoryPattern</span><span class="token punctuation">;</span><span class="token comment">/** * Created by weicools on 2016/10/18. */</span><span class="token comment">// Dog.java å…·ä½“äº§å“è§’è‰²</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Dog</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Dog eat!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token class-name">SimpleFactoryPattern</span><span class="token punctuation">;</span><span class="token comment">/** * Created by weicools on 2016/10/18. */</span><span class="token comment">// Pig.java å…·ä½“äº§å“è§’è‰²</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Pig</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Pig eat!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token class-name">SimpleFactoryPattern</span><span class="token punctuation">;</span><span class="token comment">/** * Created by weicools on 2016/10/18. */</span><span class="token comment">// AnimalFactory.java  å·¥å‚è§’è‰²</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AnimalFactory</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token class-name">AnimalFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Animal</span> <span class="token function">animalFactory</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"dog"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"pig"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Pig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token class-name">SimpleFactoryPattern</span><span class="token punctuation">;</span><span class="token comment">/** * Created by weicools on 2016/10/18. */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AnimalTest</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">Animal</span> dog <span class="token operator">=</span> <span class="token class-name">AnimalFactory</span><span class="token punctuation">.</span><span class="token function">animalFactory</span><span class="token punctuation">(</span><span class="token string">"dog"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        dog<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Animal</span> pig <span class="token operator">=</span> <span class="token class-name">AnimalFactory</span><span class="token punctuation">.</span><span class="token function">animalFactory</span><span class="token punctuation">(</span><span class="token string">"pig"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        pig<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Animal</span> animal <span class="token operator">=</span> <span class="token class-name">AnimalFactory</span><span class="token punctuation">.</span><span class="token function">animalFactory</span><span class="token punctuation">(</span><span class="token string">"dog"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        animal<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        animal <span class="token operator">=</span> <span class="token class-name">AnimalFactory</span><span class="token punctuation">.</span><span class="token function">animalFactory</span><span class="token punctuation">(</span><span class="token string">"pig"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        animal<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="6-æ¨¡å¼åˆ†æ"><a href="#6-æ¨¡å¼åˆ†æ" class="headerlink" title="6.æ¨¡å¼åˆ†æ"></a>6.æ¨¡å¼åˆ†æ</h2><ol><li>å°†å¯¹è±¡çš„åˆ›å»ºå’Œå¯¹è±¡æœ¬èº«ä¸šåŠ¡å¤„ç†åˆ†ç¦»å¯ä»¥é™ä½ç³»ç»Ÿçš„è€¦åˆåº¦ï¼Œä½¿å¾—ä¸¤è€…ä¿®æ”¹èµ·æ¥éƒ½ç›¸å¯¹å®¹æ˜“ã€‚</li><li>åœ¨è°ƒç”¨å·¥å‚ç±»çš„å·¥å‚æ–¹æ³•æ—¶ï¼Œç”±äºå·¥å‚æ–¹æ³•æ˜¯é™æ€æ–¹æ³•ï¼Œä½¿ç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ï¼Œå¯é€šè¿‡ç±»åç›´æ¥è°ƒç”¨ï¼Œè€Œä¸”åªéœ€è¦ä¼ å…¥ä¸€ä¸ªç®€å•çš„å‚æ•°å³å¯ï¼Œåœ¨å®é™…å¼€å‘ä¸­ï¼Œè¿˜å¯ä»¥åœ¨è°ƒç”¨æ—¶å°†æ‰€ä¼ å…¥çš„å‚æ•°ä¿å­˜åœ¨XMLç­‰æ ¼å¼çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œä¿®æ”¹å‚æ•°æ—¶æ— é¡»ä¿®æ”¹ä»»ä½•æºä»£ç ã€‚</li><li>ç®€å•å·¥å‚æ¨¡å¼æœ€å¤§çš„é—®é¢˜åœ¨äºå·¥å‚ç±»çš„èŒè´£ç›¸å¯¹è¿‡é‡ï¼Œå¢åŠ æ–°çš„äº§å“éœ€è¦ä¿®æ”¹å·¥å‚ç±»çš„åˆ¤æ–­é€»è¾‘ï¼Œè¿™ä¸€ç‚¹ä¸å¼€é—­åŸåˆ™æ˜¯ç›¸è¿èƒŒçš„ã€‚</li><li>ç®€å•å·¥å‚æ¨¡å¼çš„è¦ç‚¹åœ¨äºï¼šå½“ä½ éœ€è¦ä»€ä¹ˆï¼Œåªéœ€è¦ä¼ å…¥ä¸€ä¸ªæ­£ç¡®çš„å‚æ•°ï¼Œå°±å¯ä»¥è·å–ä½ æ‰€éœ€è¦çš„å¯¹è±¡ï¼Œè€Œæ— é¡»çŸ¥é“å…¶åˆ›å»ºç»†èŠ‚</li></ol><h2 id="7-ä¼˜ç‚¹-amp-ç¼ºç‚¹"><a href="#7-ä¼˜ç‚¹-amp-ç¼ºç‚¹" class="headerlink" title="7.ä¼˜ç‚¹&amp;ç¼ºç‚¹"></a>7.ä¼˜ç‚¹&amp;ç¼ºç‚¹</h2><ol><li>ä¼˜ç‚¹(å¸®åŠ©å°è£…/è§£è€¦)<ul><li>å·¥å‚ç±»å«æœ‰å¿…è¦çš„åˆ¤æ–­é€»è¾‘ï¼Œå¯ä»¥å†³å®šåœ¨ä»€ä¹ˆæ—¶å€™åˆ›å»ºå“ªä¸€ä¸ªäº§å“ç±»çš„å®ä¾‹ï¼Œå®¢æˆ·ç«¯å¯ä»¥å…é™¤ç›´æ¥åˆ›å»ºäº§å“å¯¹è±¡çš„è´£ä»»ï¼Œè€Œä»…ä»…â€œæ¶ˆè´¹â€äº§å“ï¼›ç®€å•å·¥å‚æ¨¡å¼é€šè¿‡è¿™ç§åšæ³•å®ç°äº†å¯¹è´£ä»»çš„åˆ†å‰²ï¼Œå®ƒæä¾›äº†ä¸“é—¨çš„å·¥å‚ç±»ç”¨äºåˆ›å»ºå¯¹è±¡</li><li>å®¢æˆ·ç«¯æ— é¡»çŸ¥é“æ‰€åˆ›å»ºçš„å…·ä½“äº§å“ç±»çš„ç±»åï¼Œåªéœ€è¦çŸ¥é“å…·ä½“äº§å“ç±»æ‰€å¯¹åº”çš„å‚æ•°å³å¯ï¼Œå¯¹äºä¸€äº›å¤æ‚çš„ç±»åï¼Œé€šè¿‡ç®€å•å·¥å‚æ¨¡å¼å¯ä»¥å‡å°‘ä½¿ç”¨è€…çš„è®°å¿†é‡</li><li>é€šè¿‡å¼•å…¥é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥åœ¨ä¸ä¿®æ”¹ä»»ä½•å®¢æˆ·ç«¯ä»£ç çš„æƒ…å†µä¸‹æ›´æ¢å’Œå¢åŠ æ–°çš„å…·ä½“äº§å“ç±»ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šæé«˜äº†ç³»ç»Ÿçš„çµæ´»æ€§</li></ul></li><li>ç¼ºç‚¹(å¯èƒ½å¢åŠ å®¢æˆ·ç«¯çš„å¤æ‚åº¦/ä¸æ–¹ä¾¿æ‰©å±•å­å·¥å‚)<ul><li>ç”±äºå·¥å‚ç±»é›†ä¸­äº†æ‰€æœ‰äº§å“åˆ›å»ºé€»è¾‘ï¼Œä¸€æ—¦ä¸èƒ½æ­£å¸¸å·¥ä½œï¼Œæ•´ä¸ªç³»ç»Ÿéƒ½è¦å—åˆ°å½±å“</li><li>ä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼å°†ä¼šå¢åŠ ç³»ç»Ÿä¸­ç±»çš„ä¸ªæ•°ï¼Œåœ¨ä¸€å®šç¨‹åºä¸Šå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦å’Œç†è§£éš¾åº¦</li><li>ç³»ç»Ÿæ‰©å±•å›°éš¾ï¼Œä¸€æ—¦æ·»åŠ æ–°äº§å“å°±ä¸å¾—ä¸ä¿®æ”¹å·¥å‚é€»è¾‘ï¼Œåœ¨äº§å“ç±»å‹è¾ƒå¤šæ—¶ï¼Œæœ‰å¯èƒ½é€ æˆå·¥å‚é€»è¾‘è¿‡äºå¤æ‚ï¼Œä¸åˆ©äºç³»ç»Ÿçš„æ‰©å±•å’Œç»´æŠ¤</li><li>ç®€å•å·¥å‚æ¨¡å¼ç”±äºä½¿ç”¨äº†é™æ€å·¥å‚æ–¹æ³•ï¼Œé€ æˆå·¥å‚è§’è‰²æ— æ³•å½¢æˆåŸºäºç»§æ‰¿çš„ç­‰çº§ç»“æ„</li></ul></li></ol><h2 id="8-ä½¿ç”¨ç¯å¢ƒ"><a href="#8-ä½¿ç”¨ç¯å¢ƒ" class="headerlink" title="8.ä½¿ç”¨ç¯å¢ƒ"></a>8.ä½¿ç”¨ç¯å¢ƒ</h2><ol><li>å·¥å‚ç±»è´Ÿè´£åˆ›å»ºçš„å¯¹è±¡æ¯”è¾ƒå°‘ï¼šç”±äºåˆ›å»ºçš„å¯¹è±¡è¾ƒå°‘ï¼Œä¸ä¼šé€ æˆå·¥å‚æ–¹æ³•ä¸­çš„ä¸šåŠ¡é€»è¾‘å¤ªè¿‡å¤æ‚</li><li>å®¢æˆ·ç«¯åªçŸ¥é“ä¼ å…¥å·¥å‚ç±»çš„å‚æ•°ï¼Œå¯¹äºå¦‚ä½•åˆ›å»ºå¯¹è±¡ä¸å…³å¿ƒï¼šå®¢æˆ·ç«¯æ—¢ä¸éœ€è¦å…³å¿ƒåˆ›å»ºç»†èŠ‚ï¼Œç”šè‡³è¿ç±»åéƒ½ä¸éœ€è¦è®°ä½ï¼Œåªéœ€è¦çŸ¥é“ç±»å‹æ‰€å¯¹åº”çš„å‚æ•°</li></ol><h2 id="9-æ¨¡å¼åº”ç”¨"><a href="#9-æ¨¡å¼åº”ç”¨" class="headerlink" title="9.æ¨¡å¼åº”ç”¨"></a>9.æ¨¡å¼åº”ç”¨</h2><ol><li><p>JDKç±»åº“ä¸­å¹¿æ³›ä½¿ç”¨äº†ç®€å•å·¥å‚æ¨¡å¼ï¼Œå¦‚å·¥å…·ç±»java.text.DateFormatï¼Œå®ƒç”¨äºæ ¼å¼åŒ–ä¸€ä¸ªæœ¬åœ°æ—¥æœŸæˆ–è€…æ—¶é—´ã€‚</p> <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">DateFormat</span> <span class="token function">getDateInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">DateFormat</span> <span class="token function">getDateInstance</span><span class="token punctuation">(</span><span class="token keyword">int</span> style<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">DateFormat</span> <span class="token function">getDateInstance</span><span class="token punctuation">(</span><span class="token keyword">int</span> style<span class="token punctuation">,</span><span class="token class-name">Locale</span>locale<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>JavaåŠ å¯†æŠ€æœ¯</p> <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// è·å–ä¸åŒåŠ å¯†ç®—æ³•çš„å¯†é’¥ç”Ÿæˆå™¨:</span><span class="token class-name">KeyGenerator</span> keyGen<span class="token operator">=</span><span class="token class-name">KeyGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"DESede"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// åˆ›å»ºå¯†ç å™¨:</span><span class="token class-name">Cipher</span> cp<span class="token operator">=</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"DESede"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Java </tag>
            
            <tag> DesignPattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼</title>
      <link href="/20161018/designpattern-creator-singleton-pattern/"/>
      <url>/20161018/designpattern-creator-singleton-pattern/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="è®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼"><a href="#è®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼" class="headerlink" title="è®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼"></a>è®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼</h1><h2 id="1-é—®é¢˜ï¼š"><a href="#1-é—®é¢˜ï¼š" class="headerlink" title="1.é—®é¢˜ï¼š"></a>1.é—®é¢˜ï¼š</h2><p>å¯¹äºç³»ç»Ÿä¸­çš„æŸäº›ç±»æ¥è¯´ï¼Œåªæœ‰ä¸€ä¸ªå®ä¾‹å¾ˆé‡è¦ï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªç³»ç»Ÿä¸­å¯ä»¥å­˜åœ¨å¤šä¸ªæ‰“å°ä»»åŠ¡ï¼Œä½†æ˜¯åªèƒ½æœ‰ä¸€ä¸ªæ­£åœ¨å·¥ä½œçš„ä»»åŠ¡ï¼›ä¸€ä¸ªç³»ç»Ÿåªèƒ½æœ‰ä¸€ä¸ªçª—å£ç®¡ç†å™¨æˆ–æ–‡ä»¶ç³»ç»Ÿï¼›ä¸€ä¸ªç³»ç»Ÿåªèƒ½æœ‰ä¸€ä¸ªè®¡æ—¶å·¥å…·æˆ– IDï¼ˆåºå·ï¼‰ç”Ÿæˆå™¨ã€‚å¦‚ä½•ä¿è¯ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹å¹¶ä¸”è¿™ä¸ªå®ä¾‹æ˜“äºè¢«è®¿é—®å‘¢ï¼Ÿ</p><h2 id="2-æ¨¡å¼å®šä¹‰"><a href="#2-æ¨¡å¼å®šä¹‰" class="headerlink" title="2.æ¨¡å¼å®šä¹‰"></a>2.æ¨¡å¼å®šä¹‰</h2><p>å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰ï¼šç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œè€Œä¸”è‡ªè¡Œå®ä¾‹åŒ–å¹¶å‘ç³»ç»Ÿæä¾›è¿™ä¸ªå®ä¾‹ï¼Œæä¾›å…¨å±€è®¿é—®æ–¹æ³•ã€‚</p><p>å®ç°æ€è·¯ï¼š</p><ul><li>åœ¨å•ä¾‹çš„ç±»ä¸­è®¾ç½®ä¸€ä¸ª private é™æ€å˜é‡ sInstanceï¼ŒsInstance ç±»å‹ä¸ºå½“å‰ç±»ï¼Œç”¨æ¥æŒæœ‰å•ä¾‹å”¯ä¸€çš„å®ä¾‹ã€‚</li><li>å°†ï¼ˆæ— å‚æ•°ï¼‰æ„é€ å™¨è®¾ç½®ä¸º privateï¼Œé¿å…å¤–éƒ¨ä½¿ç”¨ new æ„é€ å¤šä¸ªå®ä¾‹ã€‚</li><li>æä¾›ä¸€ä¸ª public çš„é™æ€æ–¹æ³•ï¼Œå¦‚ getInstanceï¼Œç”¨æ¥è¿”å›è¯¥ç±»çš„å”¯ä¸€å®ä¾‹ sInstanceã€‚</li></ul><h2 id="3-æ¨¡å¼ç»“æ„"><a href="#3-æ¨¡å¼ç»“æ„" class="headerlink" title="3.æ¨¡å¼ç»“æ„"></a>3.æ¨¡å¼ç»“æ„</h2><p>UML ç±»å›¾ï¼š<br><img src="https://blog-bak-1251678165.cos.ap-beijing.myqcloud.com/2016-10-18-Singleton.jpg" alt="Singleton"></p><h2 id="4-æ—¶åºå›¾"><a href="#4-æ—¶åºå›¾" class="headerlink" title="4.æ—¶åºå›¾"></a>4.æ—¶åºå›¾</h2><p><img src="https://blog-bak-1251678165.cos.ap-beijing.myqcloud.com/2016-10-18-seq_Singleton.jpg" alt="seq_Singleton"></p><h2 id="5-ä¸ƒç§å®ç°æ–¹å¼"><a href="#5-ä¸ƒç§å®ç°æ–¹å¼" class="headerlink" title="5.ä¸ƒç§å®ç°æ–¹å¼"></a>5.ä¸ƒç§å®ç°æ–¹å¼</h2><h3 id="æ‡’æ±‰å¼-çº¿ç¨‹ä¸å®‰å…¨"><a href="#æ‡’æ±‰å¼-çº¿ç¨‹ä¸å®‰å…¨" class="headerlink" title="æ‡’æ±‰å¼,çº¿ç¨‹ä¸å®‰å…¨"></a>æ‡’æ±‰å¼,çº¿ç¨‹ä¸å®‰å…¨</h3><ul><li>åœ¨å¤šä¸ªçº¿ç¨‹å¯†é›†è°ƒç”¨ getInstance æ—¶ï¼Œå­˜åœ¨åˆ›å»ºå¤šä¸ªå®ä¾‹çš„å¯èƒ½ã€‚</li><li>æ¯”å¦‚çº¿ç¨‹ A è¿›å…¥ null == sInstance è¿™æ®µä»£ç å—ï¼Œè€Œåœ¨ A çº¿ç¨‹æœªåˆ›å»ºå®Œæˆå®ä¾‹æ—¶ï¼Œ</li><li>å¦‚æœçº¿ç¨‹ B ä¹Ÿè¿›å…¥äº†è¯¥ä»£ç å—ï¼Œå¿…ç„¶ä¼šé€ æˆä¸¤ä¸ªå®ä¾‹çš„äº§ç”Ÿã€‚</li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by weicools on 2016/10/18. * * 1.0 æ‡’æ±‰å¼,çº¿ç¨‹ä¸å®‰å…¨ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SingletonLazy</span> <span class="token punctuation">{</span>    <span class="token comment">// 1.ä¸€ä¸ªç§æœ‰çš„æŒ‡å‘è‡ªå·±çš„é™æ€å˜é‡</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">SingletonLazy</span> instance <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token comment">// 2.ç§æœ‰çš„æ„é€ æ–¹æ³•,ä¿è¯ä¸èƒ½ä»å¤–éƒ¨åˆ›å»ºå¯¹è±¡</span>    <span class="token keyword">private</span> <span class="token class-name">SingletonLazy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token comment">// 3.å…¬å¼€çš„é™æ€å·¥å‚æ–¹æ³•,è¿”å›è¯¥ç±»çš„å”¯ä¸€å®ä¾‹(å½“å‘ç°æ²¡æœ‰å®ä¾‹æ²¡æœ‰åˆå§‹åŒ–çš„æ—¶å€™æ‰åˆå§‹åŒ–)</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">SingletonLazy</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingletonLazy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"åˆ›å»ºSingletonLazyç±»çš„å®ä¾‹"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å®ä¾‹å·²ç»åˆ›å»º,ä¸èƒ½å†åˆ›å»º"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">SingletonLazy</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingletonLazy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">SingletonLazy</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">SingletonLazy</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">SingletonLazy</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="é¥¿æ±‰å¼-çº¿ç¨‹å®‰å…¨"><a href="#é¥¿æ±‰å¼-çº¿ç¨‹å®‰å…¨" class="headerlink" title="é¥¿æ±‰å¼,çº¿ç¨‹å®‰å…¨"></a>é¥¿æ±‰å¼,çº¿ç¨‹å®‰å…¨</h3><ul><li>ä¸èƒ½å®Œæˆæ‡’åŠ è½½</li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by weicools on 2016/10/18. * * 2.0 é¥¿æ±‰å¼,çº¿ç¨‹å®‰å…¨ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SingletonHungry</span> <span class="token punctuation">{</span>    <span class="token comment">// 1.ç§æœ‰çš„å”¯ä¸€çš„é™æ€å®ä¾‹å˜é‡,åœ¨ç±»åŠ è½½çš„æ—¶å€™å°±åˆ›å»ºå¥½å•ä¾‹å¯¹è±¡</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">SingletonHungry</span> <span class="token constant">INSTANCE</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingletonHungry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 2.ç§æœ‰çš„æ„é€ å‡½æ•°,ç¡®ä¿ä¸èƒ½åœ¨ç±»çš„å¤–éƒ¨è®¿é—®è¯¥ç±»çš„æ„é€ å‡½æ•°</span>    <span class="token keyword">private</span> <span class="token class-name">SingletonHungry</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ‰§è¡Œæ„é€ å‡½æ•°"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">// 3.å…¬å¼€çš„é™æ€å·¥å‚è¿”å›æ­¤ç±»çš„å”¯ä¸€å®ä¾‹</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">SingletonHungry</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token constant">INSTANCE</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨ï¼Œå¤šçº¿ç¨‹ç¯å¢ƒä¸‹æ•ˆç‡ä¸é«˜"><a href="#æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨ï¼Œå¤šçº¿ç¨‹ç¯å¢ƒä¸‹æ•ˆç‡ä¸é«˜" class="headerlink" title="æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨ï¼Œå¤šçº¿ç¨‹ç¯å¢ƒä¸‹æ•ˆç‡ä¸é«˜"></a>æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨ï¼Œå¤šçº¿ç¨‹ç¯å¢ƒä¸‹æ•ˆç‡ä¸é«˜</h3><ul><li>ä½¿ç”¨ synchrnozed ä¿®é¥° getInstance æ–¹æ³•å¯èƒ½æ˜¯æœ€ç®€å•çš„ä¸€ä¸ªä¿è¯å¤šçº¿ç¨‹ä¿è¯å•ä¾‹å”¯ä¸€æ€§çš„æ–¹æ³•ã€‚synchronized ä¿®é¥°çš„æ–¹æ³•åï¼Œå½“æŸä¸ªçº¿ç¨‹è¿›å…¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œè¯¥çº¿ç¨‹åªæœ‰å½“å…¶ä»–çº¿ç¨‹ç¦»å¼€å½“å‰æ–¹æ³•åæ‰ä¼šè¿›å…¥è¯¥æ–¹æ³•ã€‚</li><li>æ‰€ä»¥å¯ä»¥ä¿è¯ getInstance åœ¨ä»»ä½•æ—¶å€™åªæœ‰ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ï¼Œä½†æ˜¯ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ï¼Œè€Œä¸” getInstance æ˜¯ä¸€ä¸ªè¢«é¢‘ç¹è°ƒç”¨çš„æ–¹æ³•ã€‚è™½ç„¶è¿™ç§æ–¹æ³•èƒ½è§£å†³é—®é¢˜ï¼Œä½†æ˜¯ä¸æ¨èã€‚</li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by weicools on 2016/10/18. * * 3.0 å•ä¾‹æ¨¡å¼ï¼Œæ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨ï¼Œå¤šçº¿ç¨‹ç¯å¢ƒä¸‹æ•ˆç‡ä¸é«˜ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SingletonLazySynchronized</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">SingletonLazySynchronized</span> instance <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">SingletonLazySynchronized</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token class-name">SingletonLazySynchronized</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingletonLazySynchronized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å®ä¾‹å·²ç»åˆ›å»º,ä¸èƒ½å†åˆ›å»º"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ‡’æ±‰å¼ï¼Œå˜ç§ï¼Œçº¿ç¨‹å®‰å…¨"><a href="#æ‡’æ±‰å¼ï¼Œå˜ç§ï¼Œçº¿ç¨‹å®‰å…¨" class="headerlink" title="æ‡’æ±‰å¼ï¼Œå˜ç§ï¼Œçº¿ç¨‹å®‰å…¨"></a>æ‡’æ±‰å¼ï¼Œå˜ç§ï¼Œçº¿ç¨‹å®‰å…¨</h3><ul><li>æ·»åŠ é™æ€ä»£ç å—,åˆå§‹åŒ–å®ä¾‹</li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by weicools on 2016/10/18. * * 4.0 å•ä¾‹æ¨¡å¼ï¼Œæ‡’æ±‰å¼ï¼Œå˜ç§ï¼Œçº¿ç¨‹å®‰å…¨ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SingletonLazyStatic</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">SingletonLazyStatic</span> instance <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token punctuation">{</span>        instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingletonLazyStatic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token class-name">SingletonLazyStatic</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">SingletonLazyStatic</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä½¿ç”¨é™æ€å†…éƒ¨ç±»ï¼Œçº¿ç¨‹å®‰å…¨ã€æ¨èã€‘"><a href="#ä½¿ç”¨é™æ€å†…éƒ¨ç±»ï¼Œçº¿ç¨‹å®‰å…¨ã€æ¨èã€‘" class="headerlink" title="ä½¿ç”¨é™æ€å†…éƒ¨ç±»ï¼Œçº¿ç¨‹å®‰å…¨ã€æ¨èã€‘"></a>ä½¿ç”¨é™æ€å†…éƒ¨ç±»ï¼Œçº¿ç¨‹å®‰å…¨ã€æ¨èã€‘</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by weicools on 2016/10/18. * * 5.0 å•ä¾‹æ¨¡å¼ï¼Œä½¿ç”¨é™æ€å†…éƒ¨ç±»ï¼Œçº¿ç¨‹å®‰å…¨ã€æ¨èã€‘ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SingletonStaticInner</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">SingletonHolder</span> <span class="token punctuation">{</span>        <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">SingletonStaticInner</span> <span class="token constant">INSTANCE</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingletonStaticInner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token class-name">SingletonStaticInner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">SingletonStaticInner</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token class-name">SingletonHolder</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä½¿ç”¨æšä¸¾æ–¹å¼ï¼Œçº¿ç¨‹å®‰å…¨"><a href="#ä½¿ç”¨æšä¸¾æ–¹å¼ï¼Œçº¿ç¨‹å®‰å…¨" class="headerlink" title="ä½¿ç”¨æšä¸¾æ–¹å¼ï¼Œçº¿ç¨‹å®‰å…¨"></a>ä½¿ç”¨æšä¸¾æ–¹å¼ï¼Œçº¿ç¨‹å®‰å…¨</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by weicools on 2016/10/18. * * 6.0 å•ä¾‹æ¨¡å¼ï¼Œä½¿ç”¨æšä¸¾æ–¹å¼ï¼Œçº¿ç¨‹å®‰å…¨ */</span><span class="token keyword">public</span> <span class="token keyword">enum</span>  <span class="token class-name">SingletonEnum</span> <span class="token punctuation">{</span>    <span class="token constant">INSTANCE</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">whateverMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä½¿ç”¨åŒé‡æ ¡éªŒé”ï¼Œçº¿ç¨‹å®‰å…¨ã€æ¨èã€‘"><a href="#ä½¿ç”¨åŒé‡æ ¡éªŒé”ï¼Œçº¿ç¨‹å®‰å…¨ã€æ¨èã€‘" class="headerlink" title="ä½¿ç”¨åŒé‡æ ¡éªŒé”ï¼Œçº¿ç¨‹å®‰å…¨ã€æ¨èã€‘"></a>ä½¿ç”¨åŒé‡æ ¡éªŒé”ï¼Œçº¿ç¨‹å®‰å…¨ã€æ¨èã€‘</h3><ul><li><p>ä½¿ç”¨åŒé‡æ£€æŸ¥åŠ é”ï¼Œé¦–å…ˆè¿›å…¥è¯¥æ–¹æ³•æ—¶è¿›è¡Œ null == sInstance æ£€æŸ¥ï¼Œå¦‚æœç¬¬ä¸€æ¬¡æ£€æŸ¥é€šè¿‡ï¼Œå³æ²¡æœ‰å®ä¾‹åˆ›å»ºï¼Œåˆ™è¿›å…¥ synchronized æ§åˆ¶çš„åŒæ­¥å—,å¹¶å†æ¬¡æ£€æŸ¥å®ä¾‹æ˜¯å¦åˆ›å»ºï¼Œå¦‚æœä»æœªåˆ›å»ºï¼Œåˆ™åˆ›å»ºè¯¥å®ä¾‹ã€‚</p></li><li><p>åŒé‡æ£€æŸ¥åŠ é”ä¿è¯äº†å¤šçº¿ç¨‹ä¸‹åªåˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œå¹¶ä¸”åŠ é”ä»£ç å—åªåœ¨å®ä¾‹åˆ›å»ºçš„ä¹‹å‰è¿›è¡ŒåŒæ­¥ã€‚å¦‚æœå®ä¾‹å·²ç»åˆ›å»ºåï¼Œè¿›å…¥è¯¥æ–¹æ³•ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œåˆ°åŒæ­¥å—çš„ä»£ç ã€‚</p></li><li><p>Volatile æ˜¯è½»é‡çº§çš„ synchronizedï¼Œå®ƒåœ¨å¤šå¤„ç†å™¨å¼€å‘ä¸­ä¿è¯äº†å…±äº«å˜é‡çš„â€œå¯è§æ€§â€ã€‚å¯è§æ€§çš„æ„æ€æ˜¯å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹ä¸€ä¸ªå…±äº«å˜é‡æ—¶ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹èƒ½è¯»åˆ°è¿™ä¸ªä¿®æ”¹çš„å€¼ã€‚ä½¿ç”¨ volatile ä¿®é¥° sInstance å˜é‡ä¹‹åï¼Œå¯ä»¥ç¡®ä¿å¤šä¸ªçº¿ç¨‹ä¹‹é—´æ­£ç¡®å¤„ç† sInstance å˜é‡ã€‚</p></li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Created by weicools on 2016/10/18. * * 7.0 å•ä¾‹æ¨¡å¼ï¼Œä½¿ç”¨åŒé‡æ ¡éªŒé”ï¼Œçº¿ç¨‹å®‰å…¨ã€æ¨èã€‘ */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SingletonVerifyLock</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">volatile</span> <span class="token keyword">static</span> <span class="token class-name">SingletonVerifyLock</span> instance <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">SingletonVerifyLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">SingletonVerifyLock</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token class-name">SingletonVerifyLock</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingletonVerifyLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="6-æ¨¡å¼åˆ†æ"><a href="#6-æ¨¡å¼åˆ†æ" class="headerlink" title="6.æ¨¡å¼åˆ†æ"></a>6.æ¨¡å¼åˆ†æ</h2><p>å•ä¾‹æ¨¡å¼çš„ç›®çš„æ˜¯ä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ã€‚å•ä¾‹æ¨¡å¼åŒ…å«çš„è§’è‰²åªæœ‰ä¸€ä¸ªï¼Œå°±æ˜¯å•ä¾‹ç±»â€”â€”Singletonã€‚å•ä¾‹ç±»æ‹¥æœ‰ä¸€ä¸ªç§æœ‰æ„é€ å‡½æ•°ï¼Œç¡®ä¿ç”¨æˆ·æ— æ³•é€šè¿‡ new å…³é”®å­—ç›´æ¥å®ä¾‹åŒ–å®ƒã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¯¥æ¨¡å¼ä¸­åŒ…å«ä¸€ä¸ªé™æ€ç§æœ‰æˆå‘˜å˜é‡ä¸é™æ€å…¬æœ‰çš„å·¥å‚æ–¹æ³•ï¼Œè¯¥å·¥å‚æ–¹æ³•è´Ÿè´£æ£€éªŒå®ä¾‹çš„å­˜åœ¨æ€§å¹¶å®ä¾‹åŒ–è‡ªå·±ï¼Œç„¶åå­˜å‚¨åœ¨é™æ€æˆå‘˜å˜é‡ä¸­ï¼Œä»¥ç¡®ä¿åªæœ‰ä¸€ä¸ªå®ä¾‹è¢«åˆ›å»º</p><p>åœ¨å•ä¾‹æ¨¡å¼çš„å®ç°è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ³¨æ„å¦‚ä¸‹ä¸‰ç‚¹ï¼š - å•ä¾‹ç±»çš„æ„é€ å‡½æ•°ä¸ºç§æœ‰ï¼› - æä¾›ä¸€ä¸ªè‡ªèº«çš„é™æ€ç§æœ‰æˆå‘˜å˜é‡ï¼› - æä¾›ä¸€ä¸ªå…¬æœ‰çš„é™æ€å·¥å‚æ–¹æ³•</p><h2 id="7-å®ä¾‹"><a href="#7-å®ä¾‹" class="headerlink" title="7.å®ä¾‹"></a>7.å®ä¾‹</h2><p>åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œæ‰“å°æ± (Print Spooler)æ˜¯ä¸€ä¸ªç”¨äºç®¡ç†æ‰“å°ä»»åŠ¡çš„åº”ç”¨ç¨‹åºï¼Œé€šè¿‡æ‰“å°æ± ç”¨æˆ·å¯ä»¥åˆ é™¤ã€ä¸­æ­¢æˆ–è€…æ”¹å˜æ‰“å°ä»»åŠ¡çš„ä¼˜å…ˆçº§ï¼Œåœ¨ä¸€ä¸ªç³»ç»Ÿä¸­åªå…è®¸è¿è¡Œä¸€ä¸ªæ‰“å°æ± å¯¹è±¡ï¼Œå¦‚æœé‡å¤åˆ›å»ºæ‰“å°æ± åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚ç°ä½¿ç”¨å•ä¾‹æ¨¡å¼æ¥æ¨¡æ‹Ÿå®ç°æ‰“å°æ± çš„è®¾è®¡</p><h2 id="8-ä¼˜ç‚¹-amp-ç¼ºç‚¹"><a href="#8-ä¼˜ç‚¹-amp-ç¼ºç‚¹" class="headerlink" title="8.ä¼˜ç‚¹&amp;ç¼ºç‚¹"></a>8.ä¼˜ç‚¹&amp;ç¼ºç‚¹</h2><ol><li>ä¼˜ç‚¹ï¼š<ul><li>æä¾›äº†å¯¹å”¯ä¸€å®ä¾‹çš„å—æ§è®¿é—®ã€‚å› ä¸ºå•ä¾‹ç±»å°è£…äº†å®ƒçš„å”¯ä¸€å®ä¾‹ï¼Œæ‰€ä»¥å®ƒå¯ä»¥ä¸¥æ ¼æ§åˆ¶å®¢æˆ·æ€æ ·ä»¥åŠä½•æ—¶è®¿é—®å®ƒï¼Œå¹¶ä¸ºè®¾è®¡åŠå¼€å‘å›¢é˜Ÿæä¾›äº†å…±äº«çš„æ¦‚å¿µ</li><li>ç”±äºåœ¨ç³»ç»Ÿå†…å­˜ä¸­åªå­˜åœ¨ä¸€ä¸ªå¯¹è±¡ï¼Œå› æ­¤å¯ä»¥èŠ‚çº¦ç³»ç»Ÿèµ„æºï¼Œå¯¹äºä¸€äº›éœ€è¦é¢‘ç¹åˆ›å»ºå’Œé”€æ¯çš„å¯¹è±¡ï¼Œå•ä¾‹æ¨¡å¼æ— ç–‘å¯ä»¥æé«˜ç³»ç»Ÿçš„æ€§èƒ½</li><li>å…è®¸å¯å˜æ•°ç›®çš„å®ä¾‹ã€‚æˆ‘ä»¬å¯ä»¥åŸºäºå•ä¾‹æ¨¡å¼è¿›è¡Œæ‰©å±•ï¼Œä½¿ç”¨ä¸å•ä¾‹æ§åˆ¶ç›¸ä¼¼çš„æ–¹æ³•æ¥è·å¾—æŒ‡å®šä¸ªæ•°çš„å¯¹è±¡å®ä¾‹</li></ul></li><li>ç¼ºç‚¹ï¼š<ul><li>ç”±äºå•ä¾‹æ¨¡å¼ä¸­æ²¡æœ‰æŠ½è±¡å±‚ï¼Œå› æ­¤å•ä¾‹ç±»çš„æ‰©å±•æœ‰å¾ˆå¤§çš„å›°éš¾</li><li>å•ä¾‹ç±»çš„èŒè´£è¿‡é‡ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šè¿èƒŒäº†â€œå•ä¸€èŒè´£åŸåˆ™â€ã€‚å› ä¸ºå•ä¾‹ç±»æ—¢å……å½“äº†å·¥å‚è§’è‰²ï¼Œæä¾›äº†å·¥å‚æ–¹æ³•ï¼ŒåŒæ—¶åˆå……å½“äº†äº§å“è§’è‰²ï¼ŒåŒ…å«ä¸€äº›ä¸šåŠ¡æ–¹æ³•ï¼Œå°†äº§å“çš„åˆ›å»ºå’Œäº§å“çš„æœ¬èº«çš„åŠŸèƒ½èåˆåˆ°ä¸€èµ·</li><li>æ»¥ç”¨å•ä¾‹å°†å¸¦æ¥ä¸€äº›è´Ÿé¢é—®é¢˜ï¼Œå¦‚ä¸ºäº†èŠ‚çœèµ„æºå°†æ•°æ®åº“è¿æ¥æ± å¯¹è±¡è®¾è®¡ä¸ºå•ä¾‹ç±»ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…±äº«è¿æ¥æ± å¯¹è±¡çš„ç¨‹åºè¿‡å¤šè€Œå‡ºç°è¿æ¥æ± æº¢å‡º</li></ul></li></ol><h2 id="9-ä½¿ç”¨ç¯å¢ƒ"><a href="#9-ä½¿ç”¨ç¯å¢ƒ" class="headerlink" title="9.ä½¿ç”¨ç¯å¢ƒ"></a>9.ä½¿ç”¨ç¯å¢ƒ</h2><ol><li>ç³»ç»Ÿåªéœ€è¦ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œå¦‚ç³»ç»Ÿè¦æ±‚æä¾›ä¸€ä¸ªå”¯ä¸€çš„åºåˆ—å·ç”Ÿæˆå™¨ï¼Œæˆ–è€…éœ€è¦è€ƒè™‘èµ„æºæ¶ˆè€—å¤ªå¤§è€Œåªå…è®¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡ã€‚</li><li>å®¢æˆ·è°ƒç”¨ç±»çš„å•ä¸ªå®ä¾‹åªå…è®¸ä½¿ç”¨ä¸€ä¸ªå…¬å…±è®¿é—®ç‚¹ï¼Œé™¤äº†è¯¥å…¬å…±è®¿é—®ç‚¹ï¼Œä¸èƒ½é€šè¿‡å…¶ä»–é€”å¾„è®¿é—®è¯¥å®ä¾‹ã€‚</li><li>åœ¨ä¸€ä¸ªç³»ç»Ÿä¸­è¦æ±‚ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹æ—¶æ‰åº”å½“ä½¿ç”¨å•ä¾‹æ¨¡å¼ã€‚åè¿‡æ¥ï¼Œå¦‚æœä¸€ä¸ªç±»å¯ä»¥æœ‰å‡ ä¸ªå®ä¾‹å…±å­˜ï¼Œå°±éœ€è¦å¯¹å•ä¾‹æ¨¡å¼è¿›è¡Œæ”¹è¿›ï¼Œä½¿ä¹‹æˆä¸ºå¤šä¾‹æ¨¡å¼</li></ol><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://droidyue.com/blog/2015/01/11/looking-into-singleton/">å•ä¾‹è¿™ç§è®¾è®¡æ¨¡å¼</a></li><li>SwordOffer</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Java </tag>
            
            <tag> DesignPattern </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaå¸¸è€ƒé¢è¯•é¢˜</title>
      <link href="/20160828/interview-java-summary/"/>
      <url>/20160828/interview-java-summary/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Java-å¸¸è€ƒé¢è¯•é¢˜"><a href="#Java-å¸¸è€ƒé¢è¯•é¢˜" class="headerlink" title="Java å¸¸è€ƒé¢è¯•é¢˜"></a>Java å¸¸è€ƒé¢è¯•é¢˜</h1><ol><li>ä»€ä¹ˆæ˜¯ Java è™šæ‹Ÿæœºï¼Œä¸ºä»€ä¹ˆ Java æ˜¯å¹³å°æ— å…³æ€§çš„è¯­è¨€ï¼Ÿ</li></ol><ul><li>Java è™šæ‹Ÿæœºæ˜¯ä¸€ä¸ªå¯ä»¥æ‰§è¡Œ Java å­—èŠ‚ç çš„è™šæ‹Ÿæœºè¿›ç¨‹ã€‚Java æºæ–‡ä»¶è¢«ç¼–è¯‘æˆèƒ½è¢« Java è™šæ‹Ÿæœºæ‰§è¡Œçš„å­—èŠ‚ç æ–‡ä»¶</li><li>Java è¢«è®¾è®¡æˆå…è®¸åº”ç”¨ç¨‹åºå¯ä»¥è¿è¡Œåœ¨ä»»æ„çš„å¹³å°ï¼Œè€Œä¸éœ€è¦ç¨‹åºå‘˜ä¸ºæ¯ä¸€ä¸ªå¹³å°å•ç‹¬é‡å†™æˆ–è€…æ˜¯é‡æ–°ç¼–è¯‘ã€‚Java è™šæ‹Ÿæœºè®©è¿™ä¸ªå˜ä¸ºå¯èƒ½ï¼Œå› ä¸ºå®ƒçŸ¥é“åº•å±‚ç¡¬ä»¶å¹³å°çš„æŒ‡ä»¤é•¿åº¦å’Œå…¶ä»–ç‰¹æ€§ï¼› JVM å±è”½äº†ä¸å…·ä½“æ“ä½œç³»ç»Ÿå¹³å°ç›¸å…³çš„ä¿¡æ¯ï¼Œä½¿å¾— Java ç¨‹åºåªéœ€ç”Ÿæˆåœ¨ Java è™šæ‹Ÿæœºä¸Šè¿è¡Œçš„ç›®æ ‡ä»£ç ï¼ˆ å­—èŠ‚ç  ï¼‰ï¼Œå°±å¯ä»¥åœ¨å¤šç§å¹³å°ä¸Šä¸åŠ ä¿®æ”¹åœ°è¿è¡Œ<span id="more"></span></li></ul><ol start="2"><li>JDK å’Œ JRE çš„åŒºåˆ«</li></ol><ul><li>Java è¿è¡Œæ—¶ç¯å¢ƒ(JRE)æ˜¯å°†è¦æ‰§è¡Œ Java ç¨‹åºçš„ Java è™šæ‹Ÿæœºã€‚å®ƒåŒæ—¶ä¹ŸåŒ…å«äº†æ‰§è¡Œ applet éœ€è¦çš„æµè§ˆå™¨æ’ä»¶</li><li>Java å¼€å‘å·¥å…·åŒ…(JDK)æ˜¯å®Œæ•´çš„ Java è½¯ä»¶å¼€å‘åŒ…ï¼ŒåŒ…å«äº†**JREï¼Œç¼–è¯‘å™¨å’Œå…¶ä»–çš„å·¥å…·(æ¯”å¦‚ï¼šJavaDocï¼ŒJava è°ƒè¯•å™¨)**ï¼Œå¯ä»¥è®©å¼€å‘è€…å¼€å‘ã€ç¼–è¯‘ã€æ‰§è¡Œ Java åº”ç”¨ç¨‹åº</li></ul><ol start="3"><li>â€staticâ€å…³é”®å­—ï¼ŸJava ä¸­æ˜¯å¦å¯ä»¥è¦†ç›–(override)ä¸€ä¸ª private æˆ–è€…æ˜¯ static çš„æ–¹æ³•ï¼Ÿ</li></ol><ul><li>â€œstaticâ€å…³é”®å­—è¡¨ç¤ºé™æ€çš„æ„æ€ï¼Œå¯ç”¨äºä¿®é¥°å˜é‡å’Œæˆå‘˜å‡½æ•°ï¼Œè¢« static ä¿®é¥°çš„æˆå‘˜å‡½æ•°åªèƒ½è®¿é—®é™æ€æˆå‘˜ï¼Œé™æ€æ˜¯éšç€ç±»åŠ è½½è€ŒåŠ è½½çš„ï¼Œå› æ­¤å¯ä»¥ç›´æ¥ç”¨ç±»è¿›è¡Œè®¿é—®</li><li>Java ä¸­ static æ–¹æ³•ä¸èƒ½è¢«è¦†ç›–ï¼Œå› ä¸ºè¦†ç›–æ˜¯åŸºäºè¿è¡Œæ—¶åŠ¨æ€ç»‘å®šçš„ï¼Œè€Œ static æ–¹æ³•æ˜¯ç¼–è¯‘æ—¶é™æ€ç»‘å®šçš„</li><li><strong>é‡å†™æ˜¯å­ç±»ä¸­çš„æ–¹æ³•å’Œå­ç±»ç»§æ‰¿çš„çˆ¶ç±»ä¸­çš„æ–¹æ³•ä¸€æ ·ï¼ˆå‡½æ•°åï¼Œå‚æ•°ï¼Œå‚æ•°ç±»å‹ï¼Œåå›å€¼ç±»å‹ï¼‰</strong>ï¼Œä½†æ˜¯å­ç±»ä¸­çš„è®¿é—®æƒé™è¦ä¸ä½äºçˆ¶ç±»ä¸­çš„è®¿é—®æƒé™ã€‚é‡å†™çš„å‰ææ˜¯å¿…é¡»è¦ç»§æ‰¿ï¼Œprivate ä¿®é¥°ä¸æ”¯æŒç»§æ‰¿ï¼Œå› æ­¤è¢«ç§æœ‰çš„æ–¹æ³•ä¸å¯ä»¥è¢«é‡å†™ã€‚é™æ€æ–¹æ³•å½¢å¼ä¸Šå¯ä»¥è¢«é‡å†™ï¼Œå³å­ç±»ä¸­å¯ä»¥é‡å†™çˆ¶ç±»ä¸­é™æ€çš„æ–¹æ³•ã€‚ä½†æ˜¯å®é™…ä¸Š<strong>ä»å†…å­˜çš„è§’åº¦ä¸Šé™æ€æ–¹æ³•ä¸å¯ä»¥è¢«é‡å†™</strong></li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Super</span><span class="token punctuation">{</span>  <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token string">"Good night"</span>  <span class="token punctuation">}</span>  <span class="token class-name">String</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token string">"Weico"</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">Sub</span> <span class="token keyword">extends</span> <span class="token class-name">Super</span><span class="token punctuation">{</span>  <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token string">"Hello"</span>  <span class="token punctuation">}</span>  <span class="token class-name">String</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token string">"weimiku"</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">{</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token class-name">Super</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sub</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">","</span> <span class="token operator">+</span> s<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// è¾“å‡ºç»“æœï¼šGood night,weimiku</span>    <span class="token comment">// å®ä¾‹æ–¹æ³•è¢«è¦†ç›–ï¼Œé™æ€æ–¹æ³•è¢«éšè—</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="4"><li>æ˜¯å¦å¯ä»¥åœ¨ static ç¯å¢ƒä¸­è®¿é—®é static å˜é‡ï¼Ÿ</li></ol><ul><li>é™æ€çš„æˆå‘˜å±äºç±»ï¼Œéšç€ç±»çš„åŠ è½½è€ŒåŠ è½½åˆ°é™æ€æ–¹æ³•åŒºå†…å­˜ï¼Œå½“ç±»åŠ è½½æ—¶ï¼Œæ­¤æ—¶ä¸ä¸€å®šæœ‰å®ä¾‹åˆ›å»ºï¼Œæ²¡æœ‰å®ä¾‹ï¼Œå°±ä¸å¯ä»¥è®¿é—®éé™æ€çš„æˆå‘˜</li><li>å½“ç±»è¢« Java è™šæ‹Ÿæœºè½½å…¥çš„æ—¶å€™ï¼Œä¼šå¯¹ static å˜é‡è¿›è¡Œåˆå§‹åŒ–ã€‚å¦‚æœä½ çš„ä»£ç å°è¯•ä¸ç”¨å®ä¾‹æ¥è®¿é—®é static çš„å˜é‡ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼Œå› ä¸ºè¿™äº›å˜é‡è¿˜æ²¡æœ‰è¢«åˆ›å»ºå‡ºæ¥ï¼Œè¿˜æ²¡æœ‰è·Ÿä»»ä½•å®ä¾‹å…³è”ä¸Š</li></ul><ol start="5"><li>Java æ”¯æŒçš„æ•°æ®ç±»å‹æœ‰å“ªäº›ï¼Ÿä»€ä¹ˆæ˜¯è‡ªåŠ¨æ‹†è£…ç®±ï¼Ÿ</li></ol><ul><li>Java æ”¯æŒ 8 ä¸­åŸºæœ¬æ•°æ®ç±»å‹ï¼šbyte/short/int/long/float/double/boolean/char</li><li>è‡ªåŠ¨è£…ç®±æ˜¯ Java ç¼–è¯‘å™¨åœ¨åŸºæœ¬æ•°æ®ç±»å‹å’Œå¯¹åº”çš„å¯¹è±¡åŒ…è£…ç±»å‹ä¹‹é—´çš„è½¬åŒ–ã€‚byte-&gt;Byte;short-&gt;Short;int-&gt;Integer;long-&gt;Long;float-&gt;Float;double-&gt;Double;boolean-&gt;Boolean;char-&gt;Character.åä¹‹å°±æ˜¯è‡ªåŠ¨æ‹†ç®±</li></ul><ol start="6"><li>Java ä¸­çš„æ–¹æ³•è¦†ç›–(Overriding)å’Œæ–¹æ³•é‡è½½(Overloading)æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</li></ol><ul><li>Java ä¸­çš„æ–¹æ³•é‡è½½ Overloading å‘ç”Ÿåœ¨<strong>åŒä¸€ä¸ªç±»</strong>é‡Œé¢ä¸¤ä¸ªæˆ–è€…æ˜¯å¤šä¸ªæ–¹æ³•çš„<strong>æ–¹æ³•åç›¸åŒä½†æ˜¯å‚æ•°ä¸åŒ</strong>çš„æƒ…å†µ</li><li>æ–¹æ³•è¦†ç›– Overriding æ˜¯è¯´å­ç±»é‡æ–°å®šä¹‰äº†çˆ¶ç±»çš„æ–¹æ³•ã€‚æ–¹æ³•è¦†ç›–å¿…é¡»æœ‰ç›¸åŒçš„æ–¹æ³•åï¼Œå‚æ•°åˆ—è¡¨å’Œè¿”å›ç±»å‹ã€‚è¦†ç›–è€…å¯èƒ½ä¸ä¼šé™åˆ¶å®ƒæ‰€è¦†ç›–çš„æ–¹æ³•çš„è®¿é—®</li><li>è®¿é—®æƒé™&gt;=çˆ¶ç±»ï¼ŒæŠ›å‡ºå¼‚å¸¸å¿…é¡»&lt;=çˆ¶ç±»ï¼ˆæˆ–è€…ä¸æŠ›å¼‚å¸¸ï¼‰ã€‚ï¼ˆç‰¹æ®Šç‚¹ï¼Œå¦‚æœå­ç±»é‡å†™çš„æ–¹æ³•æ‰€æŠ›å¼‚å¸¸å°äºçˆ¶ç±»ï¼Œé‚£ä¹ˆå°±ä¸èƒ½è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•ï¼Œå› ä¸ºå­ç±»çš„å¼‚å¸¸å°ï¼Œæ•è·ä¸äº† ï¼‰ï¼Œ private ä¿®é¥°çš„çˆ¶ç±»æ–¹æ³•ä¸èƒ½è¢«é‡å†™</li></ul><ol start="7"><li>Java ä¸­ï¼Œä»€ä¹ˆæ˜¯æ„é€ å‡½æ•°ï¼Ÿä»€ä¹ˆæ˜¯æ„é€ å‡½æ•°é‡è½½ï¼Ÿä»€ä¹ˆæ˜¯å¤åˆ¶æ„é€ å‡½æ•°ï¼Ÿ</li></ol><ul><li>å½“æ–°å¯¹è±¡è¢«åˆ›å»ºçš„æ—¶å€™ï¼Œæ„é€ å‡½æ•°ä¼šè¢«è°ƒç”¨ã€‚æ¯ä¸€ä¸ªç±»éƒ½æœ‰æ„é€ å‡½æ•°ã€‚åœ¨ç¨‹åºå‘˜æ²¡æœ‰ç»™ç±»æä¾›æ„é€ å‡½æ•°çš„æƒ…å†µä¸‹ï¼ŒJava ç¼–è¯‘å™¨ä¼šä¸ºè¿™ä¸ªç±»åˆ›å»ºä¸€ä¸ªé»˜è®¤çš„æ„é€ å‡½æ•°</li><li>Java ä¸­æ„é€ å‡½æ•°é‡è½½å’Œæ–¹æ³•é‡è½½å¾ˆç›¸ä¼¼ï¼›å¯ä»¥ä¸ºä¸€ä¸ªç±»åˆ›å»ºå¤šä¸ªæ„é€ å‡½æ•°ã€‚æ¯ä¸€ä¸ªæ„é€ å‡½æ•°å¿…é¡»æœ‰å®ƒè‡ªå·±å”¯ä¸€çš„å‚æ•°åˆ—è¡¨</li><li>Java ä¸æ”¯æŒåƒ C++ä¸­é‚£æ ·çš„å¤åˆ¶æ„é€ å‡½æ•°ï¼Œè¿™ä¸ªä¸åŒç‚¹æ˜¯å› ä¸ºå¦‚æœä½ ä¸è‡ªå·±å†™æ„é€ å‡½æ•°çš„æƒ…å†µä¸‹ï¼ŒJava ä¸ä¼šåˆ›å»ºé»˜è®¤çš„å¤åˆ¶æ„é€ å‡½æ•°</li></ul><ol start="8"><li>Java æ”¯æŒå¤šç»§æ‰¿ä¹ˆï¼Ÿ</li></ol><ul><li>Java ä¸­<strong>ç±»ä¸æ”¯æŒå¤šç»§æ‰¿</strong>ï¼Œåªæ”¯æŒå•ç»§æ‰¿ï¼ˆå³ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªçˆ¶ç±»ï¼‰</li><li>ä½†æ˜¯ java ä¸­çš„<strong>æ¥å£æ”¯æŒå¤šç»§æ‰¿</strong>ï¼Œå³ä¸€ä¸ªå­æ¥å£å¯ä»¥æœ‰å¤šä¸ªçˆ¶æ¥å£ã€‚ï¼ˆæ¥å£çš„ä½œç”¨æ˜¯ç”¨æ¥æ‰©å±•å¯¹è±¡çš„åŠŸèƒ½ï¼Œä¸€ä¸ªå­æ¥å£ç»§æ‰¿å¤šä¸ªçˆ¶æ¥å£ï¼Œè¯´æ˜å­æ¥å£æ‰©å±•äº†å¤šä¸ªåŠŸèƒ½ï¼Œå½“ç±»å®ç°æ¥å£æ—¶ï¼Œç±»å°±æ‰©å±•äº†ç›¸åº”çš„åŠŸèƒ½ï¼‰</li></ul><ol start="9"><li>æ¥å£å’ŒæŠ½è±¡ç±»çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</li></ol><ul><li>Java æä¾›å’Œæ”¯æŒåˆ›å»ºæŠ½è±¡ç±»å’Œæ¥å£ï¼Œå®ƒä»¬çš„å®ç°æœ‰å…±åŒç‚¹ï¼Œä¹Ÿæœ‰ä¸åŒä¹‹å¤„ï¼š</li><li>æ¥å£ä¸­æ‰€æœ‰çš„æ–¹æ³•éšå«çš„éƒ½æ˜¯æŠ½è±¡æ–¹æ³• / è€ŒæŠ½è±¡ç±»åˆ™å¯ä»¥åŒæ—¶åŒ…å«æŠ½è±¡å’ŒéæŠ½è±¡æ–¹æ³•</li><li>ç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ / ä½†æ˜¯åªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»</li><li>Java æ¥å£ä¸­ç”³æ˜çš„å˜é‡é»˜è®¤éƒ½æ˜¯ public static final / æŠ½è±¡ç±»å¯ä»¥åŒ…å«é final çš„å˜é‡</li><li>Java æ¥å£ä¸­çš„æˆå‘˜å‡½æ•°é»˜è®¤æ˜¯ public çš„ / æŠ½è±¡ç±»çš„æˆå‘˜å‡½æ•°å¯ä»¥æ˜¯ privateï¼Œprotected æˆ–è€…æ˜¯ public</li><li>æ¥å£æ˜¯ç»å¯¹æŠ½è±¡çš„ï¼Œä¸å¯ä»¥è¢«å®ä¾‹åŒ– / æŠ½è±¡ç±»ä¹Ÿä¸å¯ä»¥è¢«å®ä¾‹åŒ–ï¼Œä½†æ˜¯ï¼Œå¦‚æœå®ƒåŒ…å« main æ–¹æ³•çš„è¯æ˜¯å¯ä»¥è¢«è°ƒç”¨çš„</li><li>ç±»å¯ä»¥ä¸å®ç°æŠ½è±¡ç±»å’Œæ¥å£å£°æ˜çš„æ‰€æœ‰æ–¹æ³•(åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç±»ä¹Ÿå¿…é¡»å¾—å£°æ˜æˆæ˜¯æŠ½è±¡çš„)</li><li>æŠ½è±¡ç±»å¯ä»¥åœ¨ä¸æä¾›æ¥å£æ–¹æ³•å®ç°çš„æƒ…å†µä¸‹å®ç°æ¥å£â€“ï¼Ÿ</li></ul><ol start="10"><li>ä»€ä¹ˆæ˜¯å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’ï¼Ÿ</li></ol><ul><li>å€¼ä¼ é€’æ˜¯å¯¹åŸºæœ¬å‹å˜é‡è€Œè¨€çš„,ä¼ é€’çš„æ˜¯è¯¥å˜é‡çš„ä¸€ä¸ªå‰¯æœ¬,æ”¹å˜å‰¯æœ¬ä¸å½±å“åŸå˜é‡</li><li>å¼•ç”¨ä¼ é€’ä¸€èˆ¬æ˜¯å¯¹äºå¯¹è±¡å‹å˜é‡è€Œè¨€çš„,ä¼ é€’çš„æ˜¯è¯¥å¯¹è±¡åœ°å€çš„ä¸€ä¸ªå‰¯æœ¬, å¹¶ä¸æ˜¯åŸå¯¹è±¡æœ¬èº« ã€‚ æ‰€ä»¥å¯¹å¼•ç”¨å¯¹è±¡è¿›è¡Œæ“ä½œä¼šåŒæ—¶æ”¹å˜åŸå¯¹è±¡.</li><li>ä¸€èˆ¬è®¤ä¸º,java å†…çš„ä¼ é€’éƒ½æ˜¯å€¼ä¼ é€’</li><li>é—®é¢˜æ¥äº†ï¼šjava ä¸­å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’ç»™ä¸€ä¸ªæ–¹æ³•ï¼Œåˆ°åº•æ˜¯å€¼ä¼ é€’ï¼Œè¿˜æ˜¯å¼•ç”¨ä¼ é€’ï¼Ÿ<ul><li>å€¼ä¼ é€’ï¼Java ä¸­åªæœ‰æŒ‰å€¼ä¼ é€’ï¼Œæ²¡æœ‰æŒ‰å¼•ç”¨ä¼ é€’ï¼</li></ul></li></ul><ol start="11"><li>è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</li></ol><ul><li>è¿›ç¨‹æ˜¯æ‰§è¡Œç€çš„åº”ç”¨ç¨‹åºï¼Œè€Œçº¿ç¨‹æ˜¯è¿›ç¨‹å†…éƒ¨çš„ä¸€ä¸ªæ‰§è¡Œåºåˆ—ã€‚ä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ã€‚çº¿ç¨‹åˆå«åšè½»é‡çº§è¿›ç¨‹</li></ul><ol start="12"><li>åˆ›å»ºçº¿ç¨‹æœ‰å‡ ç§ä¸åŒçš„æ–¹å¼ï¼Ÿä½ å–œæ¬¢å“ªä¸€ç§ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</li></ol><ul><li>ç»§æ‰¿ Thread ç±»</li><li>å®ç° Runnable æ¥å£</li><li>åº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨ Executor æ¡†æ¶æ¥åˆ›å»ºçº¿ç¨‹æ± </li><li>å®ç° Runnable æ¥å£è¿™ç§æ–¹å¼æ›´å—æ¬¢è¿ï¼Œå› ä¸ºè¿™ä¸éœ€è¦ç»§æ‰¿ Thread ç±»ã€‚åœ¨åº”ç”¨è®¾è®¡ä¸­å·²ç»ç»§æ‰¿äº†åˆ«çš„å¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œè¿™éœ€è¦å¤šç»§æ‰¿ï¼ˆè€Œ Java ä¸æ”¯æŒå¤šç»§æ‰¿ï¼‰ï¼Œåªèƒ½å®ç°æ¥å£ã€‚åŒæ—¶ï¼Œçº¿ç¨‹æ± ä¹Ÿæ˜¯éå¸¸é«˜æ•ˆçš„ï¼Œå¾ˆå®¹æ˜“å®ç°å’Œä½¿ç”¨</li></ul><ol start="13"><li>æ¦‚æ‹¬çš„è§£é‡Šä¸‹çº¿ç¨‹çš„å‡ ç§å¯ç”¨çŠ¶æ€</li></ol><ul><li>1.æ–°å»ºï¼ˆnewï¼‰ï¼šæ–°åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡</li><li>2.å¯è¿è¡Œï¼ˆrunnableï¼‰ï¼šçº¿ç¨‹å¯¹è±¡åˆ›å»ºåï¼Œå…¶ä»–çº¿ç¨‹ï¼ˆä¾‹å¦‚ main çº¿ç¨‹ï¼‰è°ƒç”¨äº†è¯¥çº¿ç¨‹çš„ start()æ–¹æ³•ã€‚è¯¥çŠ¶æ€çš„çº¿ç¨‹ä½äºå¯è¿è¡Œçº¿ç¨‹æ± ä¸­ï¼Œç­‰å¾…è¢«çº¿ç¨‹è°ƒåº¦é€‰ä¸­ï¼Œè·å– cpu çš„ä½¿ç”¨æƒ</li><li>3.è¿è¡Œï¼ˆrunningï¼‰ï¼šå¯è¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹è·å¾—äº† CPU æ—¶é—´ç‰‡ï¼ˆtimesliceï¼‰ï¼Œæ‰§è¡Œç¨‹åºä»£ç </li><li>4.é˜»å¡ï¼ˆblockï¼‰ï¼šé˜»å¡çŠ¶æ€æ˜¯æŒ‡çº¿ç¨‹å› ä¸ºæŸç§åŸå› æ”¾å¼ƒäº† CPU ä½¿ç”¨æƒï¼Œæš‚æ—¶åœæ­¢è¿è¡Œã€‚ç›´åˆ°çº¿ç¨‹è¿›å…¥å¯è¿è¡Œ( runnable )çŠ¶æ€ï¼Œæ‰æœ‰ æœºä¼šå†æ¬¡è·å¾— cpu timeslice è½¬åˆ°è¿è¡Œ( running )çŠ¶æ€ã€‚é˜»å¡çš„æƒ…å†µåˆ†ä¸‰ç§ï¼š<ul><li>(ä¸€). ç­‰å¾…é˜»å¡ï¼šè¿è¡Œ( running )çš„çº¿ç¨‹æ‰§è¡Œ o . wait ()æ–¹æ³•ï¼Œ JVM ä¼šæŠŠè¯¥çº¿ç¨‹æ”¾ å…¥ç­‰å¾…é˜Ÿåˆ—( waitting queue )ä¸­</li><li>(äºŒ). åŒæ­¥é˜»å¡ï¼šè¿è¡Œ( running )çš„çº¿ç¨‹åœ¨è·å–å¯¹è±¡çš„åŒæ­¥é”æ—¶ï¼Œè‹¥è¯¥åŒæ­¥é” è¢«åˆ«çš„çº¿ç¨‹å ç”¨ï¼Œåˆ™ JVM ä¼šæŠŠè¯¥çº¿ç¨‹æ”¾å…¥é”æ± ( lock pool )ä¸­</li><li>(ä¸‰). å…¶ä»–é˜»å¡: è¿è¡Œ( running )çš„çº¿ç¨‹æ‰§è¡Œ Thread . sleep ( long ms )æˆ– t . join ()æ–¹æ³•ï¼Œæˆ–è€…å‘å‡ºäº† I / O è¯·æ±‚æ—¶ï¼Œ JVM ä¼šæŠŠè¯¥çº¿ç¨‹ç½®ä¸ºé˜»å¡çŠ¶æ€ã€‚å½“ sleep ()çŠ¶æ€è¶…æ—¶ã€ join ()ç­‰å¾…çº¿ç¨‹ç»ˆæ­¢æˆ–è€…è¶…æ—¶ã€æˆ–è€… I / O å¤„ç†å®Œæ¯•æ—¶ï¼Œçº¿ç¨‹é‡æ–°è½¬å…¥å¯è¿è¡Œ( runnable )çŠ¶æ€</li></ul></li><li>5.æ­»äº¡ï¼ˆdeadï¼‰ï¼šçº¿ç¨‹ run ()ã€ main () æ–¹æ³•æ‰§è¡Œç»“æŸï¼Œæˆ–è€…å› å¼‚å¸¸é€€å‡ºäº† run ()æ–¹æ³•ï¼Œåˆ™è¯¥çº¿ç¨‹ç»“æŸç”Ÿå‘½å‘¨æœŸã€‚æ­»äº¡çš„çº¿ç¨‹ä¸å¯å†æ¬¡å¤ç”Ÿ<br><img src="http://uploadfiles.nowcoder.com/images/20151217/149974_1450349079825_4697A22AC611680A692472687DEC1CFD" alt="Thread state"></li></ul><ol start="14"><li>åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥ä»£ç å—çš„åŒºåˆ«ï¼Ÿ</li></ol><ul><li>åŒæ­¥æ–¹æ³•é»˜è®¤ç”¨ this æˆ–è€…å½“å‰ç±» class å¯¹è±¡ä½œä¸ºé”</li><li>åŒæ­¥ä»£ç å—å¯ä»¥é€‰æ‹©ä»¥ä»€ä¹ˆæ¥åŠ é”ï¼Œæ¯”åŒæ­¥æ–¹æ³•è¦æ›´ç»†é¢—ç²’åº¦ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©åªåŒæ­¥ä¼šå‘ç”ŸåŒæ­¥é—®é¢˜çš„éƒ¨åˆ†ä»£ç è€Œä¸æ˜¯æ•´ä¸ªæ–¹æ³•</li></ul><ol start="15"><li>åœ¨ç›‘è§†å™¨(Monitor)å†…éƒ¨ï¼Œæ˜¯å¦‚ä½•åšçº¿ç¨‹åŒæ­¥çš„ï¼Ÿç¨‹åºåº”è¯¥åšå“ªç§çº§åˆ«çš„åŒæ­¥ï¼Ÿ</li></ol><ul><li>ç›‘è§†å™¨å’Œé”æ˜¯åœ¨ Java è™šæ‹Ÿæœºä¸­ä¸€å—ä½¿ç”¨çš„</li><li>ç›‘è§†å™¨ç›‘è§†ä¸€å—åŒæ­¥ä»£ç å—ï¼Œç¡®ä¿åªæœ‰ä¸€æ¬¡åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç å—</li><li>æ¯ä¸€ä¸ªç›‘è§†å™¨éƒ½å’Œä¸€ä¸ªå¯¹è±¡å¼•ç”¨å…³è”</li><li>çº¿ç¨‹åœ¨è·å–é”ä¹‹å‰ä¸å…è®¸æ‰§è¡ŒåŒæ­¥ä»£ç å—</li></ul><ol start="16"><li>ä»€ä¹ˆæ˜¯æ­»é”ï¼ˆdeadlockï¼‰ï¼Ÿ</li></ol><ul><li>ä¸¤ä¸ªæˆ–è€…ä¸¤ä¸ªä»¥ä¸Šçš„çº¿ç¨‹éƒ½åœ¨ç­‰å¾…å¯¹æ–¹æ‰§è¡Œå®Œæ¯•æ‰èƒ½ç»§ç»­å¾€ä¸‹æ‰§è¡Œçš„æ—¶å€™å°±å‘ç”Ÿäº†æ­»é”ï¼Œç»“æœæ˜¯è¿™äº›çº¿ç¨‹éƒ½é™·å…¥äº†æ— çº¿çš„ç­‰å¾…</li></ul><ol start="17"><li>å¦‚ä½•ç¡®ä¿ N ä¸ªçº¿ç¨‹å¯ä»¥è®¿é—® N ä¸ªèµ„æºåŒæ—¶åˆä¸å¯¼è‡´æ­»é”ï¼Ÿ</li></ol><ul><li>ä½¿ç”¨å¤šçº¿ç¨‹çš„æ—¶å€™ï¼Œç®€å•é¿å…æ­»é”çš„æ–¹å¼å°±æ˜¯ï¼šæŒ‡å®šè·å–é”çš„é¡ºåºï¼Œå¹¶å¼ºåˆ¶çº¿ç¨‹æŒ‰ç…§è§„å®šçš„ç†Ÿæ‚‰æ€’è·å–é”ï¼›å¦‚æœæ‰€æœ‰çš„çº¿ç¨‹éƒ½æ˜¯ä»¥åŒæ ·çš„é¡ºåºåŠ é”å’Œé‡Šæ”¾é”ï¼Œå°±ä¸ä¼šå‡ºç°æ­»é”äº†</li><li>å¤šçº¿ç¨‹äº§ç”Ÿæ­»é”éœ€è¦å››ä¸ªæ¡ä»¶ï¼Œåˆ†åˆ«æ˜¯<strong>äº’æ–¥æ€§ï¼Œä¿æŒå’Œè¯·æ±‚ï¼Œä¸å¯å‰¥å¤ºæ€§è¿˜æœ‰è¦å½¢æˆé—­ç¯</strong>ï¼Œè¿™å››ä¸ªæ¡ä»¶ç¼ºä¸€ä¸å¯ï¼Œåªè¦ç ´åäº†å…¶ä¸­ä¸€ä¸ªæ¡ä»¶å°±å¯ä»¥ç ´åæ­»é”ï¼Œå…¶ä¸­æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯çº¿ç¨‹éƒ½æ˜¯ä»¥åŒæ ·çš„é¡ºåºåŠ é”å’Œé‡Šæ”¾é”ï¼Œä¹Ÿå°±æ˜¯ç ´åäº†ç¬¬å››ä¸ªæ¡ä»¶<ul><li>1.äº’æ–¥æ¡ä»¶ï¼šä¸€ä¸ªèµ„æºæ¯æ¬¡åªèƒ½è¢«ä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨</li><li>2.ä¿æŒå’Œè¯·æ±‚æ¡ä»¶ï¼šä¸€ä¸ªè¿›ç¨‹å› è¯·æ±‚èµ„æºè€Œé˜»å¡æ—¶ï¼Œå¯¹å·²è·å¾—èµ„æºä¿æŒä¸æ”¾</li><li>3.ä¸å¯å‰¥å¤ºè°ƒæ•™ï¼šè¿›ç¨‹å·²è·å¾—èµ„æºï¼Œåœ¨æœªä½¿ç”¨å®Œæˆå‰ï¼Œä¸èƒ½è¢«å‰¥å¤º</li><li>4.å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼šè‹¥å¹²è¿›ç¨‹ä¹‹é—´å½¢æˆä¸€ç§å¤´å°¾ç›¸æ¥çš„å¾ªç¯ç­‰å¾…èµ„æºå…³ç³»</li></ul></li></ul><ol start="18"><li>Java é›†åˆç±»æ¡†æ¶çš„åŸºæœ¬æ¥å£æœ‰å“ªäº›ï¼Ÿ</li></ol><ul><li>é›†åˆç±»ä¸­æŒ‡å®šäº†ä¸€ç»„å«åšå…ƒç´ çš„å¯¹è±¡ï¼Œé›†åˆç±»æ¥å£ä¸­çš„æ¯ä¸€ç§å…·ä½“å®ç°ç±»éƒ½å¯ä»¥é€‰æ‹©ä»¥å®ƒçš„æ–¹å¼å¯¹å…ƒç´ è¿›è¡Œä¿å­˜å’Œæ’åºï¼Œæœ‰çš„é›†åˆç±»å…è®¸é‡å¤çš„é”®ï¼Œæœ‰äº›ä¸å…è®¸</li><li>Java é›†åˆç±»æä¾›äº†ä¸€å¥—è®¾è®¡è‰¯å¥½çš„æ”¯æŒå¯¹ä¸€ç»„å¯¹è±¡è¿›è¡Œæ“ä½œçš„æ¥å£å’Œç±»ã€‚Java é›†åˆç±»é‡Œé¢æœ€åŸºæœ¬çš„æ¥å£æœ‰ï¼š</li><li>Collectionï¼šä»£è¡¨ä¸€ç»„å¯¹è±¡ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡éƒ½æ˜¯å®ƒçš„å­å…ƒç´ <ul><li>Listï¼šæœ‰é¡ºåºçš„ Collectionï¼Œå¯ä»¥åŒ…å«é‡å¤å…ƒç´ <ul><li>ArrayListï¼šç±»ä¼¼ä¸€ä¸ªé•¿åº¦å¯å˜çš„æ•°ç»„ ã€‚é€‚åˆæŸ¥è¯¢ï¼Œä¸é€‚åˆå¢åˆ </li><li>LinkedListï¼šåº•å±‚æ˜¯åŒå‘å¾ªç¯é“¾è¡¨ã€‚é€‚åˆå¢åˆ ï¼Œä¸é€‚åˆæŸ¥è¯¢</li></ul></li><li>Setï¼šä¸åŒ…å«é‡å¤å…ƒç´ çš„ Collection<ul><li>HashSetï¼šæ ¹æ®å¯¹è±¡çš„å“ˆå¸Œå€¼ç¡®å®šå…ƒç´ åœ¨é›†åˆä¸­çš„ä½ç½®</li><li>TreeSet: ä»¥äºŒå‰æ ‘çš„æ–¹å¼å­˜å‚¨å…ƒç´ ï¼Œå®ç°äº†å¯¹é›†åˆä¸­çš„å…ƒç´ æ’åº</li></ul></li></ul></li><li>Mapï¼šå¯ä»¥æŠŠé”® key æ˜ å°„åˆ°å€¼ value å¾—å¯¹è±¡ï¼Œé”®ä¸å…è®¸é‡å¤<ul><li>HashMapï¼šç”¨äºå­˜å‚¨é”®å€¼æ˜ å°„å…³ç³»ï¼Œä¸èƒ½å‡ºç°é‡å¤çš„é”® key</li><li>TreeMapï¼šç”¨æ¥å­˜å‚¨é”®å€¼æ˜ å°„å…³ç³»ï¼Œä¸èƒ½å‡ºç°é‡å¤çš„é”® keyï¼Œæ‰€æœ‰çš„é”®æŒ‰ç…§äºŒå‰æ ‘çš„æ–¹å¼æ’åˆ—</li></ul></li></ul><ol start="19"><li>ä¸ºä»€ä¹ˆé›†åˆç±»æ²¡æœ‰å®ç° Cloneable å’Œ Serializable æ¥å£ï¼Ÿ</li></ol><ul><li>å…‹éš†(cloning)æˆ–è€…æ˜¯åºåˆ—åŒ–(serialization)çš„è¯­ä¹‰å’Œå«ä¹‰æ˜¯è·Ÿå…·ä½“çš„å®ç°ç›¸å…³çš„ã€‚å› æ­¤ï¼Œåº”è¯¥ç”±é›†åˆç±»çš„å…·ä½“å®ç°æ¥å†³å®šå¦‚ä½•è¢«å…‹éš†æˆ–è€…æ˜¯åºåˆ—åŒ–</li></ul><ol start="20"><li>ä»€ä¹ˆæ˜¯è¿­ä»£å™¨(Iterator)ï¼Ÿ</li></ol><ul><li>Iterator æ¥å£æä¾›äº†å¾ˆå¤šå¯¹é›†åˆå…ƒç´ è¿›è¡Œè¿­ä»£çš„æ–¹æ³•ã€‚æ¯ä¸€ä¸ªé›†åˆç±»éƒ½åŒ…å«äº†å¯ä»¥è¿”å›è¿­ä»£å™¨å®ä¾‹çš„è¿­ä»£æ–¹æ³•ã€‚è¿­ä»£å™¨å¯ä»¥åœ¨è¿­ä»£çš„è¿‡ç¨‹ä¸­åˆ é™¤åº•å±‚é›†åˆçš„å…ƒç´ ,ä½†æ˜¯ä¸å¯ä»¥ç›´æ¥è°ƒç”¨é›†åˆçš„ remove(Object Obj)åˆ é™¤ï¼Œå¯ä»¥é€šè¿‡è¿­ä»£å™¨çš„ remove()æ–¹æ³•åˆ é™¤</li></ul><ol start="21"><li>Iterator å’Œ ListIterator çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</li></ol><ul><li>Iterator å¯ä»¥éå† List å’Œ Set / ListIterator åªèƒ½éå† List</li><li>Iterator å¯¹é›†åˆåªèƒ½æ˜¯å‰å‘éå† / ListIterator æ—¢å¯ä»¥å‰å‘ä¹Ÿå¯ä»¥åå‘</li><li>ListIterator å®ç°äº† Iterator æ¥å£ï¼Œå¹¶åŒ…å«å…¶ä»–çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼šå¢åŠ å…ƒç´ ï¼Œæ›¿æ¢å…ƒç´ ï¼Œè·å–å‰ä¸€ä¸ªå’Œåä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•ç­‰ç­‰</li></ul><ol start="22"><li>å¿«é€Ÿå¤±è´¥ï¼ˆfail-fastï¼‰å’Œå®‰å…¨å¤±è´¥ï¼ˆfail-safeï¼‰åŒºåˆ«</li></ol><ul><li>Iterator çš„å®‰å…¨å¤±è´¥æ˜¯åŸºäºå¯¹åº•å±‚é›†åˆè¿›è¡Œæ‹·è´ï¼Œæ‰€ä»¥ä¸å—æºé›†åˆä¸Šä¿®æ”¹çš„å½±å“</li><li>java.util åŒ…ä¸‹é¢çš„æ‰€æœ‰é›†åˆç±»éƒ½æ˜¯å¿«é€Ÿå¤±è´¥</li><li>java.util.concurrent åŒ…ä¸‹é¢çš„æ‰€æœ‰çš„ç±»éƒ½æ˜¯å®‰å…¨å¤±è´¥çš„</li><li>å¿«é€Ÿå¤±è´¥çš„è¿­ä»£å™¨ä¼šæŠ›å‡º ConcurrentModificationException å¼‚å¸¸ï¼Œè€Œå®‰å…¨å¤±è´¥çš„è¿­ä»£å™¨æ°¸è¿œä¸ä¼šæŠ›å‡ºè¿™æ ·çš„å¼‚å¸¸</li></ul><ol start="23"><li>Java ä¸­çš„ HashMap çš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</li></ol><ul><li>Java ä¸­ HashMap æ˜¯ä»¥é”®å€¼å¯¹ï¼ˆkey-valueï¼‰çš„å½¢å¼å­˜å‚¨å…ƒç´ </li><li>HashMap éœ€è¦ä¸€ä¸ª hash å‡½æ•°ï¼Œå®ƒä½¿ç”¨ hashCode()å’Œ equals()æ–¹æ³•æ¥å‘é›†åˆæ·»åŠ å…ƒç´ /ä»é›†åˆä¸­æ£€ç´¢å…ƒç´ </li><li>å½“è°ƒç”¨ put()æ–¹æ³•çš„æ—¶å€™ï¼ŒHashMap ä¼šè®¡ç®— key çš„ hash å€¼ï¼Œç„¶åæŠŠé”®å€¼å¯¹å­˜å‚¨åœ¨é›†åˆä¸­åˆé€‚çš„ç´¢å¼•ä¸Šã€‚å¦‚æœ key å·²ç»å­˜åœ¨äº†ï¼Œvalue ä¼šè¢«æ›´æ–°æˆæ–°å€¼</li><li>HashMap çš„ä¸€äº›é‡è¦çš„ç‰¹æ€§æ˜¯å®ƒçš„å®¹é‡(capacity)ï¼Œè´Ÿè½½å› å­(load factor)å’Œæ‰©å®¹æé™(threshold resizing)</li></ul><ol start="24"><li>hashCode()å’Œ equals()æ–¹æ³•çš„é‡è¦æ€§ä½“ç°åœ¨ä»€ä¹ˆåœ°æ–¹ï¼Ÿ</li></ol><ul><li>Java ä¸­çš„ HashMap ä½¿ç”¨ hashCode()å’Œ equals()æ–¹æ³•æ¥ç¡®å®šé”®å€¼å¯¹çš„ç´¢å¼•ï¼Œå½“æ ¹æ®é”®è·å–å€¼çš„æ—¶å€™ä¹Ÿä¼šç”¨åˆ°è¿™ä¸¤ä¸ªæ–¹æ³•</li><li>å¦‚æœæ²¡æœ‰æ­£ç¡®çš„å®ç°è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸¤ä¸ªä¸åŒçš„é”®å¯èƒ½ä¼šæœ‰ç›¸åŒçš„ hash å€¼ï¼Œå› æ­¤ï¼Œå¯èƒ½ä¼šè¢«é›†åˆè®¤ä¸ºæ˜¯ç›¸ç­‰çš„</li><li>è¿™ä¸¤ä¸ªæ–¹æ³•ä¹Ÿç”¨æ¥å‘ç°é‡å¤å…ƒç´ ã€‚æ‰€ä»¥è¿™ä¸¤ä¸ªæ–¹æ³•çš„å®ç°å¯¹ HashMap çš„ç²¾ç¡®æ€§å’Œæ­£ç¡®æ€§æ˜¯è‡³å…³é‡è¦çš„</li></ul><ol start="25"><li>HashMap å’Œ Hashtable æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</li></ol><ul><li>HashMap å’Œ Hashtable éƒ½å®ç°äº† Map çš„æ¥å£ï¼Œå› æ­¤å¾ˆå¤šç‰¹æ€§éå¸¸ç›¸ä¼¼ã€‚ä»–ä»¬ä¸åŒä¹‹å¤„åœ¨äºï¼š</li><li>HashMap è¿è¡Œé”®å’Œå€¼æ˜¯ nullï¼Œè€Œ Hashtable ä¸å…è®¸é”®å€¼ä¸º null</li><li>Hashtable æ˜¯åŒæ­¥çš„ï¼Œè€Œ HashMap ä¸æ˜¯ï¼›æ‰€ä»¥ HashMap æ›´é€‚åˆå•çº¿ç¨‹ç¯å¢ƒï¼ŒHashtable æ›´é€‚åˆå¤šçº¿ç¨‹ç¯å¢ƒ</li><li>HashMap æä¾›äº†å¯ä»¥ä¾›åº”ç”¨è¿­ä»£çš„é”®çš„é›†åˆï¼Œå› æ­¤ HashMap æ˜¯å¿«é€Ÿå¤±è´¥çš„ï¼›å¦ä¸€æ–¹ï¼ŒHashtable æä¾›äº†å¯¹é”®çš„åˆ—ä¸¾(Enumeration)ã€‚ä¸€èˆ¬è®¤ä¸º Hashtable æ˜¯ä¸€ä¸ªé—ç•™çš„ç±»</li></ul><ol start="26"><li>æ•°ç»„(Array)å’Œåˆ—è¡¨(ArrayList)æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿä»€ä¹ˆæ—¶å€™åº”è¯¥ä½¿ç”¨ Array è€Œä¸æ˜¯ ArrayListï¼Ÿ</li></ol><ul><li>Array å¯ä»¥åŒ…å«åŸºæœ¬ç±»å‹å’Œå¯¹è±¡ç±»å‹ / ArrayList åªèƒ½åŒ…å«å¯¹è±¡ç±»å‹</li><li>Array çš„å¤§å°æ˜¯å›ºå®šçš„ / ArrayList çš„å¤§å°æ˜¯åŠ¨æ€å˜åŒ–çš„</li><li>ArrayList æä¾›æ›´å¤šçš„æ–¹æ³•å’Œç‰¹æ€§ï¼Œä¾‹å¦‚ï¼šaddAll(),removeAll(),iterator()</li><li>å¯¹äºåŸºæœ¬æ•°æ®ç±»å‹ï¼Œé›†åˆä½¿ç”¨è‡ªåŠ¨è£…ç®±æ¥å‡å°‘ç¼–ç å·¥ä½œé‡ï¼›ä½†æ˜¯å½“å¤„ç†å›ºå®šå¤§å°å›ºå®šå¤§å°çš„åŸºæœ¬æ•°æ®ç±»å‹çš„æ—¶å€™ï¼Œè¿™ç§æ–¹å¼ç›¸å¯¹æ¯”è¾ƒæ…¢</li></ul><ol start="27"><li>ArrayList å’Œ LinkedList æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</li></ol><ul><li>ArrayList å’Œ LinkedList éƒ½å®ç°äº† List æ¥å£ï¼Œä¸åŒä¹‹å¤„åœ¨äºï¼š</li><li>ArrayList æ˜¯åŸºäºç´¢å¼•çš„æ•°æ®æ¥å£ï¼Œå®ƒçš„åº•å±‚æ˜¯æ•°ç»„ï¼Œå®ƒå¯ä»¥ä»¥ O(1)æ—¶é—´å¤æ‚åº¦å¯¹å…ƒç´ è¿›è¡Œéšæœºè®¿é—® / ä¸æ­¤å¯¹åº”ï¼ŒLinkedList æ˜¯ä»¥å…ƒç´ åˆ—è¡¨çš„å½¢å¼å­˜å‚¨å®ƒçš„æ•°æ®ï¼Œæ¯ä¸€ä¸ªå…ƒç´ éƒ½å’Œå®ƒçš„å‰ä¸€ä¸ªå…ƒç´ å’Œåä¸€ä¸ªå…ƒç´ é“¾æ¥åœ¨ä¸€èµ·ï¼ŒæŸ¥æ‰¾æŸä¸ªå…ƒç´ çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(N)</li><li>ç›¸å¯¹äº ArrayListï¼ŒLinkedList çš„æ’å…¥ï¼Œæ·»åŠ ï¼Œåˆ é™¤æ“ä½œé€Ÿåº¦æ›´å¿«ï¼Œå› ä¸ºå½“å…ƒç´ è¢«æ·»åŠ åˆ°é›†åˆä»»æ„ä½ç½®çš„æ—¶å€™ï¼Œä¸éœ€è¦åƒæ•°ç»„é‚£æ ·é‡æ–°è®¡ç®—å¤§å°æˆ–è€…æ˜¯æ›´æ–°ç´¢å¼•</li><li>LinkedList æ¯” ArrayList æ›´å å†…å­˜ï¼Œå› ä¸º LinkedList ä¸ºæ¯ä¸€ä¸ªèŠ‚ç‚¹å­˜å‚¨äº†ä¸¤ä¸ªå¼•ç”¨ï¼Œä¸€ä¸ªæŒ‡å‘å‰ä¸€ä¸ªå…ƒç´ ï¼Œä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ </li></ul><ol start="28"><li>Comparable å’Œ Comparator æ¥å£æ˜¯å¹²ä»€ä¹ˆçš„ï¼Ÿåˆ—å‡ºå®ƒä»¬çš„åŒºåˆ«</li></ol><ul><li>Java æä¾›äº†åªåŒ…å«ä¸€ä¸ª compareTo()æ–¹æ³•çš„ Comparable æ¥å£ã€‚è¿™ä¸ªæ–¹æ³•å¯ä»¥ä¸ªç»™ä¸¤ä¸ªå¯¹è±¡æ’åºã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒè¿”å›è´Ÿæ•°ï¼Œ0ï¼Œæ­£æ•°æ¥è¡¨æ˜è¾“å…¥å¯¹è±¡å°äºï¼Œç­‰äºï¼Œå¤§äºå·²ç»å­˜åœ¨çš„å¯¹è±¡</li><li>Java æä¾›äº†åŒ…å« compare()å’Œ equals()ä¸¤ä¸ªæ–¹æ³•çš„ Comparator æ¥å£ã€‚compare()æ–¹æ³•ç”¨æ¥ç»™ä¸¤ä¸ªè¾“å…¥å‚æ•°æ’åºï¼Œè¿”å›è´Ÿæ•°ï¼Œ0ï¼Œæ­£æ•°è¡¨æ˜ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å°äºï¼Œç­‰äºï¼Œå¤§äºç¬¬äºŒä¸ªå‚æ•°ã€‚equals()æ–¹æ³•éœ€è¦ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œå®ƒç”¨æ¥å†³å®šè¾“å…¥å‚æ•°æ˜¯å¦å’Œ comparator ç›¸ç­‰ã€‚åªæœ‰å½“è¾“å…¥å‚æ•°ä¹Ÿæ˜¯ä¸€ä¸ª comparator å¹¶ä¸”è¾“å…¥å‚æ•°å’Œå½“å‰ comparator çš„æ’åºç»“æœæ˜¯ç›¸åŒçš„æ—¶å€™ï¼Œè¿™ä¸ªæ–¹æ³•æ‰è¿”å› true</li></ul><ol start="29"><li>ä»€ä¹ˆæ˜¯ Java ä¼˜å…ˆçº§é˜Ÿåˆ—(Priority Queue)ï¼Ÿ</li></ol><ul><li>Priority Queue ä¸€ä¸ªåŸºäºä¼˜å…ˆçº§å †å¾—æ— çº¿é˜Ÿåˆ—ï¼Œå®ƒçš„å…ƒç´ æ˜¯æŒ‰ç…§è‡ªç„¶é¡ºåºæ’åºçš„</li><li>åœ¨åˆ›å»ºçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç»™å®ƒæä¾›ä¸€ä¸ªè´Ÿè´£ç»™å…ƒç´ æ’åºçš„æ¯”è¾ƒå™¨</li><li>PriorityQueue ä¸å…è®¸ null å€¼ï¼Œå› ä¸ºä»–ä»¬æ²¡æœ‰è‡ªç„¶é¡ºåºï¼Œæˆ–è€…è¯´ä»–ä»¬æ²¡æœ‰ä»»ä½•çš„ç›¸å…³è”çš„æ¯”è¾ƒå™¨</li><li>PriorityQueue ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå…¥é˜Ÿå’Œå‡ºé˜Ÿçš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(log(n))</li></ul><ol start="30"><li>ä½ äº†è§£å¤§ O ç¬¦å·(big-O notation)ä¹ˆï¼Ÿä½ èƒ½ç»™å‡ºä¸åŒæ•°æ®ç»“æ„çš„ä¾‹å­ä¹ˆï¼Ÿ</li></ol><ul><li>å¤§ O ç¬¦å·æè¿°äº†å½“æ•°æ®ç»“æ„é‡Œé¢çš„å…ƒç´ å¢åŠ çš„æ—¶å€™ï¼Œç®—æ³•çš„è§„æ¨¡æˆ–è€…æ˜¯æ€§èƒ½åœ¨æœ€åçš„åœºæ™¯ä¸‹æœ‰å¤šä¹ˆå¥½ã€‚</li><li>å¤§ O ç¬¦å·ä¹Ÿå¯ç”¨æ¥æè¿°å…¶ä»–çš„è¡Œä¸ºï¼Œæ¯”å¦‚ï¼šå†…å­˜æ¶ˆè€—ã€‚å› ä¸ºé›†åˆç±»å®é™…ä¸Šæ˜¯æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨å¤§ O ç¬¦å·åŸºäºæ—¶é—´ï¼Œå†…å­˜å’Œæ€§èƒ½æ¥é€‰æ‹©æœ€å¥½çš„å®ç°ã€‚å¤§ O ç¬¦å·å¯ä»¥å¯¹å¤§é‡æ•°æ®çš„æ€§èƒ½ç»™å‡ºä¸€ä¸ªå¾ˆå¥½çš„è¯´æ˜</li></ul><ol><li><p>å¦‚ä½•æƒè¡¡æ˜¯ä½¿ç”¨æ— åºçš„æ•°ç»„è¿˜æ˜¯æœ‰åºçš„æ•°ç»„ï¼Ÿ</p><ul><li>æœ‰åºæ•°ç»„æœ€å¤§çš„å¥½å¤„åœ¨äºæŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(log n)ï¼Œè€Œæ— åºæ•°ç»„æ˜¯ O(n)ã€‚æœ‰åºæ•°ç»„çš„ç¼ºç‚¹æ˜¯æ’å…¥æ“ä½œçš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(n)ï¼Œå› ä¸ºå€¼å¤§çš„å…ƒç´ éœ€è¦å¾€åç§»åŠ¨æ¥ç»™æ–°å…ƒç´ è…¾ä½ç½®ã€‚ç›¸åï¼Œæ— åºæ•°ç»„çš„æ’å…¥æ—¶é—´å¤æ‚åº¦æ˜¯å¸¸é‡ O(1)</li></ul></li><li><p>Java é›†åˆç±»æ¡†æ¶çš„æœ€ä½³å®è·µ</p><ul><li>æ ¹æ®åº”ç”¨çš„éœ€è¦æ­£ç¡®é€‰æ‹©è¦ä½¿ç”¨çš„é›†åˆçš„ç±»å‹å¯¹æ€§èƒ½éå¸¸é‡è¦ï¼Œæ¯”å¦‚ï¼šå‡å¦‚å…ƒç´ çš„å¤§å°æ˜¯å›ºå®šçš„ï¼Œè€Œä¸”èƒ½äº‹å…ˆçŸ¥é“ï¼Œæˆ‘ä»¬å°±åº”è¯¥ç”¨ Array è€Œä¸æ˜¯ ArrayList</li><li>æœ‰äº›é›†åˆç±»å…è®¸æŒ‡å®šåˆå§‹å®¹é‡ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬èƒ½ä¼°è®¡å‡ºå­˜å‚¨çš„å…ƒç´ çš„æ•°ç›®ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®åˆå§‹å®¹é‡æ¥é¿å…é‡æ–°è®¡ç®— hash å€¼æˆ–è€…æ˜¯æ‰©å®¹</li><li>ä¸ºäº†ç±»å‹å®‰å…¨ï¼Œå¯è¯»æ€§å’Œå¥å£®æ€§çš„åŸå› æ€»æ˜¯è¦ä½¿ç”¨æ³›å‹ã€‚åŒæ—¶ï¼Œä½¿ç”¨æ³›å‹è¿˜å¯ä»¥é¿å…è¿è¡Œæ—¶çš„ ClassCastException</li><li>ä½¿ç”¨ JDK æä¾›çš„ä¸å˜ç±»(immutable class)ä½œä¸º Map çš„é”®å¯ä»¥é¿å…ä¸ºæˆ‘ä»¬è‡ªå·±çš„ç±»å®ç° hashCode()å’Œ equals()æ–¹æ³•</li><li>ç¼–ç¨‹çš„æ—¶å€™æ¥å£ä¼˜äºå®ç°</li><li>åº•å±‚çš„é›†åˆå®é™…ä¸Šæ˜¯ç©ºçš„æƒ…å†µä¸‹ï¼Œè¿”å›é•¿åº¦æ˜¯ 0 çš„é›†åˆæˆ–è€…æ˜¯æ•°ç»„ï¼Œä¸è¦è¿”å› null</li></ul></li><li><p>Enumeration æ¥å£å’Œ Iterator æ¥å£çš„åŒºåˆ«</p><ul><li>Enumeration é€Ÿåº¦æ˜¯ Iterator çš„ 2 å€ï¼ŒåŒæ—¶å ç”¨æ›´å°‘çš„å†…å­˜</li><li>ä½†æ˜¯ï¼ŒIterator è¿œè¿œæ¯” Enumeration å®‰å…¨ï¼Œå› ä¸ºå…¶ä»–çº¿ç¨‹ä¸èƒ½å¤Ÿä¿®æ”¹æ­£åœ¨è¢« iterator éå†çš„é›†åˆé‡Œé¢çš„å¯¹è±¡</li><li>åŒæ—¶ï¼ŒIterator å…è®¸è°ƒç”¨è€…åˆ é™¤åº•å±‚é›†åˆé‡Œé¢çš„å…ƒç´ ï¼Œè¿™å¯¹ Enumeration æ¥è¯´æ˜¯ä¸å¯èƒ½çš„</li></ul></li><li><p>HashSet å’Œ TreeSet æœ‰åŒºåˆ«</p><ul><li>HashSet æ˜¯ç”±ä¸€ä¸ª hash è¡¨æ¥å®ç°çš„ï¼Œå› æ­¤ï¼Œå®ƒçš„å…ƒç´ æ˜¯æ— åºçš„ã€‚add()ï¼Œremove()ï¼Œcontains()æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(1)</li><li>TreeSet æ˜¯ç”±ä¸€ä¸ªæ ‘å½¢çš„ç»“æ„æ¥å®ç°çš„ï¼Œå®ƒé‡Œé¢çš„å…ƒç´ æ˜¯æœ‰åºçš„ã€‚å› æ­¤ï¼Œadd()ï¼Œremove()ï¼Œcontains()æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(logn)</li></ul></li><li><p>Java åƒåœ¾å›æ”¶ç›®çš„</p><ul><li>åƒåœ¾å›æ”¶çš„ç›®çš„æ˜¯è¯†åˆ«å¹¶ä¸”ä¸¢å¼ƒåº”ç”¨ä¸å†ä½¿ç”¨çš„å¯¹è±¡æ¥é‡Šæ”¾å’Œé‡ç”¨èµ„æº</li></ul></li><li><p>System.gc()å’Œ Runtime.gc()ä¼šåšä»€ä¹ˆäº‹æƒ…</p><ul><li>ç”¨æ¥æç¤º JVM è¦è¿›è¡Œåƒåœ¾å›æ”¶ã€‚ä½†æ˜¯ï¼Œç«‹å³å¼€å§‹è¿˜æ˜¯å»¶è¿Ÿè¿›è¡Œåƒåœ¾å›æ”¶æ˜¯å–å†³äº JVM çš„</li></ul></li><li><p>finalize()æ–¹æ³•ä»€ä¹ˆæ—¶å€™è¢«è°ƒç”¨ï¼Ÿææ„å‡½æ•°(finalization)çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ</p><ul><li>åƒåœ¾å›æ”¶å™¨(garbage colector)å†³å®šå›æ”¶æŸå¯¹è±¡æ—¶ï¼Œå°±ä¼šè¿è¡Œè¯¥å¯¹è±¡çš„ finalize()æ–¹æ³• ä½†æ˜¯åœ¨ Java ä¸­å¾ˆä¸å¹¸ï¼Œå¦‚æœå†…å­˜æ€»æ˜¯å……è¶³çš„ï¼Œé‚£ä¹ˆåƒåœ¾å›æ”¶å¯èƒ½æ°¸è¿œä¸ä¼šè¿›è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ filalize()å¯èƒ½æ°¸è¿œä¸è¢«æ‰§è¡Œï¼Œæ˜¾ç„¶æŒ‡æœ›å®ƒåšæ”¶å°¾å·¥ä½œæ˜¯é ä¸ä½çš„ï¼Œå®ƒæœ€ä¸»è¦çš„ç”¨é€”æ˜¯å›æ”¶ç‰¹æ®Šæ¸ é“ç”³è¯·çš„å†…å­˜ã€‚</li><li>ææ„ finalizationï¼Œæ¯”å¦‚ä½ åœ¨è°ƒç”¨äº†ä¸€äº› native çš„æ–¹æ³•ï¼Œå¯ä»¥è¦åœ¨ finaliztion é‡Œå»è°ƒç”¨é‡Šæ”¾å‡½æ•°</li></ul></li><li><p>å¦‚æœå¯¹è±¡çš„å¼•ç”¨è¢«ç½®ä¸º nullï¼Œåƒåœ¾æ”¶é›†å™¨æ˜¯å¦ä¼šç«‹å³é‡Šæ”¾å¯¹è±¡å ç”¨çš„å†…å­˜ï¼Ÿ</p><ul><li>ä¸ä¼šï¼Œåœ¨ä¸‹ä¸€ä¸ªåƒåœ¾å›æ”¶å‘¨æœŸä¸­ï¼Œè¿™ä¸ªå¯¹è±¡å°†æ˜¯å¯è¢«å›æ”¶çš„</li></ul></li><li><p>Java å †çš„ç»“æ„æ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Ÿä»€ä¹ˆæ˜¯å †ä¸­çš„æ°¸ä¹…ä»£(Perm Gen space)?</p><ul><li>JVM çš„å †æ˜¯è¿è¡Œæ—¶æ•°æ®åŒºï¼Œæ‰€æœ‰ç±»çš„å®ä¾‹å’Œæ•°ç»„éƒ½æ˜¯åœ¨å †ä¸Šåˆ†é…å†…å­˜ã€‚å®ƒåœ¨ JVM å¯åŠ¨çš„æ—¶å€™è¢«åˆ›å»ºã€‚å¯¹è±¡æ‰€å çš„å †å†…å­˜æ˜¯ç”±è‡ªåŠ¨å†…å­˜ç®¡ç†ç³»ç»Ÿä¹Ÿå°±æ˜¯åƒåœ¾æ”¶é›†å™¨å›æ”¶</li><li>å †å†…å­˜æ˜¯ç”±å­˜æ´»å’Œæ­»äº¡çš„å¯¹è±¡ç»„æˆçš„ã€‚å­˜æ´»çš„å¯¹è±¡æ˜¯åº”ç”¨å¯ä»¥è®¿é—®çš„ï¼Œä¸ä¼šè¢«åƒåœ¾å›æ”¶ã€‚æ­»äº¡çš„å¯¹è±¡æ˜¯åº”ç”¨ä¸å¯è®¿é—®å°šä¸”è¿˜æ²¡æœ‰è¢«åƒåœ¾æ”¶é›†å™¨å›æ”¶æ‰çš„å¯¹è±¡ã€‚ä¸€ç›´åˆ°åƒåœ¾æ”¶é›†å™¨æŠŠè¿™äº›å¯¹è±¡å›æ”¶æ‰ä¹‹å‰ï¼Œä»–ä»¬ä¼šä¸€ç›´å æ®å †å†…å­˜ç©ºé—´</li></ul></li><li><p>ä¸²è¡Œ(serial)æ”¶é›†å™¨å’Œååé‡(throughput)æ”¶é›†å™¨çš„åŒºåˆ«</p><ul><li>ä¸²è¡Œæ”¶é›†å™¨å¯¹å¤§å¤šæ•°çš„å°åº”ç”¨(åœ¨ç°ä»£å¤„ç†å™¨ä¸Šéœ€è¦å¤§æ¦‚ 100M å·¦å³çš„å†…å­˜)å°±è¶³å¤Ÿäº†</li><li>ååé‡æ”¶é›†å™¨ä½¿ç”¨å¹¶è¡Œç‰ˆæœ¬çš„æ–°ç”Ÿä»£åƒåœ¾æ”¶é›†å™¨ï¼Œå®ƒç”¨äºä¸­ç­‰è§„æ¨¡å’Œå¤§è§„æ¨¡æ•°æ®çš„åº”ç”¨ç¨‹åº</li></ul></li><li><p>åœ¨ Java ä¸­ï¼Œå¯¹è±¡ä»€ä¹ˆæ—¶å€™å¯ä»¥è¢«åƒåœ¾å›æ”¶</p><ul><li>å½“æ²¡æœ‰ä»»ä½•å¯¹è±¡çš„å¼•ç”¨æŒ‡å‘å¯¹è±¡æ—¶åœ¨ä¸€ä¸ªä¸å¯é¢„æœŸçš„æ—¶é—´å†…å¯¹è±¡æ‰ä¼šè¢«å›æ”¶(å¯¹äºé‚£äº›å¾ªç¯åº”ç”¨çš„æ—¶å€™ï¼Œä¹Ÿè¦è¢«å›æ”¶)</li><li>å½“å¯¹è±¡å¯¹å½“å‰ä½¿ç”¨è¿™ä¸ªå¯¹è±¡çš„åº”ç”¨ç¨‹åºå˜å¾—ä¸å¯è§¦åŠçš„æ—¶å€™ï¼Œè¿™ä¸ªå¯¹è±¡å°±å¯ä»¥è¢«å›æ”¶äº†</li></ul></li><li><p>JVM çš„æ°¸ä¹…ä»£ä¸­ä¼šå‘ç”Ÿåƒåœ¾å›æ”¶ä¹ˆï¼Ÿ</p><ul><li>åƒåœ¾å›æ”¶ä¸ä¼šå‘ç”Ÿåœ¨æ°¸ä¹…ä»£ï¼Œå¦‚æœæ°¸ä¹…ä»£æ»¡äº†æˆ–è€…æ˜¯è¶…è¿‡äº†ä¸´ç•Œå€¼ï¼Œä¼šè§¦å‘å®Œå…¨åƒåœ¾å›æ”¶(Full GC)</li><li>å¦‚æœä½ ä»”ç»†æŸ¥çœ‹åƒåœ¾æ”¶é›†å™¨çš„è¾“å‡ºä¿¡æ¯ï¼Œå°±ä¼šå‘ç°æ°¸ä¹…ä»£ä¹Ÿæ˜¯è¢«å›æ”¶çš„</li></ul></li><li><p>Java ä¸­çš„ä¸¤ç§å¼‚å¸¸ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿä»–ä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><ul><li>Java ä¸­æœ‰ä¸¤ç§å¼‚å¸¸ï¼šå—æ£€æŸ¥çš„(checked)å¼‚å¸¸å’Œä¸å—æ£€æŸ¥çš„(unchecked)å¼‚å¸¸</li><li>ä¸å—æ£€æŸ¥çš„å¼‚å¸¸ä¸éœ€è¦åœ¨æ–¹æ³•æˆ–è€…æ˜¯æ„é€ å‡½æ•°ä¸Šå£°æ˜ï¼Œå°±ç®—æ–¹æ³•æˆ–è€…æ˜¯æ„é€ å‡½æ•°çš„æ‰§è¡Œå¯èƒ½ä¼šæŠ›å‡ºè¿™æ ·çš„å¼‚å¸¸ï¼Œå¹¶ä¸”ä¸å—æ£€æŸ¥çš„å¼‚å¸¸å¯ä»¥ä¼ æ’­åˆ°æ–¹æ³•æˆ–è€…æ˜¯æ„é€ å‡½æ•°çš„å¤–é¢</li><li>å—æ£€æŸ¥çš„å¼‚å¸¸å¿…é¡»è¦ç”¨ throws è¯­å¥åœ¨æ–¹æ³•æˆ–è€…æ˜¯æ„é€ å‡½æ•°ä¸Šå£°æ˜</li></ul></li><li><p>Java ä¸­ Exception å’Œ Error æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><ul><li>Exception å’Œ Error éƒ½æ˜¯ Throwable çš„å­ç±»</li><li>Exception ç”¨äºç”¨æˆ·ç¨‹åºå¯ä»¥æ•è·çš„å¼‚å¸¸æƒ…å†µ</li><li>Error å®šä¹‰äº†ä¸æœŸæœ›è¢«ç”¨æˆ·ç¨‹åºæ•è·çš„å¼‚å¸¸</li></ul></li><li><p>throw å’Œ throws æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><ul><li>throw å…³é”®å­—ç”¨æ¥åœ¨ç¨‹åºä¸­æ˜ç¡®çš„æŠ›å‡ºå¼‚å¸¸ï¼Œç›¸åï¼Œthrows è¯­å¥ç”¨æ¥è¡¨æ˜æ–¹æ³•ä¸èƒ½å¤„ç†çš„å¼‚å¸¸</li><li>Throw ç”¨äºæ–¹æ³•å†…éƒ¨ï¼ŒThrows ç”¨äºæ–¹æ³•å£°æ˜ä¸Š;Throw åè·Ÿå¼‚å¸¸å¯¹è±¡ï¼ŒThrows åè·Ÿå¼‚å¸¸ç±»å‹;Throw ååªèƒ½è·Ÿä¸€ä¸ªå¼‚å¸¸å¯¹è±¡ï¼ŒThrows åå¯ä»¥ä¸€æ¬¡å£°æ˜å¤šç§å¼‚å¸¸ç±»å‹</li><li>æ¯ä¸€ä¸ªæ–¹æ³•éƒ½å¿…é¡»è¦æŒ‡å®šå“ªäº›å¼‚å¸¸ä¸èƒ½å¤„ç†ï¼Œæ‰€ä»¥æ–¹æ³•çš„è°ƒç”¨è€…æ‰èƒ½å¤Ÿç¡®ä¿å¤„ç†å¯èƒ½å‘ç”Ÿçš„å¼‚å¸¸ï¼Œå¤šä¸ªå¼‚å¸¸æ˜¯ç”¨é€—å·åˆ†éš”çš„(è¯­æ³•ï¼šä¿®é¥°ç¬¦ è¿”å›å€¼ç±»å‹ æ–¹æ³•å å‚æ•°ç±»å‹ throws å¼‚å¸¸ç±»<br>public void test throws Exception1,Exception2(){})</li></ul></li><li><p>å¼‚å¸¸å¤„ç†å®Œæˆä»¥åï¼ŒException å¯¹è±¡ä¼šå‘ç”Ÿä»€ä¹ˆå˜åŒ–ï¼Ÿ</p><ul><li>Exception å¯¹è±¡ä¼šåœ¨ä¸‹ä¸€ä¸ªåƒåœ¾å›æ”¶è¿‡ç¨‹ä¸­è¢«å›æ”¶æ‰</li></ul></li><li><p>finally ä»£ç å—å’Œ finalize()æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><ul><li>æ— è®º try catch è¯­å¥å—ä¸­çš„ä»£ç å—æ˜¯å¦æŠ›å‡ºå¼‚å¸¸ï¼Œfinally ä»£ç å—éƒ½ä¼šæ‰§è¡Œï¼Œå®ƒä¸»è¦æ˜¯ç”¨æ¥é‡Šæ”¾åº”ç”¨å ç”¨çš„èµ„æº</li><li>finalize()æ–¹æ³•æ˜¯ Object ç±»çš„ä¸€ä¸ª protected æ–¹æ³•ï¼Œå®ƒæ˜¯åœ¨å¯¹è±¡è¢«åƒåœ¾å›æ”¶ä¹‹å‰ç”± Java è™šæ‹Ÿæœºæ¥è°ƒç”¨çš„</li></ul></li><li><p>ä»€ä¹ˆæ˜¯ Appletï¼Ÿ</p><ul><li>java applet æ˜¯èƒ½å¤Ÿè¢«åŒ…å«åœ¨ HTML é¡µé¢ä¸­å¹¶ä¸”èƒ½è¢«å¯ç”¨äº† java çš„å®¢æˆ·ç«¯æµè§ˆå™¨æ‰§è¡Œçš„ç¨‹åºã€‚Applet ä¸»è¦ç”¨æ¥åˆ›å»ºåŠ¨æ€äº¤äº’çš„ web åº”ç”¨ç¨‹åº</li></ul></li><li><p>Applet çš„ç”Ÿå‘½å‘¨æœŸ:</p><ul><li>Initï¼šæ¯æ¬¡è¢«è½½å…¥çš„æ—¶å€™éƒ½ä¼šè¢«åˆå§‹åŒ–</li><li>Startï¼šå¼€å§‹æ‰§è¡Œ applet</li><li>Stopï¼šç»“æŸæ‰§è¡Œ applet</li><li>Destroyï¼šå¸è½½ applet ä¹‹å‰ï¼Œåšæœ€åçš„æ¸…ç†å·¥ä½œ</li></ul></li><li><p>å½“ applet è¢«è½½å…¥çš„æ—¶å€™ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p><ul><li>é¦–å…ˆåˆ›å»º applet æ§åˆ¶ç±»çš„å®ä¾‹;ç„¶ååˆå§‹åŒ– applet;æœ€åå¼€å§‹è¿è¡Œ</li></ul></li><li><p>Applet å’Œæ™®é€šçš„ Java åº”ç”¨ç¨‹åºæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><ul><li>applet æ˜¯è¿è¡Œåœ¨å¯ç”¨äº† java çš„æµè§ˆå™¨ä¸­ï¼ŒJava åº”ç”¨ç¨‹åºæ˜¯å¯ä»¥åœ¨æµè§ˆå™¨ä¹‹å¤–è¿è¡Œçš„ç‹¬ç«‹çš„ Java ç¨‹åº</li><li>Java åº”ç”¨ç¨‹åºéœ€è¦ä¸€ä¸ªæœ‰ç‰¹å®šæ–¹æ³•ç­¾åçš„ main å‡½æ•°æ¥å¼€å§‹æ‰§è¡Œã€‚Java applet ä¸éœ€è¦è¿™æ ·çš„å‡½æ•°æ¥å¼€å§‹æ‰§è¡Œ</li><li>Java applet ä¸€èˆ¬ä¼šä½¿ç”¨å¾ˆä¸¥æ ¼çš„å®‰å…¨ç­–ç•¥ï¼ŒJava åº”ç”¨ä¸€èˆ¬ä½¿ç”¨æ¯”è¾ƒå®½æ¾çš„å®‰å…¨ç­–ç•¥</li></ul></li><li><p>Java applet æœ‰å“ªäº›é™åˆ¶æ¡ä»¶ï¼Ÿ</p><ul><li>applet ä¸èƒ½å¤Ÿè½½å…¥ç±»åº“æˆ–è€…å®šä¹‰æœ¬åœ°æ–¹æ³•</li><li>applet ä¸èƒ½åœ¨å®¿ä¸»æœºä¸Šè¯»å†™æ–‡ä»¶</li><li>applet ä¸èƒ½è¯»å–ç‰¹å®šçš„ç³»ç»Ÿå±æ€§</li><li>applet ä¸èƒ½å‘èµ·ç½‘ç»œè¿æ¥ï¼Œé™¤éæ˜¯è·Ÿå®¿ä¸»æœº</li><li>applet ä¸èƒ½å¤Ÿå¼€å¯å®¿ä¸»æœºä¸Šå…¶ä»–ä»»ä½•çš„ç¨‹åº</li></ul></li><li><p>ä»€ä¹ˆæ˜¯ä¸å—ä¿¡ä»»çš„ appletï¼Ÿ</p><ul><li>ä¸å—ä¿¡ä»»çš„ applet æ˜¯ä¸èƒ½è®¿é—®æˆ–æ˜¯æ‰§è¡Œæœ¬åœ°ç³»ç»Ÿæ–‡ä»¶çš„ Java appletï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰ä¸‹è½½çš„ applet éƒ½æ˜¯ä¸å—ä¿¡ä»»çš„</li></ul></li><li><p>ä»ç½‘ç»œä¸ŠåŠ è½½çš„ applet å’Œä»æœ¬åœ°æ–‡ä»¶ç³»ç»ŸåŠ è½½çš„ applet æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><ul><li>å½“ applet æ˜¯ä»ç½‘ç»œä¸ŠåŠ è½½çš„æ—¶å€™ï¼Œapplet æ˜¯ç”± applet ç±»åŠ è½½å™¨è½½å…¥çš„ï¼Œå®ƒå— applet å®‰å…¨ç®¡ç†å™¨çš„é™åˆ¶</li><li>å½“ applet æ˜¯ä»å®¢æˆ·ç«¯çš„æœ¬åœ°ç£ç›˜è½½å…¥çš„æ—¶å€™ï¼Œapplet æ˜¯ç”±æ–‡ä»¶ç³»ç»ŸåŠ è½½å™¨è½½å…¥çš„</li><li>ä»æ–‡ä»¶ç³»ç»Ÿè½½å…¥çš„ applet å…è®¸åœ¨å®¢æˆ·ç«¯è¯»æ–‡ä»¶ï¼Œå†™æ–‡ä»¶ï¼ŒåŠ è½½ç±»åº“ï¼Œå¹¶ä¸”ä¹Ÿå…è®¸æ‰§è¡Œå…¶ä»–ç¨‹åºï¼Œä½†æ˜¯ï¼Œå´é€šä¸è¿‡å­—èŠ‚ç æ ¡éªŒ</li></ul></li><li><p>applet ç±»åŠ è½½å™¨æ˜¯ä»€ä¹ˆï¼Ÿå®ƒä¼šåšå“ªäº›å·¥ä½œï¼Ÿ</p><ul><li>å½“ applet æ˜¯ä»ç½‘ç»œä¸ŠåŠ è½½çš„æ—¶å€™ï¼Œå®ƒæ˜¯ç”± applet ç±»åŠ è½½å™¨è½½å…¥çš„ã€‚ç±»åŠ è½½å™¨æœ‰è‡ªå·±çš„ java åç§°ç©ºé—´ç­‰çº§ç»“æ„ã€‚ç±»åŠ è½½å™¨ä¼šä¿è¯æ¥è‡ªæ–‡ä»¶ç³»ç»Ÿçš„ç±»æœ‰å”¯ä¸€çš„åç§°ç©ºé—´ï¼Œæ¥è‡ªç½‘ç»œèµ„æºçš„ç±»æœ‰å”¯ä¸€çš„åç§°ç©ºé—´</li><li>å½“æµè§ˆå™¨é€šè¿‡ç½‘ç»œè½½å…¥ applet çš„æ—¶å€™ï¼Œapplet çš„ç±»è¢«æ”¾ç½®äºå’Œ applet çš„æºç›¸å…³è”çš„ç§æœ‰çš„åç§°ç©ºé—´ä¸­ã€‚ç„¶åï¼Œé‚£äº›è¢«ç±»åŠ è½½å™¨è½½å…¥è¿›æ¥çš„ç±»éƒ½æ˜¯é€šè¿‡äº†éªŒè¯å™¨éªŒè¯çš„ã€‚éªŒè¯å™¨ä¼šæ£€æŸ¥ç±»æ–‡ä»¶æ ¼å¼æ˜¯å¦éµå®ˆ Java è¯­è¨€è§„èŒƒï¼Œç¡®ä¿ä¸ä¼šå‡ºç°å †æ ˆæº¢å‡º(stack overflow)æˆ–è€…ä¸‹æº¢(underflow)ï¼Œä¼ é€’ç»™å­—èŠ‚ç æŒ‡ä»¤çš„å‚æ•°æ˜¯æ­£ç¡®çš„</li></ul></li><li><p>applet å®‰å…¨ç®¡ç†å™¨æ˜¯ä»€ä¹ˆï¼Ÿå®ƒä¼šåšå“ªäº›å·¥ä½œï¼Ÿ</p><ul><li>applet å®‰å…¨ç®¡ç†å™¨æ˜¯ç»™ applet æ–½åŠ é™åˆ¶æ¡ä»¶çš„ä¸€ç§æœºåˆ¶ã€‚æµè§ˆå™¨å¯ä»¥åªæœ‰ä¸€ä¸ªå®‰å…¨ç®¡ç†å™¨ã€‚å®‰å…¨ç®¡ç†å™¨åœ¨å¯åŠ¨çš„æ—¶å€™è¢«åˆ›å»ºï¼Œä¹‹åä¸èƒ½è¢«æ›¿æ¢è¦†ç›–æˆ–è€…æ˜¯æ‰©å±•</li></ul></li><li><p>å¼¹å‡ºå¼é€‰æ‹©èœå•(Choice)å’Œåˆ—è¡¨(List)æœ‰ä»€ä¹ˆåŒºåˆ«</p><ul><li>Choice æ˜¯ä»¥ä¸€ç§ç´§å‡‘çš„å½¢å¼å±•ç¤ºçš„ï¼Œéœ€è¦ä¸‹æ‹‰æ‰èƒ½çœ‹åˆ°æ‰€æœ‰çš„é€‰é¡¹ã€‚Choice ä¸­ä¸€æ¬¡åªèƒ½é€‰ä¸­ä¸€ä¸ªé€‰é¡¹</li><li>List åŒæ—¶å¯ä»¥æœ‰å¤šä¸ªå…ƒç´ å¯è§ï¼Œæ”¯æŒé€‰ä¸­ä¸€ä¸ªæˆ–è€…å¤šä¸ªå…ƒç´ </li></ul></li><li><p>å¸ƒå±€ç®¡ç†å™¨</p><ul><li>å¸ƒå±€ç®¡ç†å™¨ç”¨æ¥åœ¨å®¹å™¨ä¸­ç»„ç»‡ç»„ä»¶</li></ul></li><li><p>æ»šåŠ¨æ¡(Scrollbar)å’Œæ»šåŠ¨é¢æ¿(JScrollPane)åŒºåˆ«</p><ul><li>Scrollbar æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œä¸æ˜¯å®¹å™¨ã€‚è€Œ JScrollPane æ˜¯å®¹å™¨ã€‚JScrollPane è‡ªå·±å¤„ç†æ»šåŠ¨äº‹ä»¶</li><li>åœ¨è®¾ç½®ç•Œé¢æ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°åœ¨ä¸€ä¸ªè¾ƒå°çš„å®¹å™¨çª—ä½“ä¸­æ˜¾ç¤ºä¸€ä¸ªè¾ƒå¤§éƒ¨åˆ†çš„å†…å®¹ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨ JScrollPane é¢æ¿ï¼ŒJscrollPane é¢æ¿æ˜¯å¸¦æ»šåŠ¨æ¡çš„é¢æ¿ï¼Œä¹Ÿæ˜¯ä¸€ç§å®¹å™¨ï¼Œä½†æ˜¯å¸¸ç”¨äºå¸ƒç½®å•ä¸ªæ§ä»¶ï¼Œå¹¶ä¸”ä¸å¯ä»¥ä½¿ç”¨å¸ƒå±€ç®¡ç†å™¨ã€‚å¦‚æœéœ€è¦åœ¨ JScrollPane é¢æ¿ä¸­æ”¾ç½®å¤šä¸ªæ§ä»¶ï¼Œéœ€è¦å°†å¤šä¸ªæ§ä»¶æ”¾ç½®åˆ° JPanel é¢æ¿ä¸Šï¼Œç„¶åå°† JPanel é¢æ¿ä½œä¸ºä¸€ä¸ªæ•´ä½“æ§ä»¶æ·»åŠ åˆ° JScrollPane æ§ä»¶ä¸Š</li></ul></li><li><p>å“ªäº› Swing çš„æ–¹æ³•æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ</p><ul><li>åªæœ‰ 3 ä¸ªçº¿ç¨‹å®‰å…¨çš„æ–¹æ³•ï¼š repaint(), revalidate(), and invalidate()</li></ul></li><li><p>æ”¯æŒé‡ç»˜(painting)çš„ç»„ä»¶</p><ul><li>Canvas, Frame, Panel,å’Œ Applet æ”¯æŒé‡ç»˜</li></ul></li><li><p>ä»€ä¹ˆæ˜¯è£å‰ª(clipping)ï¼Ÿ</p><ul><li>é™åˆ¶åœ¨ä¸€ä¸ªç»™å®šçš„åŒºåŸŸæˆ–è€…å½¢çŠ¶çš„ç»˜å›¾æ“ä½œå°±åšè£å‰ª</li></ul></li><li><p>MenuItem å’Œ CheckboxMenuItem çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p><ul><li>CheckboxMenuItem ç±»ç»§æ‰¿è‡ª MenuItem ç±»ï¼Œæ”¯æŒèœå•é€‰é¡¹å¯ä»¥é€‰ä¸­æˆ–è€…ä¸é€‰ä¸­</li></ul></li><li><p>è¾¹ç¼˜å¸ƒå±€(BorderLayout)é‡Œé¢çš„å…ƒç´ æ˜¯å¦‚ä½•å¸ƒå±€çš„ï¼Ÿ</p><ul><li>BorderLayout é‡Œé¢çš„å…ƒç´ æ˜¯æŒ‰ç…§å®¹å™¨çš„ä¸œè¥¿å—åŒ—ä¸­è¿›è¡Œå¸ƒå±€çš„</li></ul></li><li><p>ç½‘æ ¼åŒ…å¸ƒå±€(GridBagLayout)é‡Œé¢çš„å…ƒç´ æ˜¯å¦‚ä½•å¸ƒå±€çš„ï¼Ÿ</p><ul><li>GridBagLayout é‡Œé¢çš„å…ƒç´ æ˜¯æŒ‰ç…§ç½‘æ ¼è¿›è¡Œå¸ƒå±€çš„ã€‚ä¸åŒå¤§å°çš„å…ƒç´ å¯èƒ½ä¼šå æ®ç½‘æ ¼çš„å¤šäº 1 è¡Œæˆ–ä¸€åˆ—ã€‚å› æ­¤ï¼Œè¡Œæ•°å’Œåˆ—æ•°å¯ä»¥æœ‰ä¸åŒçš„å¤§å°</li></ul></li><li><p>Windows å’Œ Frame åŒºåˆ«</p><ul><li>Frame ç±»ç»§æ‰¿äº† Window ç±»ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªå¯ä»¥æœ‰èœå•æ çš„ä¸»åº”ç”¨çª—å£</li></ul></li><li><p>è£å‰ª(clipping)å’Œé‡ç»˜(repainting)æœ‰ä»€ä¹ˆè”ç³»ï¼Ÿ</p><ul><li>å½“çª—å£è¢« AWT é‡ç»˜çº¿ç¨‹é‡ç»˜çš„æ—¶å€™ï¼Œå®ƒä¼šæŠŠè£å‰ªåŒºåŸŸè®¾ç½®æˆé‡ç»˜çš„çª—å£åŒºåŸŸ</li></ul></li><li><p>äº‹ä»¶ç›‘å¬å™¨æ¥å£(event-listener interface)å’Œäº‹ä»¶é€‚é…å™¨(event-adapter)çš„å…³ç³»</p><ul><li>äº‹ä»¶ç›‘å¬å™¨æ¥å£å®šä¹‰äº†å¯¹ç‰¹å®šçš„äº‹ä»¶ï¼Œäº‹ä»¶å¤„ç†å™¨å¿…é¡»è¦å®ç°çš„æ–¹æ³•</li><li>äº‹ä»¶é€‚é…å™¨ç»™äº‹ä»¶ç›‘å¬å™¨æ¥å£æä¾›äº†é»˜è®¤çš„å®ç°ï¼ˆé€‚é…å™¨æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œå°±æ˜¯æˆ‘å†™ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œå®ç°æ¥å£æ‰€æœ‰æ–¹æ³•ï¼Œä½†æ˜¯éƒ½æ²¡æœ‰è¯­å¥ï¼Œä½ è¦å®ç°å“ªä¸ªæ–¹æ³•ï¼Œå°±é‡å†™å“ªä¸ªæ–¹æ³•ï¼‰</li></ul></li><li><p>GUI ç»„ä»¶å¦‚ä½•æ¥å¤„ç†å®ƒè‡ªå·±çš„äº‹ä»¶ï¼Ÿ</p><ul><li>GUI ç»„ä»¶å¯ä»¥å¤„ç†å®ƒè‡ªå·±çš„äº‹ä»¶ï¼Œåªè¦å®ƒå®ç°ç›¸å¯¹åº”çš„äº‹ä»¶ç›‘å¬å™¨æ¥å£ï¼Œå¹¶ä¸”æŠŠè‡ªå·±ä½œä¸ºäº‹ä»¶ç›‘å¬å™¨</li></ul></li><li><p>Java çš„å¸ƒå±€ç®¡ç†å™¨æ¯”ä¼ ç»Ÿçš„çª—å£ç³»ç»Ÿæœ‰å“ªäº›ä¼˜åŠ¿ï¼Ÿ</p><ul><li>Java ä½¿ç”¨å¸ƒå±€ç®¡ç†å™¨ä»¥ä¸€ç§ä¸€è‡´çš„æ–¹å¼åœ¨æ‰€æœ‰çš„çª—å£å¹³å°ä¸Šæ‘†æ”¾ç»„ä»¶ã€‚</li><li>å› ä¸ºå¸ƒå±€ç®¡ç†å™¨ä¸ä¼šå’Œç»„ä»¶çš„ç»å¯¹å¤§å°å’Œä½ç½®ç›¸ç»‘å®šï¼Œæ‰€ä»¥ä»–ä»¬èƒ½å¤Ÿé€‚åº”è·¨çª—å£ç³»ç»Ÿçš„ç‰¹å®šå¹³å°çš„ä¸åŒ</li></ul></li><li><p>Java çš„ Swing ç»„ä»¶çš„ç§è®¾è®¡æ¨¡å¼</p><ul><li>Java ä¸­çš„ Swing ç»„ä»¶ä½¿ç”¨äº† MVC(è§†å›¾-æ¨¡å‹-æ§åˆ¶å™¨)è®¾è®¡æ¨¡å¼</li></ul></li><li><p>JDBC æ˜¯å…è®¸ç”¨æˆ·åœ¨ä¸åŒæ•°æ®åº“ä¹‹é—´åšé€‰æ‹©çš„ä¸€ä¸ªæŠ½è±¡å±‚ã€‚JDBC å…è®¸å¼€å‘è€…ç”¨ JAVA å†™æ•°æ®åº“åº”ç”¨ç¨‹åºï¼Œè€Œä¸éœ€è¦å…³å¿ƒåº•å±‚ç‰¹å®šæ•°æ®åº“çš„ç»†èŠ‚</p></li><li><p>é©±åŠ¨(Driver)åœ¨ JDBC ä¸­çš„è§’è‰²</p><ul><li>JDBC é©±åŠ¨æä¾›äº†ç‰¹å®šå‚å•†å¯¹ JDBC API æ¥å£ç±»çš„å®ç°</li><li>é©±åŠ¨å¿…é¡»è¦æä¾› java.sql åŒ…ä¸‹é¢è¿™äº›ç±»çš„å®ç°ï¼šConnection, Statement, PreparedStatement,CallableStatement, ResultSet å’Œ Driver</li></ul></li><li><p>Class.forName()æ–¹æ³•ä½œç”¨</p><ul><li>åˆå§‹åŒ–å‚æ•°æŒ‡å®šçš„ç±»ï¼Œå¹¶ä¸”è¿”å›æ­¤ç±»å¯¹åº”çš„ Class å¯¹è±¡</li><li>åœ¨åˆå§‹åŒ–ä¸€ä¸ªç±»ï¼Œç”Ÿæˆä¸€ä¸ªå®ä¾‹çš„æ—¶å€™ï¼ŒnewInstance()æ–¹æ³•ä½¿ç”¨ç±»åŠ è½½æœºåˆ¶ï¼Œnew å…³é”®å­—æ˜¯åˆ›å»ºä¸€ä¸ªæ–°ç±»ï¼›ä» JVM çš„è§’åº¦çœ‹ï¼Œæˆ‘ä»¬ä½¿ç”¨å…³é”®å­— new åˆ›å»ºä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œè¿™ä¸ªç±»å¯ä»¥æ²¡æœ‰è¢«åŠ è½½ã€‚ä½†æ˜¯ä½¿ç”¨ newInstance()æ–¹æ³•çš„æ—¶å€™å°±è¦æ±‚ï¼š 1ã€è¿™ä¸ªç±»å·²ç»åŠ è½½ï¼› 2ã€è¿™ä¸ªç±»å·²ç»è¿æ¥äº†ï¼›å®Œæˆä¸Šé¢ä¸¤ä¸ªæ­¥éª¤çš„æ­£æ˜¯ Class çš„é™æ€æ–¹æ³• forName()æ‰€å®Œæˆçš„ï¼Œè¿™ä¸ªé™æ€æ–¹æ³•è°ƒç”¨äº†å¯åŠ¨ç±»åŠ è½½å™¨ï¼Œå³åŠ è½½ java API çš„é‚£ä¸ªåŠ è½½å™¨</li></ul></li><li><p>PreparedStatement æ¯” Statement æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ</p><ul><li>PreparedStatements æ˜¯é¢„ç¼–è¯‘çš„ï¼ŒPreparedStatements å®ä¾‹åŒ…æ¶µå·²ç¼–è¯‘çš„ sql è¯­å¥ï¼Œæ‰€ä»¥å…¶æ‰§è¡Œé€Ÿåº¦è¦å¿«äº statement å¯¹è±¡ï¼Œæ€§èƒ½ä¼šæ›´å¥½</li><li>PreparedStatements ä½œä¸º statement çš„å­ç±»ï¼Œç»§æ‰¿äº† statement çš„æ‰€æœ‰æ–¹æ³•ï¼Œä¸‰ç§æ–¹æ³•ï¼Œexcute,excuteQuery å’Œ excuteUpdate å·²è¢«æ›´æ”¹ä»¥ä½¿ä¹‹ä¸å†éœ€è¦å‚æ•°</li><li>PreparedStatements çš„ä»£ç å¯è¯»æ€§ï¼Œå¯ç»´æŠ¤æ€§å¼ºäº statement.</li><li>æå¤§çš„æé«˜äº†å®‰å…¨æ€§</li></ul></li><li><p>ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ CallableStatementï¼Ÿç”¨æ¥å‡†å¤‡ CallableStatement çš„æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ</p><ul><li>CallableStatement ç”¨æ¥æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹ã€‚å­˜å‚¨è¿‡ç¨‹æ˜¯ç”±æ•°æ®åº“å­˜å‚¨å’Œæä¾›çš„ï¼Œå®ƒè¿˜æä¾›äº†å®‰å…¨æ€§å’Œæ¨¡å—åŒ–</li><li>å­˜å‚¨è¿‡ç¨‹å¯ä»¥æ¥å—è¾“å…¥å‚æ•°ï¼Œä¹Ÿå¯ä»¥æœ‰è¿”å›ç»“æœ</li><li>å‡†å¤‡ä¸€ä¸ª CallableStatement çš„æ–¹æ³•æ˜¯ï¼šCallableStament.prepareCall();</li></ul></li><li><p>RMI:Java è¿œç¨‹æ–¹æ³•è°ƒç”¨(Java RMI)æ˜¯ Java API å¯¹è¿œç¨‹è¿‡ç¨‹è°ƒç”¨(RPC)æä¾›çš„é¢å‘å¯¹è±¡çš„ç­‰ä»·å½¢å¼ï¼Œæ”¯æŒç›´æ¥ä¼ è¾“åºåˆ—åŒ–çš„ Java å¯¹è±¡å’Œåˆ†å¸ƒå¼åƒåœ¾å›æ”¶ã€‚è¿œç¨‹æ–¹æ³•è°ƒç”¨å¯ä»¥çœ‹åšæ˜¯æ¿€æ´»è¿œç¨‹æ­£åœ¨è¿è¡Œçš„å¯¹è±¡ä¸Šçš„æ–¹æ³•çš„æ­¥éª¤ã€‚RMI å¯¹è°ƒç”¨è€…æ˜¯ä½ç½®é€æ˜çš„ï¼Œå› ä¸ºè°ƒç”¨è€…æ„Ÿè§‰æ–¹æ³•æ˜¯æ‰§è¡Œåœ¨æœ¬åœ°è¿è¡Œçš„å¯¹è±¡ä¸Šçš„ã€‚çœ‹ä¸‹ RMI çš„ä¸€äº›æ³¨æ„äº‹é¡¹</p></li><li><p>RMI ä½“ç³»ç»“æ„çš„åŸºæœ¬åŸåˆ™</p><ul><li>RMI ä½“ç³»ç»“æ„æ˜¯åŸºäºä¸€ä¸ªéå¸¸é‡è¦çš„è¡Œä¸ºå®šä¹‰å’Œè¡Œä¸ºå®ç°ç›¸åˆ†ç¦»çš„åŸåˆ™ã€‚RMI å…è®¸å®šä¹‰è¡Œä¸ºçš„ä»£ç å’Œå®ç°è¡Œä¸ºçš„ä»£ç ç›¸åˆ†ç¦»ï¼Œå¹¶ä¸”è¿è¡Œåœ¨ä¸åŒçš„ JVM ä¸Š</li></ul></li><li><p>RMI ä½“ç³»ç»“æ„åˆ†å±‚</p><ul><li>å­˜æ ¹å’Œéª¨æ¶å±‚(Stub and Skeleton layer)ï¼šè¿™ä¸€å±‚å¯¹ç¨‹åºå‘˜æ˜¯é€æ˜çš„ï¼Œå®ƒä¸»è¦è´Ÿè´£æ‹¦æˆªå®¢æˆ·ç«¯å‘å‡ºçš„æ–¹æ³•è°ƒç”¨è¯·æ±‚ï¼Œç„¶åæŠŠè¯·æ±‚é‡å®šå‘ç»™è¿œç¨‹çš„ RMI æœåŠ¡</li><li>è¿œç¨‹å¼•ç”¨å±‚(Remote Reference Layer)ï¼šRMI ä½“ç³»ç»“æ„çš„ç¬¬äºŒå±‚ç”¨æ¥è§£æå®¢æˆ·ç«¯å¯¹æœåŠ¡ç«¯è¿œç¨‹å¯¹è±¡çš„å¼•ç”¨ã€‚è¿™ä¸€å±‚è§£æå¹¶ç®¡ç†å®¢æˆ·ç«¯å¯¹æœåŠ¡ç«¯è¿œç¨‹å¯¹è±¡çš„å¼•ç”¨ã€‚è¿æ¥æ˜¯ç‚¹åˆ°ç‚¹çš„</li><li>ä¼ è¾“å±‚(Transport layer)ï¼šè¿™ä¸€å±‚è´Ÿè´£è¿æ¥å‚ä¸æœåŠ¡çš„ä¸¤ä¸ª JVMã€‚è¿™ä¸€å±‚æ˜¯å»ºç«‹åœ¨ç½‘ç»œä¸Šæœºå™¨é—´çš„ TCP/IP è¿æ¥ä¹‹ä¸Šçš„ã€‚å®ƒæä¾›äº†åŸºæœ¬çš„è¿æ¥æœåŠ¡ï¼Œè¿˜æœ‰ä¸€äº›é˜²ç«å¢™ç©¿é€ç­–ç•¥</li></ul></li><li><p>RMI ä¸­çš„è¿œç¨‹æ¥å£(Remote Interface)æ‰®æ¼”äº†ä»€ä¹ˆæ ·çš„è§’è‰²ï¼Ÿ</p><ul><li>è¿œç¨‹æ¥å£ç”¨æ¥æ ‡è¯†å“ªäº›æ–¹æ³•æ˜¯å¯ä»¥è¢«éæœ¬åœ°è™šæ‹Ÿæœºè°ƒç”¨çš„æ¥å£ã€‚è¿œç¨‹å¯¹è±¡å¿…é¡»è¦ç›´æ¥æˆ–è€…æ˜¯é—´æ¥å®ç°è¿œç¨‹æ¥å£ã€‚å®ç°äº†è¿œç¨‹æ¥å£çš„ç±»åº”è¯¥å£°æ˜è¢«å®ç°çš„è¿œç¨‹æ¥å£ï¼Œç»™æ¯ä¸€ä¸ªè¿œç¨‹å¯¹è±¡å®šä¹‰æ„é€ å‡½æ•°ï¼Œç»™æ‰€æœ‰è¿œç¨‹æ¥å£çš„æ–¹æ³•æä¾›å®ç°</li></ul></li><li><p>RMI ä¸­çš„è¿œç¨‹æ¥å£(Remote Interface)æ‰®æ¼”äº†ä»€ä¹ˆæ ·çš„è§’è‰²ï¼Ÿ</p><ul><li>è¿œç¨‹æ¥å£ç”¨æ¥æ ‡è¯†å“ªäº›æ–¹æ³•æ˜¯å¯ä»¥è¢«éæœ¬åœ°è™šæ‹Ÿæœºè°ƒç”¨çš„æ¥å£ã€‚è¿œç¨‹å¯¹è±¡å¿…é¡»è¦ç›´æ¥æˆ–è€…æ˜¯é—´æ¥å®ç°è¿œç¨‹æ¥å£ã€‚å®ç°äº†è¿œç¨‹æ¥å£çš„ç±»åº”è¯¥å£°æ˜è¢«å®ç°çš„è¿œç¨‹æ¥å£ï¼Œç»™æ¯ä¸€ä¸ªè¿œç¨‹å¯¹è±¡å®šä¹‰æ„é€ å‡½æ•°ï¼Œç»™æ‰€æœ‰è¿œç¨‹æ¥å£çš„æ–¹æ³•æä¾›å®ç°ã€‚</li></ul></li><li><p>java.rmi.Naming ç±»æ‰®æ¼”äº†ä»€ä¹ˆæ ·çš„è§’è‰²ï¼Ÿ</p><ul><li>java.rmi.Naming ç±»ç”¨æ¥å­˜å‚¨å’Œè·å–åœ¨è¿œç¨‹å¯¹è±¡æ³¨å†Œè¡¨é‡Œé¢çš„è¿œç¨‹å¯¹è±¡çš„å¼•ç”¨ã€‚Naming ç±»çš„æ¯ä¸€ä¸ªæ–¹æ³•æ¥æ”¶ä¸€ä¸ª URL æ ¼å¼çš„ String å¯¹è±¡ä½œä¸ºå®ƒçš„å‚æ•°</li></ul></li><li><p>RMI çš„ç»‘å®š(Binding)</p><ul><li>ç»‘å®šæ˜¯ä¸ºäº†æŸ¥è¯¢æ‰¾è¿œç¨‹å¯¹è±¡è€Œç»™è¿œç¨‹å¯¹è±¡å…³è”æˆ–è€…æ˜¯æ³¨å†Œä»¥åä¼šç”¨åˆ°çš„åç§°çš„è¿‡ç¨‹ã€‚è¿œç¨‹å¯¹è±¡å¯ä»¥ä½¿ç”¨ Naming ç±»çš„ bind()æˆ–è€… rebind()æ–¹æ³•è·Ÿåç§°ç›¸å…³è”</li></ul></li><li><p>Naming ç±»çš„ bind()å’Œ rebind()æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><ul><li>bind()æ–¹æ³•è´Ÿè´£æŠŠæŒ‡å®šåç§°ç»‘å®šç»™è¿œç¨‹å¯¹è±¡ï¼Œrebind()æ–¹æ³•è´Ÿè´£æŠŠæŒ‡å®šåç§°é‡æ–°ç»‘å®šåˆ°ä¸€ä¸ªæ–°çš„è¿œç¨‹å¯¹è±¡ã€‚å¦‚æœé‚£ä¸ªåç§°å·²ç»ç»‘å®šè¿‡äº†ï¼Œå…ˆå‰çš„ç»‘å®šä¼šè¢«æ›¿æ¢æ‰</li></ul></li><li><p>è®© RMI ç¨‹åºèƒ½æ­£ç¡®è¿è¡Œæœ‰å“ªäº›æ­¥éª¤ï¼Ÿ</p><ul><li>ç¼–è¯‘æ‰€æœ‰çš„æºæ–‡ä»¶</li><li>ä½¿ç”¨ rmic ç”Ÿæˆ stub</li><li>å¯åŠ¨ rmiregistry</li><li>å¯åŠ¨ RMI æœåŠ¡å™¨</li><li>è¿è¡Œå®¢æˆ·ç«¯ç¨‹åº</li></ul></li><li><p>RMI çš„ stub æ‰®æ¼”äº†ä»€ä¹ˆæ ·çš„è§’è‰²ï¼Ÿ</p><ul><li>è¿œç¨‹å¯¹è±¡çš„ stub æ‰®æ¼”äº†è¿œç¨‹å¯¹è±¡çš„ä»£è¡¨æˆ–è€…ä»£ç†çš„è§’è‰²ã€‚è°ƒç”¨è€…åœ¨æœ¬åœ° stub ä¸Šè°ƒç”¨æ–¹æ³•ï¼Œå®ƒè´Ÿè´£åœ¨è¿œç¨‹å¯¹è±¡ä¸Šæ‰§è¡Œæ–¹æ³•ã€‚å½“ stub çš„æ–¹æ³•è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œä¼šç»å†ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</li><li>åˆå§‹åŒ–åˆ°åŒ…å«äº†è¿œç¨‹å¯¹è±¡çš„ JVM çš„è¿æ¥</li><li>åºåˆ—åŒ–å‚æ•°åˆ°è¿œç¨‹çš„ JVM</li><li>ç­‰å¾…æ–¹æ³•è°ƒç”¨å’Œæ‰§è¡Œçš„ç»“æœ</li><li>ååºåˆ—åŒ–è¿”å›çš„å€¼æˆ–è€…æ˜¯æ–¹æ³•æ²¡æœ‰æ‰§è¡ŒæˆåŠŸæƒ…å†µä¸‹çš„å¼‚å¸¸</li><li>æŠŠå€¼è¿”å›ç»™è°ƒç”¨è€…</li></ul></li><li><p>ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼åƒåœ¾å›æ”¶(DGC)ï¼Ÿå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</p><ul><li>DGC å«åšåˆ†å¸ƒå¼åƒåœ¾å›æ”¶ã€‚RMI ä½¿ç”¨ DGC æ¥åšè‡ªåŠ¨åƒåœ¾å›æ”¶ã€‚å› ä¸º RMI åŒ…å«äº†è·¨è™šæ‹Ÿæœºçš„è¿œç¨‹å¯¹è±¡çš„å¼•ç”¨ï¼Œåƒåœ¾å›æ”¶æ˜¯å¾ˆå›°éš¾çš„ã€‚DGC ä½¿ç”¨å¼•ç”¨è®¡æ•°ç®—æ³•æ¥ç»™è¿œç¨‹å¯¹è±¡æä¾›è‡ªåŠ¨å†…å­˜ç®¡ç†</li></ul></li><li><p>RMI ä¸­ä½¿ç”¨ RMI å®‰å…¨ç®¡ç†å™¨(RMISecurityManager)çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ</p><ul><li>RMISecurityManager ä½¿ç”¨ä¸‹è½½å¥½çš„ä»£ç æä¾›å¯è¢« RMI åº”ç”¨ç¨‹åºä½¿ç”¨çš„å®‰å…¨ç®¡ç†å™¨ã€‚å¦‚æœæ²¡æœ‰è®¾ç½®å®‰å…¨ç®¡ç†å™¨ï¼ŒRMI çš„ç±»åŠ è½½å™¨å°±ä¸ä¼šä»è¿œç¨‹ä¸‹è½½ä»»ä½•çš„ç±»ã€‚</li></ul></li><li><p>è§£é‡Šä¸‹ Marshalling å’Œ demarshalling</p><ul><li>å½“åº”ç”¨ç¨‹åºå¸Œæœ›æŠŠå†…å­˜å¯¹è±¡è·¨ç½‘ç»œä¼ é€’åˆ°å¦ä¸€å°ä¸»æœºæˆ–è€…æ˜¯æŒä¹…åŒ–åˆ°å­˜å‚¨çš„æ—¶å€™ï¼Œå°±å¿…é¡»è¦æŠŠå¯¹è±¡åœ¨å†…å­˜é‡Œé¢çš„è¡¨ç¤ºè½¬åŒ–æˆåˆé€‚çš„æ ¼å¼ã€‚è¿™ä¸ªè¿‡ç¨‹å°±å«åš Marshallingï¼Œåä¹‹å°±æ˜¯ demarshalling</li></ul></li><li><p>è§£é‡Šä¸‹ Serialization å’Œ Deserialization</p><ul><li><p>Java æä¾›äº†ä¸€ç§å«åšå¯¹è±¡åºåˆ—åŒ–çš„æœºåˆ¶ï¼Œä»–æŠŠå¯¹è±¡è¡¨ç¤ºæˆä¸€è¿ä¸²çš„å­—èŠ‚ï¼Œé‡Œé¢åŒ…å«äº†å¯¹è±¡çš„æ•°æ®ï¼Œå¯¹è±¡çš„ç±»å‹ä¿¡æ¯ï¼Œå¯¹è±¡å†…éƒ¨çš„æ•°æ®çš„ç±»å‹ä¿¡æ¯ç­‰ç­‰</p></li><li><p>åºåˆ—åŒ–å¯ä»¥çœ‹æˆæ˜¯ä¸ºäº†æŠŠå¯¹è±¡å­˜å‚¨åœ¨ç£ç›˜ä¸Šæˆ–è€…æ˜¯ä»ç£ç›˜ä¸Šè¯»å‡ºæ¥å¹¶é‡å»ºå¯¹è±¡è€ŒæŠŠå¯¹è±¡æ‰å¹³åŒ–çš„ä¸€ç§æ–¹å¼ã€‚ååºåˆ—åŒ–æ˜¯æŠŠå¯¹è±¡ä»æ‰å¹³çŠ¶æ€è½¬åŒ–æˆæ´»åŠ¨å¯¹è±¡çš„ç›¸åçš„æ­¥éª¤</p></li><li><p>Servlet æ˜¯ç”¨æ¥å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚å¹¶äº§ç”ŸåŠ¨æ€ç½‘é¡µå†…å®¹çš„ Java ç±»ã€‚</p></li><li><p>Servlet ä¸»è¦æ˜¯ç”¨æ¥å¤„ç†æˆ–è€…æ˜¯å­˜å‚¨ HTML è¡¨å•æäº¤çš„æ•°æ®ï¼Œäº§ç”ŸåŠ¨æ€å†…å®¹ï¼Œåœ¨æ— çŠ¶æ€çš„ HTTP åè®®ä¸‹ç®¡ç†çŠ¶æ€ä¿¡æ¯</p></li></ul></li><li><p>Servlet çš„ä½“ç³»ç»“æ„</p><ul><li>æ‰€æœ‰çš„ Servlet éƒ½å¿…é¡»è¦å®ç°çš„æ ¸å¿ƒçš„æ¥å£æ˜¯ javax.servlet.Servlet</li><li>æ¯ä¸€ä¸ª Servlet éƒ½å¿…é¡»è¦ç›´æ¥æˆ–è€…æ˜¯é—´æ¥å®ç°è¿™ä¸ªæ¥å£ï¼Œæˆ–è€…æ˜¯ç»§æ‰¿ javax.servlet.GenericServlet æˆ–è€… javax.servlet.http.HTTPServlet</li><li>æœ€åï¼ŒServlet ä½¿ç”¨å¤šçº¿ç¨‹å¯ä»¥å¹¶è¡Œçš„ä¸ºå¤šä¸ªè¯·æ±‚æœåŠ¡</li></ul></li><li><p>Applet å’Œ Servlet æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><ul><li>Applet æ˜¯è¿è¡Œåœ¨å®¢æˆ·ç«¯ä¸»æœºçš„æµè§ˆå™¨ä¸Šçš„å®¢æˆ·ç«¯ Java ç¨‹åºã€‚è€Œ Servlet æ˜¯è¿è¡Œåœ¨ web æœåŠ¡å™¨ä¸Šçš„æœåŠ¡ç«¯çš„ç»„ä»¶</li><li>applet å¯ä»¥ä½¿ç”¨ç”¨æˆ·ç•Œé¢ç±»ï¼Œè€Œ Servlet æ²¡æœ‰ç”¨æˆ·ç•Œé¢ï¼Œç›¸åï¼ŒServlet æ˜¯ç­‰å¾…å®¢æˆ·ç«¯çš„ HTTP è¯·æ±‚ï¼Œç„¶åä¸ºè¯·æ±‚äº§ç”Ÿå“åº”</li></ul></li><li><p>GenericServlet å’Œ HttpServlet åŒºåˆ«</p><ul><li>GenericServlet æ˜¯ä¸€ä¸ªé€šç”¨çš„åè®®æ— å…³çš„ Servletï¼Œå®ƒå®ç°äº† Servlet å’Œ ServletConfig æ¥å£ã€‚ç»§æ‰¿è‡ª GenericServlet çš„ Servlet åº”è¯¥è¦è¦†ç›– service()æ–¹æ³•</li><li>è‹¥è¦å¼€å‘ä¸€ä¸ªèƒ½ç”¨åœ¨ç½‘é¡µä¸ŠæœåŠ¡äºä½¿ç”¨ HTTP åè®®è¯·æ±‚çš„ Servletï¼Œä½ çš„ Servlet å¿…é¡»è¦ç»§æ‰¿è‡ª HttpServlet</li></ul></li><li><p>Servlet çš„ç”Ÿå‘½å‘¨æœŸ</p><ul><li>1ï¼‰å¯¹æ¯ä¸€ä¸ªå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼ŒServlet å¼•æ“è½½å…¥ Servletï¼Œè°ƒç”¨å®ƒçš„ init()æ–¹æ³•ï¼Œå®Œæˆ Servlet çš„åˆå§‹åŒ–</li><li>2ï¼‰Servlet å¯¹è±¡é€šè¿‡ä¸ºæ¯ä¸€ä¸ªè¯·æ±‚å•ç‹¬è°ƒç”¨ service()æ–¹æ³•æ¥å¤„ç†æ‰€æœ‰éšåæ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚</li><li>3ï¼‰æœ€åï¼Œè°ƒç”¨ Servlet çš„ destroy()æ–¹æ³•æŠŠ Servlet åˆ é™¤æ‰</li></ul></li><li><p>doGet()æ–¹æ³•å’Œ doPost()æ–¹æ³•åŒºåˆ«</p><ul><li>doGetï¼šGET æ–¹æ³•ä¼šæŠŠåå€¼å¯¹è¿½åŠ åœ¨è¯·æ±‚çš„ URL åé¢ã€‚å› ä¸º URL å¯¹å­—ç¬¦æ•°ç›®æœ‰é™åˆ¶ï¼Œè¿›è€Œé™åˆ¶äº†ç”¨åœ¨å®¢æˆ·ç«¯è¯·æ±‚çš„å‚æ•°å€¼çš„æ•°ç›®ã€‚å¹¶ä¸”è¯·æ±‚ä¸­çš„å‚æ•°å€¼æ˜¯å¯è§çš„ï¼Œå› æ­¤ï¼Œæ•æ„Ÿä¿¡æ¯ä¸èƒ½ç”¨è¿™ç§æ–¹å¼ä¼ é€’</li><li>doPOSTï¼šPOST æ–¹æ³•é€šè¿‡æŠŠè¯·æ±‚å‚æ•°å€¼æ”¾åœ¨è¯·æ±‚ä½“ä¸­æ¥å…‹æœ GET æ–¹æ³•çš„é™åˆ¶ï¼Œå› æ­¤ï¼Œå¯ä»¥å‘é€çš„å‚æ•°çš„æ•°ç›®æ˜¯æ²¡æœ‰é™åˆ¶çš„ã€‚æœ€åï¼Œé€šè¿‡ POST è¯·æ±‚ä¼ é€’çš„æ•æ„Ÿä¿¡æ¯å¯¹å¤–éƒ¨å®¢æˆ·ç«¯æ˜¯ä¸å¯è§çš„</li></ul></li><li><p>Web åº”ç”¨ç¨‹åº</p><ul><li>Web åº”ç”¨ç¨‹åºæ˜¯å¯¹ Web æˆ–è€…æ˜¯åº”ç”¨æœåŠ¡å™¨çš„åŠ¨æ€æ‰©å±•</li><li>æœ‰ä¸¤ç§ç±»å‹çš„ Web åº”ç”¨ï¼šé¢å‘è¡¨ç°çš„å’Œé¢å‘æœåŠ¡çš„ã€‚é¢å‘è¡¨ç°çš„ Web åº”ç”¨ç¨‹åºä¼šäº§ç”ŸåŒ…å«äº†å¾ˆå¤šç§æ ‡è®°è¯­è¨€å’ŒåŠ¨æ€å†…å®¹çš„äº¤äº’çš„ web é¡µé¢ä½œä¸ºå¯¹è¯·æ±‚çš„å“åº”ã€‚è€Œé¢å‘æœåŠ¡çš„ Web åº”ç”¨å®ç°äº† Web æœåŠ¡çš„ç«¯ç‚¹(endpoint)</li></ul></li><li><p>ä»€ä¹ˆæ˜¯æœåŠ¡ç«¯åŒ…å«(Server Side Include)ï¼Ÿ</p><ul><li>æœåŠ¡ç«¯åŒ…å«(SSI)æ˜¯ä¸€ç§ç®€å•çš„è§£é‡Šå‹æœåŠ¡ç«¯è„šæœ¬è¯­è¨€ï¼Œå¤§å¤šæ•°æ—¶å€™ä»…ç”¨åœ¨ Web ä¸Šï¼Œç”¨ servlet æ ‡ç­¾åµŒå…¥è¿›æ¥</li><li>SSI æœ€å¸¸ç”¨çš„åœºæ™¯æŠŠä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶åŒ…å«åˆ° Web æœåŠ¡å™¨çš„ä¸€ä¸ª Web é¡µé¢ä¸­ã€‚å½“æµè§ˆå™¨è®¿é—® Web é¡µé¢çš„æ—¶å€™ï¼ŒWeb æœåŠ¡å™¨ä¼šç”¨å¯¹åº”çš„ servlet äº§ç”Ÿçš„æ–‡æœ¬æ¥æ›¿æ¢ Web é¡µé¢ä¸­çš„ servlet æ ‡ç­¾</li></ul></li><li><p>Servlet é“¾(Servlet Chaining)</p><ul><li>Servlet é“¾æ˜¯æŠŠä¸€ä¸ª Servlet çš„è¾“å‡ºå‘é€ç»™å¦ä¸€ä¸ª Servlet çš„æ–¹æ³•ã€‚ç¬¬äºŒä¸ª Servlet çš„è¾“å‡ºå¯ä»¥å‘é€ç»™ç¬¬ä¸‰ä¸ª Servletï¼Œä¾æ¬¡ç±»æ¨ã€‚é“¾æ¡ä¸Šæœ€åä¸€ä¸ª Servlet è´Ÿè´£æŠŠå“åº”å‘é€ç»™å®¢æˆ·ç«¯</li></ul></li><li><p>å¦‚ä½•çŸ¥é“æ˜¯å“ªä¸€ä¸ªå®¢æˆ·ç«¯çš„æœºå™¨æ­£åœ¨è¯·æ±‚ä½ çš„ Servletï¼Ÿ</p><ul><li>ServletRequest ç±»å¯ä»¥æ‰¾å‡ºå®¢æˆ·ç«¯æœºå™¨çš„ IP åœ°å€æˆ–è€…æ˜¯ä¸»æœºå</li><li>etRemoteAddr()æ–¹æ³•è·å–å®¢æˆ·ç«¯ä¸»æœºçš„ IP åœ°å€ï¼ŒgetRemoteHost()å¯ä»¥è·å–ä¸»æœºå</li></ul></li><li><p>HTTP å“åº”çš„ç»“æ„æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ</p><ul><li>çŠ¶æ€ç (Status Code)ï¼šæè¿°äº†å“åº”çš„çŠ¶æ€ã€‚å¯ä»¥ç”¨æ¥æ£€æŸ¥æ˜¯å¦æˆåŠŸçš„å®Œæˆäº†è¯·æ±‚ã€‚è¯·æ±‚å¤±è´¥çš„æƒ…å†µä¸‹ï¼ŒçŠ¶æ€ç å¯ç”¨æ¥æ‰¾å‡ºå¤±è´¥çš„åŸå› ã€‚å¦‚æœ Servlet æ²¡æœ‰è¿”å›çŠ¶æ€ç ï¼Œé»˜è®¤ä¼šè¿”å›æˆåŠŸçš„çŠ¶æ€ç  HttpServletResponse.SC_OK</li><li>HTTP å¤´éƒ¨(HTTP Header)ï¼šå®ƒä»¬åŒ…å«äº†æ›´å¤šå…³äºå“åº”çš„ä¿¡æ¯ã€‚æ¯”å¦‚ï¼šå¤´éƒ¨å¯ä»¥æŒ‡å®šè®¤ä¸ºå“åº”è¿‡æœŸçš„è¿‡æœŸæ—¥æœŸï¼Œæˆ–è€…æ˜¯æŒ‡å®šç”¨æ¥ç»™ç”¨æˆ·å®‰å…¨çš„ä¼ è¾“å®ä½“å†…å®¹çš„ç¼–ç æ ¼å¼</li><li>ä¸»ä½“(Body)ï¼šå®ƒåŒ…å«äº†å“åº”çš„å†…å®¹ã€‚å®ƒå¯ä»¥åŒ…å« HTML ä»£ç ï¼Œå›¾ç‰‡ï¼Œç­‰ç­‰ã€‚ä¸»ä½“æ˜¯ç”±ä¼ è¾“åœ¨ HTTP æ¶ˆæ¯ä¸­ç´§è·Ÿåœ¨å¤´éƒ¨åé¢çš„æ•°æ®å­—èŠ‚ç»„æˆçš„</li></ul></li><li><p>ä»€ä¹ˆæ˜¯ cookieï¼Ÿsession å’Œ cookie æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><ul><li>cookie æ˜¯ Web æœåŠ¡å™¨å‘é€ç»™æµè§ˆå™¨çš„ä¸€å—ä¿¡æ¯ã€‚æµè§ˆå™¨ä¼šåœ¨æœ¬åœ°æ–‡ä»¶ä¸­ç»™æ¯ä¸€ä¸ª Web æœåŠ¡å™¨å­˜å‚¨ cookieã€‚ä»¥åæµè§ˆå™¨åœ¨ç»™ç‰¹å®šçš„ Web æœåŠ¡å™¨å‘è¯·æ±‚çš„æ—¶å€™ï¼ŒåŒæ—¶ä¼šå‘é€æ‰€æœ‰ä¸ºè¯¥æœåŠ¡å™¨å­˜å‚¨çš„ cookie</li><li>æ— è®ºå®¢æˆ·ç«¯æµè§ˆå™¨åšæ€ä¹ˆæ ·çš„è®¾ç½®ï¼Œsession éƒ½åº”è¯¥èƒ½æ­£å¸¸å·¥ä½œã€‚å®¢æˆ·ç«¯å¯ä»¥é€‰æ‹©ç¦ç”¨ cookieï¼Œä½†æ˜¯ï¼Œsession ä»ç„¶æ˜¯èƒ½å¤Ÿå·¥ä½œçš„ï¼Œå› ä¸ºå®¢æˆ·ç«¯æ— æ³•ç¦ç”¨æœåŠ¡ç«¯çš„ session</li><li>åœ¨å­˜å‚¨çš„æ•°æ®é‡æ–¹é¢ session å’Œ cookies ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚session èƒ½å¤Ÿå­˜å‚¨ä»»æ„çš„ Java å¯¹è±¡ï¼Œcookie åªèƒ½å­˜å‚¨ String ç±»å‹çš„å¯¹è±¡</li></ul></li><li><p>æµè§ˆå™¨å’Œ Servlet é€šä¿¡ä½¿ç”¨çš„æ˜¯ HTTP åè®®</p></li><li><p>HTTP éš§é“:HTTP éš§é“æ˜¯ä¸€ç§åˆ©ç”¨ HTTP æˆ–è€…æ˜¯ HTTPS æŠŠå¤šç§ç½‘ç»œåè®®å°è£…èµ·æ¥è¿›è¡Œé€šä¿¡çš„æŠ€æœ¯ã€‚å› æ­¤ï¼ŒHTTP åè®®æ‰®æ¼”äº†ä¸€ä¸ªæ‰“é€šç”¨äºé€šä¿¡çš„ç½‘ç»œåè®®çš„ç®¡é“çš„åŒ…è£…å™¨çš„è§’è‰²ã€‚æŠŠå…¶ä»–åè®®çš„è¯·æ±‚æ©ç›–æˆ HTTP çš„è¯·æ±‚å°±æ˜¯ HTTP éš§é“</p></li><li><p>sendRedirect()å’Œ forward()æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><ul><li>sendRedirect()æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„è¯·æ±‚ï¼Œè€Œ forward()æ–¹æ³•åªæ˜¯æŠŠè¯·æ±‚è½¬å‘åˆ°ä¸€ä¸ªæ–°çš„ç›®æ ‡ä¸Š</li><li>é‡å®šå‘(redirect)ä»¥åï¼Œä¹‹å‰è¯·æ±‚ä½œç”¨åŸŸèŒƒå›´ä»¥å†…çš„å¯¹è±¡å°±å¤±æ•ˆäº†ï¼Œå› ä¸ºä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„è¯·æ±‚ï¼Œè€Œè½¬å‘(forwarding)ä»¥åï¼Œä¹‹å‰è¯·æ±‚ä½œç”¨åŸŸèŒƒå›´ä»¥å†…çš„å¯¹è±¡è¿˜æ˜¯èƒ½è®¿é—®çš„</li><li>ä¸€èˆ¬è®¤ä¸º sendRedirect()æ¯” forward()è¦æ…¢</li></ul></li><li><p>ä»€ä¹ˆæ˜¯ URL ç¼–ç å’Œ URL è§£ç ï¼Ÿ</p><ul><li>URL ç¼–ç æ˜¯è´Ÿè´£æŠŠ URL é‡Œé¢çš„ç©ºæ ¼å’Œå…¶ä»–çš„ç‰¹æ®Šå­—ç¬¦æ›¿æ¢æˆå¯¹åº”çš„åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œåä¹‹å°±æ˜¯è§£ç </li></ul></li><li><p>ä»€ä¹ˆæ˜¯ JSP é¡µé¢ï¼Ÿ</p><ul><li>JSP é¡µé¢æ˜¯ä¸€ç§åŒ…å«äº†é™æ€æ•°æ®å’Œ JSP å…ƒç´ ä¸¤ç§ç±»å‹çš„æ–‡æœ¬çš„æ–‡æœ¬æ–‡æ¡£</li><li>é™æ€æ•°æ®å¯ä»¥ç”¨ä»»ä½•åŸºäºæ–‡æœ¬çš„æ ¼å¼æ¥è¡¨ç¤ºï¼Œæ¯”å¦‚ï¼šHTML æˆ–è€… XML</li><li>JSP æ˜¯ä¸€ç§æ··åˆäº†é™æ€å†…å®¹å’ŒåŠ¨æ€äº§ç”Ÿçš„å†…å®¹çš„æŠ€æœ¯</li></ul></li><li><p>JSP è¯·æ±‚æ˜¯å¦‚ä½•è¢«å¤„ç†çš„ï¼Ÿ</p><ul><li>æµè§ˆå™¨é¦–å…ˆè¦è¯·æ±‚ä¸€ä¸ªä»¥.jsp æ‰©å±•åç»“å°¾çš„é¡µé¢ï¼Œå‘èµ· JSP è¯·æ±‚ï¼Œç„¶åï¼ŒWeb æœåŠ¡å™¨è¯»å–è¿™ä¸ªè¯·æ±‚ï¼Œä½¿ç”¨ JSP ç¼–è¯‘å™¨æŠŠ JSP é¡µé¢è½¬åŒ–æˆä¸€ä¸ª Servlet ç±»ã€‚</li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåªæœ‰å½“ç¬¬ä¸€æ¬¡è¯·æ±‚é¡µé¢æˆ–è€…æ˜¯ JSP æ–‡ä»¶å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ JSP æ–‡ä»¶æ‰ä¼šè¢«ç¼–è¯‘ï¼Œç„¶åæœåŠ¡å™¨è°ƒç”¨ servlet ç±»ï¼Œå¤„ç†æµè§ˆå™¨çš„è¯·æ±‚ã€‚ä¸€æ—¦è¯·æ±‚æ‰§è¡Œç»“æŸï¼Œservlet ä¼šæŠŠå“åº”å‘é€ç»™å®¢æˆ·ç«¯</li></ul></li><li><p>JSP ä¼˜ç‚¹</p><ul><li>JSP é¡µé¢æ˜¯è¢«åŠ¨æ€ç¼–è¯‘æˆ Servlet çš„ï¼Œå› æ­¤ï¼Œå¼€å‘è€…å¯ä»¥å¾ˆå®¹æ˜“çš„æ›´æ–°å±•ç°ä»£ç </li><li>JSP é¡µé¢å¯ä»¥è¢«é¢„ç¼–è¯‘</li><li>JSP é¡µé¢å¯ä»¥å¾ˆå®¹æ˜“çš„å’Œé™æ€æ¨¡æ¿ç»“åˆï¼ŒåŒ…æ‹¬ï¼šHTML æˆ–è€… XMLï¼Œä¹Ÿå¯ä»¥å¾ˆå®¹æ˜“çš„å’Œäº§ç”ŸåŠ¨æ€å†…å®¹çš„ä»£ç ç»“åˆèµ·æ¥</li><li>å¼€å‘è€…å¯ä»¥æä¾›è®©é¡µé¢è®¾è®¡è€…ä»¥ç±» XML æ ¼å¼æ¥è®¿é—®çš„è‡ªå®šä¹‰çš„ JSP æ ‡ç­¾åº“</li><li>å¼€å‘è€…å¯ä»¥åœ¨ç»„ä»¶å±‚åšé€»è¾‘ä¸Šçš„æ”¹å˜ï¼Œè€Œä¸éœ€è¦ç¼–è¾‘å•ç‹¬ä½¿ç”¨äº†åº”ç”¨å±‚é€»è¾‘çš„é¡µé¢ã€‚</li></ul></li><li><p>ä»€ä¹ˆæ˜¯ JSP æŒ‡ä»¤(Directive)ï¼ŸJSP ä¸­æœ‰å“ªäº›ä¸åŒç±»å‹çš„æŒ‡ä»¤ï¼Ÿ</p><ul><li>Directive æ˜¯å½“ JSP é¡µé¢è¢«ç¼–è¯‘æˆ Servlet çš„æ—¶å€™ï¼ŒJSP å¼•æ“è¦å¤„ç†çš„æŒ‡ä»¤ã€‚Directive ç”¨æ¥è®¾ç½®é¡µé¢çº§åˆ«çš„æŒ‡ä»¤ï¼Œä»å¤–éƒ¨æ–‡ä»¶æ’å…¥æ•°æ®ï¼ŒæŒ‡å®šè‡ªå®šä¹‰çš„æ ‡ç­¾åº“ã€‚Directive æ˜¯å®šä¹‰åœ¨ &lt;%@ å’Œ %&gt;ä¹‹é—´çš„ã€‚ä¸‹é¢åˆ—å‡ºäº†ä¸åŒç±»å‹çš„ Directiveï¼š</li><li>åŒ…å«æŒ‡ä»¤(Include directive)ï¼šç”¨æ¥åŒ…å«æ–‡ä»¶å’Œåˆå¹¶æ–‡ä»¶å†…å®¹åˆ°å½“å‰çš„é¡µé¢ã€‚</li><li>é¡µé¢æŒ‡ä»¤(Page directive)ï¼šç”¨æ¥å®šä¹‰ JSP é¡µé¢ä¸­ç‰¹å®šçš„å±æ€§ï¼Œæ¯”å¦‚é”™è¯¯é¡µé¢å’Œç¼“å†²åŒºã€‚</li><li>Taglib æŒ‡ä»¤ï¼š ç”¨æ¥å£°æ˜é¡µé¢ä¸­ä½¿ç”¨çš„è‡ªå®šä¹‰çš„æ ‡ç­¾åº“ã€‚</li></ul></li><li><p>JSP åŠ¨ä½œ(JSP action)</p><ul><li>JSP åŠ¨ä½œä»¥ XML è¯­æ³•çš„ç»“æ„æ¥æ§åˆ¶ Servlet å¼•æ“çš„è¡Œä¸ºã€‚å½“ JSP é¡µé¢è¢«è¯·æ±‚çš„æ—¶å€™ï¼ŒJSP åŠ¨ä½œä¼šè¢«æ‰§è¡Œã€‚å®ƒä»¬å¯ä»¥è¢«åŠ¨æ€çš„æ’å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œé‡ç”¨ JavaBean ç»„ä»¶ï¼Œè½¬å‘ç”¨æˆ·åˆ°å…¶ä»–çš„é¡µé¢ï¼Œæˆ–è€…æ˜¯ç»™ Java æ’ä»¶äº§ç”Ÿ HTML ä»£ç ã€‚ä¸‹é¢åˆ—å‡ºäº†å¯ç”¨çš„åŠ¨ä½œï¼š</li><li>jsp:include-å½“ JSP é¡µé¢è¢«è¯·æ±‚çš„æ—¶å€™åŒ…å«ä¸€ä¸ªæ–‡ä»¶</li><li>jsp:useBean-æ‰¾å‡ºæˆ–è€…æ˜¯åˆå§‹åŒ– Javabean</li><li>jsp:setProperty-è®¾ç½® JavaBean çš„å±æ€§</li><li>jsp:getProperty-è·å– JavaBean çš„å±æ€§</li><li>jsp:forward-æŠŠè¯·æ±‚è½¬å‘åˆ°æ–°çš„é¡µé¢</li><li>jsp:plugin-äº§ç”Ÿç‰¹å®šæµè§ˆå™¨çš„ä»£ç ã€‚</li></ul></li><li><p>ä»€ä¹ˆæ˜¯ Scriptletsï¼Ÿ</p><ul><li>JSP æŠ€æœ¯ä¸­ï¼Œscriptlet æ˜¯åµŒå…¥åœ¨ JSP é¡µé¢ä¸­çš„ä¸€æ®µ Java ä»£ç ã€‚scriptlet æ˜¯ä½äºæ ‡ç­¾å†…éƒ¨çš„æ‰€æœ‰çš„ä¸œè¥¿ï¼Œåœ¨æ ‡ç­¾ä¸æ ‡ç­¾ä¹‹é—´ï¼Œç”¨æˆ·å¯ä»¥æ·»åŠ ä»»æ„æœ‰æ•ˆçš„ scriplet</li></ul></li><li><p>å£°æ˜(Decalaration)åœ¨å“ªé‡Œï¼Ÿ</p><ul><li>å£°æ˜è·Ÿ Java ä¸­çš„å˜é‡å£°æ˜å¾ˆç›¸ä¼¼ï¼Œå®ƒç”¨æ¥å£°æ˜éšåè¦è¢«è¡¨è¾¾å¼æˆ–è€… scriptlet ä½¿ç”¨çš„å˜é‡ã€‚æ·»åŠ çš„å£°æ˜å¿…é¡»è¦ç”¨å¼€å§‹å’Œç»“æŸæ ‡ç­¾åŒ…èµ·æ¥</li></ul></li><li><p>ä»€ä¹ˆæ˜¯è¡¨è¾¾å¼(Expression)ï¼Ÿ</p><ul><li>ã€åˆ—è¡¨å¾ˆé•¿ï¼Œå¯ä»¥åˆ†ä¸Šã€ä¸­ã€ä¸‹å‘å¸ƒã€‘</li><li>JSP è¡¨è¾¾å¼æ˜¯ Web æœåŠ¡å™¨æŠŠè„šæœ¬è¯­è¨€è¡¨è¾¾å¼çš„å€¼è½¬åŒ–æˆä¸€ä¸ª String å¯¹è±¡ï¼Œæ’å…¥åˆ°è¿”å›ç»™å®¢æˆ·ç«¯çš„æ•°æ®æµä¸­ã€‚è¡¨è¾¾å¼æ˜¯åœ¨&lt;%=å’Œ%&gt;è¿™ä¸¤ä¸ªæ ‡ç­¾ä¹‹é—´å®šä¹‰çš„</li></ul></li><li><p>éšå«å¯¹è±¡æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿæœ‰å“ªäº›éšå«å¯¹è±¡ï¼Ÿ</p><ul><li>JSP éšå«å¯¹è±¡æ˜¯é¡µé¢ä¸­çš„ä¸€äº› Java å¯¹è±¡ï¼ŒJSP å®¹å™¨è®©è¿™äº› Java å¯¹è±¡å¯ä»¥ä¸ºå¼€å‘è€…æ‰€ä½¿ç”¨ã€‚å¼€å‘è€…ä¸ç”¨æ˜ç¡®çš„å£°æ˜å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ä»–ä»¬ã€‚JSP éšå«å¯¹è±¡ä¹Ÿå«åšé¢„å®šä¹‰å˜é‡ã€‚ä¸‹é¢åˆ—å‡ºäº† JSP é¡µé¢ä¸­çš„éšå«å¯¹è±¡ï¼šapplicationã€pageã€requestã€responseã€sessionã€exceptionã€outã€configã€pageContext</li></ul></li><li><p>é¢å‘å¯¹è±¡è½¯ä»¶å¼€å‘çš„ä¼˜ç‚¹æœ‰å“ªäº›ï¼Ÿ</p><ul><li>ä»£ç å¼€å‘æ¨¡å—åŒ–ï¼Œæ›´æ˜“ç»´æŠ¤å’Œä¿®æ”¹</li><li>ä»£ç å¤ç”¨</li><li>å¢å¼ºä»£ç çš„å¯é æ€§å’Œçµæ´»æ€§</li><li>å¢åŠ ä»£ç çš„å¯ç†è§£æ€§</li><li>é¢å‘å¯¹è±¡ç¼–ç¨‹æœ‰å¾ˆå¤šé‡è¦çš„ç‰¹æ€§ï¼Œæ¯”å¦‚ï¼šå°è£…ï¼Œç»§æ‰¿ï¼Œå¤šæ€å’ŒæŠ½è±¡</li></ul></li><li><p>å°è£…çš„å®šä¹‰å’Œå¥½å¤„æœ‰å“ªäº›ï¼Ÿ</p><ul><li>å°è£…ç»™å¯¹è±¡æä¾›äº†éšè—å†…éƒ¨ç‰¹æ€§å’Œè¡Œä¸ºçš„èƒ½åŠ›ã€‚å¯¹è±¡æä¾›ä¸€äº›èƒ½è¢«å…¶ä»–å¯¹è±¡è®¿é—®çš„æ–¹æ³•æ¥æ”¹å˜å®ƒå†…éƒ¨çš„æ•°æ®ã€‚åœ¨ Java å½“ä¸­ï¼Œæœ‰ 3 ç§ä¿®é¥°ç¬¦ï¼špublicï¼Œprivate å’Œ protectedã€‚æ¯ä¸€ç§ä¿®é¥°ç¬¦ç»™å…¶ä»–çš„ä½äºåŒä¸€ä¸ªåŒ…æˆ–è€…ä¸åŒåŒ…ä¸‹é¢å¯¹è±¡èµ‹äºˆäº†ä¸åŒçš„è®¿é—®æƒé™ã€‚ä¸‹é¢åˆ—å‡ºäº†ä½¿ç”¨å°è£…çš„ä¸€äº›å¥½å¤„ï¼š</li><li>é€šè¿‡éšè—å¯¹è±¡çš„å±æ€§æ¥ä¿æŠ¤å¯¹è±¡å†…éƒ¨çš„çŠ¶æ€</li><li>æé«˜äº†ä»£ç çš„å¯ç”¨æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œå› ä¸ºå¯¹è±¡çš„è¡Œä¸ºå¯ä»¥è¢«å•ç‹¬çš„æ”¹å˜æˆ–è€…æ˜¯æ‰©å±•</li><li>ç¦æ­¢å¯¹è±¡ä¹‹é—´çš„ä¸è‰¯äº¤äº’æé«˜æ¨¡å—åŒ–</li><li>å‚è€ƒè¿™ä¸ªæ–‡æ¡£è·å–æ›´å¤šå…³äºå°è£…çš„ç»†èŠ‚å’Œç¤ºä¾‹</li></ul></li><li><p>å¤šæ€çš„å®šä¹‰ï¼Ÿ</p><ul><li>å¤šæ€æ˜¯ç¼–ç¨‹è¯­è¨€ç»™ä¸åŒçš„åº•å±‚æ•°æ®ç±»å‹åšç›¸åŒçš„æ¥å£å±•ç¤ºçš„ä¸€ç§èƒ½åŠ›</li><li>ä¸€ä¸ªå¤šæ€ç±»å‹ä¸Šçš„æ“ä½œå¯ä»¥åº”ç”¨åˆ°å…¶ä»–ç±»å‹çš„å€¼ä¸Šé¢</li></ul></li><li><p>ç»§æ‰¿çš„å®šä¹‰ï¼Ÿ</p><ul><li>ç»§æ‰¿ç»™å¯¹è±¡æä¾›äº†ä»åŸºç±»è·å–å­—æ®µå’Œæ–¹æ³•çš„èƒ½åŠ›ã€‚ç»§æ‰¿æä¾›äº†ä»£ç çš„é‡ç”¨è¡Œï¼Œä¹Ÿå¯ä»¥åœ¨ä¸ä¿®æ”¹ç±»çš„æƒ…å†µä¸‹ç»™ç°å­˜çš„ç±»æ·»åŠ æ–°ç‰¹æ€§</li></ul></li><li><p>æŠ½è±¡çš„å®šä¹‰ï¼ŸæŠ½è±¡å’Œå°è£…çš„ä¸åŒç‚¹ï¼Ÿ</p><ul><li>æŠ½è±¡æ˜¯æŠŠæƒ³æ³•ä»å…·ä½“çš„å®ä¾‹ä¸­åˆ†ç¦»å‡ºæ¥çš„æ­¥éª¤ï¼Œå› æ­¤ï¼Œè¦æ ¹æ®ä»–ä»¬çš„åŠŸèƒ½è€Œä¸æ˜¯å®ç°ç»†èŠ‚æ¥åˆ›å»ºç±»ã€‚Java æ”¯æŒåˆ›å»ºåªæš´æ¼æ¥å£è€Œä¸åŒ…å«æ–¹æ³•å®ç°çš„æŠ½è±¡çš„ç±»ã€‚è¿™ç§æŠ½è±¡æŠ€æœ¯çš„ä¸»è¦ç›®çš„æ˜¯æŠŠç±»çš„è¡Œä¸ºå’Œå®ç°ç»†èŠ‚åˆ†ç¦»å¼€</li><li>æŠ½è±¡å’Œå°è£…æ˜¯äº’è¡¥çš„æ¦‚å¿µã€‚ä¸€æ–¹é¢ï¼ŒæŠ½è±¡å…³æ³¨å¯¹è±¡çš„è¡Œä¸ºã€‚å¦ä¸€æ–¹é¢ï¼Œå°è£…å…³æ³¨å¯¹è±¡è¡Œä¸ºçš„ç»†èŠ‚ã€‚ä¸€èˆ¬æ˜¯é€šè¿‡éšè—å¯¹è±¡å†…éƒ¨çŠ¶æ€ä¿¡æ¯åšåˆ°å°è£…ï¼Œå› æ­¤ï¼Œå°è£…å¯ä»¥çœ‹æˆæ˜¯ç”¨æ¥æä¾›æŠ½è±¡çš„ä¸€ç§ç­–ç•¥</li></ul></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Interview </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼ä¹‹å­¦ä¹ UMLç±»å›¾å’Œæ—¶åºå›¾</title>
      <link href="/20160724/designpattern-uml/"/>
      <url>/20160724/designpattern-uml/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å­¦ä¹ -UML-ç±»å›¾å’Œæ—¶åºå›¾"><a href="#å­¦ä¹ -UML-ç±»å›¾å’Œæ—¶åºå›¾" class="headerlink" title="å­¦ä¹  UML ç±»å›¾å’Œæ—¶åºå›¾"></a>å­¦ä¹  UML ç±»å›¾å’Œæ—¶åºå›¾</h1><p>ç±»å›¾ä¸­å„ä¸ªç±»ä¹‹é—´çš„å…³ç³»ï¼› èƒ½çœ‹æ‡‚ç±»å›¾ä¸­å„ä¸ªç±»ä¹‹é—´çš„çº¿æ¡ã€ç®­å¤´ä»£è¡¨ä»€ä¹ˆæ„æ€åï¼Œä¹Ÿå°±è¶³å¤Ÿåº”å¯¹ æ—¥å¸¸çš„å·¥ä½œå’Œäº¤æµï¼› åŒæ—¶ï¼Œæˆ‘ä»¬åº”è¯¥èƒ½å°†ç±»å›¾æ‰€è¡¨è¾¾çš„å«ä¹‰å’Œæœ€ç»ˆçš„ä»£ç å¯¹åº”èµ·æ¥</p><span id="more"></span><h2 id="ç®€å•ç¤ºä¾‹"><a href="#ç®€å•ç¤ºä¾‹" class="headerlink" title="ç®€å•ç¤ºä¾‹"></a>ç®€å•ç¤ºä¾‹</h2><p><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/29rXZX.jpg"></p><ul><li>è½¦çš„ç±»å›¾ç»“æ„ä¸º&lt;&lt;abstract&gt;&gt;ï¼Œè¡¨ç¤ºè½¦æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼›</li><li>å®ƒæœ‰ä¸¤ä¸ªç»§æ‰¿ç±»ï¼šå°æ±½è½¦å’Œè‡ªè¡Œè½¦ï¼›å®ƒä»¬ä¹‹é—´çš„å…³ç³»ä¸ºå®ç°å…³ç³»ï¼Œä½¿ç”¨å¸¦ç©ºå¿ƒç®­å¤´çš„è™šçº¿è¡¨ç¤ºï¼›</li><li>å°æ±½è½¦ä¸ºä¸ SUV ä¹‹é—´ä¹Ÿæ˜¯ç»§æ‰¿å…³ç³»ï¼Œå®ƒä»¬ä¹‹é—´çš„å…³ç³»ä¸ºæ³›åŒ–å…³ç³»ï¼Œä½¿ç”¨å¸¦ç©ºå¿ƒç®­å¤´çš„å®çº¿è¡¨ç¤ºï¼›</li><li>å°æ±½è½¦ä¸å‘åŠ¨æœºä¹‹é—´æ˜¯ç»„åˆå…³ç³»ï¼Œä½¿ç”¨å¸¦å®å¿ƒç®­å¤´çš„å®çº¿è¡¨ç¤ºï¼›</li><li>å­¦ç”Ÿä¸ç­çº§ä¹‹é—´æ˜¯èšåˆå…³ç³»ï¼Œä½¿ç”¨å¸¦ç©ºå¿ƒç®­å¤´çš„å®çº¿è¡¨ç¤ºï¼›</li><li>å­¦ç”Ÿä¸èº«ä»½è¯ä¹‹é—´ä¸ºå…³è”å…³ç³»ï¼Œä½¿ç”¨ä¸€æ ¹å®çº¿è¡¨ç¤ºï¼›</li><li>å­¦ç”Ÿä¸Šå­¦éœ€è¦ç”¨åˆ°è‡ªè¡Œè½¦ï¼Œä¸è‡ªè¡Œè½¦æ˜¯ä¸€ç§ä¾èµ–å…³ç³»ï¼Œä½¿ç”¨å¸¦ç®­å¤´çš„è™šçº¿è¡¨ç¤ºï¼›</li></ul><h2 id="ç±»ä¸ç±»ä¹‹é—´çš„å…³ç³»"><a href="#ç±»ä¸ç±»ä¹‹é—´çš„å…³ç³»" class="headerlink" title="ç±»ä¸ç±»ä¹‹é—´çš„å…³ç³»"></a>ç±»ä¸ç±»ä¹‹é—´çš„å…³ç³»</h2><h3 id="1-æ³›åŒ–å…³ç³»-generalization"><a href="#1-æ³›åŒ–å…³ç³»-generalization" class="headerlink" title="1.æ³›åŒ–å…³ç³»(generalization)"></a>1.æ³›åŒ–å…³ç³»(generalization)</h3><ul><li>ç±»çš„ç»§æ‰¿ç»“æ„è¡¨ç°åœ¨ UML ä¸­ä¸ºï¼šæ³›åŒ–(generalize)ä¸å®ç°(realize)</li><li>ç»§æ‰¿å…³ç³»ä¸º is-a çš„å…³ç³»ï¼›ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´å¦‚æœå¯ä»¥ç”¨ is-a æ¥è¡¨ç¤ºï¼Œå°±æ˜¯ç»§æ‰¿å…³ç³»ï¼šï¼ˆ..æ˜¯..)</li><li>ä¾‹å¦‚ï¼šæ±½è½¦æ˜¯è½¦ï¼Œç‹—æ˜¯åŠ¨ç‰©ï¼Œåœ°çƒæ˜¯è¡Œæ˜Ÿ</li><li>æ³›åŒ–å…³ç³»ç”¨ä¸€æ¡å¸¦ç©ºå¿ƒç®­å¤´çš„ç›´æ¥è¡¨ç¤ºï¼›å¦‚ä¸‹å›¾è¡¨ç¤ºï¼ˆA ç»§æ‰¿è‡ª Bï¼‰<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/arL9Qf.jpg"></li><li>ä¾‹å¦‚ï¼šæ±½è½¦åœ¨ç°å®ä¸­æœ‰å®ç°ï¼Œå¯ç”¨æ±½è½¦å®šä¹‰å…·ä½“çš„å¯¹è±¡ï¼›æ±½è½¦ä¸ SUV ä¹‹é—´ä¸ºæ³›åŒ–å…³ç³»ï¼›<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/yqaZ1R.jpg"></li></ul><blockquote><ul><li>æ³¨ï¼šæœ€ç»ˆä»£ç ä¸­ï¼Œæ³›åŒ–å…³ç³»è¡¨ç°ä¸º<em>ç»§æ‰¿éæŠ½è±¡ç±»</em></li></ul></blockquote><h3 id="2-å®ç°å…³ç³»-realize"><a href="#2-å®ç°å…³ç³»-realize" class="headerlink" title="2.å®ç°å…³ç³»(realize)"></a>2.å®ç°å…³ç³»(realize)</h3><ul><li>å®ç°å…³ç³»ç”¨ä¸€æ¡å¸¦ç©ºå¿ƒç®­å¤´çš„è™šçº¿è¡¨ç¤º</li><li>ä¾‹å¦‚ï¼šegï¼šâ€è½¦â€ä¸ºä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œåœ¨ç°å®ä¸­å¹¶æ— æ³•ç›´æ¥ç”¨æ¥å®šä¹‰å¯¹è±¡ï¼›åªæœ‰æŒ‡æ˜å…·ä½“çš„å­ç±»(æ±½è½¦è¿˜æ˜¯è‡ªè¡Œè½¦)ï¼Œæ‰ å¯ä»¥ç”¨æ¥å®šä¹‰å¯¹è±¡ï¼ˆâ€è½¦â€è¿™ä¸ªç±»åœ¨ C++ä¸­ç”¨æŠ½è±¡ç±»è¡¨ç¤ºï¼Œåœ¨ JAVA ä¸­æœ‰æ¥å£è¿™ä¸ªæ¦‚å¿µï¼Œæ›´å®¹æ˜“ç†è§£ï¼‰<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/9oBm7t.jpg"></li></ul><blockquote><ul><li>æ³¨ï¼šæœ€ç»ˆä»£ç ä¸­ï¼Œå®ç°å…³ç³»è¡¨ç°ä¸º<em>ç»§æ‰¿æŠ½è±¡ç±»</em></li></ul></blockquote><h3 id="3-èšåˆå…³ç³»-aggregation"><a href="#3-èšåˆå…³ç³»-aggregation" class="headerlink" title="3.èšåˆå…³ç³»(aggregation)"></a>3.èšåˆå…³ç³»(aggregation)</h3><ul><li>èšåˆå…³ç³»ç”¨ä¸€æ¡å¸¦ç©ºå¿ƒè±å½¢ç®­å¤´çš„ç›´çº¿è¡¨ç¤ºï¼Œå¦‚ä¸‹å›¾è¡¨ç¤º A èšåˆåˆ° B ä¸Šï¼Œæˆ–è€…è¯´ B ç”± A ç»„æˆ<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/o52AIJ.jpg"></li><li>èšåˆå…³ç³»ç”¨äºè¡¨ç¤ºå®ä½“å¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼Œè¡¨ç¤ºæ•´ä½“ç”±éƒ¨åˆ†æ„æˆçš„è¯­ä¹‰ï¼›ä¾‹å¦‚ä¸€ä¸ªéƒ¨é—¨ç”±å¤šä¸ªå‘˜å·¥ç»„æˆ</li><li>ä¸ç»„åˆå…³ç³»ä¸åŒçš„æ˜¯ï¼Œæ•´ä½“å’Œéƒ¨åˆ†ä¸æ˜¯å¼ºä¾èµ–çš„ï¼Œå³ä½¿æ•´ä½“ä¸å­˜åœ¨äº†ï¼Œéƒ¨åˆ†ä»ç„¶å­˜åœ¨ï¼›ä¾‹å¦‚ï¼Œ éƒ¨é—¨æ’¤é”€äº†ï¼Œäººå‘˜ä¸ä¼šæ¶ˆå¤±ï¼Œä»–ä»¬ä¾ç„¶å­˜åœ¨</li></ul><h3 id="4-ç»„åˆå…³ç³»-composition"><a href="#4-ç»„åˆå…³ç³»-composition" class="headerlink" title="- 4.ç»„åˆå…³ç³»(composition)"></a>- 4.ç»„åˆå…³ç³»(composition)</h3><ul><li>ç»„åˆå…³ç³»ç”¨ä¸€æ¡å¸¦å®å¿ƒè±å½¢ç®­å¤´ç›´çº¿è¡¨ç¤ºï¼Œå¦‚ä¸‹å›¾è¡¨ç¤º A ç»„æˆ Bï¼Œæˆ–è€… B ç”± A ç»„æˆ<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/PZnMM8.jpg"></li><li>ä¸èšåˆå…³ç³»ç›¸æ¯”ç›¸åŒä¹‹å¤„ï¼šåŒæ ·è¡¨ç¤ºæ•´ä½“ç”±éƒ¨åˆ†æ„æˆçš„è¯­ä¹‰ï¼›æ¯”å¦‚å…¬å¸ç”±å¤šä¸ªéƒ¨é—¨ç»„æˆ</li><li>ä½†ç»„åˆå…³ç³»æ˜¯ä¸€ç§å¼ºä¾èµ–çš„ç‰¹æ®Šèšåˆå…³ç³»ï¼Œå¦‚æœæ•´ä½“ä¸å­˜åœ¨äº†ï¼Œåˆ™éƒ¨åˆ†ä¹Ÿä¸å­˜åœ¨äº†ï¼›ä¾‹å¦‚ï¼Œ å…¬å¸ä¸å­˜åœ¨äº†ï¼Œéƒ¨é—¨ä¹Ÿå°†ä¸å­˜åœ¨äº†</li></ul><h3 id="5-å…³è”å…³ç³»-association"><a href="#5-å…³è”å…³ç³»-association" class="headerlink" title="5.å…³è”å…³ç³»(association)"></a>5.å…³è”å…³ç³»(association)</h3><ul><li>å…³è”å…³ç³»æ˜¯ç”¨ä¸€æ¡ç›´çº¿è¡¨ç¤ºçš„ï¼›å®ƒæè¿°ä¸åŒç±»çš„å¯¹è±¡ä¹‹é—´çš„ç»“æ„å…³ç³»ï¼›å®ƒæ˜¯ä¸€ç§é™æ€å…³ç³»ï¼Œ é€šå¸¸ä¸è¿è¡ŒçŠ¶æ€æ— å…³ï¼Œä¸€èˆ¬ç”±å¸¸è¯†ç­‰å› ç´ å†³å®šçš„ï¼›å®ƒä¸€èˆ¬ç”¨æ¥å®šä¹‰å¯¹è±¡ä¹‹é—´é™æ€çš„ã€å¤©ç„¶çš„ç»“æ„ï¼› æ‰€ä»¥ï¼Œå…³è”å…³ç³»æ˜¯ä¸€ç§â€œå¼ºå…³è”â€çš„å…³ç³»</li><li>ä¾‹å¦‚ï¼šä¹˜è½¦äººå’Œè½¦ç¥¨ä¹‹é—´å°±æ˜¯ä¸€ç§å…³è”å…³ç³»ï¼›ä¸»æ¿å’Œ PC ä¸»æœºä¹‹é—´çš„ä¸€ç§å…³è”å…³ç³»</li><li>å…³è”å…³ç³»é»˜è®¤ä¸å¼ºè°ƒæ–¹å‘ï¼Œè¡¨ç¤ºå¯¹è±¡é—´ç›¸äº’çŸ¥é“ï¼›å¦‚æœç‰¹åˆ«å¼ºè°ƒæ–¹å‘ï¼Œå¦‚ä¸‹å›¾ï¼Œè¡¨ç¤º A çŸ¥é“ Bï¼Œä½† B ä¸çŸ¥é“ A<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/GvpcSE.jpg"></li></ul><blockquote><ul><li>æ³¨ï¼šåœ¨æœ€ç»ˆä»£ç ä¸­ï¼Œå…³è”å¯¹è±¡é€šå¸¸æ˜¯<em>ä»¥æˆå‘˜å˜é‡çš„å½¢å¼å®ç°çš„</em></li></ul></blockquote><h3 id="6-ä¾èµ–å…³ç³»-dependency"><a href="#6-ä¾èµ–å…³ç³»-dependency" class="headerlink" title="6.ä¾èµ–å…³ç³»(dependency)"></a>6.ä¾èµ–å…³ç³»(dependency)</h3><ul><li>ä¾èµ–å…³ç³»æ˜¯ç”¨ä¸€å¥—å¸¦ç®­å¤´çš„è™šçº¿è¡¨ç¤ºçš„ï¼›å¦‚ä¸‹å›¾è¡¨ç¤º A ä¾èµ–äº Bï¼›ä»–æè¿°ä¸€ä¸ªå¯¹è±¡åœ¨è¿è¡ŒæœŸé—´ä¼šç”¨åˆ°å¦ä¸€ä¸ªå¯¹è±¡çš„å…³ç³»<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/eKl57t.jpg"></li><li>ä¸å…³è”å…³ç³»ä¸åŒçš„æ˜¯ï¼Œå®ƒæ˜¯ä¸€ç§ä¸´æ—¶æ€§çš„å…³ç³»ï¼Œé€šå¸¸åœ¨è¿è¡ŒæœŸé—´äº§ç”Ÿï¼Œå¹¶ä¸”éšç€è¿è¡Œæ—¶çš„å˜åŒ–ï¼› ä¾èµ–å…³ç³»ä¹Ÿå¯èƒ½å‘ç”Ÿå˜åŒ–</li><li>ä¾èµ–ä¹Ÿæœ‰æ–¹å‘ï¼Œå…¶ä¸­åŒå‘ä¾èµ–æ˜¯ä¸€ç§éå¸¸ç³Ÿç³•çš„ç»“æ„ï¼Œä¸€èˆ¬éƒ½åº”è¯¥åªä¿æŒå•å‘ä¾èµ–</li></ul><blockquote><ul><li>æ³¨ï¼šåœ¨æœ€ç»ˆä»£ç ä¸­ï¼Œä¾èµ–å…³ç³»ä½“ç°ä¸º<em>ç±»æ„é€ æ–¹æ³•åŠç±»æ–¹æ³•çš„ä¼ å…¥å‚æ•°</em>ï¼Œç®­å¤´çš„æŒ‡å‘ä¸ºè°ƒç”¨å…³ç³»ï¼›ä¾èµ–å…³ç³»å¤„ç†ä¸´æ—¶çŸ¥é“å¯¹æ–¹å¤–ï¼Œè¿˜æ˜¯â€œä½¿ç”¨â€å¯¹æ–¹çš„æ–¹æ³•å’Œå±æ€§</li></ul></blockquote><h2 id="æ—¶åºå›¾"><a href="#æ—¶åºå›¾" class="headerlink" title="æ—¶åºå›¾"></a>æ—¶åºå›¾</h2><ul><li>ä¸ºäº†å±•ç¤ºå¯¹è±¡ä¹‹é—´çš„äº¤äº’ç»†èŠ‚ï¼Œåç»­å¯¹è®¾è®¡æ¨¡å¼è§£æçš„ç« èŠ‚ï¼Œéƒ½ä¼šç”¨åˆ°æ—¶åºå›¾ï¼›</li><li>æ—¶åºå›¾ï¼ˆSequence Diagramï¼‰æ˜¯æ˜¾ç¤ºå¯¹è±¡ä¹‹é—´äº¤äº’çš„å›¾ï¼Œè¿™äº›å¯¹è±¡æ˜¯æŒ‰æ—¶é—´é¡ºåºæ’åˆ—çš„ã€‚æ—¶åºå›¾ä¸­æ˜¾ç¤ºçš„æ˜¯å‚ä¸äº¤äº’çš„å¯¹è±¡åŠå…¶å¯¹è±¡ä¹‹é—´æ¶ˆæ¯äº¤äº’çš„é¡ºåºã€‚</li><li>æ—¶åºå›¾åŒ…æ‹¬çš„å»ºæ¨¡å…ƒç´ ä¸»è¦æœ‰ï¼šå¯¹è±¡ï¼ˆActorï¼‰ã€ç”Ÿå‘½çº¿ï¼ˆLifelineï¼‰ã€æ§åˆ¶ç„¦ç‚¹ï¼ˆFocus of controlï¼‰ã€æ¶ˆæ¯ï¼ˆMessageï¼‰ç­‰ç­‰ã€‚</li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://design-patterns.readthedocs.io/zh_CN/latest/read_uml.html">çœ‹æ‡‚ UML ç±»å›¾å’Œæ—¶åºå›¾</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> DesignPattern </tag>
            
            <tag> UML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Androidé¢è¯•è¦ç‚¹æ€»ç»“</title>
      <link href="/20160715/interview-android-summary/"/>
      <url>/20160715/interview-android-summary/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Android-é¢è¯•è¦ç‚¹æ€»ç»“"><a href="#Android-é¢è¯•è¦ç‚¹æ€»ç»“" class="headerlink" title="Android é¢è¯•è¦ç‚¹æ€»ç»“"></a>Android é¢è¯•è¦ç‚¹æ€»ç»“</h1><h2 id="1-Java-æŠ€æœ¯"><a href="#1-Java-æŠ€æœ¯" class="headerlink" title="1.Java æŠ€æœ¯"></a>1.Java æŠ€æœ¯</h2><ul><li><p>1.1 Java åŸºç¡€<br>_ å¯¹è±¡ã€ç»§æ‰¿ã€å¤šæ€ç†è§£<br>_ æ³›å‹ä½œç”¨åŠä½¿ç”¨åœºæ™¯<br>_ æšä¸¾çš„ç‰¹ç‚¹åŠä½¿ç”¨åœºæ™¯<br>_ çº¿ç¨‹ sleep å’Œ wait çš„åŒºåˆ«<br>_ Java åå°„æœºåˆ¶<br>_ weak/soft/strong çš„åŒºåˆ« * Object çš„ hasCode()ä¸ equals()çš„åŒºåˆ«å’Œä½œç”¨</p><span id="more"></span></li><li><p>1.2 é›†åˆç±»</p><ul><li>Java å¸¸ç”¨é›†åˆç±»ã€åŒºåˆ«å’Œæ€§èƒ½</li><li>å¹¶å‘ç›¸å…³é›†åˆç±»</li><li>éƒ¨åˆ†å¸¸ç”¨é›†åˆç±»çš„å†…éƒ¨å®ç°æ–¹å¼</li></ul></li><li><p>1.3 å¤šçº¿ç¨‹ç›¸å…³</p><ul><li>Threadã€Runableã€Callableã€Futrue ç±»å…³ç³»å’ŒåŒºåˆ«</li><li>JDK ä¸­é»˜è®¤æä¾›å“ªäº›çº¿ç¨‹æ± ï¼Œæœ‰ä½•åŒºåˆ«</li><li>çº¿ç¨‹åŒæ­¥æœ‰å‡ ç§æ–¹å¼ï¼Œåˆ†åˆ«é˜è¿°åœ¨é¡¹ç›®ä¸­çš„ç”¨æ³•</li><li>åœ¨ç†è§£é»˜è®¤çº¿ç¨‹æ± å‰æä¸‹ï¼Œè‡ªå·±å®ç°çº¿ç¨‹æ± </li></ul></li><li><p>1.4 å­—ç¬¦</p><ul><li>æ³¨è§£çš„ä½¿ç”¨</li><li>æ³¨è§£çš„çº§åˆ«åŠæ„ä¹‰</li><li>å¦‚ä½•è‡ªå®šä¹‰æ³¨è§£</li></ul></li></ul><h2 id="2-Android-æŠ€æœ¯"><a href="#2-Android-æŠ€æœ¯" class="headerlink" title="2.Android æŠ€æœ¯"></a>2.Android æŠ€æœ¯</h2><ul><li><p>2.1 Android åŸºç¡€</p><ul><li>å››å¤§ç»„ä»¶çš„æ„ä¹‰åŠä½¿ç”¨ï¼Œç”Ÿå‘½å‘¨æœŸå›è°ƒåŠæ„ä¹‰</li><li>AsynTaskã€Handle çš„ä½¿ç”¨</li><li>Android ç³»ç»Ÿå±‚æ¬¡æ¡†æ¶ç»“æ„</li><li>AsynTask çš„å®ç°æ–¹å¼</li><li>AsynTask ä½¿ç”¨çš„æ—¶å€™åº”è¯¥æ³¨æ„ä»€ä¹ˆ</li><li>Android å¸¸è§çš„å­˜å‚¨æ–¹å¼</li><li>Looperã€Handler å’Œ MessageQueue çš„å…³ç³»</li><li>Activity çš„å¯åŠ¨æµç¨‹ï¼ˆè€ƒå¯Ÿé˜Ÿ Framework çš„ç†Ÿæ‚‰ç¨‹åº¦ï¼‰ã€</li><li>å¤šè¿›ç¨‹å¼€å‘æ³¨æ„äº‹é¡¹ï¼ˆApplication ç±»åŒºåˆ†è¿›ç¨‹ï¼Œè¿›ç¨‹é—´å†…å­˜ä¸å¯è§ã€è¿›ç¨‹é—´é€šè®¯æ–¹å¼ï¼‰</li></ul></li><li><p>2.2 Resource ç›¸å…³</p><ul><li>.9 å›¾ç‰‡çš„æ„ä¹‰</li><li>style å’Œ theme çš„ä½œç”¨å’Œç”¨æ³•</li><li>dpiã€spã€px çš„åŒºåˆ«ä»¥åŠè½¬æ¢å…³ç³»</li><li>raw å’Œ assets çš„æ–‡ä»¶å¤¹ä½œç”¨ï¼ŒäºŒè€…çš„åŒºåˆ«</li><li>Android ç³»ç»Ÿå¦‚ä½•åœ¨å¤šä¸ªèµ„æºæ–‡ä»¶å¤¹ä¸‹æŸ¥æ‰¾åŒ¹é…æœ€åˆé€‚çš„èµ„æº</li></ul></li><li><p>2.3 è™šæ‹Ÿæœº</p><ul><li>Java å†…å­˜æ¨¡å‹</li><li>Android è™šæ‹Ÿæœºç‰¹ç‚¹</li><li>Dalvik å’Œ Art çš„åŒºåˆ«</li><li>ç†Ÿæ‚‰åƒåœ¾å›æ”¶çš„å®ç°æœºåˆ¶ï¼Œäº†è§£è™šæ‹Ÿæœºçš„ GC ç±»å‹</li></ul></li><li><p>2.4 View ç›¸å…³</p><ul><li>å¸¸ç”¨ç»„ä»¶çš„ä½¿ç”¨ï¼šListViewã€RecyclerView åŠ Adapter çš„ä½¿ç”¨</li><li>View ä¹‹é—´çš„ç»§æ‰¿å…³ç³»</li><li>Invalidate ä¸ postInvalidate çš„åŒºåˆ«</li><li>è‡ªå®šä¹‰ View çš„å®ç°æ–¹å¼ï¼ˆæ ¹æ®é¡¹ç›®ç»éªŒè¯¢é—®ç›¸å…³æ¡ä»¶ï¼‰</li><li>onMeasure/onLayout/onDraw çš„ä½œç”¨</li><li>Paintã€Matrixã€Shader ç­‰ç»˜åˆ¶ç›¸å…³ç±»çš„æ–¹æ³•ä½œç”¨</li><li>è¯¦ç»†æè¿°äº‹ä»¶åˆ†å‘æœºåˆ¶</li></ul></li><li><p>2.5 åŠ¨ç”»</p><ul><li>Android åŠ¨ç”»çš„å®ç°æ–¹å¼</li><li>Interpolatio ç±»çš„æ„ä¹‰å’Œå¸¸ç”¨çš„ Interpolator</li><li>ViewAnimation ä¸å±æ€§åŠ¨ç”»æœ‰ä»€ä¹ˆåŒºåˆ«</li><li>å¦‚ä½•è‡ªå®šä¹‰ ViewAnimation</li><li>å±æ€§åŠ¨ç”»çš„å®ç°åŸç†</li></ul></li><li><p>2.6 å›¾ç‰‡å¤„ç†</p><ul><li>ä¸€èˆ¬å›¾ç‰‡ä¸­å¦‚ä½•åŠ è½½å¤§å›¾</li><li>å›¾ç‰‡å‹ç¼©æ–¹å¼</li><li>å¦‚ä½•ä¸å‹ç¼©å›¾ç‰‡åŠ è½½é«˜æ¸…å›¾</li><li>å›¾ç‰‡åŠ è½½è¿‡ç¨‹ä¸­ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨ç¼“å­˜ï¼Œè¿™ä¸ªç¼“å­˜çš„ä¸»è¦ä½œç”¨æ˜¯ä»€ä¹ˆ</li><li>è°ˆè°ˆè‡ªå·±ç†Ÿæ‚‰çš„å›¾ç‰‡åŠ è½½æ¡†æ¶</li></ul></li></ul><h2 id="3-é¡¹ç›®ç»éªŒ"><a href="#3-é¡¹ç›®ç»éªŒ" class="headerlink" title="3.é¡¹ç›®ç»éªŒ"></a>3.é¡¹ç›®ç»éªŒ</h2><ul><li><p>3.1 å¼€å‘å·¥å…·</p><ul><li>ä»£ç ç®¡ç†å·¥å…·ï¼šSVNã€Git</li><li>å¸¸ç”¨è°ƒè¯•å·¥å…·ï¼šHierarchy Viewerã€ DDMS ç­‰</li><li>CI å·¥å…·ï¼šLint æ£€æŸ¥ï¼ŒFindbugsï¼ŒJenkins</li><li>å†…å­˜åˆ†æå·¥å…·ï¼šdumpsysã€memoinfoã€MAT</li></ul></li><li><p>3.2 é¡¹ç›®å·¥ç¨‹</p><ul><li>APP æ›´æ–°ç­–ç•¥ï¼šæ¨é€/æ‹‰å–</li><li>å¦‚ä½•ç»Ÿä¸€å¤„ç†é”™è¯¯* å¦‚ä½•æ”¶é›†ç”¨æˆ·è¡Œä¸º</li><li>æ—¥å¿—ç®¡ç†æœ‰å“ªäº›è¦ç‚¹ï¼Ÿ(Debug åŒ…å¼€æ”¾ï¼Œrelease åŒ…å…³é—­ï¼Œé”™è¯¯æ—¥å¿—åé¦ˆ)</li><li>æ‰“åŒ…æ–¹å¼ Antã€Mavenã€Gradle</li><li>æœºå‹é€‚é…æƒ…å†µ</li></ul></li><li><p>3.3 å¼€å‘å¹³å°</p><ul><li>æ˜¯å¦ä½¿ç”¨è¿‡ç¬¬ä¸‰æ–¹å¹³å°</li><li>å¸¸ç”¨å¼€æ”¾å¹³å°çš„ç†Ÿæ‚‰åº¦(å¾®ä¿¡ã€QQã€å¾®åšã€æ”¯ä»˜å®ç­‰å¸¸ç”¨çš„æ”¯ä»˜å’Œåˆ†äº«)</li><li>æ˜¯å¦è¿›è¡Œè¿‡å¯¹ç¬¬ä¸‰æ–¹å¹³å°çš„ç»Ÿä¸€å°è£…ï¼Ÿ</li><li>æ˜¯å¦è‡ªå·±å¼€å‘è¿‡ SDKï¼Ÿ</li></ul></li><li><p>3.4 è®¾è®¡ç›¸å…³</p><ul><li>æœ‰å“ªäº›å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼ã€è®¾è®¡åŸåˆ™</li><li>è®¾è®¡æ¨¡å¼åœ¨ Android æºç ä¸­çš„åº”ç”¨</li><li>è®¾è®¡æ¨¡å¼åœ¨é¡¹ç›®ä¸­çš„åº”ç”¨</li><li>é¡¹ç›®ä¸­çš„åˆ†åŒ…æ–¹å¼</li><li>MVC åœ¨ android ä¸­çš„åº”ç”¨ï¼Œåˆ©å¼Š</li><li>android é¡¹ç›®ä¸­çš„å¸¸è§å±‚æ¬¡ç»“æ„,åŒ…åˆ’åˆ†</li><li>æœ‰æ²¡æœ‰è®¾è®¡è¿‡é¡¹ç›®ä¸­çš„å±‚çº§ç»“æ„ã€åŒ…åˆ’åˆ†</li></ul></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Android </tag>
            
            <tag> Java </tag>
            
            <tag> Interview </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mac OS X ç»ˆç«¯å‘½ä»¤å­¦ä¹ </title>
      <link href="/20151229/mac-terminalusing/"/>
      <url>/20151229/mac-terminalusing/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Mac-OS-X-ç»ˆç«¯å‘½ä»¤å­¦ä¹ "><a href="#Mac-OS-X-ç»ˆç«¯å‘½ä»¤å­¦ä¹ " class="headerlink" title="Mac OS X ç»ˆç«¯å‘½ä»¤å­¦ä¹ "></a>Mac OS X ç»ˆç«¯å‘½ä»¤å­¦ä¹ </h1><ol><li>æ˜¾ç¤ºå½“å‰ç›®å½•çš„è·¯å¾„</li></ol><ul><li>pwd<span id="more"></span></li></ul><ol start="2"><li>åˆ—å‡ºæ–‡ä»¶</li></ol><ul><li>ls å‚æ•° ç›®å½•å</li><li>å‚æ•°: -w æ˜¾ç¤ºä¸­æ–‡ï¼Œ-l è¯¦ç»†ä¿¡æ¯ï¼Œ -a åŒ…æ‹¬éšè—æ–‡ä»¶ï¼Œæ¯ä¸€è¡Œå¼€å¤´æ˜¯ â€œdâ€ åˆ™ä¸ºæ–‡ä»¶å¤¹ï¼Œå¼€å¤´æ˜¯ â€œ-â€ åˆ™ä¸ºæ–‡ä»¶ã€‚</li><li>ä¾‹: çœ‹çœ‹é©±åŠ¨ç›®å½•ä¸‹æœ‰ä»€ä¹ˆï¼š<br>ls /System/Library/Extensions</li></ul><ol start="3"><li>æ‰“å¼€ç›®å½•</li></ol><ul><li>cd ç›®å½•å</li><li>cd .. ï¼šè¿”å›ä¸Šä¸€çº§ç›®å½•</li><li>cd ../.. ï¼šcd ../.. /..ï¼šè¿”å›ä¸Šä¸¤çº§/ä¸‰çº§ç›®å½•</li><li>cd . ï¼šå½“å‰ç›®å½•</li><li>ä¾‹ï¼šæƒ³åˆ°é©±åŠ¨ç›®å½•ä¸‹æºœè¾¾ä¸€åœˆï¼š<br>cd /System/Library/Extensions</li></ul><ol start="4"><li>å»ºç«‹æ–°ç›®å½•</li></ol><ul><li>mkdir ç›®å½•å</li><li>ä¾‹ï¼šåœ¨é©±åŠ¨ç›®å½•ä¸‹å»ºä¸€ä¸ªå¤‡ä»½ç›®å½•<br>backupï¼šmkdir/System/Library/Extensions/backup</li></ul><ol start="5"><li>æ–°å»ºæ–‡ä»¶</li></ol><ul><li>touch æ–‡ä»¶å</li><li>ä¾‹ï¼šåœ¨å½“å‰ç›®å½•ä¸‹å»ºä¸€ä¸ªå¤‡ä»½æ–‡ä»¶ backupï¼š<br>touch backup.txt</li></ul><ol start="6"><li>æ‹·è´æ–‡ä»¶</li></ol><ul><li>cp å‚æ•° æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶</li><li>ä¾‹ï¼šæƒ³æŠŠæ¡Œé¢çš„ Natit.kext æ‹·è´åˆ°é©±åŠ¨ç›®å½•ä¸­<br> cp -R /User/ç”¨æˆ·å/Desktop/Natit.kext /System/Library/Extensions</li><li>å‚æ•° R è¡¨ç¤ºå¯¹ç›®å½•è¿›è¡Œé€’å½’æ“ä½œï¼Œkext åœ¨å›¾å½¢ç•Œé¢ä¸‹çœ‹èµ·æ¥æ˜¯ä¸ªæ–‡ä»¶ï¼Œå®é™…ä¸Šæ˜¯ä¸ªæ–‡ä»¶å¤¹ã€‚</li><li>æŠŠé©±åŠ¨ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å¤‡ä»½åˆ°æ¡Œé¢ backupï¼š<br>cp -R /System/Library/Extensions/ /User/ç”¨æˆ·å/Desktop/backup</li></ul><ol start="7"><li>åˆ é™¤æ–‡ä»¶</li></ol><ul><li>rm å‚æ•° æ–‡ä»¶</li><li>å‚æ•°ï¼rf è¡¨ç¤ºé€’å½’å’Œå¼ºåˆ¶ï¼Œåƒä¸‡è¦å°å¿ƒä½¿ç”¨ï¼Œå¦‚æœæ‰§è¡Œäº† rm -rf / ä½ çš„ç³»ç»Ÿå°±å…¨æ²¡äº†</li><li>ä¾‹ï¼šæƒ³åˆ é™¤é©±åŠ¨çš„ç¼“å­˜ï¼š<code>rm </code>-rf /System/Library/Extensions.kextcache<code> rm -rf /System/Library/Extensions.mkext</code></li></ul><ol start="8"><li>ç§»åŠ¨æ–‡ä»¶</li></ol><ul><li>mv æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶</li><li>ä¾‹ï¼šæƒ³æŠŠ AppleHDA.Kext ç§»åˆ°æ¡Œé¢ï¼š<br>mv /System/Library/Extensions/AppleHDA.kext /User/ç”¨æˆ·å/Desktop</li></ul><ol start="9"><li>æ–‡æœ¬ç¼–è¾‘</li></ol><ul><li>nano æ–‡ä»¶å<br>ä¾‹ï¼šç¼–è¾‘ Info.plistï¼šnano /System/Library/Extensions/Natit.kext/Info.plist</li></ul><ol start="10"><li>æ¸…å±</li></ol><ul><li>clear</li></ul><ol start="11"><li>ç›®å½•æ“ä½œï¼š</li></ol><table><thead><tr><th>å‘½ä»¤å</th><th>åŠŸèƒ½æè¿°</th><th>ä½¿ç”¨ä¸¾ä¾‹</th></tr></thead><tbody><tr><td>mkdir</td><td>åˆ›å»ºä¸€ä¸ªç›®å½•</td><td>mkdir dirname</td></tr><tr><td>rmdir</td><td>åˆ é™¤ä¸€ä¸ªç›®å½•</td><td>rmdir dirname</td></tr><tr><td>mvdir</td><td>ç§»åŠ¨æˆ–é‡å‘½åä¸€ä¸ªç›®å½•</td><td>mvdir dir1 dir2</td></tr><tr><td>cd</td><td>æ”¹å˜å½“å‰ç›®å½•</td><td>cd dirname</td></tr><tr><td>pwd</td><td>æ˜¾ç¤ºå½“å‰ç›®å½•çš„è·¯å¾„å</td><td>pwd</td></tr><tr><td>ls</td><td>æ˜¾ç¤ºå½“å‰ç›®å½•çš„å†…å®¹</td><td>ls -la</td></tr></tbody></table><ol start="12"><li>æ–‡ä»¶æ“ä½œï¼š</li></ol><table><thead><tr><th>å‘½ä»¤å</th><th>åŠŸèƒ½æè¿°</th><th>ä½¿ç”¨ä¸¾ä¾‹</th></tr></thead><tbody><tr><td>cat</td><td>æ˜¾ç¤ºæˆ–è¿æ¥æ–‡ä»¶</td><td>cat filename</td></tr><tr><td>od</td><td>æ˜¾ç¤ºéæ–‡æœ¬æ–‡ä»¶çš„å†…å®¹</td><td>od -c filename</td></tr><tr><td>cp</td><td>å¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•</td><td>cp file1 file2</td></tr><tr><td>rm</td><td>åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•</td><td>rm filename</td></tr><tr><td>mv</td><td>æ”¹å˜æ–‡ä»¶åæˆ–æ‰€åœ¨ç›®å½•</td><td>mv file1 file2</td></tr><tr><td>find</td><td>ä½¿ç”¨åŒ¹é…è¡¨è¾¾å¼æŸ¥æ‰¾æ–‡ä»¶</td><td>find . -name â€œ*.câ€ -print</td></tr><tr><td>file</td><td>æ˜¾ç¤ºæ–‡ä»¶ç±»å‹</td><td>file filename</td></tr></tbody></table><ol start="13"><li>é€‰æ‹©æ“ä½œï¼š</li></ol><table><thead><tr><th>å‘½ä»¤å</th><th>åŠŸèƒ½æè¿°</th><th>ä½¿ç”¨ä¸¾ä¾‹</th></tr></thead><tbody><tr><td>head</td><td>æ˜¾ç¤ºæ–‡ä»¶çš„æœ€åˆå‡ è¡Œ</td><td>head -20 filename</td></tr><tr><td>tail</td><td>æ˜¾ç¤ºæ–‡ä»¶çš„æœ€åå‡ è¡Œ</td><td>tail -15 filename</td></tr><tr><td>cut</td><td>æ˜¾ç¤ºæ–‡ä»¶æ¯è¡Œä¸­çš„æŸäº›åŸŸ</td><td>cut -f1,7 -d: /etc/passwd</td></tr><tr><td>colrm</td><td>ä»æ ‡å‡†è¾“å…¥ä¸­åˆ é™¤è‹¥å¹²åˆ—</td><td>colrm 8 20 file2</td></tr><tr><td>diff</td><td>æ¯”è¾ƒå¹¶æ˜¾ç¤ºä¸¤ä¸ªæ–‡ä»¶çš„å·®å¼‚</td><td>diff file1 file2</td></tr><tr><td>sort</td><td>æ’åºæˆ–å½’å¹¶æ–‡ä»¶</td><td>sort -d -f -u file1</td></tr><tr><td>uniq</td><td>å»æ‰æ–‡ä»¶ä¸­çš„é‡å¤è¡Œ</td><td>uniq file1 file2</td></tr><tr><td>comm</td><td>æ˜¾ç¤ºä¸¤æœ‰åºæ–‡ä»¶çš„å…¬å…±å’Œéå…¬å…±è¡Œ</td><td>comm file1 file2</td></tr><tr><td>wc</td><td>ç»Ÿè®¡æ–‡ä»¶çš„å­—ç¬¦æ•°ã€è¯æ•°å’Œè¡Œæ•°</td><td>wc filename</td></tr><tr><td>nl</td><td>ç»™æ–‡ä»¶åŠ ä¸Šè¡Œå·</td><td>nl file1 &gt;file2</td></tr></tbody></table><ol start="14"><li><p>è¿›ç¨‹æ“ä½œï¼š</p><table><thead><tr><th>å‘½ä»¤å</th><th>åŠŸèƒ½æè¿°</th><th>ä½¿ç”¨ä¸¾ä¾‹</th></tr></thead><tbody><tr><td>ps</td><td>æ˜¾ç¤ºè¿›ç¨‹å½“å‰çŠ¶æ€</td><td>ps u</td></tr><tr><td>kill</td><td>ç»ˆæ­¢è¿›ç¨‹</td><td>kill -9 30142</td></tr></tbody></table></li><li><p>æ—¶é—´æ“ä½œï¼š</p><table><thead><tr><th>å‘½ä»¤å</th><th>åŠŸèƒ½æè¿°</th><th>ä½¿ç”¨ä¸¾ä¾‹</th></tr></thead><tbody><tr><td>date</td><td>æ˜¾ç¤ºç³»ç»Ÿçš„å½“å‰æ—¥æœŸå’Œæ—¶é—´</td><td>date</td></tr><tr><td>cal</td><td>æ˜¾ç¤ºæ—¥å†</td><td>cal 8 1996</td></tr><tr><td>time</td><td>ç»Ÿè®¡ç¨‹åºçš„æ‰§è¡Œæ—¶é—´</td><td>time a.out</td></tr></tbody></table></li><li><p>ç½‘ç»œä¸é€šä¿¡æ“ä½œï¼š</p><table><thead><tr><th>å‘½ä»¤å</th><th>åŠŸèƒ½æè¿°</th><th>ä½¿ç”¨ä¸¾ä¾‹</th></tr></thead><tbody><tr><td>telnet</td><td>è¿œç¨‹ç™»å½•</td><td>telnet hpc.sp.net.edu.cn</td></tr><tr><td>rlogin</td><td>è¿œç¨‹ç™»å½•</td><td>rlogin hostname -l username</td></tr><tr><td>rsh</td><td>åœ¨è¿œç¨‹ä¸»æœºæ‰§è¡ŒæŒ‡å®šå‘½ä»¤</td><td>rsh f01n03 date</td></tr><tr><td>ftp</td><td>åœ¨æœ¬åœ°ä¸»æœºä¸è¿œç¨‹ä¸»æœºä¹‹é—´ä¼ è¾“æ–‡ä»¶</td><td>ftpftp.sp.net.edu.cn</td></tr><tr><td>rcp</td><td>åœ¨æœ¬åœ°ä¸»æœºä¸è¿œç¨‹ä¸»æœº ä¹‹é—´å¤åˆ¶æ–‡ä»¶</td><td>rcp file1 host1:file2</td></tr><tr><td>ping</td><td>ç»™ä¸€ä¸ªç½‘ç»œä¸»æœºå‘é€ å›åº”è¯·æ±‚</td><td>ping hpc.sp.net.edu.cn</td></tr><tr><td>mail</td><td>é˜…è¯»å’Œå‘é€ç”µå­é‚®ä»¶</td><td>mail</td></tr><tr><td>write</td><td>ç»™å¦ä¸€ç”¨æˆ·å‘é€æŠ¥æ–‡</td><td>write username pts/1</td></tr><tr><td>mesg</td><td>å…è®¸æˆ–æ‹’ç»æ¥æ”¶æŠ¥æ–‡</td><td>mesg n</td></tr></tbody></table></li><li><p>Korn Shell å‘½ä»¤ï¼š</p><table><thead><tr><th>å‘½ä»¤å</th><th>åŠŸèƒ½æè¿°</th><th>ä½¿ç”¨ä¸¾ä¾‹</th></tr></thead><tbody><tr><td>history</td><td>åˆ—å‡ºæœ€è¿‘æ‰§è¡Œè¿‡çš„ å‡ æ¡å‘½ä»¤åŠç¼–å·</td><td>history</td></tr><tr><td>r</td><td>é‡å¤æ‰§è¡Œæœ€è¿‘æ‰§è¡Œè¿‡çš„ æŸæ¡å‘½ä»¤</td><td>r -2</td></tr><tr><td>alias</td><td>ç»™æŸä¸ªå‘½ä»¤å®šä¹‰åˆ«å</td><td>alias del=rm -i</td></tr><tr><td>unalias</td><td>å–æ¶ˆå¯¹æŸä¸ªåˆ«åçš„å®šä¹‰</td><td>unalias del</td></tr></tbody></table></li><li><p>å…¶å®ƒå‘½ä»¤ï¼š</p><table><thead><tr><th>å‘½ä»¤å</th><th>åŠŸèƒ½æè¿°</th><th>ä½¿ç”¨ä¸¾ä¾‹</th></tr></thead><tbody><tr><td>uname</td><td>æ˜¾ç¤ºæ“ä½œç³»ç»Ÿçš„æœ‰å…³ä¿¡æ¯</td><td>uname -a</td></tr><tr><td>clear</td><td>æ¸…é™¤å±å¹•æˆ–çª—å£å†…å®¹</td><td>clear</td></tr><tr><td>env</td><td>æ˜¾ç¤ºå½“å‰æ‰€æœ‰è®¾ç½®è¿‡çš„ç¯å¢ƒå˜é‡</td><td>env</td></tr><tr><td>who</td><td>åˆ—å‡ºå½“å‰ç™»å½•çš„æ‰€æœ‰ç”¨æˆ·</td><td>who</td></tr><tr><td>whoami</td><td>æ˜¾ç¤ºå½“å‰æ­£è¿›è¡Œæ“ä½œçš„ç”¨æˆ·å</td><td>whoami</td></tr><tr><td>tty</td><td>æ˜¾ç¤ºç»ˆç«¯æˆ–ä¼ªç»ˆç«¯çš„åç§°</td><td>tty</td></tr><tr><td>stty</td><td>æ˜¾ç¤ºæˆ–é‡ç½®æ§åˆ¶é”®å®šä¹‰</td><td>stty -a</td></tr><tr><td>du</td><td>æŸ¥è¯¢ç£ç›˜ä½¿ç”¨æƒ…å†µ</td><td>du -k subdir</td></tr><tr><td>df</td><td>æ˜¾ç¤ºæ–‡ä»¶ç³»ç»Ÿçš„æ€»ç©ºé—´å’Œå¯ç”¨ç©ºé—´</td><td>df</td></tr><tr><td>w</td><td>æ˜¾ç¤ºå½“å‰ç³»ç»Ÿæ´»åŠ¨çš„æ€»ä¿¡æ¯</td><td>w</td></tr></tbody></table></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> macOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HexoBlogæ­å»º</title>
      <link href="/20151124/hexo-blog-build/"/>
      <url>/20151124/hexo-blog-build/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="HexoBlog-æ­å»º"><a href="#HexoBlog-æ­å»º" class="headerlink" title="HexoBlog æ­å»º"></a>HexoBlog æ­å»º</h1><p>æ›´è¯¦ç»†æ•™ç¨‹å‚è€ƒï¼š<a href="https://easyhexo.com/">https://easyhexo.com/</a></p><h2 id="ä¸€-ç¯å¢ƒæ­å»º"><a href="#ä¸€-ç¯å¢ƒæ­å»º" class="headerlink" title="ä¸€.ç¯å¢ƒæ­å»º"></a>ä¸€.ç¯å¢ƒæ­å»º</h2><h3 id="1-å®‰è£…-git"><a href="#1-å®‰è£…-git" class="headerlink" title="1. å®‰è£… git"></a>1. å®‰è£… git</h3><pre><code>- Mac OSXä¸‹:å®‰è£…Xcodeå³å¯/æˆ–è€…å®‰è£…å‘½ä»¤è¡Œå·¥å…·- Windowsä¸‹:å®‰è£…git bash</code></pre><span id="more"></span><h3 id="2-å®‰è£…-node-js"><a href="#2-å®‰è£…-node-js" class="headerlink" title="2. å®‰è£… node.js"></a>2. å®‰è£… node.js</h3><ul><li><p>1ï¼‰Mac OSX ä¸‹:é¦–å…ˆå®‰è£… Ruby ç¯å¢ƒï¼Œç„¶åå®‰è£… HomeBrewï¼ˆè¯¦æƒ… Googleï¼‰</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ ruby <span class="token parameter variable">-e</span> "<span class="token variable"><span class="token variable">$(</span><span class="token function">curl</span> <span class="token parameter variable">-fsSL</span> https://raw.github.com/Homebrew/homebrew/go/install<span class="token variable">)</span></span>â€<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>2ï¼‰ä½¿ç”¨ Homebrew å®‰è£… Node.js (æ³¨æ„æ£€æŸ¥ Node ç‰ˆæœ¬ï¼Œæˆªæ­¢ 2020.05.12 14.x ç‰ˆæœ¬ ä¼šå¯¼è‡´ hexo éƒ¨ç½²å‡ºé”™)</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ brew update$ brew <span class="token function">install</span> <span class="token function">node</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>3ï¼‰Windows/OSX ä¸‹ä¹Ÿå¯ä»¥è¿›å…¥<a href="https://nodejs.org/en/">Node.js å®˜ç½‘</a>ä¸‹è½½å®‰è£…åŒ…å®‰è£…</p></li><li><p>4ï¼‰ä¸€èˆ¬ Node modules é€šå¸¸è¢«å®‰è£…åœ¨æ¯ä¸ªé¡¹ç›®çš„æœ¬åœ°æ–‡ä»¶å¤¹ node_modulesï¼ŒNpm ä½¿ç”¨(æ›´è¯¦ç»†çš„å‘½ä»¤æ“ä½œå‚è€ƒç™¾åº¦/Google)</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">npm</span> <span class="token function">install</span> <span class="token operator">&lt;</span>package<span class="token operator">&gt;</span>     <span class="token comment"># å®‰è£…åœ¨æœ¬åœ°é¡¹ç›®ä¸­</span>$ <span class="token function">npm</span> <span class="token function">install</span> <span class="token parameter variable">-g</span> <span class="token operator">&lt;</span>package<span class="token operator">&gt;</span>  <span class="token comment"># å®‰è£…åœ¨å…¨å±€</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li></ul><h2 id="äºŒ-å®‰è£…-Hexoï¼ˆå‚è€ƒHexoï¼‰"><a href="#äºŒ-å®‰è£…-Hexoï¼ˆå‚è€ƒHexoï¼‰" class="headerlink" title="äºŒ.å®‰è£… Hexoï¼ˆå‚è€ƒHexoï¼‰"></a>äºŒ.å®‰è£… Hexoï¼ˆå‚è€ƒ<a href="https://hexo.io/">Hexo</a>ï¼‰</h2><h3 id="1-åˆå§‹åŒ–å’Œå®‰è£…"><a href="#1-åˆå§‹åŒ–å’Œå®‰è£…" class="headerlink" title="1. åˆå§‹åŒ–å’Œå®‰è£…"></a>1. åˆå§‹åŒ–å’Œå®‰è£…</h3><p>åœ¨ Finder ä¸­å»ºç«‹æ–°çš„æ–‡ä»¶å¤¹ Hexoï¼Œcd è¿›å…¥è¿™ä¸ªç›®å½•ä¸‹(æ¨èä½¿ç”¨ iTerm2)è¿›è¡Œæ“ä½œ</p><pre><code><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token builtin class-name">cd</span> /Users/weico/Hexo<span class="token comment">#è¿™æ˜¯æˆ‘çš„ç”µè„‘</span>$ <span class="token function">npm</span> <span class="token function">install</span> hexo-cli <span class="token parameter variable">-g</span>$ hexo init blog$ <span class="token builtin class-name">cd</span> blog$ <span class="token function">npm</span> <span class="token function">install</span>$ hexo g    <span class="token comment">#ç”Ÿæˆé™æ€åšå®¢</span>$ hexo s<span class="token comment">#ä¹Ÿå¯ä»¥æŒ‡å®šç«¯å£$ hexo server -p 5000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></code></pre><h3 id="2-Hexo-ç®€å•ä½¿ç”¨"><a href="#2-Hexo-ç®€å•ä½¿ç”¨" class="headerlink" title="2. Hexo ç®€å•ä½¿ç”¨"></a>2. Hexo ç®€å•ä½¿ç”¨</h3><ul><li><p>1ï¼‰å¸¸ç”¨å‘½ä»¤</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo new <span class="token string">"postName"</span> <span class="token comment">#æ–°å»ºæ–‡ç« </span>$ hexo new page <span class="token string">"pageName"</span> <span class="token comment">#æ–°å»ºé¡µé¢</span>$ hexo generate <span class="token comment">#ç”Ÿæˆé™æ€é¡µé¢è‡³publicç›®å½•</span>$ hexo server <span class="token comment">#å¼€å¯é¢„è§ˆè®¿é—®ç«¯å£ï¼ˆé»˜è®¤ç«¯å£4000ï¼Œ'ctrl + c'å…³é—­serverï¼‰</span>$ hexo deploy <span class="token comment">#å°†.deployç›®å½•éƒ¨ç½²åˆ°GitHub</span>$ hexo <span class="token builtin class-name">help</span>  <span class="token comment"># æŸ¥çœ‹å¸®åŠ©</span>$ hexo version  <span class="token comment">#æŸ¥çœ‹Hexoçš„ç‰ˆæœ¬</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>2ï¼‰å¤åˆå‘½ä»¤</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo deploy <span class="token parameter variable">-g</span>  <span class="token comment">#ç”ŸæˆåŠ éƒ¨ç½²</span>$ hexo server <span class="token parameter variable">-g</span>  <span class="token comment">#ç”ŸæˆåŠ é¢„è§ˆ</span>$ hexo cl <span class="token operator">&amp;&amp;</span> hexo g <span class="token operator">&amp;&amp;</span> hexo d <span class="token operator">&amp;&amp;</span> hexo cl<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>3ï¼‰å‘½ä»¤ç®€å†™</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo n <span class="token operator">==</span> hexo new$ hexo g <span class="token operator">==</span> hexo generate$ hexo s <span class="token operator">==</span> hexo server$ hexo d <span class="token operator">==</span> hexo deploy<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h3 id="3-éƒ¨ç½²åˆ°-GitHub"><a href="#3-éƒ¨ç½²åˆ°-GitHub" class="headerlink" title="3. éƒ¨ç½²åˆ° GitHub"></a>3. éƒ¨ç½²åˆ° GitHub</h3><ul><li>1ï¼‰é¦–å…ˆè®¾ç½®ä½ çš„ç”¨æˆ·åå¯†ç <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">git</span> config <span class="token parameter variable">--global</span> user.email <span class="token string">"bu.ru@qq.com"</span>$ <span class="token function">git</span> config <span class="token parameter variable">--global</span> user.name <span class="token string">"bruce-sha"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li>2ï¼‰ç”Ÿæˆå¯†é’¥<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ ssh-keygen <span class="token parameter variable">-t</span> rsa <span class="token parameter variable">-C</span> <span class="token string">"bu.ru@qq.com"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li>3ï¼‰åˆ°/Users/ç”¨æˆ·å/.ssh ä¸‹æ‰“å¼€.pub æ–‡ä»¶å°†å…¶æ·»åŠ åˆ° Github ä¸Šçš„ SSH Key</li><li>4ï¼‰æ‰§è¡Œ npm install hexo-deployer-git â€“save ## å®‰è£…éƒ¨ç½²æ‰€éœ€è¦çš„æ’ä»¶</li><li>5ï¼‰éƒ¨ç½²åˆ° Github å‰éœ€è¦é…ç½®_config.yml æ–‡ä»¶ï¼Œé¦–å…ˆæ‰¾åˆ°ä¸‹é¢çš„å†…å®¹<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># Deployment</span><span class="token comment">## Docs: http://hexo.io/docs/deployment.html</span><span class="token key atrule">deploy</span><span class="token punctuation">:</span>  <span class="token key atrule">type</span><span class="token punctuation">:</span><span class="token comment"># å°†ä¸Šé¢å†…å®¹ä¿®æ”¹ä¸ºï¼š</span><span class="token comment"># Deployment</span><span class="token comment">## Docs: http://hexo.io/docs/deployment.html</span><span class="token key atrule">deploy</span><span class="token punctuation">:</span>  <span class="token key atrule">type</span><span class="token punctuation">:</span> git<span class="token comment">#è¿™é‡Œä½¿ç”¨gitï¼Œè€Œä¸ä½¿ç”¨github</span>  <span class="token key atrule">repository</span><span class="token punctuation">:</span> git@github.com<span class="token punctuation">:</span>weikeet/weikeet.github.io.git<span class="token comment">#è¿™æ˜¯æˆ‘çš„Githubè´¦æˆ·</span>  <span class="token key atrule">branch</span><span class="token punctuation">:</span> master<span class="token comment">#éƒ¨ç½²åˆ†æ”¯</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h3 id="4-æ’ä»¶å®‰è£…"><a href="#4-æ’ä»¶å®‰è£…" class="headerlink" title="4. æ’ä»¶å®‰è£…"></a>4. æ’ä»¶å®‰è£…</h3><ul><li><p>1ï¼‰sitemap æ’ä»¶å®‰è£…ã€ä½¿ç”¨-å¯ä»¥å°†ä½ ç«™ç‚¹åœ°å›¾æäº¤ç»™æœç´¢å¼•æ“ï¼Œæ–‡ä»¶è·¯å¾„\sitemap.xml</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">npm</span> <span class="token function">install</span> hexo-generator-sitemap<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none"># ExtensionsPlugins:- hexo-generator-sitemap#sitemapsitemap:  path: sitemap.xml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>2ï¼‰feed æ’ä»¶å®‰è£…ã€ä½¿ç”¨-RSS çš„ç”Ÿæˆæ’ä»¶ï¼Œä½ å¯ä»¥åœ¨é…ç½®æ˜¾ç¤ºä½ ç«™ç‚¹çš„ RSSï¼Œæ–‡ä»¶è·¯å¾„\atom.xml</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">npm</span> <span class="token function">install</span> hexo-generator-feed<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none"># ExtensionsPlugins:- hexo-generator-feed- hexo-generator-sitemap#Feed Atomfeed:  type: atom  path: atom.xml  limit: 20<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h3 id="5-å…¬ç›Š-404-é¡µé¢"><a href="#5-å…¬ç›Š-404-é¡µé¢" class="headerlink" title="5. å…¬ç›Š 404 é¡µé¢"></a>5. å…¬ç›Š 404 é¡µé¢</h3><ul><li>è…¾è®¯å…¬ç›Š 404 é¡µé¢-åœ¨ä¸»é¢˜çš„ source ç›®å½•ä¸‹åˆ›å»º 404.htmlï¼Œå†…å®¹å¦‚ä¸‹<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content-type<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/html;charset=utf-8;<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>IE=edge,chrome=1<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>robots<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>all<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>robots<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>index,follow<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span>      <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span>      <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.qq.com/404/search_children.js<span class="token punctuation">"</span></span>      <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span>      <span class="token attr-name">homePageUrl</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>your site url <span class="token punctuation">"</span></span>      <span class="token attr-name">homePageName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>å›åˆ°æˆ‘çš„ä¸»é¡µ<span class="token punctuation">"</span></span>    <span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h3 id="6-ä¸»ä½“é€‰æ‹©å’Œé…ç½®"><a href="#6-ä¸»ä½“é€‰æ‹©å’Œé…ç½®" class="headerlink" title="6. ä¸»ä½“é€‰æ‹©å’Œé…ç½®"></a>6. ä¸»ä½“é€‰æ‹©å’Œé…ç½®</h3><p>GitHub æˆ–è€…åœ¨å®˜ç½‘å¯ä»¥æ‰¾åˆ°å¾ˆå¤šå¾ˆæ¼‚äº®çš„ä¸»é¢˜ï¼Œå®‰è£…å¯¹åº”çš„æ–‡æ¡£è¿›è¡Œé…ç½®å³å¯</p><p>ä¹Ÿå¯ä»¥å‚è€ƒ <a href="https://easyhexo.com/">https://easyhexo.com/</a> é‡Œé¢æ‰€ç½—åˆ—åˆ°çš„ä¸»é¢˜ï¼Œéƒ½æ˜¯éå¸¸ä¸é”™çš„</p><h3 id="7-Q-amp-A"><a href="#7-Q-amp-A" class="headerlink" title="7. Q &amp; A"></a>7. Q &amp; A</h3><ul><li><p>1ï¼‰hexo ERROR Deployer not found: githubï¼Œä¸èƒ½éƒ¨ç½²åˆ° githubã€‚</p><pre class="line-numbers language-none"><code class="language-none">è§£å†³åŠæ³•ï¼š1.å®‰è£… npm install hexo-deployer-git â€“saveï¼›2.å°†Hexoçš„é…ç½®æ–‡ä»¶_config.ymlä¸­çš„deploy çš„ typeç”±githubæ”¹ä¸ºgit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>2ï¼‰ç”Ÿæˆ SSH key æ—¶ï¼Œåœ¨é‚£ä¸ªç›®å½•ä¸‹æ‰§è¡Œçš„ ssh-keygen -t rsa -C â€œ<a href="mailto:xxxx@xxxx.com">xxxx@xxxx.com</a>â€å°±ä¼šåœ¨é‚£ç”Ÿæˆ.pub æ–‡ä»¶ï¼Œå¹¶ä¸æ˜¯åœ¨.ssh é‡Œé¢ QAQ</p></li><li><p>3ï¼‰SSH æ— æ³•è¿æ¥åˆ° GitHub æ—¶ï¼Œå°è¯• ssh-add ~/.ssh/ç§é’¥æ–‡ä»¶å</p></li><li><p>4ï¼‰å®‰è£…çš„æ—¶å€™æœ€å¥½åŠ ä¸Š sudo</p></li></ul><h2 id="Hexo-è‡ªåŠ¨æ„å»º-By-Travis"><a href="#Hexo-è‡ªåŠ¨æ„å»º-By-Travis" class="headerlink" title="Hexo è‡ªåŠ¨æ„å»º By Travis"></a>Hexo è‡ªåŠ¨æ„å»º By Travis</h2><h3 id="é…ç½®-GitHub-Token"><a href="#é…ç½®-GitHub-Token" class="headerlink" title="é…ç½® GitHub Token"></a>é…ç½® GitHub Token</h3><p>å¦‚æœéœ€è¦ä½¿ç”¨ travis è‡ªåŠ¨åŒ–æ„å»ºä½ çš„åšå®¢ï¼Œtravis è‡ªç„¶éœ€è¦è¯»å†™ä½ çš„ GitHub ä¸Šçš„ Repoã€‚GitHub æä¾›äº† token æœºåˆ¶æ¥ä¾›å¤–éƒ¨è®¿é—®ä½ çš„ä»“åº“ã€‚</p><p>è¿›å…¥<a href="https://github.com/settings/tokens">github.com/settings/tokens</a>ï¼Œç”Ÿæˆä¸€ä¸ªä¾› travis è¯»å†™ä½ çš„ GitHub ç”¨çš„ tokenï¼Œè‡³äº token çš„æƒé™ï¼Œä¸ä¼šçš„ç›´æ¥å…¨é€‰äº†ï¼Œä½†æ˜¯ä¸å»ºè®®è¿™æ ·åšï¼Œé£é™©æ¯”è¾ƒå¤§ï¼Œæˆ–è€…é€‰æ‹©èƒ½å¤Ÿè®¿é—®å’Œæäº¤ä»“åº“ä»£ç çš„æƒé™å³å¯ï¼Œtoken æ³¨æ„ä¿å¯†ï¼Œå¾…ä¼šä¼šç”¨åˆ°ã€‚<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/2020-05-12/15892123178972.jpg" alt="-w1028"></p><h3 id="é…ç½®-Travis-CI"><a href="#é…ç½®-Travis-CI" class="headerlink" title="é…ç½® Travis-CI"></a>é…ç½® Travis-CI</h3><p>ä½¿ç”¨ GitHub è´¦å·ç™»é™† travisï¼Œåœ¨ travis è¿›å…¥ä»“åº“åŒæ­¥ç®¡ç†è¿›å…¥ travis-ci.org/profileï¼Œæ‰“å¼€åˆšæ‰æ‰˜ç®¡çš„ hexo åšå®¢æºç ä»“åº“åŒæ­¥å¼€å…³<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/2020-05-12/15892124687030.jpg" alt="-w682"></p><p>è¿›å…¥è®¾ç½®é¡µï¼Œè®¾ç½®è‡ªåŠ¨åŒ–ç¼–è¯‘æ—¶æœºï¼Œè‡ªåŠ¨åŒ–ç¼–è¯‘è¿‡ç¨‹ä¸­éœ€è¦ç”¨åˆ°çš„å˜é‡ã€‚<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/2020-05-12/15892127916778.jpg" alt="-w1015"><br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/2020-05-12/15892128991659.jpg" alt="-w1171"></p><p>æ·»åŠ å¿…è¦çš„ Shell å˜é‡<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/2020-05-12/15892129715179.jpg" alt="-w1475"><br>è®°ä½ NAME åœ¨é…ç½® travis.yml ä¼šç”¨åˆ°</p><h3 id="ç¼–å†™-travis-yml-æ–‡ä»¶"><a href="#ç¼–å†™-travis-yml-æ–‡ä»¶" class="headerlink" title="ç¼–å†™.travis.yml æ–‡ä»¶"></a>ç¼–å†™.travis.yml æ–‡ä»¶</h3><p>.travis.yml æ˜¯ travis å¹³å°è¿›è¡Œè‡ªåŠ¨åŒ–æ„å»ºçš„é…ç½®æ–‡ä»¶ï¼Œtravis ä¼šæ ¹æ®é…ç½®æ–‡ä»¶ç”Ÿæˆä¸€ä¸ª shell è‡ªåŠ¨åŒ–è„šæœ¬ã€‚</p><p>è¿›å…¥ hexo åšå®¢æºç æœ¬åœ° repo</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> hexo<span class="token function">touch</span> .travis.yml<span class="token function">vim</span> .travis.yml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># æŒ‡å®šæ„å»ºç¯å¢ƒæ˜¯Node.js</span><span class="token key atrule">language</span><span class="token punctuation">:</span> node_js<span class="token comment"># æŒ‡å®šç‰ˆæœ¬ï¼Œå½“å‰æœ€æ–°ç‰ˆ14.xä¼šå¯¼è‡´hexoéƒ¨ç½²å¤±è´¥ï¼Œæ”¹ä¸º12.16</span><span class="token key atrule">node_js</span><span class="token punctuation">:</span>  <span class="token punctuation">-</span> 12.16.3<span class="token comment"># æŒ‡å®šéœ€è¦sudoæƒé™</span><span class="token key atrule">sudo</span><span class="token punctuation">:</span> required<span class="token comment"># è®¾ç½®ç¼“å­˜æ–‡ä»¶</span><span class="token key atrule">cache</span><span class="token punctuation">:</span>  <span class="token key atrule">directories</span><span class="token punctuation">:</span>    <span class="token punctuation">-</span> node_modules<span class="token comment"># è®¾ç½®é’©å­åªæ£€æµ‹hexoåˆ†æ”¯çš„pushå˜åŠ¨</span><span class="token key atrule">branches</span><span class="token punctuation">:</span>  <span class="token key atrule">only</span><span class="token punctuation">:</span>    <span class="token punctuation">-</span> hexo<span class="token comment"># åœ¨æ„å»ºä¹‹å‰å®‰è£…hexoç¯å¢ƒ</span><span class="token key atrule">before_install</span><span class="token punctuation">:</span>  <span class="token punctuation">-</span> npm install <span class="token punctuation">-</span>g hexo<span class="token punctuation">-</span>cli<span class="token comment"># å®‰è£…gitæ’ä»¶å’Œæœç´¢åŠŸèƒ½æ’ä»¶</span><span class="token key atrule">install</span><span class="token punctuation">:</span>  <span class="token punctuation">-</span> npm install  <span class="token punctuation">-</span> npm install hexo<span class="token punctuation">-</span>deployer<span class="token punctuation">-</span>git <span class="token punctuation">-</span><span class="token punctuation">-</span>save<span class="token comment"># æ‰§è¡Œæ¸…ç¼“å­˜ï¼Œç”Ÿæˆç½‘é¡µæ“ä½œ</span><span class="token key atrule">script</span><span class="token punctuation">:</span>  <span class="token punctuation">-</span> hexo clean  <span class="token punctuation">-</span> hexo generate<span class="token comment"># è®¾ç½®gitæäº¤åï¼Œé‚®ç®±ï¼›æ›¿æ¢çœŸå®tokenåˆ°_config.ymlæ–‡ä»¶ï¼Œæœ€ådepoyéƒ¨ç½²</span><span class="token key atrule">after_script</span><span class="token punctuation">:</span>  <span class="token punctuation">-</span> git config user.name "weikeet"  <span class="token punctuation">-</span> git config user.email "1570682285@qq.com"  <span class="token comment"># æ›¿æ¢åŒç›®å½•ä¸‹çš„ `_config.yml` æ–‡ä»¶ä¸­ `github_token` å­—ç¬¦ä¸²ä¸ºtravisåå°åˆšæ‰é…ç½®çš„å˜é‡ï¼Œæ³¨æ„&gt;æ­¤å¤„sedå‘½ä»¤ç”¨äº†åŒå¼•å·ï¼Œå•å¼•å·æ— æ•ˆ</span>  <span class="token punctuation">-</span> sed <span class="token punctuation">-</span>i "s/github_token/$<span class="token punctuation">{</span>GITHUB_TOKEN<span class="token punctuation">}</span>/g" ./_config.yml  <span class="token punctuation">-</span> sed <span class="token punctuation">-</span>i "s/coding_token/$<span class="token punctuation">{</span>CODING_TOKEN<span class="token punctuation">}</span>/g" ./_config.yml  <span class="token punctuation">-</span> sed <span class="token punctuation">-</span>i "s/phone_number/$<span class="token punctuation">{</span>CODING_NUMBER<span class="token punctuation">}</span>/g" ./_config.yml  <span class="token punctuation">-</span> hexo deploy<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¿®æ”¹ä¸‹_config.yml æ–‡ä»¶çš„ deploy èŠ‚ç‚¹ï¼š</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># ä¿®æ”¹å‰</span><span class="token key atrule">deploy</span><span class="token punctuation">:</span>  <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> git    <span class="token key atrule">repo</span><span class="token punctuation">:</span> git@github.com<span class="token punctuation">:</span>userName/RepoName.git    <span class="token key atrule">branch</span><span class="token punctuation">:</span> master<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">deploy</span><span class="token punctuation">:</span>  <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> git    <span class="token comment"># github_token ä¼šè¢« .travis.yml ä¸­sedå‘½ä»¤æ›¿æ¢</span>    <span class="token key atrule">repo</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github_token@github.com/weikeet/weikeet.github.io.git    <span class="token key atrule">branch</span><span class="token punctuation">:</span> master  <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> git    <span class="token comment"># æ–°çš„e.coding åªèƒ½ç”¨ç”µè¯å’Œé‚®ç®±ï¼Œä¸èƒ½ä½¿ç”¨è´¦æˆ·åï¼Œé‚®ç®±å¸¦@å­—ç¬¦ä¼šå¯¼è‡´Gité“¾æ¥è¯†åˆ«é”™è¯¯</span>    <span class="token key atrule">repo</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//phone_number<span class="token punctuation">:</span>coding_token@e.coding.net/weicools/Weicools.git    <span class="token key atrule">branch</span><span class="token punctuation">:</span> master<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="é…ç½®å‚è€ƒ"><a href="#é…ç½®å‚è€ƒ" class="headerlink" title="é…ç½®å‚è€ƒ"></a>é…ç½®å‚è€ƒ</h3><ul><li><a href="https://michael728.github.io/2019/06/16/cicd-hexo-blog-travis/">https://michael728.github.io/2019/06/16/cicd-hexo-blog-travis/</a></li><li><a href="http://duansm.top/2018/08/05/hexo-travis/">http://duansm.top/2018/08/05/hexo-travis/</a></li><li><a href="https://juejin.im/post/5a1fa30c6fb9a045263b5d2a">https://juejin.im/post/5a1fa30c6fb9a045263b5d2a</a></li><li><a href="https://github.com/xiong-it/xiong-it.github.io/blob/hexo/.travis.yml">https://github.com/xiong-it/xiong-it.github.io/blob/hexo/.travis.yml</a></li><li><a href="https://github.com/xiong-it/xiong-it.github.io/blob/hexo/_config.yml">https://github.com/xiong-it/xiong-it.github.io/blob/hexo/_config.yml</a></li></ul><h2 id="åŒçº¿éƒ¨ç½²-GitHub-Coding"><a href="#åŒçº¿éƒ¨ç½²-GitHub-Coding" class="headerlink" title="åŒçº¿éƒ¨ç½² GitHub+Coding"></a>åŒçº¿éƒ¨ç½² GitHub+Coding</h2><p>hexo deploy æ—¶(ç”±äºéƒ¨ç½²çš„ç¯å¢ƒä¸Šæ²¡æœ‰é…ç½® SSH)ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ https+TOKEN æ¨¡å¼ å®ç°æ›´å¿«éƒ¨ç½²<br>GitHub æ ¼å¼ï¼š<a href="https://github_token@github.com/useName/RepoName.git">https://github_token@github.com/useName/RepoName.git</a><br>Coding æ ¼å¼ï¼šhttps://[phone_number]:[coding_token/coding_password]@e.coding.net/useName/RepoName.git</p><blockquote><p>coding_password ä¸èƒ½å¸¦æœ‰@ å¦åˆ™ä¼šå¯¼è‡´ GitUrl è¯†åˆ«é”™è¯¯</p></blockquote><h3 id="å¼€å¯-Coding-Page"><a href="#å¼€å¯-Coding-Page" class="headerlink" title="å¼€å¯ Coding Page"></a>å¼€å¯ Coding Page</h3><p>æ‰“å¼€ä»“åº“è®¾ç½®ï¼Œæ‰“å¼€æŒç»­é›†æˆå’ŒæŒç»­éƒ¨ç½²<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/2020-05-12/15892135165321.jpg" alt="-w1760"><br>ç„¶åæ‰“å¼€æŒç»­éƒ¨ç½²ä¸­çš„é™æ€ç½‘ç«™ï¼Œç‚¹å‡»ç«‹å³éƒ¨ç½²ï¼Œå°±ä¼šå¾—åˆ°ä¸€ä¸ª coding çš„åšå®¢ç½‘å€<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/2020-05-12/15892136176032.jpg" alt="-w1893"><br>ç„¶åç‚¹å‡»è®¾ç½®ï¼Œé…ç½®åŸŸåï¼Œé…ç½®ä¹‹å‰éœ€è¦å…ˆåœ¨åŸŸåè§£æä¸­æ·»åŠ  CNAME è§£æé“ Coding çš„åšå®¢åœ°å€ä¾‹å¦‚ï¼š<a href="https://030dsd.coding-pages.com/">https://xxxx.coding-pages.com</a>ï¼Œæ³¨æ„å¦‚æœæœ‰ GitHub çš„è§£æçš„è¯éœ€è¦å…ˆåˆ é™¤ï¼Œå¦åˆ™æ— æ³•å¼€å¯ httpsã€‚(Coding Pages ç”³è¯· SSL/TLS å®‰å…¨è¯ä¹¦å‡ºç°ä»¥ä¸‹é”™è¯¯ï¼šurn:acme:error:unauthorized: Invalid response from <a href="http://www.xxxx.cn/.well-known/acme-challenge/ysOz9wW3U_GFPP8kRP4w8uknBZ9UfiUT7t2xpu9pDCw">http://www.xxxx.cn/.well-known/acme-challenge/ysOz9wW3U_GFPP8kRP4w8uknBZ9UfiUT7t2xpu9pDCw</a> [185.199.111.153]: ï¼Œå› ä¸ºè¿™ç§æƒ…å†µä¸‹ï¼Œåœ¨éªŒè¯åŸŸåæ‰€æœ‰æƒæ—¶ä¼šå®šä½åˆ° Github Pages çš„ä¸»æœºä¸Šå¯¼è‡´ SSL è¯ä¹¦ç”³è¯·å¤±è´¥)<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/141psU.png" alt="141psU"><br>é…ç½®å¥½åŸŸåè§£æä¹‹åï¼Œåœ¨ Coding ä¸­ç»‘å®šåŸŸåï¼Œç„¶åå¼ºåˆ¶å¼€å¯ httpsï¼Œå¼€å¯æˆåŠŸåå†å»é…ç½® GitHub çš„è§£æ<br><img src="https://blog-1251678165.cos.ap-chengdu.myqcloud.com/2020-05-12/15892138072661.jpg" alt="-w1578"></p><h3 id="åŒçº¿éƒ¨ç½²å‚è€ƒ"><a href="#åŒçº¿éƒ¨ç½²å‚è€ƒ" class="headerlink" title="åŒçº¿éƒ¨ç½²å‚è€ƒ"></a>åŒçº¿éƒ¨ç½²å‚è€ƒ</h3><ul><li><a href="https://zhuanlan.zhihu.com/p/111608743?from_voters_page=true">æ–°ç‰ˆ coding-page ä¸ Gridea å…è´¹æ­å»ºä¸ªäººåšå®¢</a></li><li><a href="https://www.cnblogs.com/sunhang32/p/11969964.html">åŠ é€Ÿè‡ªå·±çš„ hexoï¼Œä½¿ç”¨ GitHub+Coding å®ç°å›½å†…å¤–ç½‘ç«™åŠ é€Ÿ</a></li><li><a href="https://huaien.co/technology/enable-https-on-coding-pages/">ç»™æ‰˜ç®¡åœ¨ Coding Pages ä¸Šçš„åšå®¢å¼€å¯ HTTPS æ”¯æŒ ç”³è¯·å¤±è´¥çš„åŸå› </a></li><li><a href="https://www.cnblogs.com/TRHX/p/11699949.html">Coding Pages ç”³è¯· SSL è¯ä¹¦é”™è¯¯</a></li></ul><h2 id="å‚è€ƒæ•™ç¨‹"><a href="#å‚è€ƒæ•™ç¨‹" class="headerlink" title="å‚è€ƒæ•™ç¨‹"></a>å‚è€ƒæ•™ç¨‹</h2><ul><li><a href="https://easyhexo.com/">https://easyhexo.com/</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
